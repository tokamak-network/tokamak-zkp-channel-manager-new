Directory structure:
â””â”€â”€ tokamak-network-tokamak-zk-evm-contracts/
    â”œâ”€â”€ README.md
    â”œâ”€â”€ CLAUDE.md
    â”œâ”€â”€ foundry.toml
    â”œâ”€â”€ package.json
    â”œâ”€â”€ broadcast/
    â”‚   â”œâ”€â”€ Deploy.s.sol/
    â”‚   â”‚   â””â”€â”€ 11155111/
    â”‚   â”‚       â”œâ”€â”€ run-1756282185.json
    â”‚   â”‚       â””â”€â”€ run-latest.json
    â”‚   â”œâ”€â”€ DeployStateTransitionVerifier.s.sol/
    â”‚   â”‚   â””â”€â”€ 11155111/
    â”‚   â”‚       â”œâ”€â”€ run-1750594176.json
    â”‚   â”‚       â””â”€â”€ run-latest.json
    â”‚   â””â”€â”€ UpdateState.s.sol/
    â”‚       â””â”€â”€ 11155111/
    â”‚           â”œâ”€â”€ run-1750594477.json
    â”‚           â””â”€â”€ run-latest.json
    â”œâ”€â”€ groth16/
    â”‚   â”œâ”€â”€ README.md
    â”‚   â”œâ”€â”€ CLAUDE.md
    â”‚   â”œâ”€â”€ convert_proof.py
    â”‚   â”œâ”€â”€ circuits/
    â”‚   â”‚   â”œâ”€â”€ README.md
    â”‚   â”‚   â”œâ”€â”€ circom-2.0
    â”‚   â”‚   â”œâ”€â”€ package.json
    â”‚   â”‚   â””â”€â”€ src/
    â”‚   â”‚       â”œâ”€â”€ circuit_N4.circom
    â”‚   â”‚       â”œâ”€â”€ circuit_N5.circom
    â”‚   â”‚       â”œâ”€â”€ circuit_N6.circom
    â”‚   â”‚       â”œâ”€â”€ circuit_N7.circom
    â”‚   â”‚       â””â”€â”€ circuit_N8.circom
    â”‚   â”œâ”€â”€ prover/
    â”‚   â”‚   â”œâ”€â”€ README.md
    â”‚   â”‚   â”œâ”€â”€ 128_leaves_groth/
    â”‚   â”‚   â”‚   â”œâ”€â”€ generateProof.cjs
    â”‚   â”‚   â”‚   â””â”€â”€ input_example.json
    â”‚   â”‚   â”œâ”€â”€ 16_leaves_groth/
    â”‚   â”‚   â”‚   â”œâ”€â”€ generateProof.cjs
    â”‚   â”‚   â”‚   â””â”€â”€ input_example.json
    â”‚   â”‚   â”œâ”€â”€ 32_leaves_groth/
    â”‚   â”‚   â”‚   â”œâ”€â”€ generateProof.cjs
    â”‚   â”‚   â”‚   â””â”€â”€ input_example.json
    â”‚   â”‚   â””â”€â”€ 64_leaves_groth/
    â”‚   â”‚       â”œâ”€â”€ generateProof.cjs
    â”‚   â”‚       â””â”€â”€ input_example.json
    â”‚   â”œâ”€â”€ trusted-setup/
    â”‚   â”‚   â”œâ”€â”€ 128_leaves_vk/
    â”‚   â”‚   â”‚   â”œâ”€â”€ circuit_final.zkey
    â”‚   â”‚   â”‚   â””â”€â”€ verification_key.json
    â”‚   â”‚   â”œâ”€â”€ 16_leaves_vk/
    â”‚   â”‚   â”‚   â”œâ”€â”€ circuit_final.zkey
    â”‚   â”‚   â”‚   â””â”€â”€ verification_key.json
    â”‚   â”‚   â”œâ”€â”€ 32_leaves_vk/
    â”‚   â”‚   â”‚   â”œâ”€â”€ circuit_final.zkey
    â”‚   â”‚   â”‚   â””â”€â”€ verification_key.json
    â”‚   â”‚   â””â”€â”€ 64_leaves_vk/
    â”‚   â”‚       â”œâ”€â”€ circuit_final.zkey
    â”‚   â”‚       â””â”€â”€ verification_key.json
    â”‚   â””â”€â”€ verifier/
    â”‚       â”œâ”€â”€ foundry.toml
    â”‚       â”œâ”€â”€ scripts/
    â”‚       â”‚   â”œâ”€â”€ README.md
    â”‚       â”‚   â”œâ”€â”€ generate_verifier_128_leaves.py
    â”‚       â”‚   â”œâ”€â”€ generate_verifier_16_leaves.py
    â”‚       â”‚   â”œâ”€â”€ generate_verifier_32_leaves.py
    â”‚       â”‚   â””â”€â”€ generate_verifier_64_leaves.py
    â”‚       â”œâ”€â”€ src/
    â”‚       â”‚   â”œâ”€â”€ Groth16Verifier128Leaves.sol
    â”‚       â”‚   â”œâ”€â”€ Groth16Verifier128LeavesIC1.sol
    â”‚       â”‚   â”œâ”€â”€ Groth16Verifier128LeavesIC2.sol
    â”‚       â”‚   â”œâ”€â”€ Groth16Verifier16Leaves.sol
    â”‚       â”‚   â”œâ”€â”€ Groth16Verifier32Leaves.sol
    â”‚       â”‚   â”œâ”€â”€ Groth16Verifier64Leaves.sol
    â”‚       â”‚   â””â”€â”€ Groth16Verifier64LeavesIC.sol
    â”‚       â””â”€â”€ test/
    â”‚           â”œâ”€â”€ 128_leaves/
    â”‚           â”‚   â””â”€â”€ Groth16Verifier128LeavesTest.t.sol
    â”‚           â”œâ”€â”€ 16_leaves/
    â”‚           â”‚   â””â”€â”€ Groth16Verifier16LeavesTest.t.sol
    â”‚           â”œâ”€â”€ 32_leaves/
    â”‚           â”‚   â””â”€â”€ Groth16Verifier32LeavesTest.t.sol
    â”‚           â””â”€â”€ 64_leaves/
    â”‚               â””â”€â”€ Groth16Verifier64LeavesTest.t.sol
    â”œâ”€â”€ script/
    â”‚   â”œâ”€â”€ README.md
    â”‚   â”œâ”€â”€ generate-contracts-json.sh
    â”‚   â”œâ”€â”€ deploy/
    â”‚   â”‚   â”œâ”€â”€ README.md
    â”‚   â”‚   â”œâ”€â”€ deploy-v2.sh
    â”‚   â”‚   â”œâ”€â”€ DeployTokamakVerifier.s.sol
    â”‚   â”‚   â”œâ”€â”€ DeployV2.s.sol
    â”‚   â”‚   â”œâ”€â”€ env-v2.template
    â”‚   â”‚   â”œâ”€â”€ register-function.sh
    â”‚   â”‚   â”œâ”€â”€ RegisterFunction.s.sol
    â”‚   â”‚   â”œâ”€â”€ set-channel-public-key.sh
    â”‚   â”‚   â”œâ”€â”€ SetChannelPublicKey.s.sol
    â”‚   â”‚   â”œâ”€â”€ test-groth16-integration.sh
    â”‚   â”‚   â””â”€â”€ TestGroth16Integration.s.sol
    â”‚   â”œâ”€â”€ output/
    â”‚   â”‚   â”œâ”€â”€ README.md
    â”‚   â”‚   â””â”€â”€ contracts-sepolia.json
    â”‚   â””â”€â”€ upgrade/
    â”‚       â”œâ”€â”€ README.md
    â”‚       â”œâ”€â”€ update-groth16-verifier16.sh
    â”‚       â”œâ”€â”€ UpdateGroth16Verifier16.s.sol
    â”‚       â”œâ”€â”€ upgrade-bridge-admin-manager.sh
    â”‚       â”œâ”€â”€ upgrade-bridge-core.sh
    â”‚       â”œâ”€â”€ upgrade-bridge-deposit-manager.sh
    â”‚       â”œâ”€â”€ upgrade-bridge-proof-manager.sh
    â”‚       â”œâ”€â”€ upgrade-bridge-withdraw-manager.sh
    â”‚       â”œâ”€â”€ upgrade-contracts.sh
    â”‚       â”œâ”€â”€ upgrade-tokamak-verifier.sh
    â”‚       â”œâ”€â”€ UpgradeBridgeAdminManager.s.sol
    â”‚       â”œâ”€â”€ UpgradeBridgeCore.s.sol
    â”‚       â”œâ”€â”€ UpgradeBridgeDepositManager.s.sol
    â”‚       â”œâ”€â”€ UpgradeBridgeProofManager.s.sol
    â”‚       â”œâ”€â”€ UpgradeBridgeWithdrawManager.s.sol
    â”‚       â”œâ”€â”€ UpgradeContracts.s.sol
    â”‚       â””â”€â”€ UpgradeTokamakVerifier.s.sol
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ BridgeAdminManager.sol
    â”‚   â”œâ”€â”€ BridgeCore.sol
    â”‚   â”œâ”€â”€ BridgeDepositManager.sol
    â”‚   â”œâ”€â”€ BridgeProofManager.sol
    â”‚   â”œâ”€â”€ BridgeWithdrawManager.sol
    â”‚   â”œâ”€â”€ interface/
    â”‚   â”‚   â”œâ”€â”€ IBridgeCore.sol
    â”‚   â”‚   â”œâ”€â”€ IGroth16Verifier128Leaves.sol
    â”‚   â”‚   â”œâ”€â”€ IGroth16Verifier16Leaves.sol
    â”‚   â”‚   â”œâ”€â”€ IGroth16Verifier32Leaves.sol
    â”‚   â”‚   â”œâ”€â”€ IGroth16Verifier64Leaves.sol
    â”‚   â”‚   â”œâ”€â”€ ITokamakVerifier.sol
    â”‚   â”‚   â””â”€â”€ IZecFrost.sol
    â”‚   â”œâ”€â”€ library/
    â”‚   â”‚   â”œâ”€â”€ RLP.sol
    â”‚   â”‚   â””â”€â”€ ZecFrost.sol
    â”‚   â””â”€â”€ verifier/
    â”‚       â”œâ”€â”€ Groth16Verifier128Leaves.sol
    â”‚       â”œâ”€â”€ Groth16Verifier128LeavesIC1.sol
    â”‚       â”œâ”€â”€ Groth16Verifier128LeavesIC2.sol
    â”‚       â”œâ”€â”€ Groth16Verifier16Leaves.sol
    â”‚       â”œâ”€â”€ Groth16Verifier32Leaves.sol
    â”‚       â”œâ”€â”€ Groth16Verifier64Leaves.sol
    â”‚       â”œâ”€â”€ Groth16Verifier64LeavesIC.sol
    â”‚       â””â”€â”€ TokamakVerifier.sol
    â”œâ”€â”€ test/
    â”‚   â”œâ”€â”€ bridge/
    â”‚   â”‚   â”œâ”€â”€ Bridge.t.sol
    â”‚   â”‚   â”œâ”€â”€ ChannelIdTest.t.sol
    â”‚   â”‚   â”œâ”€â”€ ModularArchitectureTest.t.sol
    â”‚   â”‚   â”œâ”€â”€ MptKeysAndPubSignals.t.sol
    â”‚   â”‚   â”œâ”€â”€ PreAllocatedLeaves.t.sol
    â”‚   â”‚   â”œâ”€â”€ ProofSubmission.t.sol
    â”‚   â”‚   â”œâ”€â”€ TimeoutWithdrawal.t.sol
    â”‚   â”‚   â”œâ”€â”€ UserStorageSlots.t.sol
    â”‚   â”‚   â””â”€â”€ VerifyFinalBalancesInput.t.sol
    â”‚   â”œâ”€â”€ frost/
    â”‚   â”‚   â””â”€â”€ ZecFrost.t.sol
    â”‚   â”œâ”€â”€ groth16/
    â”‚   â”‚   â”œâ”€â”€ 128_leaves/
    â”‚   â”‚   â”‚   â”œâ”€â”€ Groth16Verifier128LeavesTest.t.sol
    â”‚   â”‚   â”‚   â”œâ”€â”€ proof.json
    â”‚   â”‚   â”‚   â””â”€â”€ public.json
    â”‚   â”‚   â”œâ”€â”€ 16_leaves/
    â”‚   â”‚   â”‚   â”œâ”€â”€ Groth16Verifier16LeavesTest.t.sol
    â”‚   â”‚   â”‚   â”œâ”€â”€ proof.json
    â”‚   â”‚   â”‚   â””â”€â”€ public.json
    â”‚   â”‚   â”œâ”€â”€ 32_leaves/
    â”‚   â”‚   â”‚   â”œâ”€â”€ Groth16Verifier32LeavesTest.t.sol
    â”‚   â”‚   â”‚   â”œâ”€â”€ proof.json
    â”‚   â”‚   â”‚   â””â”€â”€ public.json
    â”‚   â”‚   â””â”€â”€ 64_leaves/
    â”‚   â”‚       â”œâ”€â”€ Groth16Verifier64LeavesTest.t.sol
    â”‚   â”‚       â”œâ”€â”€ proof.json
    â”‚   â”‚       â””â”€â”€ public.json
    â”‚   â”œâ”€â”€ js-scripts/
    â”‚   â”‚   â”œâ”€â”€ generate_proof.sh
    â”‚   â”‚   â”œâ”€â”€ generateGroth16Proof.js
    â”‚   â”‚   â”œâ”€â”€ generateProof.js
    â”‚   â”‚   â”œâ”€â”€ merkleTree.js
    â”‚   â”‚   â””â”€â”€ simpleQuaternaryTree.js
    â”‚   â”œâ”€â”€ scalability/
    â”‚   â”‚   â””â”€â”€ ChannelScalability.t.sol
    â”‚   â””â”€â”€ verifier/
    â”‚       â”œâ”€â”€ Verifier.t.sol
    â”‚       â””â”€â”€ proof1/
    â”‚           â”œâ”€â”€ channel5_proof1.json
    â”‚           â””â”€â”€ channel5_proof2.json
    â”œâ”€â”€ utils/
    â”‚   â”œâ”€â”€ compareBlockHashMethods.js
    â”‚   â”œâ”€â”€ computeBlockHashFromEvent.js
    â”‚   â”œâ”€â”€ computeBlockInfoHash.js
    â”‚   â”œâ”€â”€ computeFunctionInstanceHash.js
    â”‚   â”œâ”€â”€ instance.json
    â”‚   â””â”€â”€ instance_description.json
    â””â”€â”€ .github/
        â”œâ”€â”€ ISSUE_TEMPLATE/
        â”‚   â”œâ”€â”€ bug_report.md
        â”‚   â””â”€â”€ feature_request.md
        â””â”€â”€ workflows/
            â”œâ”€â”€ claude-code-review.yml
            â”œâ”€â”€ claude.yml
            â””â”€â”€ test.yml

================================================
FILE: README.md
================================================
# Tokamak Private Channels Contracts

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Solidity](https://img.shields.io/badge/Solidity-0.8.29-blue.svg)](https://soliditylang.org/)
[![Foundry](https://img.shields.io/badge/Foundry-âœ“-green.svg)](https://getfoundry.sh/)

Our Channel Bridge enables on-demand state channels that hold private L2s. State channels are in charge of aggregating proofs and managing state root.

This repository implements the core smart contracts for the Tokamak zkEVM Bridge solution, providing Layer 2 privacy with Ethereum-equivalent functionality through zero-knowledge proofs.

### Modular Architecture Design

#### **RollupBridge Components**:
- **Modular Design**: Separated concerns across specialized manager contracts
- **Upgradeable Contracts**: UUPS proxy pattern for all core components
- **Gas Optimization**: Streamlined operations with efficient state management
- **Scalable Verification**: Dynamic tree size selection based on channel requirements

#### **Dynamic Merkle Tree Sizing**
The system automatically selects optimal Merkle tree sizes based on channel requirements:

- **Adaptive Sizing**: Tree sizes of 16, 32, 64, or 128 leaves based on participant Ã— token count
- **Groth16 Verification**: Specialized verifiers for each tree size
- **Efficient Proofs**: Optimized proof verification for different channel scales

## Key Features

- **Cryptographic Security**: Groth16 zero-knowledge proofs ensure computation integrity
- **Gas Efficiency**: Dynamic tree sizing with optimized state management
- **Multi-Party**: Supports 1-128 participants with configurable token sets
- **Comprehensive Verification**: Multi-layer verification including ZK-SNARK validation
- **Balance Conservation**: Mathematical guarantees preventing fund creation/destruction
- **State Management**: Secure state transitions with proper authorization
- **ðŸ”§pgradeable Architecture**: UUPS proxy pattern for seamless contract upgrades
- **Granular Withdrawals**: Per-token withdrawal system allowing multiple withdrawals
- **Secure Channel Management**: Channel leader controls with proper authorization

## Core Components

#### **Modular Bridge Architecture**
- **`BridgeCore.sol`**: Core state management and channel operations
- **`BridgeDepositManager.sol`**: Deposit handling and token management
- **`BridgeProofManager.sol`**: ZK proof submission and verification
- **`BridgeWithdrawManager.sol`**: Per-token withdrawal processing and finalization
- **`BridgeAdminManager.sol`**: Administrative functions and contract management
- **`IBridgeCore.sol`**: Core interface definitions and data structures

#### **Verification Layer**
- **`TokamakVerifier.sol`**: Main ZK-SNARK proof verification contract
- **`Groth16Verifier*.sol`**: Specialized Groth16 verifiers for different tree sizes (16, 32, 64, 128 leaves)
- **`ZecFrost.sol`**: FROST signature verification library

#### **Utility Layer**
- **`RLP.sol`**: Recursive Length Prefix encoding utilities

### Workflow Phases

1. **Channel Opening**: Authorization and participant registration with leader assignment
2. **Public Key Setup**: Channel leader sets cryptographic public key for signatures
3. **Deposit Period**: Secure fund collection with per-token balance tracking
4. **State Initialization**: Groth16 proof submission establishing initial state root
6. **Proof Submission**: ZK proof verification of computation results and final balances
7. **Signature Verification**: FROST signature validation for result authenticity
8. **Channel Closure**: State transition to Closed with verified final balances
9. **Settlement**: Cryptographically verified per-token fund distribution
10. **Cleanup**: Storage optimization and resource reclamation

## Security Model

### Cryptographic Guarantees
- **Balance Integrity**: Merkle tree proofs ensure tamper-evident balance tracking
- **State Consistency**: Groth16 proofs link all state transitions cryptographically
- **Consensus Security**: FROST multi-signature consensus mechanisms
- **ZK Privacy**: Computation verification without revealing details

### Economic Security
- **Deposit Protection**: Funds locked until valid closure proof
- **Conservation Laws**: Mathematical balance sum verification
- **Root History**: Rollback capability for state recovery
- **Channel Isolation**: Per-channel state prevents cross-contamination

## Getting Started

### Prerequisites

#### 1. Foundry Toolkit
Foundry is a blazing fast, portable and modular toolkit for Ethereum development.

```bash
# Install Foundry
curl -L https://foundry.paradigm.xyz | bash

# Follow the instructions to add Foundry to your PATH, then run:
foundryup

# Verify installation
forge --version
cast --version
anvil --version
```

#### 2. Node.js and npm
Required for additional tooling and dependencies.

```bash
# Using nvm (recommended)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 18
nvm use 18

# Verify installation
node --version  # Should show v18.x.x
npm --version
```

### Installation

```bash
# Clone the repository
git clone https://github.com/tokamak-network/Tokamak-Zk-EVM-contracts.git
cd Tokamak-Zk-EVM-contracts

# Install dependencies
forge install

# Build the project
forge build

# Run tests
forge test
```

## Testing

The project includes comprehensive test coverage for all components:

```bash
# Run all tests
forge test

# Run specific test contracts
forge test --match-contract RollupBridgeTest
forge test --match-contract WithdrawalsTest
forge test --match-contract ModularArchitectureTest

# Run with gas reporting
forge test --gas-report

# Run with verbose output
forge test -vvv

# Run specific test functions
forge test --match-test testChannelCreationAndDeposits
```

### Test Coverage

- **RollupBridge.t.sol**: 24 tests covering modular bridge operations and state transitions
- **Withdrawals.t.sol**: 10 tests covering per-token withdrawal functionality
- **ModularArchitectureTest.t.sol**: 5 tests covering modular architecture interactions
- **Groth16Verifier*.t.sol**: Tests covering Groth16 verification for different tree sizes (16, 32, 64, 128 leaves)
- **Verifier.t.sol**: 5 tests covering ZK proof verification
- **ZecFrost.t.sol**: 2 tests covering FROST signature verification
- **Total**: 52 comprehensive tests ensuring security and functionality

## Project Structure

```
src/
â”œâ”€â”€ interface/                         # Contract interfaces
â”‚   â”œâ”€â”€ IBridgeCore.sol                # Core bridge interface
â”‚   â”œâ”€â”€ IGroth16Verifier*.sol          # Groth16 verifier interfaces
â”‚   â”œâ”€â”€ ITokamakVerifier.sol           # Tokamak verifier interface
â”‚   â””â”€â”€ IZecFrost.sol                  # FROST signature interface
â”œâ”€â”€ verifier/                          # ZK proof verification
â”‚   â”œâ”€â”€ TokamakVerifier.sol            # Main Tokamak verifier
â”‚   â”œâ”€â”€ Groth16Verifier*.sol           # Groth16 verifiers for different tree sizes
â”‚   â””â”€â”€ Verifier.sol                   # Base verifier contract
â”œâ”€â”€ library/                           # Utility libraries
â”‚   â”œâ”€â”€ RLP.sol                        # RLP encoding utilities
â”‚   â””â”€â”€ ZecFrost.sol                   # FROST signature library
â”œâ”€â”€ BridgeCore.sol                     # Core state management
â”œâ”€â”€ BridgeDepositManager.sol           # Deposit handling
â”œâ”€â”€ BridgeProofManager.sol             # Proof management
â”œâ”€â”€ BridgeWithdrawManager.sol          # Per-token withdrawal management
â””â”€â”€ BridgeAdminManager.sol             # Administrative functions

test/
â”œâ”€â”€ bridge/                            # Bridge-specific tests
â”‚   â”œâ”€â”€ Bridge.t.sol                   # Modular bridge tests 
â”‚   â”œâ”€â”€ Withdrawals.t.sol              # Withdrawal functionality tests 
â”‚   â””â”€â”€ ModularArchitectureTest.t.sol  # Modular architecture tests 
â”œâ”€â”€ groth16/                           # Groth16 verifier tests
â”‚   â”œâ”€â”€ 16_leaves/                     # 16-leaf tree tests 
â”‚   â”œâ”€â”€ 32_leaves/                     # 32-leaf tree tests 
â”‚   â”œâ”€â”€ 64_leaves/                     # 64-leaf tree tests 
â”‚   â””â”€â”€ 128_leaves/                    # 128-leaf tree tests 
â”œâ”€â”€ verifier/                          # Verifier tests
â”‚   â””â”€â”€ Verifier.t.sol                 # ZK verifier tests 
â”œâ”€â”€ frost/                             # FROST signature tests
â”‚   â””â”€â”€ ZecFrost.t.sol                 # FROST tests
â”œâ”€â”€ js-scripts/                        # JavaScript utilities
â”‚   â”œâ”€â”€ generateGroth16Proof.js        # Groth16 proof generation
â”‚   â”œâ”€â”€ generateProof.js               # General proof generation
â”‚   â””â”€â”€ merkleTree.js                  # Merkle tree utilities
â””â”€â”€ scripts/                           # Test scripts
    â””â”€â”€ generate_proof.sh              # Proof generation script
```


## Contributing

We welcome contributions! Please see our [Contributing Guidelines](CONTRIBUTING.md) for details.

### Development Workflow

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/amazing-feature`
3. Make your changes
4. Add tests for new functionality
5. Ensure all tests pass: `forge test`
6. Commit your changes: `git commit -m 'Add amazing feature'`
7. Push to the branch: `git push origin feature/amazing-feature`
8. Open a Pull Request

### Code Style

- Follow Solidity style guide
- Use comprehensive NatSpec documentation
- Include tests for all new functionality
- Ensure gas optimization where possible

## Documentation

- **Technical Docs**: [docs/](./docs/) directory
- **Test Documentation**: Detailed test coverage and examples

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Support

- **Issues**: [GitHub Issues](https://github.com/tokamak-network/Tokamak-zkEVM-contracts/issues)
- **Discussions**: [GitHub Discussions](https://github.com/tokamak-network/Tokamak-zkEVM-contracts/discussions)
- **Documentation**: [docs/](./docs/) directory

## Acknowledgments

- **OpenZeppelin**: For secure contract libraries
- **Foundry**: For the excellent development toolkit
- **Community**: For feedback and contributions

---

**Built by the Tokamak Network team**

*For more information, visit [tokamak.network](https://tokamak.network)*


================================================
FILE: CLAUDE.md
================================================
# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Overview

This is the Tokamak zkEVM contracts repository - a Zero-Knowledge rollup bridge system that enables secure off-chain computation with on-chain settlement. The system uses ZK-SNARKs (specifically Groth16) for computation verification and manages state channels with configurable Merkle tree sizes.

## Development Commands

### Build & Testing
```bash
# Build all contracts
forge build

# Run all tests
forge test

# Run specific test files
forge test --match-contract RollupBridgeTest
forge test --match-contract WithdrawalsTest
forge test --match-contract ModularArchitectureTest

# Run with gas reporting
forge test --gas-report

# Run with verbose output for debugging
forge test -vvv

# Run specific test functions
forge test --match-test testChannelCreationAndDeposits
```

### Deployment & Scripts
```bash
# Deploy V2 contracts (main deployment)
./script/deploy/deploy-v2.sh sepolia

# Deploy TokamakVerifier
./script/deploy/deploy-tokamak-verifier.sh sepolia

# Upgrade contracts
./script/upgrade/upgrade-contracts.sh sepolia

# Register functions
./script/deploy/register-function.sh

# Set channel public key
./script/deploy/set-channel-public-key.sh

# Test Groth16 integration
./script/deploy/test-groth16-integration.sh
```

### Environment Setup
Copy `script/deploy/env-v2.template` to `.env` and configure:
```bash
PRIVATE_KEY=your_private_key
RPC_URL=your_rpc_url
ETHERSCAN_API_KEY=your_api_key
DEPLOYER_ADDRESS=0x...
```

## Architecture Overview

### Modular Bridge Design
The system uses a modular architecture with specialized manager contracts:

- **BridgeCore.sol**: Core state management and channel operations
- **BridgeDepositManager.sol**: Handles deposits and token management 
- **BridgeProofManager.sol**: ZK proof submission and verification
- **BridgeWithdrawManager.sol**: Per-token withdrawal processing
- **BridgeAdminManager.sol**: Administrative functions

### Channel Lifecycle
1. **Initialization**: Channel creation with participants and target contract
2. **Opening**: Public key setup by channel leader
3. **Deposits**: Secure fund collection with per-token tracking
4. **State Initialization**: Groth16 proof establishes initial state root
5. **Off-chain Computation**: L2 processing with consensus mechanisms
6. **Proof Submission**: ZK verification of computation results
7. **Signature Verification**: FROST signature validation
8. **Closure**: State transition with verified final balances
9. **Withdrawal**: Per-token fund distribution

### Verification Layer
- **TokamakVerifier.sol**: Main ZK-SNARK proof verification
- **Groth16Verifier*.sol**: Specialized verifiers for different tree sizes (16, 32, 64, 128 leaves)
- **ZecFrost.sol**: FROST signature verification library

### Dynamic Merkle Tree Sizing
The system automatically selects tree sizes based on channel requirements:
- Tree sizes: 16, 32, 64, or 128 leaves
- Selection based on participant Ã— token count
- Each size has its own optimized Groth16 verifier

## Key File Locations

### Core Contracts
- `src/BridgeCore.sol` - Main bridge logic
- `src/interface/IBridgeCore.sol` - Core interface definitions
- `src/verifier/TokamakVerifier.sol` - ZK proof verification
- `src/library/ZecFrost.sol` - FROST signatures
- `src/library/RLP.sol` - RLP encoding utilities

### Test Structure
- `test/bridge/` - Bridge functionality tests (39 tests total)
- `test/groth16/` - Groth16 verifier tests for each tree size
- `test/verifier/` - ZK verification tests
- `test/frost/` - FROST signature tests
- `test/js-scripts/` - JavaScript utilities for proof generation

### Deployment Scripts
- `script/deploy/DeployV2.s.sol` - Main deployment script
- `script/upgrade/UpgradeContracts.s.sol` - Contract upgrade script
- Shell wrappers in `script/deploy/` and `script/upgrade/`

## Security Features

- **UUPS Upgradeable**: Safe upgrade mechanism with storage protection
- **Balance Conservation**: Mathematical guarantees preventing fund loss/creation
- **Multi-signature Consensus**: FROST threshold signatures
- **Per-token Isolation**: Independent token balance management
- **ZK Privacy**: Computation verification without revealing details
- **Access Control**: Role-based permissions with channel leaders

## Testing Notes

- 52 comprehensive tests covering all functionality
- Gas limit configured to 100M for heavy ZK operations
- FFI enabled for JavaScript proof generation scripts
- Test data includes real Groth16 proofs in `test/groth16/*/proof.json`

## Common Development Patterns

- All contracts use OpenZeppelin Upgradeable pattern
- Contracts follow modular design with clear separation of concerns
- ZK verification is abstracted behind interfaces for different tree sizes
- Error handling uses custom errors for gas efficiency
- Events are emitted for all state changes

## Important Notes

- **No ETH Support**: System focused exclusively on ERC20 tokens
- **Channel Leaders**: Each channel has a designated leader for key operations
- **Tree Size Selection**: Automatic based on participant and token counts
- **Proof Generation**: Uses external JavaScript scripts with FFI
- **Upgrades**: UUPS pattern allows seamless contract upgrades while preserving state


================================================
FILE: foundry.toml
================================================
[profile.default]
src = "src"
out = "out"
libs = ["lib"]
remappings = [
    "@openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/",
    "@openzeppelin/=lib/openzeppelin-contracts/contracts/",
]

viaIr = true
optimizer = true
optimizer_runs = 200

evm_version = "prague"

# Enable FFI for JavaScript script integration
ffi = true

# Increase gas limit for tests
gas_limit = 100_000_000
block_gas_limit = 100_000_000

[profile.ci]
src = "src"
out = "out"
libs = ["lib"]
remappings = [
    "@openzeppelin-upgradeable/=lib/openzeppelin-contracts-upgradeable/contracts/",
    "@openzeppelin/=lib/openzeppelin-contracts/contracts/",
]

viaIr = true
optimizer = true
optimizer_runs = 200

evm_version = "prague"

# Enable FFI for JavaScript script integration
ffi = true

# Increase gas limit for CI builds
gas_limit = 100_000_000
block_gas_limit = 100_000_000

[profile.test]
gas_limit = 100_000_000
block_gas_limit = 100_000_000

# For specific heavy tests
[profile.heavy]
gas_limit = 1_000_000_000
block_gas_limit = 1_000_000_000


================================================
FILE: package.json
================================================
{
  "type": "module",
  "dependencies": {
    "ethers": "^6.14.1",
    "fs": "^0.0.1-security",
    "js-sha3": "^0.9.3",
    "msgpackr": "^1.11.3"
  }
}



================================================
FILE: broadcast/Deploy.s.sol/11155111/run-1756282185.json
================================================
{
  "transactions": [
    {
      "hash": "0x14395d21d193c2e09ab4e708c85c8a8b5186be2898f6c906c4dfe549664e13df",
      "transactionType": "CREATE",
      "contractName": "Poseidon4",
      "contractAddress": "0xa22a3ce2e3eb5865acdca8980f95c8eaa87ef4a1",
      "function": null,
      "arguments": null,
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x4aa779",
        "value": "0x0",
        "input": "0x6080806040523461001657614307908161001b8239f35b5f80fdfe604060808152600480361015610013575f80fd5b5f3560e01c80636ebd052f146109cd5780639116466d146107c45780639bf03e34146106c6578063c02c648a146104ad578063e10b107d1461028c5763e24372e11461005d575f80fd5b34610288575f36600319011261028857610075610a2c565b9060803683375f8252602082015f81528383015f815260608401915f835261009b6109f8565b9460a03687375f865251602086015251858501525160608401525160808301526100c3610c6c565b90602082519201519260a0366100d76109f8565b37925f925f5b83811061020957505f5b603881106101a757505f935b8385106101065760208787519051908152f35b90919293945f5b600581106101635750835f5b60058110610139575061012e90600192614210565b9501939291906100f3565b6001915061015061014a8285610c47565b516141be565b61015a8285610c47565b52018490610119565b916101a06001915f805160206142b28339815191526101828686610c47565b5161018d838961418a565b51900861019a8686610c47565b5261419c565b920161010d565b949180939491925f5b600581106101dd5750600191816101ca6101d193516141be565b8152614210565b950193929190936100e7565b928192506101ff905f805160206142b283398151915261018286600195610c47565b92019084916101b0565b945f94919293945b600581106102625750835f5b6005811061023e575061023290600192614210565b950193929190936100dd565b6001915061024f61014a8285610c47565b6102598285610c47565b5201849061021d565b916102816001915f805160206142b28339815191526101828686610c47565b9201610211565b5f80fd5b509034610288575f366003190112610288576102a6610a2c565b91608036843760019081845260208401600281528385016003815260608601918383526102d16109f8565b9660a03689375f885251602088015251858701525160608601525160808501526102f9610c6c565b90602082519201519460a03661030d6109f8565b37945f925f5b83811061042d57505f5b603881106103d257505f935b83851061033c5760208789519051908152f35b909192939480975f5b60058110610395575084825f5b6005811061037157505061036591614210565b97950193929190610329565b90915061038161014a8285610c47565b61038b8285610c47565b5201828691610352565b926103cb83915f805160206142b28339815191526103b38786610c47565b516103be838a61418a565b51900861019a8786610c47565b9301610345565b948281985f96939495965b60058110610402575090816101ca6103f593516141be565b979591949392910161031d565b93819250610423905f805160206142b28339815191526103b3878795610c47565b93019085916103dd565b9480975f95929394955b60058110610488575084825f5b6005811061046457505061045791614210565b9795919493929101610313565b90915061047461014a8285610c47565b61047e8285610c47565b5201828691610444565b926104a683915f805160206142b28339815191526103b38786610c47565b9301610437565b5090346102885760a0366003190112610288573660231215610288576104d16109f8565b9060a4823682116102885784905b8282106106b65750505060a0366104f46109f8565b376104fd610c6c565b928351906020809501519360a0366105136109f8565b37935f925f5b83811061063757505f5b603881106105dc57505f935b83851061055f57855187895f835b6005821061054a5760a085f35b8280600192865181520194019101909261053d565b90919293955f5b600581106105b65750835f5b60058110610592575061058790600192614210565b96019392919061052f565b600191506105a361014a8285610c47565b6105ad8285610c47565b52018490610572565b916105d56001915f805160206142b28339815191526101828686610c47565b9201610566565b959180939491925f5b6005811061060b5750600191816101ca6105ff93516141be565b96019392919093610523565b9281925061062d905f805160206142b283398151915261018286600195610c47565b92019084916105e5565b955f94919293945b600581106106905750835f5b6005811061066c575061066090600192614210565b96019392919093610519565b6001915061067d61014a8285610c47565b6106878285610c47565b5201849061064b565b916106af6001915f805160206142b28339815191526101828686610c47565b920161063f565b81358152602091820191016104df565b503461028857608036600319011261028857803560243560443591606435935f805160206142b28339815191528083101561077657808410156107765780851015610776578510156107285760208661072187878787610a4c565b9051908152f35b608490602087519162461bcd60e51b8352820152602260248201527f506f736569646f6e344669656c643a20696e70757420697320746f6f206c6172604482015261676560f01b6064820152fd5b865162461bcd60e51b8152602081840152602260248201527f506f736569646f6e344669656c643a20696e70757420697320746f6f206c6172604482015261676560f01b6064820152608490fd5b5034610288575f366003190112610288576107dd610a2c565b906080368337607b8252602082016101c881528383016103158152606084019162018af8835261080b6109f8565b9460a03687375f86525160208601525185850152516060840152516080830152610833610c6c565b90602082519201519260a0366108476109f8565b37925f925f5b83811061094e57505f5b603881106108f357505f935b8385106108765760208787519051908152f35b90919293945f5b600581106108cd5750835f5b600581106108a9575061089e90600192614210565b950193929190610863565b600191506108ba61014a8285610c47565b6108c48285610c47565b52018490610889565b916108ec6001915f805160206142b28339815191526101828686610c47565b920161087d565b949180939491925f5b600581106109225750600191816101ca61091693516141be565b95019392919093610857565b92819250610944905f805160206142b283398151915261018286600195610c47565b92019084916108fc565b945f94919293945b600581106109a75750835f5b60058110610983575061097790600192614210565b9501939291909361084d565b6001915061099461014a8285610c47565b61099e8285610c47565b52018490610962565b916109c66001915f805160206142b28339815191526101828686610c47565b9201610956565b5090346102885760803660031901126102885761072160209260643590604435906024359035610a4c565b6040519060a0820182811067ffffffffffffffff821117610a1857604052565b634e487b7160e01b5f52604160045260245ffd5b604051906080820182811067ffffffffffffffff821117610a1857604052565b929190610a57610a2c565b9360803686378452602084019081526040840191825260608401928352610a7c6109f8565b9360a03686375f8552516020850152516040840152516060830152516080820152610aa5610c6c565b602081519101519160a036610ab86109f8565b37915f905f5b60048110610bca57505f5b60388110610b7857505f925b60048410610ae557505050505190565b909192935f5b60058110610b3a5750825f5b60058110610b165750610b0c90600192614210565b9401929190610ad5565b60019150610b2761014a8285610c47565b610b318285610c47565b52018390610af7565b93610b716001915f805160206142b2833981519152610b598886610c47565b51610b64838861418a565b51900861019a8886610c47565b9401610aeb565b935f939192935b60058110610ba45750610b9983826101ca600194516141be565b940192919092610ac9565b93610bc36001915f805160206142b2833981519152610b598886610c47565b9401610b7f565b935f939192935b60058110610c215750825f5b60058110610bfd5750610bf290600192614210565b940192919092610abe565b60019150610c0e61014a8285610c47565b610c188285610c47565b52018390610bdd565b93610c406001915f805160206142b2833981519152610b598886610c47565b9401610bd1565b906005811015610c585760051b0190565b634e487b7160e01b5f52603260045260245ffd5b604080519067ffffffffffffffff9082810182811184821017610a1857612840840181811084821117610a185782526128009081368237845260209485850192610cb46109f8565b935f5b60a080821015610cda57908991610ccc6109f8565b903682378188015201610cb7565b50509384528051959691959094919287929082019190821181831017610a18577f5e876f8493c339c36750caa31382bea4a90d6928976a3f996a30a3f1af778f639186527f5c5bec06aa43ca811a9c78919fe505276e4625b2dc92b86947cc4d7726c77d3d81527f6268bc5f9031edb5b6bc2edbbe091cce714d51abbba4301fa0a19319da4ca232848201527f4572aeff3e581883c3333a4fcb784afdd0f4b81f0d34e36835fd9a2644342b6a868201526060907f2c44402b93c5ac82bc8bb58e947fca107e865d85b1cb0f1f32f0c05cdaf439f8828201526080937f023eb54d53e89505d0c9258bee0de17bb0a11e451b48d22d88549e05e2018403858301527f5c3c49994dfe7863f506ee54719e6ee22a8136da7b276fd95b222de90b48feec60a08301527f349b3f7366f89983b3858e40a22f53fa2e62ad46932303ce85d42591ca5141a360c08301527f0b383428a756701b8c1c1c38c9c3abbb4df3b6fbb5a581fe9bba326455776e9160e08301527f6814d01a7834e8f1f53b89bae25702ed6c864c49ffba3820e6106185e81a85e16101008301527f382d39c6bdbba256b12d3fa4476187c14c4867255ea999c6503e92f520e9a9186101208301527f507aa38edca7a8d6925c668abc3a17a3252efb8f94740a7775db0bb328d1061e6101408301527f3bd1bbe1f40eb3fa7def818257305e9c50a675d756e6aed051fc4e7b7b132d8b6101608301527f4ddaf59374164d01c4c07ac09d306653f607cb880ab16330c680994321df3f4a6101808301527f36a92b9f74005c1802eb60930a7135d4af73fc20a535506093f98fa0aa1fbd916101a08301527f1eeb8e80a4a1382bda0c063aa61dad5da57fa80865d0beeb2b9e69a07b5965f46101c08301527f245c1c6d6f21bf7dd2abd1626514169678fa53bd900f6bd2cd854a9a965cb77b6101e08301527f4fee9d33743fa477a4fe71f77e5c95778db9c7efee51846f4a2d369e18a15cdd6102008301527f1a1492b84929e7080f0b6c8b1c46e9164beed12136837032670d44165d269c696102208301527f64f9e3fa689c48974257c4e505827bb9c0babbe89366dfcbb3162eafab4e8b076102408301527f0b0a1a2b2762612d71d2f2d692c632218b5e47f3f0e38d638cfd365c313dbd486102608301527f05b20208ea0377139f322767d36fea854d28ccedb083ab8901f4054f822c51016102808301527f0710c608d8a48043e99dd94a0b1d22906b67dafb6bc5b95adf8c2f24ce81b0cd6102a08301527f68e5bf430d23864f21836ccefc1fac4801bdc00cc43de2608532d788c7fb45e76102c08301527f09221b8a932a7820912b20bf5b919b7e0a22b3c9d2a1f0d9832ca03b0fc0ed9f6102e08301527f65ac3ba4cbab3d2622b373ef54c1dfb299e7fb992555478d5c1c44ee786329536103008301527f114be59c06f561e8324e306a28896fb1dd3802773891f54f0b8243718ef125426103208301527f61d96c0b2e0683a2d7ffcd9e0b3a58b86fb3ecca7941391e597efc13f38ff5036103408301527f103454e35e0f4d690d8d1ab122b4c5c92e0512004f1af1e3140694c686cbeba96103608301527f2d2d628ded9373dcfc3ad59072a51b9a2d6c8c470753066195b77ca3a821fe476103808301527f2b0bf337fd4454a5e38344e0e711b9ae2281545fd99ad3fe46da2e1e4b9c98ce6103a08301527f0575c431f72a40242de5963e47cc7dad1aced5d9a1c9de5ac7ab5c22fad3cd676103c08301527f0ec8f181daf128e716d3d7726dcf8ecbdddadca0063dc726196baec197eb36126103e08301527f33779259084a94462f31c2650f6affd717ea200e62d2349f07fba50dd64b48756104008301527f122bdda32a00e4a3335a55fb2af4a24044fe2b223bebbbde2b32e09ef1add1016104208301527f14884ad16b1f79e5ba9d3c24b2f3f76272411ddfaa9bafb421ef4d583ba736bc6104408301527f323f85cbba64efc38ccc35c5fa9d673fef3ff652da7f2f93e176a40de61e1e706104608301527f1a3fac3af20c37aed0e41f6fa6f1a488401f16c61fc3a4e86cda951a0e3795e36104808301527f1d927c14cd47e25613656bc80171954894d2e882e35a4dc804cbc0803d47a8146104a08301527f22f1a2a2ade490e188fea20d062700568123e4b54290ab6a695584f3ec971eab6104c08301527f2c04db231c81645f30937dc5546efb30690acea9ef5769ce42000f486f893a456104e08301527f21385b6f914a8c6f421629278dfa84f2ccdcf621b05013247341438237ad3fc16105008301527f2f00090ff1cb76eaf3b6cf23718ae736af07c34cac823388e0234420247e31606105208301527f455e8b0828f3667021a434761d5b6a5fb2e90635a6b038e4315f8a30dda4af006105408301527f028b320c702e077887d5556c7c879c7d54c6c681497a1d4fa5f2045fc553211f6105608301527f2502f751749978112c96e7321ff1c0b76b3ff74190dadba0b67eac15462079f46105808301527f0a02577f723a21ced13408ed76b38ad8bbdfcc8132bb6dfbbbea8ece52e0e8106105a08301527f55d052b889557f2fc0e61e83b82261a759b75cfbec4c6f97b1104301163753b76105c08301527f450a0821b86175e4877ccb7e8b1918bbe3e88819bc9ed36ce30cca14b8eeb9116105e08301527f4a399ec4758d73d11ab365f26081aea3a61d156ec6f0185a18702e8ee1631f186106008301527f1305a1f607f37901c0a88b2b7f23672efec118296f4550a058f4f94c25b660926106208301527f08e98ff1f10c0092b41a881d5663d8d85b081830f3f5bc904dc9b2a88969344d6106408301527f1a986478818b795d1a509aff8d2ac2588342e320b77c1ebda86c5be7b03894876106608301527f3a68e478946a5cfc6c3a21c7416ad4afa64f7130ddf8986935942d6835665edd6106808301527f115b2ef9469d91408b6e1d46e671d335aabac9d8882cdf17d1afb385b1051e3e6106a08301527f0b7fe376d67252e90d9f06b43947fca03a50072c24d8598b7248fbc8b0d64e9e6106c08301527f621fba0544792a4910a92402dc5c56630bbdc50cad3edc99ee6e5466b72950426106e08301527f47ea2bb0150f7e51992433be07d695f5ee93a948cdee6fe573b5ddd9702ac19f6107008301527f3333d094869d1f23f0ae3787ad1c105122e8338b51b7a970260ea700d409d55e6107208301527f36291942b0c4d1329fa0db7230b3ef9be3e8e4b1b51897631bed81ef4d4053276107408301527f548bdc2c8e44774efaa30d0df03cd307b25ef86fe73bfd7de1c16116afa8d4326107608301527f2ff0b6bb42027bb7b5eff8a312df92db0928c4fd5f47b6cdd87a13c5983b50b56107808301527f4765640bd361f949a2ba640706c1f1436dc29d769c57a31b027bd6dd4c1c799b6107a08301527f311b329ed3aafeae007cabd2bd3cf506698ea4248dc684145e0d2a2fd789a8b86107c08301527f18cf391449564ad053c4af0b0734e6c1f1de59d415ede6c4ded5a29e644205656107e08301527f030053d7aa258bd41e80bc261fbea820091418b2fe5121ce24e12c1ad57cfe126108008301527f347d2cc8b97eca81ed23167c5c2f6cb214972cc54cb86f93e5e49b52ab79ef816108208301527f73e40cea4c8924cc70d7555087c7384af177bf4ba4fcd4d923c3bd78072bf4376108408301527f5d26bfff868d80acb7185d70543557aca3886e17dc537ca7997b834939f345256108608301527f41ebe1430659e09fcb9a8ae6be869b51bb1261dfda863efc4ccb60ab9d2d3dea6108808301527f32f72f5fabe91e618ef627a08e9d8667a9180a22c10aa859d70b80239bfc8cc66108a08301527f0ffdf50ad0cb49c17906f3cc43ee935b6a82cd5ac4574beb8d9df72eab4e806c6108c08301527f61374dc1b440ea38ca2bc3c49d6060f4f0e32ba7669040e30388caf2ab833e116108e08301527f27ec5217fa23b99f059a21d5ef05e9e477bd68025545246edce72bd7d70acb4b6109008301527f6a91bd2230a5d48e7496d52dc84436e077f89f44bd08d883e74257df856440ce6109208301527f4988f6b46cff4106095f3a8b6e07fc1a50f8f419b0778645b564e69638fb7e346109408301527f5255dfc95d1c0ca86a7ed39bbe02112cf62e4ee518b40901768e0ea5a2c30bcf6109608301527f35491d836b717f64d348e449d958bada0f89479479c18787c9046c846261de246109808301527f5f28561407a056594276543ccfbfedb72892cadd7eb63c4fe00d3120372e19226109a08301527f397ccc5ef29caa6de873609650e9bea17ac048e52e4f8c86cbfdbbdc9f5eea9a6109c08301527f6431baeb99d486abd0c30bd23eedbb7aaf863dfe32cdc6ea6a29a62a49ec5fa26109e08301527f09afe5011abd7c99753eec059463d6cd5c91dd494afe903b1ddbd0fa74cd1753610a008301527f28f1cec0ec97fe7aa7d4642897e1c51ce50fe46b5f28650bc41e523b370033d5610a208301527f0cb26f0ca4624dddbdf19003dae43f28d0e2b75e2df657d9acea9140d860e51a610a408301527f373bf8d7205b2684fbf374dc8d8535d7f278815f7cfd857f6ee064e8c96c3454610a608301527f42927ab0937f41bce0d6f843b523605c78e4d283bad74f846fbe8b8d7abf1ef5610a808301527f5ee3c0e954d211a4bdd47823cfdb7bca087c95b7a4d250200a9754d316f59aff610aa08301527f678615cf67212c3a2993577659d4263655b9dd58708ccfa20afe9083b6ecb662610ac08301527f3c54727f944cca495d23c1777e7536c6321f871326092e6beb94d87444157ddc610ae08301527f53c65020af3f5abda95860ad9383f77f10d5a8e7dc1975b74346db78de0b49eb610b008301527f5f5dd3df34ccc64f794d16acbc63bed0c4ce2cd38089e11dc95c9871c2a7ae31610b208301527f09637e652e915ae0bc1d62b7da1c9d8b973bf8f23f4322bab6bcc7b4a4406a9f610b408301527f546b9e395dee0a9466918ed255f76df4cd2c7c19681f2f712d4c16107b461351610b608301527f18cb6e5d6d0959114085a657a62004d6d4bac25ae567ca63501cd280f915de1d610b808301527f58782afd4a8a938bed95f04b985f4711efb2dacb8427fd6f8de78eb619ae9cad610ba08301527f072db66d8b16ae3aeb6d9e932e4de43e2e5cbfaaf34c7a0aa24dd9cf2a8e41b9610bc08301527f577832f774c67cddd7505cf603ca2e8fec342531bd0a1dbdde6d2e0728d565ec610be08301527f08c6f1218fd35bfd0e6b5b50735a0c9a6d284f4051672f41c0fe39465f0a3af2610c008301527f0eba8169994d61a6f1d3f5a7be72a0229f10693847f87734cd5305b77749240c610c208301527f04851fb71ef33d8a5df10bf40b43519035055256714de067c7d845304d464145610c408301527f2a5da7e9bf73c9479fa6e5f71288d31cefb6894921ac1e76d1e82be69ec4fed3610c608301527f58a009a0ea2c67b5923aa87f30a79f448b66d6c21507d07354991eef394c7d1a610c808301527f580d5aa604771bdf66ce0092f4c7174819c96b5e92499f48fe0199c4200060c0610ca08301527f72542655258cd87a0d0044f4e93d58584e6cf0009edb87f8175eb9c4e5778f85610cc08301527f22fc306957bf2306ac57ac3301b2d32dccdc860a7c0ceaddafd6727747e42034610ce08301527f47ea3e54e528ddc6e63b7ee7f14f80082b1df4719a68c4c9444a4aa640b21fa6610d008301527f2e237e775ea78f7f7b0843e916f0837b99e5f2543628d0b9050be31e16fffaf0610d208301527f254faafb9e2c37d7918e6a9f7b627db4f5317e83cd293ee6d62acc483806a7ca610d408301527f20efada29ea259911ca23420027e98b8c5af2a2f202903c7149a7167d6b0ce6c610d608301527f184a55e01875861e661289b3ad905293239eeae97ee5db99332b37e8f6c307e1610d808301527f6acbe53e7aced8a5a614cf26a175397f136c25f2fb2e7b0a58caa97b1009f1ea610da08301527f264991a53ef2e9918551c6b90ef7bb8339cd2f898e2322f44acff18b9b9a66d6610dc08301527f5078f86a7da7702a4cc8a3223da343beab035793b9434c39321da9d3691f999a610de08301527f39a8104ab4e2622b9523a3a9f9ee3b41a8397ea953823e419e06269fb3d2c1eb610e008301527f35728c2b81c712a34f3fe53c4393021ae73795035bcf1e631c0a99f44bf5639b610e208301527f41d7615f8bd97f178282eac27dbdc3215b7a2606a86122827c44bad1e42c67e9610e408301527f233bd5884457b5a4e1b4d1298f4695e172e6193afc096e78af06c474e85b13fa610e608301527f2f967109b61b2b2eb441e9a7132308cf975724cdc241eb94655d5480b6a45cae610e808301527f64f73e5667bde7037ddb61a224bfca795a61fbf0f78ea04019183161b0237c77610ea08301527f3829281d031f932f1ae9a2067bf6513dc51d5455b6dfa2955b16373596a7989b610ec08301527f52954070f8e0b8f4eb729b51e0c391101bcc120bb503d2578914d110355746d6610ee08301527f03b69267b12f495332d5c8a466cf1323221b891669924d118a44e89c0df8f1a4610f008301527f1d33c92e7d3ee1749755786f52ec76c7bd7a9a4b772174702a35fad10d40b2e1610f208301527f08d86c442959963e62deb44bd05d10e51e37c66c524c90b18fb3537ffc3fee70610f408301527f24194a8ccf272dee642baf29a85cdb203bddf6da1348fa538abde1d28b1e170c610f608301527f1c0b6f25101f49faa88022f8c83bac53ea9f160f62b6d19bbe321b5fede43ea9610f808301527f5965df1635254bb73a2d95bdc456a1957c797f02a6351a3f7ff22e4b014bdb17610fa08301527f6fecddfd9ffaf803e45405fac3529a15a0093ac87afa05c50915bd154ef0cf6d610fc08301527f6c5a8175e24da73409ded2913dc27396cc1da85c947683186df43b33f92d55e2610fe08301527f40e211d645b6bdee48d4b4faa0f0b3180a6c6dc54ef620477c0384b0610fee606110008301527f42adc6f65f9df8036a34dd4fa987a26497a6526dda4b90f49de337c149748d706110208301527f73185cb8f8642b0eb4449590423d9e65bd29805945dacf6d59c8e8a0babd987f6110408301527f1999004fd6cd12e05fabf2d5b9f0cfa062c0eb4a90413894e2d1b70e5b5d527e6110608301527f4f89f26b5f08f1aab934b63ddc6a25942475ae3ed15b5c36c55ec579af3b0ecd6110808301527f12a5fbf0400a087aba86a4226a836325339c3c95375a0cb09db74905ca5d968a6110a08301527f11a3fa42d518e20448aaeba3783c045f368a3d002723e10676a541a9e12a78ce6110c08301527f2f59f158b1c60bf12bbb4d956ff1dc9442aad7e876e2562d4438dfd2e2655ba06110e08301527f48956231bc3a0c3581112417097659b50d06c16b511c535c2decc1a3bce340b36111008301527f2849b06e476443c43bd47dd906fccdf2728c537a7a5f0f6938e168bbd8149a0e6111208301527f58d1184212a2fe71f72bb99b925e9c1432179bd4c8ff918daf4dfd7e7cee91ed6111408301527f3fc33989242fa44cbd5172dc768de9a6c9d4a142d6fa7b99679735aea4e3cc616111608301527f04609e4a1be08e45a07d3cab7478c170a88cdbf32e124721cf6b8b1292be02c46111808301527f51a47f35ce630b8a01599a2f45d141496e6babe83c19f1e58f34cedae71a48196111a08301527f011de2c7cafc96dc5d5919ae288780167e017d27067288f8c79bd2344700d97e6111c08301527f5505b08ca4fbe52ad9fe89d2a797f975bb9605b25b399741248aa4b29da00b666111e08301527f0764417ff69a6cdf71ed5ca55be442dcf7b9c23364cedc4830ce28a8d31fe6176112008301527f1ea443addd653c9a0eb5f9a7dfee8d543f3f4e413067c6bda7fe278f6f0a69946112208301527f30e8242b2eb26dde1277a06df6c4a335e18c3819df2e71cad28c1082a1c94dfc6112408301527f4be93987573b6cfc6fd56c56cba5e12bb539818aa40f1fdc8c611d29f80481846112608301527f42b770b2264660e60e59d224e4a050d5d7f1f31a45690ff2577f28e3dbe299866112808301527f08a27e30763aad74f3d3f24b6e19d4a3bfabca120244698d3f4b7bb2ad4919a86112a08301527f2cc5903961de4dcbbd0933b1961ce0f9e11eb86626dc332f1787954597b456276112c08301527f47e985d487ee6e1e26bacd792ac5ba28d4509c9dd7c39ef7416951e9647a4dbc6112e08301527f2b93f9997e71be645215084ba7e08d2ff99b8f839f800caefe3a30661396ce616113008301527f712d0469727032af24d88a999b60638a9c04e2fad716a68868dd6d2f5c8bf1af6113208301527f6bdaebef7927e6c195dc585eb0520a55d565a8c26107503341497c7a5098d7cd6113408301527f66c00c9738eaa31d7b0b8a2fe0b1de81d8b42fc536383a40509079e97615197d6113608301527f1fcfaf860b9f60eea753e8a2d79c344bf94384942cd898fd9a254acb40469c506113808301527f28b4dc5e4f2550e929ed53c414e2cfea1ca76b137f7ebec54533c4652105b9386113a08301527f472b0e17b62a901a4747be944d427c0e3a501de3403e4551c1cd29a04090e6aa6113c08301527f52f256eaa5ed5afc5b02bfd70dc7c70eaedbc3f89d72140b4374c36741c17f726113e08301527f604a77f3a748eb226cf823c3ee35009d95a99eeae0d0b59513fef0356204b9b16114008301527f0b6e82f7e448979b1f794e2449f4cf865d12dd0515ce061ecc2de699ab8f93646114208301527f08ac469169f16f69d9953b3f0060e6356abcc7eaf46216a83146e6470d0f34076114408301527f593ae35f24590d6e1125e9a4e968e2a03424e6527173002e20f10da98739be876114608301527f1842a0080d610897631657769cfe98480828c5af6f8ab0454e1fc5181871abfb6114808301527f1b4617ab22cbbeb10c39493e2dc4b465e17e795b82ebb9c986a18ea0c5f713126114a08301527f12f49e7b20d1b518f36f2d3aea11fd8b60f19cf5b0a2416076f12a8b203f18546114c08301527f2930f273fa05d398e9439d14b49ae806649b330696b98864d603dae3afb0ec376114e08301527f0bd3c0be6e783e92b477cc3429c27de9c532f3269d540c49be9ea939d7a1a68b6115008301527f58cca0bc2eaee337303a1035429216b5f5b23acdcafd5496e30b85806a64ed516115208301527f22f54df37e0c28d9ff08bfad67c572127f657256b93974992e90c362b84c142d6115408301527f4f227e82309f2af0243a3840e8d3a457b328e00c00b6d58a76dd7ad245e792d76115608301527f4fa65b781e4c2ed965b74c201e8af52a835bc991db3ae610be9ece0778221fab6115808301527f6168f0439fe970f7cc596c8a18bdf3e7285c9eb52e3372afa9084df3cbadcb2c6115a08301527f2ee0f0f1b7fae6d6ec9851629b8410c9b0d80ffa0e6bca06d6009c174b4cde766115c08301527f463de84b0649f8fc6c262e00e6a950a656604a8ca21a527950f6eee511e7118a6115e08301527f5fb8be949ded20fddbca6db6105d2a0b64e527932a3924fad59a96a58b34bf8e6116008301527f0c2e0aa86422baebfbd0e70123222cf86ab85010684f0d6d4b7fbf8e2b9680016116208301527f5f8726f651ad2518b78c6fe100462dc0c13d8acf6e42651d682297cea73fc8686116408301527f51c95bf666ff8fecf4e0b85bb58b834d2218d9f20170bf1be5d3c9aec43def386116608301527f3c4a879d04291aec2897628e731f3f63e04a8c7cd382a8c0fb014a62bbe8be616116808301527f4e3f2713561dd6e4b5071e0759eaa9545eab7b6335466e7c618d3988d1bad5046116a08301527f1158d86cddece49c18d48e32822fb977de5033e0e902c45601f8852193e4a6046116c08301527f02263730859a58ba2d3db60d5d7c7466824850b3207435e476ba35890a37fd2c6116e08301527f4d439b61a3703c36425888a3acf85639085b9a95429dcedd1b046c0a4a78acc56117008301527f1330cb0c5d2fa075aabb6bfb28276a9bbb44fb43306a63246aae25e1527868bd6117208301527f16b95b643081cb043bdae50355f91df79c9b588c43e59038e6e6d0cc1698b5a56117408301527f1fb8d50108e2fb3ea1f80aa372da950a36eca4571240be90aa5b3fccfef3c3216117608301527f4a53ec9735e16f6183934f1a7813d75cd11bbde409d8b262273bdfe5bc5dcc506117808301527f079ba56e1ca1d8c8eade23e8273e2db2a486901dbce8cd86caf41ae406fa21d56117a08301527f38ed6aa3cc88a95fb845db9d5ef043ecacbfac58a8bb5cd9bce8e4d1e5967c686117c08301527f2aae4dacc5a04fc32d1abd33601ee1c23c2986cc24dd63bf6d63be3a996fc5f46117e08301527f4d34a394da7c0ecb24de0dff84192c35090ba8748d5690272f9948efd2d095b46118008301527f42b103442e734014097c5c63f509110dbc1872226e7db81b19c474c4c406aa186118208301527f48a2063c98229fdaa1768185d6a3f4dea3db1ce1de6b7b121794580993f5c78c6118408301527f6ce4def3b2ebbdc1a4cf7f1a57d58467b1c48be6aa9c55c21696456dd58f03bb6118608301527f195ce730b876d5929a76a7c5d69bf1911280dab5a69c2cd38ee4b61dadfc00e26118808301527f63bf1167c90f8dd2360d3e401c7fbed17da04b327ea2c94875739591bdc7d5dc6118a08301527f5db879cb0bbf165c80452e14073c8b96ab8fb608a22b43c3cf267419c0dbf3c86118c08301527f472b50d6fb5d632e95ae0c5dd5f071ec8b6b4ee1407e5f3996a3b6e9c2a3d5876118e08301527f3cb873e98b29b2ed4d8066a06315d673bdff53c907b9adfbf52b37bd9799521c6119008301527f0793192ee98e2f57a73911ddb781380b061b92218fb0d79416ff47ce679703c36119208301527f3c159af2d3c008156298b33d8cab5ec2e8cd70773d81414266812783cdabe19a6119408301527f1c065141b64831c3ca0dcaf2d805bca7fa9473b9b163fa4c35fa3c83d2f933eb6119608301527f23943e9e8a571aeb36c24eea0d3ee5f097aef800b3b8744189c74c6abe4f34076119808301527f3e9bf606619c174b6b417a2fd7bcf68269a082c5bd72fd8dd668bb3be7cbea166119a08301527f480648a70c24e511be0e6d05d6d9a465877d3fd3428aa4b1a9e9e41de5c6b4406119c08301527f4324bdda4691820deb1481dbda3abb1cd5a05ccedf764b01317deabfd3e044f16119e08301527f6f2915f09c70fb227bb6c0a4e7f134e85629d9a5b547de9a9cf74fb851384641611a008301527f5f6d84cceaa1d3d3100a850dff27eb37f63db619532cf27291d5b35713ff215b611a208301527f2fcbf6ae9d4cdb276ea017df3d2ebec767c2b7fe1bb8558e9a6e3322ae63a62b611a408301527f408c45f73c4165b6cd00567331a72b4e26d79dfc305da5da9b8fd34311bcff9c611a608301527f67799ccf850146c5f1ff10669a69189d943448ad0efea1c614133324e1505a5e611a808301527f51ec52ac5329ecfed2a65bf7694212c04f47f4628de8c011d93afdad53ac9d4d611aa08301527e6e70e25eb8093bdcf955a5364a868b75d3729d057e78ad8358204ee3b1f8fb611ac08301527f50d01794d6f55e78fd516d212da55c3bb16f616032c3a8c284c60d61f877090f611ae08301527f1f74c3f88a37452f5fcd729af8fa1716e1d434d5a394e0457094f0563c31755b611b008301527f019487e8c5dbb68aa598be6e60a580aa186baca856104373fce6ef6cd87fddce611b208301527f4832ef55d38c938a015350f39b5b2185107dacce78ee4f85c47bbe5658e09ab8611b408301527f4a85d06c39d9c8c00baa1c5dfb59ff29ba80099912a56e9e8add6884763cd068611b608301527f41488ae48b74da505eb63124cc93220a6528420430bcc57338be26231ba3755b611b808301527f21b5d82ddd050ecca07247349ae1aa49c63d1d52941fbab73e5060fe8595e30d611ba08301527f5c9b5273d97bbb50dc4cb6b754f15da0c9ff93a61d75f4395f02f0f4d173067a611bc08301527f0a062f37f718f4c37a8c2bf9ef2f7c4a2119ba043eb6ffed51e0b5c55b7a247c611be08301527f159f9276bd128ed2d5b09f5fdaba71bf13806df7a17df30e6ed08086b8dace0e611c008301527f397cf7ac45224459e819581c1f2ba6412dd078820337ecec0d6a883b83370198611c208301527f32e654ddc435855db6a681a4134ce1a7f85525d0dde7a8e7365f36d6b8acb385611c408301527f07245288af44bddd2f744d5e093ea7f100de626fa216bc3044516254939edd3e611c608301527f61266cbaef88498a8255902e3a0efd2e45563158c8d47c75ec9af41d62fe128e611c808301527f73157756a167275b89ecb982dc3d2fab484c7eee1d0800df9ea07712048c9d2d611ca08301527f0c0b409aaa3a87cf5c0504c624b23570dad7fc9ae30f1f056996bb6a7b2b5c53611cc08301527f03801ea9c955bbc5c32ff8d8d3174bcc2f4f3249b711090a4c963a784e06c554611ce08301527f17690270da56baeba4e614f7e8780b3b15201ac3d7ae406eb4dbe811f8b13956611d008301527f0779f987f90f1c4f8e319418659d4bd33ac790e8eb07c153c28aa089775dcf38611d208301527f2f74df84cb03f57ca5946f15f2fb134d42a3288f32a5d5ffb1a9fe1d2a391bfd611d408301527f6ddaa41db23ce0405078e68938a27c0386674531648061bbd79359c91f32aac2611d608301527f2f49ab87e23a5d392c5e457337342795f3066a07f987de091f325ac32b8ba72c611d808301527f0efc38d20700d5b5a3b055be496dbdf82b0ab3e07dda2a0df3b16c07b02dabb4611da08301527f6f5ab923c9d18fd41b977c0f544cb9af853dddd00734b01f9280145a1dc7cfc9611dc08301527f0903ed0675157f6629cff37a2055f827bdbea9801a09fa7ee01c66b108265b8b611de08301527f700f5c0c5990d42434a15bc34c228500c52f0441de8419783a1509045d2aaf8b611e008301527f6a0e3381e15190acf36abed91ee25dc7fde5c90a3c5154a4329b2662188c2cb8611e208301527f4757ddbab350afd9c61e7a748d936388aa9ff3709c64a080ab9f28646d1d7181611e408301527f60f9d0c0c463bffe9c08d557dfd5d1054a98f32c04eaa80c49290cd45897b2a7611e608301527f0720379ef288498c5e6100d19258c915b32fd1f76a7878fd3575137b695e5789611e808301527f2265c46e022a5ef8ff8e9293803aff7f15ce0814a9edee3b1d546c7865407e3c611ea08301527f1206dc6f2948499c0a2d173e0ce4850870a8b1957d362ce6aad3603084cfb48a611ec08301527f3497b1b2410e8b30f6c09dd43d54aa9755c4bdaa743f8af7df57486dc70786c2611ee08301527f1ac1322d723d7d2c9e8a475140bc3991e124c7752dbe38d83ee03985cab3ec06611f008301527f06d7e810be67618152bb71fe9246ed8390e61d21fdaf4d357d67bb5de77df230611f208301527f0ee137d56d3c1f10af868ae52affaa93f1900ef4b93656322c7f295f3949436f611f408301527f21da6fd7aaca1d900c16ab0292cbda61f3c784d2ab0efe4fb1b87d443b54a76a611f608301527f1db1c07b4c58b4bada79593314f41f0050a88831ff9f9073fb31114e0e67285d611f808301527f5898c5429b336972114192ac64c5226082c3b2fee5a63a862fddba0789d6a473611fa08301527f6ce149f5c89369cbae1a7da096eb5b0ffdb885dc1916c9884dbbae22e6db34e8611fc08301527f312b1c75d7428aa4ddecc9229f9bfccfd4be6ef3ba7b16e04c6021255d1de0d5611fe08301527f08ac2c7ded2c05ddb49ae7ac6102c229dde9275c3589a88b40069c8c3cf236ee6120008301527f1725748fd880aabb1d6453669335fba232e6b2d25e69f3d56a504a3e5b05d76e6120208301527f248998a735f44fc524d9a3854e5d49e3dd1487e334ab8609558b89a5db5855586120408301527f51327888436d6fa1820a24f5106403e6f3cf35a5b2ef9148ff6aa6eceef4656e6120608301527f0c8b5a14aa194279b5d7676414246a40756786c8718d30a87d643d9320c4ec436120808301527f4dc96baa6c646df7036040dde9349b3f2ee384cafad6de954f4cd861069b24816120a08301527f718209ea4f77c3f76ecb439d05adf0b70294bad752b6c7f9af5711ce87be65a16120c08301527f639a0d20110526eaa343c723af04d126cd523ec21cf43d38b35398a0c56265b06120e08301527f2532f06a0066838b5c4cb4ddbd2e619bd7a9a4e37d4def67d20cd24cb8e672066121008301527f6b6d6b0887e56bebac8bd69265d4ce6a00ba7470d0168d65a2d25523900917c06121208301527f49f013fd9c831d3bbb0a371937ccfc302a424cc46d4ec08b5f45ac52ac31e8cd6121408301527f394e2a96c15cfa8f3ffcf5cb63264101b5c86f3fe92be4f842eb456d57295fe86121608301527f1ac743d177683ccc6719998182d6b7f431f1251f47a8446dc256830a359a789f6121808301527f3e3e342fba7c149018bcd2cc36ccff80a7eb3284f044cb5dbb9fb325f3b4b9f46121a08301527f3acc235e3731adafb4e9d9ef258e17f27329ac022a49b127205de91ea9322c8a6121c08301527f608afd9af0e5cfe07f12bf3316628eb8b9942121bfbd43ff7fe22a479aaad6046121e08301527f0ff89b10a1c9e65ef3a74ed5f7ac9892ac86faefc74731fd2b600834b186aac46122008301527f52f4e44f6d3341b5bf59399c6d53490fa8908e38e24a6142b90e5cbabae262926122208301527f38ee391b76fd73893fb64102547ca12c03cae780df15bf46727e57d07720575e6122408301527f3aea1da1370f5f1a3e7bec277a3cb39f286f3f00e82b701a359c041bcf6d9b806122608301527f21527c01d8037ea85f26001543e0caaa27114f3d00a155fcd4038a1fef06f0d96122808301527f60fc95ccdb1cf5a2700a6d66c7178bab18c5aaafd1d84329ef0521f72a45ca716122a08301527f5ab6a484d0d3ecfd4bf7d02da51f2d335fbc16bcc6d24beb6c2cd1730ed46c1a6122c08301527f4ea32259f9226d6e3d829d55ef0dfad8e8c7b83293358e0b9f899b54ad0bb82b6122e08301527f05b6e5b66f488a0378388224ad8c50eb6764df75505e02e713c95dfeb07da0756123008301527f31712374e5e6154ad9e2c9d26e6b2b804755971130c2d1b9bacc151872e69e196123208301527f1e579ccdcfed1c91d2fbf8b171f7c5352a986493bf227e5a9b1b8128a512646c6123408301527f2a2acebc6ea9b7b1170331b1f5fa73176ac647a25f590752552d88120ad535d06123608301527f49153077b745ebc3292e66fce38393f30524d2d3514b284aed7475e849d74e326123808301527f5375d9a81513c847f8c5f072049c59011dcacc7a8ded4dfb0ce8d89e3a997f146123a08301527f435d971e1eb8e44821c6c1ba05116256fa79c35db080a09ef7e24f59f420dd456123c08301527f58503b3a94f096941dad28f1caf856e5ce8f43a87505bc82ec4eab08149fd5d96123e08301527f3875898530fddee93f088fff6afe6998548c24552e1ce79bfd6989a34f91dba16124008301527f19380c553178569b69ba13e029af8a40e2753db62df5a0a70c13b6105f1e3daf6124208301527f1c00372679acb24658db79cde4b98711447ea35fe771de55c9addc7ccbcfcbfd6124408301527f6b5dbfea22d86bd8bbfdb5d787f2d58830ae60032ff2e4639e1508c8fc6b5d806124608301527f4607d1076850ad704386a117a214e6e7cd0fe5ffa9d88eb0d26b3e803201e6416124808301527f0f91e67891be0164227f53bbb878dcf24262bd48a3003e35adc2a55de5a47db66124a08301527f45996205840c4b3d5c410afd195a0646c8300255f65f994e608dc7889d9f2e5b6124c08301527f3ead3e9e499d91be44dfb36a1ec2d0e606a736e0ab546d4454e12835352fc1156124e08301527f1598c26031f70feec9e034f64b1d9a36a695d767a26bfa59cee0cb445eb4b3076125008301527f1cc0c0f8eaffe3789e3b439093440f1a60b921721763d41055c78922b871b03a6125208301527f48703d4aa9bf7adc5e911c7817d88968569bc88162ad297ed48fb428931500476125408301527f5593e8d4c35eb09c60c8b0f998419159d552513affaa6ab9c34a07c3a577fc786125608301527f1d0edcbd6dcddf3ae0a64a0cd44eb759f2330f172cd4ed007a041ac18c5de8506125808301527f328371fd8f5642affaa80772e382ba086b4aeae25cf32cb1fd6a03f4c17434e36125a08301527f37941017b7862dedd6d93c13b7f08bb932defcd29c70d1b1d5724ca40c29cc726125c08301527f10c59d50cb8d8d939b2b97163b5ce65d63d4b0a58522ff95addfc01620ef01006125e08301527f0d5b533b43b0b27d9b64551c7ceaee9fb0b6b9061d13326147360615dda112126126008301527f636375e8e3a62551030f9dbe7811775d90b697a1619360756afec469adc3f4686126208301527f16ff3d1de7193f4b98611664a8b64cbc4fe39ddbd74337d8e347e4bca730cd946126408301527f1cc95775b2716b3cdd35e56a7c7b2497564f9f44f202e18baf52d064877a4eab6126608301527f36daf37534506831829b7229f6b34c5020846e98e02eef2db84136c910ba15946126808301527f61a68e2455dce0f6783ef9e5131db78a998c62b695a83078485b414f5f605e5a6126a08301527f12b11dd703fc60f2ede9f64b5050371c32fe393d86a3341996fc4210069d2a226126c08301527f27bf254291de0508e8b83ca24a6f9412b5eb98ea795b87bb1040e411c2a823c96126e08301527f35f4aa5fe745e6e65654e48e4b395290b2e872dde27245f08910ef4e0ff34b2a6127008301527f24fdbbb549e57cbccc5914748a55d3f64778f957b6024162b89b3a3de13b19116127208301527f22485592115c7396684ea68c47390d13e784c29e5c2f1d15997bbad58557a29f6127408301527f2056b61a624a856030a66e540f7a878f418adf12317d378869140919a33d02f66127608301527f38df7ffa7f9be7b2e80f05da1af774693bb3f59d13c3570b242096fccc6b16016127808301527f35b15b6c4c7bf09e1d9eebea32d2c9abe4fd1abd978480c637aa42b430e356376127a08301527f255267e1ead997f166dcf53f0d0cd7e69a8199a11950ceb2515f8f8667d067636127c08301527f3fd6bd225026a4673ee244b3ba4e49f9ff5dddea1238c4db69e1bf5d88a850206127e0830152527f707fbbeb0bf2b5aa6ed7573b46506eff64c69ce781aa7fa616e3d53390922a1e613dfe6109f8565b96613e076109f8565b7f5edc4de43ff07c60ace8f91ac726180f38604b5bb2f2ab2c27aa2a4d53cf708181527f21c0f632624d48a11931e2bcb8695897e5cb1d7cec432d115df1b25ea0d9d4a3878201527f4243ff5f4a234a2256286afa4ec59b4c9c32439c0869f1aa0b92a5ab82ee1b38828201527f7344ba891ca71591e07e7e6aa563931b9d07b548c816668af7f6170e5c8cd073848201527f20c42fc15a32ed98b81609d1e9de98f255e4b46414af1dad036bfe255d3d2f19868201528852613ec86109f8565b7f68186626fb0239ce09c22fe4ec756ab3dede54596e3cc426ac7ec1f5c38881f281527f1cdfe1f1de4a7290ab39316b544da5e6576d4d1c05eaf0719c3c60867fab0372878201527f1992e57fe5537033e0b3711c4aba9a6630fdf87a5962a442e926718e92f7e573828201527f5033856a6fe61acbb5a95e6f8e1d6e5aca6e1d2125d0c03d864e8fecdb3ccd4a848201527f09e7c08b5c3289751cf3e30a7ab45c59aaca49585c3f08fb39a67bc9466cceb28682015286890152613f8b6109f8565b7f73ac6ff5f192940a6a3198b94a158121172678891e35c8895c6a20f4164f7c9381527f03ac6b5eccedc5da43ff372db13fa55ac197bb9592e15d4feb74ee152e90e952878201527f1574427d32abdcde8a24db9e42219c68f84d89f342f0eb455309c7937054f842828201527f21fcae8d9f8f62a956217b8fd134560fc2654527ee9e5359beefb95b2c59288d848201527f06ca0c88a61632956a1d3e91999c842f03b6e7f121df734ce75682fbfa1ef7f9868201528189015261404e6109f8565b7f4ce4f0699adf8172f73b8cd2407d7db698a2625bf837b95a35abbf4eddcbd7dd81527f1a0f8b3e444c78fcc67ce285e743094a787745b2761df2203979fc08d3ab3a99878201527f40a3f19fa4064fd9c119dd0acaea02ea3ae33a5df8b181867ff6b705f159e4af828201527f051d14de8bbf745f9f8a20682c4104c48a0198e8f604ae06b45de4051d90065c848201527f294ce128d90968ca910a8cc18c9ab58d41a0a91df79bed878952aa88f7433a8086820152838901527f35151e81622f69dec5eedf76619630dc42997eeaf162fdda7644ce726da53c3b6141326109f8565b967f637e4ac13df1eefbc7ee982d5a044b89a20d383b17fa5a23bfe25a7915d8885f88528701528501528301527f121909e9d5554a3b3d207272ad07359bb49136e23fe6f0d1c62c3bf940ca5bcd8183015283015252565b90610140811015610c585760051b0190565b5f1981146141aa5760010190565b634e487b7160e01b5f52601160045260245ffd5b6001809190600591825b6141d25750505090565b8183166141f5575b805f805160206142b2833981519152910991811c91826141c8565b925f805160206142b2833981519152848192099390506141da565b60a061421a6109f8565b3690376142256109f8565b60a03682375f5b6005808210156142a9575f6142418385610c47565b525f5b81811061425557505060010161422c565b6001906142628486610c47565b5161427782614271878b610c47565b51610c47565b51905f805160206142b28339815191528092614293858b610c47565b51900990086142a28587610c47565b5201614244565b50509150509056fe73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001a2646970667358221220e706740d4cac649155f238450602209c539ff114bec34405aea1cbb73c97ed1864736f6c63430008170033",
        "nonce": "0x10b",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    },
    {
      "hash": "0x9f4c2dc61cadae8e450e06f9e24eb6b7cabd0914eabd6a2a308c039409823c08",
      "transactionType": "CREATE",
      "contractName": "MerkleTreeManager4",
      "contractAddress": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
      "function": null,
      "arguments": [
        "0xA22A3cE2e3eb5865ACdCA8980F95C8EAA87eF4a1"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x25eee2",
        "value": "0x0",
        "input": "0x60c03461010a57601f61224438819003918201601f19168301916001600160401b0383118484101761010e5780849260209460405283398101031261010a57516001600160a01b03908181169081900361010a5733156100f2575f543360018060a01b03198216175f55604051923391167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3608052600360a0526121219081610123823960805181818161098801528181610c9b01528181611667015281816117220152611983015260a0518181816105ee01528181610d1701528181610d58015281816113b7015261153a0152f35b604051631e4fbdf760e01b81525f6004820152602490fd5b5f80fd5b634e487b7160e01b5f52604160045260245ffdfe6080806040526004361015610012575f80fd5b5f3560e01c9081630fc3cec01461182c5750806310af81eb14611805578063110b6444146117515780631fd2333d14610557578063331b6ab31461170d57806338bf282e1461160457806339afd14e146115df5780633fe98de5146115c457806342b6834b1461155e578063631c56ef1461151e578063715018a6146114c757806374012968146114835780637410ad081461136f578063890586cf14611340578063891ac401146113115780638a82b4b514610a955780638da5cb5b146112ea5780638dd14802146111f75780639f67003914610ade578063a6f51d4a14610ab3578063b091b31a14610a95578063b0a7945914610a6f578063b6b2060e1461090b578063bfcb0e9e146108db578063cd87a3b4146108c0578063ce03fdab14610896578063cfb2893d1461059b578063d302b4ac14610557578063da561fd814610518578063e1d5deb414610454578063e78cea921461042c578063e829558814610406578063ec1b740f146103eb578063ed85b328146103c4578063eff8ba5914610394578063f2a991541461037a578063f2fde38b146102f5578063f4e019e4146102725763fef1deb4146101c9575f80fd5b3461026e576101d736611856565b90805f52600b60205260ff60405f20541615610256575f52600960205260405f20805482101561021b5760209161020d91611a1f565b90546040519160031b1c8152f35b60405162461bcd60e51b8152602060048201526013602482015272496e646578206f7574206f6620626f756e647360681b6044820152606490fd5b6024906040519063ea17a6a560e01b82526004820152fd5b5f80fd5b3461026e57606036600319011261026e5760043561028e61186c565b6001600160a01b03604435818116939084900361026e576102b482600154163314611a48565b805f52600b60205260ff60405f20541615610256575f52600860205260405f2091165f5260205260405f20906001600160601b0360a01b8254161790555f80f35b3461026e57602036600319011261026e5761030e611882565b610316611fc9565b6001600160a01b03908116908115610362575f54826001600160601b0360a01b8216175f55167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b604051631e4fbdf760e01b81525f6004820152602490fd5b3461026e575f36600319011261026e5760206040515f8152f35b3461026e57602036600319011261026e576004355f526005602052602063ffffffff60405f205416604051908152f35b3461026e575f36600319011261026e5760206040515f805160206120cc8339815191528152f35b3461026e575f36600319011261026e57602060405160038152f35b3461026e57602036600319011261026e576020610424600435611ce4565b604051908152f35b3461026e575f36600319011261026e576001546040516001600160a01b039091168152602090f35b3461026e57602036600319011261026e57600435805f52600b60205260ff60405f20541615610256575f52600660205260405f20805461049381611c9e565b9061049d81611c9e565b925f5b8281106104d5576104c3846104d1876040519384936040855260408501906118c9565b9083820360208501526118c9565b0390f35b806104e260019284611ad8565b50828060a01b03809154166104f78388611cd0565b52826105038386611ad8565b500154166105118288611cd0565b52016104a0565b3461026e57602036600319011261026e57600435805f52600b60205260ff60405f20541615610256575f526009602052602060405f2054604051908152f35b3461026e57604036600319011261026e57602061057261186c565b6004355f526008825260405f2060018060a01b038092165f52825260405f205416604051908152f35b3461026e5760a036600319011261026e576024600435813567ffffffffffffffff811161026e576105d0903690600401611898565b9091805f52600b60205260ff60405f2054161561087f5750604435917f000000000000000000000000000000000000000000000000000000000000000063ffffffff16915f9160643591835b8585106106325760208760405190608435148152f35b600396848816806107115750828210156106df57610651828486611ac8565b3590600183018084116106cc57610669908587611ac8565b3560028401928385116106b95761068461068b948789611ac8565b3592611927565b9681018091116106a657600190935b60021c9401939261061c565b87634e487b7160e01b5f5260116004525ffd5b8b634e487b7160e01b5f5260116004525ffd5b8a634e487b7160e01b5f5260116004525ffd5b60019194975061070b906106f287611ce4565b6106fb88611ce4565b9061070589611ce4565b92611927565b9661069a565b6001908082036107915750838310156107735761072f838587611ac8565b359083018084116106cc57610745908587611ac8565b3560028401928385116106b957610684610760948789611ac8565b9681018091116106a6576001909361069a565b5060019194975061070b9061078787611ce4565b906106fb88611ce4565b60029290830361080757848410156107de576107ae848688611ac8565b359184018085116106b9576107c4908688611ac8565b35928401928385116106b957610684610760948789611ac8565b905060019295985061070b91506107f487611ce4565b906107fe88611ce4565b61070589611ce4565b90848410156108525761081b848688611ac8565b359084018085116106b957610831908688611ac8565b35928401928385116106b95761084b610760948789611ac8565b3591611927565b5060019295985061070b915061086787611ce4565b61087088611ce4565b61087989611ce4565b91611927565b83906040519063ea17a6a560e01b82526004820152fd5b3461026e57602036600319011261026e576004355f52600a602052602060405f2054604051908152f35b3461026e575f36600319011261026e576020604051601e8152f35b3461026e57602036600319011261026e576004355f526004602052602063ffffffff60405f205416604051908152f35b3461026e57606036600319011261026e57610924611882565b6001600160a01b03908116905f805160206120cc833981519152906044359082821015610a1f5782841015610a1f576040516326fc0f8d60e21b81526004810192909252602482018490525f604483018190526064830152602090829060849082907f0000000000000000000000000000000000000000000000000000000000000000165afa908115610a14575f916109e1575b506020928280926024359009900890808210156109d9575b50604051908152f35b9006826109d0565b90506020813d602011610a0c575b816109fc60209383611905565b8101031261026e575160206109b8565b3d91506109ef565b6040513d5f823e3d90fd5b60405162461bcd60e51b815260206004820152602260248201527f506f736569646f6e344669656c643a20696e70757420697320746f6f206c6172604482015261676560f01b6064820152608490fd5b3461026e57604036600319011261026e576020610424610a8d61186c565b600435611be3565b3461026e57602036600319011261026e576020610424600435611a8b565b3461026e57604036600319011261026e576020610ad4602435600435611af1565b6040519015158152f35b3461026e57606036600319011261026e5760243567ffffffffffffffff811161026e57610b0f903690600401611898565b9060443567ffffffffffffffff811161026e57610b30903690600401611898565b91610b4660018060a01b03600154163314611a48565b6004355f52600b60205260ff60405f205416156111de578284036111c9576004355f52600660205260405f20546111b0575f5b848110610bc15784610b8c600435611a8b565b60405191825260208201527fe8f75c77455801acfd20f8b159f4f665b5f9c79b63cec4391c567272c0ba3e7d604060043592a2005b610bd081868497959697611ac8565b35906001600160a01b038216820361026e576004355f9081526008602090815260408083206001600160a01b0386811685529252909120541691821561119e57610c1b828888611ac8565b356004355f52600960205260405f20805480155f1461117e5750505f5b5f805160206120cc833981519152811015610a1f575f805160206120cc833981519152851015610a1f576040516326fc0f8d60e21b81526004810191909152602481018590525f6044820181905260648201526020816084816001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000165afa908115610a14575f9161113f575b505f805160206120cc8339815191529182910984085f805160206120cc83398151915281101561112a575b6004355f52600560205263ffffffff60405f2054169163ffffffff610d3c817f000000000000000000000000000000000000000000000000000000000000000016611ff4565b16831015611111575f9583835b63ffffffff89169063ffffffff7f000000000000000000000000000000000000000000000000000000000000000016821015610ef457896003841680610de1575050633fffffff610dd160019263ffffffff946004355f52600260205260405f20815f526020528160405f2055610dbf81611ce4565b610705610dcb83611ce4565b92611ce4565b935b60021c169901169790610d49565b60018103610e28575050633fffffff610e2260019263ffffffff946004355f52600260205260405f20815f5260205260405f205491610705610dcb83611ce4565b93610dd3565b9091906002908103610e7357600192633fffffff9263ffffffff95610e22936004355f5260205260405f20815f52602052610705610e6d60405f20549460043561209e565b91611ce4565b91506004355f528160205260405f20835f5260205260405f205492610e9a8c60043561209e565b926004355f5260205260405f209163ffffffff6107d0830111610ee05763ffffffff94600194633fffffff94876107d0610e229601165f5260205260405f205491611927565b634e487b7160e01b5f52601160045260245ffd5b94939298505050989796986004355f526004602052601e63ffffffff610f1f8160405f205416612089565b16066004355f52600460205263ffffffff60405f20911663ffffffff19918183825416179055600360205260405f20905f526020528360405f2055610f6385612089565b906004355f52600560205263ffffffff60405f20921690825416179055600960205260405f208054600160401b8110156110fd57610fa691600182018155611a1f565b9080549160031b5f19928387831b921b19161790556004355f52600a60205260405f20908154908114610ee05760010190556004355f52600660205260405f20610ff1868b8b611ac8565b356040519788606081011067ffffffffffffffff60608b0111176110fd576060890160405260018060a01b0384168952602089015260408801528054600160401b8110156110fd5761104891600182018155611ad8565b6110ea5760026040600198898060a01b038151166001600160601b0360a01b90818654161785558a8501908b8060a01b036020840151169082541617905501519101556004355f52600760205260405f2090868060a01b03165f526020528360405f2055604051928352602083015260408201527fe9c05509de49ff5cb0ca8d4402e6d5b43be3de99140366db16d00f74f0e14d27606060043592a201610b79565b634e487b7160e01b5f525f60045260245ffd5b634e487b7160e01b5f52604160045260245ffd5b604051635d271a2760e11b815260048101849052602490fd5b5f805160206120cc8339815191529006610cf6565b90506020813d602011611176575b8161115a60209383611905565b8101031261026e57515f805160206120cc833981519152610ccb565b3d915061114d565b5f198101908111610ee05761119291611a1f565b90549060031b1c610c38565b60405163232a9e3d60e11b8152600490fd5b60246040516329ca47b160e01b81526004356004820152fd5b6040516001621398b960e31b03198152600490fd5b602460405163ea17a6a560e01b81526004356004820152fd5b3461026e57602036600319011261026e57611210611882565b611218611fc9565b6001549060ff8260a01c166112b0576001600160a01b0316908115611272576001600160a81b0319168117600160a01b176001557fa49730bff544fd0b716395c592e39c6fd2d2481a19b9229b5b240483db95a4955f80a2005b60405162461bcd60e51b8152602060048201526016602482015275496e76616c696420627269646765206164647265737360501b6044820152606490fd5b60405162461bcd60e51b8152602060048201526012602482015271109c9a5919d948185b1c9958591e481cd95d60721b6044820152606490fd5b3461026e575f36600319011261026e575f546040516001600160a01b039091168152602090f35b3461026e57602036600319011261026e576004355f52600b602052602060ff60405f2054166040519015158152f35b3461026e5761134e36611856565b905f52600260205260405f20905f52602052602060405f2054604051908152f35b3461026e5760208060031936011261026e576004359061139a60018060a01b03600154163314611a48565b815f52600b815260ff60405f20541661146a576113dc63ffffffff7f000000000000000000000000000000000000000000000000000000000000000016611ce4565b825f526003825260405f205f8052825260405f2055815f526009815260405f2090815491600160401b8310156110fd578261143d9160017f1ff5410102c1974ab4242cb28f3001d2d6401c8e655d96fe6c013715d29ffb0e95018155611a1f565b8154905f199060031b1b19169055825f52600b815260405f20600160ff198254161790556040515f8152a2005b604051630c13c1df60e41b815260048101839052602490fd5b3461026e57604036600319011261026e5761149c61186c565b6004355f52600760205260405f209060018060a01b03165f52602052602060405f2054604051908152f35b3461026e575f36600319011261026e576114df611fc9565b5f80546001600160a01b0319811682556001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b3461026e575f36600319011261026e57602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b3461026e57602036600319011261026e57600435805f52600b60205260ff60405f20541615610256575f52600960205260405f2080549081156115b2575f198201918211610ee05760209161020d91611a1f565b60405163ac0a938760e01b8152600490fd5b3461026e575f36600319011261026e57602060405160048152f35b3461026e575f36600319011261026e57602060ff60015460a01c166040519015158152f35b3461026e57604036600319011261026e576004356024355f805160206120cc833981519152808310156116f4578110156116dc576040516326fc0f8d60e21b8152600481019290925260248201525f6044820181905260648201526020816084817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa8015610a14575f906116a9575b602090604051908152f35b506020813d6020116116d4575b816116c360209383611905565b8101031261026e576020905161169e565b3d91506116b6565b60249060405190630c62327960e31b82526004820152fd5b604051630c62327960e31b815260048101849052602490fd5b3461026e575f36600319011261026e576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b3461026e5760208060031936011261026e57600435805f52600b825260ff60405f20541615610256575f526009815260405f20604051908183825491828152019081925f52845f20905f5b868282106117f15786866117b282880383611905565b60405192839281840190828552518091526040840192915f5b8281106117da57505050500390f35b8351855286955093810193928101926001016117cb565b83548552909301926001928301920161179c565b3461026e57608036600319011261026e576020610424606435604435602435600435611927565b3461026e5760209061183d36611856565b905f526003835260405f20905f52825260405f20548152f35b604090600319011261026e576004359060243590565b602435906001600160a01b038216820361026e57565b600435906001600160a01b038216820361026e57565b9181601f8401121561026e5782359167ffffffffffffffff831161026e576020808501948460051b01011161026e57565b9081518082526020808093019301915f5b8281106118e8575050505090565b83516001600160a01b0316855293810193928101926001016118da565b90601f8019910116810190811067ffffffffffffffff8211176110fd57604052565b9291905f805160206120cc83398151915280851015611a0657808210156119ed57808310156116f4578310156116f4576040516326fc0f8d60e21b815260048101949094526024840152604483015260648201526020816084817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa908115610a14575f916119be575090565b90506020813d6020116119e5575b816119d960209383611905565b8101031261026e575190565b3d91506119cc565b604051630c62327960e31b815260048101839052602490fd5b604051630c62327960e31b815260048101869052602490fd5b8054821015611a34575f5260205f2001905f90565b634e487b7160e01b5f52603260045260245ffd5b15611a4f57565b60405162461bcd60e51b815260206004820152601460248201527313db9b1e48189c9a5919d94818d85b8818d85b1b60621b6044820152606490fd5b805f52600b60205260ff60405f20541615610256575f52600360205260405f20600460205263ffffffff60405f2054165f5260205260405f205490565b9190811015611a345760051b0190565b8054821015611a34575f52600360205f20910201905f90565b90815f526020600b60205260409060ff60405f20541615611bca578215611bc257835f9492939452600493600460205263ffffffff938460405f2054169384600195866001905b611b4b575b505050505050505050505f90565b15611bb3575b5f90835f5260038752845f2089821690815f528852855f20548714611ba55790899115611b9d575b168015611b8a575f19019087611b38565b60118a634e487b7160e01b5f525260245ffd5b50601e611b79565b505050505050505091505090565b8188821603611b515780611b3d565b505050505f90565b60405163ea17a6a560e01b815260048101859052602490fd5b90815f52600b60205260ff60405f20541615611c6d57815f52600760205260405f209060018060a01b0380911691825f5260205260405f2054925f52600660205260405f20918254841091821592611c54575b5050611c4e57600291611c4891611ad8565b50015490565b50505f90565b909150611c618484611ad8565b50541614155f80611c36565b60405163ea17a6a560e01b815260048101839052602490fd5b67ffffffffffffffff81116110fd5760051b60200190565b90611ca882611c86565b611cb56040519182611905565b8281528092611cc6601f1991611c86565b0190602036910137565b8051821015611a345760209160051b010190565b80611d0e57507f0d823319708ab99ec915efd4f7e03d11ca1790918e8f04cd14100aceca2aa9ff90565b60018103611d3b57507f170a9598425eb05eb8dc06986c6afc717811e874326a79576c02d338bdf14f1390565b60028103611d6857507f273b1a40397b618dac2fc66ceb71399a3e1a60341e546e053cbfa5995e824caf90565b60038103611d9557507f16bf9b1fb2dfa9d88cfb1752d6937a1594d257c2053dff3cb971016bfcffe2a190565b60048103611dc257507f1288271e1f93a29fa6e748b7468a77a9b8fc3db6b216ce5fc2601fc3e9bd6b3690565b60058103611def57507f1d47548adec1068354d163be4ffa348ca89f079b039c9191378584abd79edeca90565b60068103611e1c57507f0b98a89e6827ef697b8fb2e280a2342d61db1eb5efc229f5f4a77fb333b80bef90565b60078103611e4957507f231555e37e6b206f43fdcd4d660c47442d76aab1ef552aef6db45f3f9cf2e95590565b60088103611e7657507f03d0dc8c92e2844abcc5fdefe8cb67d93034de0862943990b09c6b8e3fa27a8690565b60098103611ea357507f1d51ac275f47f10e592b8e690fd3b28a76106893ac3e60cd7b2a3a443f4e835590565b600a8103611ed057507f16b671eb844a8e4e463e820e26560357edee4ecfdbf5d7b0a28799911505088d90565b600b8103611efd57507f115ea0c2f132c5914d5bb737af6eed04115a3896f0d65e12e761ca560083da1590565b600c8103611f2a57507f139a5b42099806c76efb52da0ec1dde06a836bf6f87ef7ab4bac7d00637e28f090565b600d8103611f5757507f0804853482335a6533eb6a4ddfc215a08026db413d247a7695e807e38debea8e90565b600e8103611f8457507f2f0b264ab5f5630b591af93d93ec2dfed28eef017b251e40905cdf798368980390565b600f8103611fb157507f170fc161bf1b9610bf196c173bdae82c4adfd93888dc317f5010822a3ba9ebee90565b6024906040519063112517f360e21b82526004820152fd5b5f546001600160a01b03163303611fdc57565b60405163118cdaa760e01b8152336004820152602490fd5b801561208357600190602081108216604e8210831617612070578190600480935b808311612030575050508163ffffffff048111610ee0570290565b9091938063ffffffff04811161205d57818516612054575b800293811c9190612015565b80930292612048565b601183634e487b7160e01b5f525260245ffd5b905060040a9063ffffffff8211610ee057565b50600190565b90600163ffffffff80931601918211610ee057565b5f52600260205260405f20906103e863ffffffff80921601818111610ee057165f5260205260405f20549056fe73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001a2646970667358221220163ebe247b4245a347669140d1d720a95d628eb3f17aea03c9f26a632588f28e64736f6c63430008170033000000000000000000000000a22a3ce2e3eb5865acdca8980f95c8eaa87ef4a1",
        "nonce": "0x10c",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    },
    {
      "hash": "0xfa59790b17e4a7432b1016cd9045f204d13dee446262525a0854e9d1a712c17c",
      "transactionType": "CREATE",
      "contractName": "RollupBridge",
      "contractAddress": "0xa9be9ba80802eadffeee5dc1ff46b0ed7da8a19d",
      "function": null,
      "arguments": [
        "0x708fbfE3acC1F65948304015f1789a05383a674b",
        "0xef249e41F6DC67BdfdBe44f4690cB4527d65CdD2"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x41ce0a",
        "value": "0x0",
        "input": "0x60c0346200010657601f62003b4e38819003918201601f19168301916001600160401b038311848410176200010a57808492604094855283398101031262000106576200005a602062000052836200011e565b92016200011e565b9060015f553315620000ee5760018054336001600160a01b031982168117909255604051936001600160a01b03939092849283167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3166080521660a052613a1a9081620001348239608051818181610e650152611844015260a0518181816104a2015281816113c101526119580152f35b604051631e4fbdf760e01b81525f6004820152602490fd5b5f80fd5b634e487b7160e01b5f52604160045260245ffd5b51906001600160a01b0382168203620001065756fe60806040526004361015610011575f80fd5b5f3560e01c80630a9306d7146102ea5780630ec107bd146102e557806311a00fc2146102e0578063175b0284146102db578063181e0124146102d65780631878d1f1146102d15780631d7a4993146102cc5780631f48d924146102c757806329e58659146102c25780632befa771146102bd57806332f1abe9146102b857806337427b221461021357806339410508146102b35780633a984bc5146102ae5780633b250b0f146102a957806349925ecc146102a45780635358fbda1461029f5780635b7ca75f1461029a5780635beb7cba146102955780635c820bd514610290578063715018a61461028b57806378d8fdc814610286578063794715b01461028157806379b53ebe1461025e5780637add14121461027c5780638043ca6614610277578063865887ee146102725780638da5cb5b1461026d578063921f27fa14610268578063981a131d14610263578063bc803dcc1461025e578063bde0a39214610259578063bf67d43514610254578063c3a079ed1461024f578063cf96cb3c1461024a578063d6df096d14610245578063d8625b0714610240578063df1097e21461023b578063e295c7e314610236578063e328412014610231578063e5949b5d1461022c578063ef7c8f9c14610227578063f2fde38b14610222578063f3a11da71461021d578063f3baf070146102185763f4606f0014610213575f80fd5b610908565b611efe565b611ee1565b611e51565b611e24565b611d8c565b611ca1565b611c1c565b6118bb565b611873565b61182f565b6117f8565b6117db565b6117ae565b611768565b61121f565b611733565b611706565b6116de565b6112ef565b61129f565b61125f565b611137565b611074565b611019565b610faf565b610f19565b610c51565b610b67565b610a5f565b6109b4565b610969565b610925565b6108a9565b610809565b610702565b6106cc565b610661565b61061b565b6105f5565b61051f565b6104d1565b61048d565b610313565b6001600160a01b0381160361030057565b5f80fd5b60043590610311826102ef565b565b3461030057606036600319011261030057602435600435610333826102ef565b7f984a71c9d95fd4794aeba33ae72edfec22053fde75488d63abef9dc69ee795af610448604435610362613639565b6008610376855f52600260205260405f2090565b6103986001610389600984015460ff1690565b61039281610636565b14611f19565b335f90815260068201602052604090206103bd906103b8905b5460ff1690565b611f5d565b6103fa836103f4816001600160a01b038b16600181141580610456575b6103e390611f9d565b6103ee821515611ff5565b3361365a565b14612041565b335f90815260078201602052604090206104158482546120bb565b9055016104238282546120bb565b9055604080516001600160a01b03909616865260208601919091523394918291820190565b0390a361045460015f55565b005b5060018601546103e39061047a906001600160a01b03165b6001600160a01b031690565b821490506103da565b5f91031261030057565b34610300575f366003190112610300576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b346103005760403660031901126103005760206024356104f0816102ef565b6004355f9081526002835260408082206001600160a01b03938416835260050160205290205416604051908152f35b3461030057602036600319011261030057600435610545815f52600260205260405f2090565b600d81015461055c906001600160a01b031661046e565b331480156105e1575b61056e906120c8565b6105b5600982016105946004610585835460ff1690565b61058e81610636565b1461210a565b6105a860128401546011850154111561214d565b805460ff19166005179055565b600b429101557ffa82118a5bf7ca3641b351a388555187c7f3c78269df3dd0280c6a99f18b5bc95f80a2005b506001546001600160a01b03163314610565565b346103005760203660031901126103005760206106136004356121a6565b604051908152f35b34610300575f36600319011261030057602060405160018152f35b6006111561064057565b634e487b7160e01b5f52602160045260245ffd5b9060068210156106405752565b34610300576020366003190112610300576004355f52600260205260a060405f20600180831b036001820154169060ff6009820154169060048101546106bb60036002840154930154936040519586526020860190610654565b604084015260608301526080820152f35b34610300576020366003190112610300576004355f5260026020526040805f206003600282015491015482519182526020820152f35b346103005760203660031901126103005760043561077f610777600b610730845f52600260205260405f2090565b6001546001600160a01b0316331480156107e4575b61074e906121de565b6107706005610761600984015460ff1690565b61076a81610636565b14612221565b01546120ab565b421015612262565b610799610794825f52600260205260405f2090565b6124f9565b335f908152600460205260409020805460ff19169055604051907f9b17bc5e2d37eeef74a4fa6e5f52445d4246a339a9f3e7372b33c8972520bf1c5f80a260018152602090f35b0390f35b50600d81015461074e90610800906001600160a01b031661046e565b33149050610745565b34610300575f36600319011261030057602060405160438152f35b9080825180825260208092019180808360051b8601019501935f905b8382106108505750505050505090565b90919293949583601f198084840301885288518051908185525f5b8281106108955750505f818501840152601f01169091018101968101950193929160010190610840565b81810185015186820186015288940161086b565b34610300576020366003190112610300576004355f5260026020526108fa60405f206107e06108e660166108df601585016125f0565b93016125f0565b604051938493604085526040850190610824565b908382036020850152610824565b34610300575f366003190112610300576020600554604051908152f35b34610300576020366003190112610300576004355f52600260205260405f20600c600a8201549101548101809111610964576020906040519042118152f35b612097565b34610300575f36600319011261030057602060405160038152f35b9181601f84011215610300578235916001600160401b038311610300576020808501948460051b01011161030057565b346103005760e0366003190112610300576109cd610304565b6001600160401b03602435818111610300576109ed903690600401610984565b9260443583811161030057610a06903690600401610984565b9460643585811161030057610a1f903690600401610984565b90608435968711610300576107e097610a3f610a4f983690600401610984565b95909460c4359860a435986126ca565b6040519081529081906020820190565b34610300576040366003190112610300576001600160401b03600435602435828111610300573660238201121561030057806004013592831161030057602436918460061b01011161030057805f5260026020527f2ee02df5a60e88925a03b4a97c2dc2cfda07bd3e99e240b012ee9d9cfd6a6078610b4e601160405f20610af3600460ff60098401541661058e81610636565b600d810154610b0a906001600160a01b031661046e565b33148015610b53575b610b1c90612d3d565b856012820155610b33610b2e866137f7565b612d7f565b01546040805195865260208601919091523394918291820190565b0390a3005b506001546001600160a01b03163314610b13565b602036600319011261030057600435610b7e613639565b6008610b92825f52600260205260405f2090565b610ba56001610389600984015460ff1690565b335f9081526006820160205260409020610bc2906103b8906103b1565b610bcd341515612dd5565b600181810154610be8916001600160a01b0390911614612e21565b335f9081526007820160205260409020610c033482546120bb565b905501610c113482546120bb565b9055604051907f984a71c9d95fd4794aeba33ae72edfec22053fde75488d63abef9dc69ee795af3392806104483482919060206040840193600181520152565b346103005760031960403682011261030057602435906004356001600160401b038311610300576101008360040192843603011261030057610c9b815f52600260205260405f2090565b9160098301610ccc610cae825460ff1690565b610cb781610636565b60028114908115610f05575b50959195612e6d565b600d840154610cee90610ce7906001600160a01b031661046e565b3314612ea9565b60c48101610cfc8184612eee565b949050610d1a60e4840195610d118787612eee565b91905014612f23565b610d34610d278386612eee565b9050600488015414612f68565b5f968793845b610d448588612eee565b90508a1015610d9457610d8b610d79600192610d73610d6d8e610d678b8e612eee565b90612fdb565b906138a0565b906120bb565b96610d73610d6d8d610d678d8d612eee565b99019894610d3a565b88610dea610de060a4969a610dda610dd060209a610dca610e61999a9d610e3799610dc460088b01548214612ff6565b14613042565b8d612eee565b90601587016130d1565b8a612eee565b90601684016130d1565b610e0d88359788601084015560248601356003840155600460ff19825416179055565b610e1a6044850189612eee565b929091610e2a606487018b612eee565b92909a6084880190612eee565b9390926040519b8c998a996317f8535960e21b8b52013596600e600f860195019360048b016132ef565b03817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa908115610f0057610a4f610ecc927fa8977c3509942b265a162041f3c634a9747979778b29a612e6df75b0bf6364d2945f91610ed1575b506133a1565b0390a2005b610ef3915060203d602011610ef9575b610eeb8183612599565b8101906131e9565b86610ec6565b503d610ee1565b613396565b60039150610f1281610636565b145f610cc3565b34610300576020366003190112610300576004355f90815260026020908152604091829020600881015460019091015483519182526001600160a01b031691810191909152f35b9591949099989793610f91610100989461012089019c895260018060a01b0380981660208a01526040890190610654565b6060870152608086015260a085015260c08401521660e08201520152565b34610300576020366003190112610300576004355f52600260205260405f2080546107e060018060a01b03806001850154169360ff60098201541691600482015460088301546011840154916014601286015494600d8701541695015495604051998a998a610f60565b34610300575f366003190112610300576110316139b8565b600180546001600160a01b031981169091555f906001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b34610300576020366003190112610300576004355f526002602052602060018060a01b03600d60405f20015416604051908152f35b9081518082526020808093019301915f5b8281106110c8575050505090565b8351855293810193928101926001016110ba565b909291604082019160408152845180935260608101926020809601905f5b81811061111a5750505061111793945060208184039101526110a9565b90565b82516001600160801b0316865294870194918701916001016110fa565b3461030057602080600319360112610300576004355f52600290600260205260409060405f2091600e83019060405192839061118661117c8554809760209181520190565b945f5260205f2090565b915f945b6001908782880110156111ba5784546001600160801b038116825260801c8482015295890195930192840161118a565b6111e7600f8a6111e18680958c8e8c5491818110611205575b106111f7575b500385612599565b016133e0565b906107e0604051928392836110dc565b60801c8152602001876111d9565b6001600160801b03831684529260019060200193016111d3565b346103005760203660031901126103005760043561123c816102ef565b60018060a01b03165f526003602052602060ff60405f2054166040519015158152f35b346103005760203660031901126103005760043561127c816102ef565b60018060a01b03165f526004602052602060ff60405f2054166040519015158152f35b346103005760403660031901126103005760206112e66024356112c1816102ef565b6004355f5260028352600760405f20019060018060a01b03165f5260205260405f2090565b54604051908152f35b346103005760803660031901126103005760048035602435606435926001600160401b038411610300576113296114189436908301610984565b949091611334613639565b611346855f52600260205260405f2090565b6113686005611359600984015460ff1690565b61136281610636565b146133fb565b60138101906113996113946113906103b133869060018060a01b03165f5260205260405f2090565b1590565b613434565b335f90815260068201602052604090206113b6906103b8906103b1565b60018060a01b0394857f0000000000000000000000000000000000000000000000000000000000000000166040998a5191631fd2333d60e01b83528a838060209a8b9333908c84019092916020906040830194835260018060a01b0316910152565b0381845afa8015610f0057888c8e61145b965f946116af575b5061143f8d85161515613489565b51809681926342b6834b60e01b83528c83019190602083019252565b0381855afa938415610f005789918e8d925f9761168c575b5051635b59030760e11b81526001600160a01b039091168a820190815260208101929092526040820195909552849081906060015b0381845afa938415610f00578b8d8a955f97611659575b506114e8908a60038a015491519889978896879663cfb2893d60e01b88526044359488016134db565b03915afa8015610f005760019361150d61151f9261152c945f9161163c575b5061350a565b335f9081526020919091526040902090565b805460ff19166001179055565b0180549093166001600160a01b0316905f1982016115b05750505081611590610448926115835f8080807fe5df19de43c8c04fd192bc68e484b2593570925fbb6ad8c07ccafbc2aa5c37a19933620f4240f161354d565b546001600160a01b031690565b94516001600160a01b039095168552602085015233939081906040820190565b865163a9059cbb60e01b815233918101918252602082018690529294929391859185919082905f90829060400103925af1908115610f00577fe5df19de43c8c04fd192bc68e484b2593570925fbb6ad8c07ccafbc2aa5c37a194610448946115909361161e575b5050611583565b8161163492903d10610ef957610eeb8183612599565b505f80611617565b6116539150893d8b11610ef957610eeb8183612599565b5f611507565b6114e891975061167e90873d8911611685575b6116768183612599565b8101906134cc565b96906114bf565b503d61166c565b6114a89197506116a890853d8711611685576116768183612599565b9690611473565b6116d0919450833d85116116d7575b6116c88183612599565b810190613474565b925f611431565b503d6116be565b34610300575f366003190112610300576001546040516001600160a01b039091168152602090f35b34610300576020366003190112610300576004355f5260026020526020600360405f200154604051908152f35b34610300576020366003190112610300576004355f526002602052602060405f20601160128201549101541115604051908152f35b34610300576020366003190112610300576004355f52600260205260405f20600b600a820154910154906107e06040519283928360209093929193604081019481520152565b34610300576020366003190112610300576004355f5260026020526020601060405f200154604051908152f35b34610300575f366003190112610300576020604051621275008152f35b34610300576020366003190112610300576004355f526002602052602060ff600960405f2001541661182d6040518092610654565bf35b34610300575f366003190112610300576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b3461030057602036600319011261030057600435611890816102ef565b6118986139b8565b6001600160a01b03165f908152600360205260409020805460ff19166001179055005b346103005760203660031901126103005760048035906118d9613639565b6118eb825f52600260205260405f2090565b90600982016118fb815460ff1690565b61190481610636565b61191c60019160018114908115611c08575b50612e6d565b600d84015461193e90611937906001600160a01b031661046e565b331461358f565b828401805461195561194f826135c8565b916135c8565b927f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031692833b156103005760408051630e8215a160e31b81528881018b8152919290915f90839081906020010381838a5af1918215610f00578492611bf5575b505f9260078b01925b611afc575b5050505050813b1561030057604051639f67003960e01b8152925f91849182916119f991908b8a850161360e565b038183855af1908115610f0057611a35946020938893611ae3575b50604051635848d98d60e11b81529081019283529485928391829160200190565b03915afa908115610f00577f5e9c8d64d9b3e1e9b9aaad80273ff6f8b37a48c391c9d889ac590aab00b79ae693611aa2935f93611abf575b506002019182556001611a81825460ff1690565b611a8a81610636565b14611aae575b50546040519081529081906020820190565b0390a261045460015f55565b805460ff191660021790555f611a90565b6002919350611adc9060203d602011611685576116768183612599565b9290611a6d565b80611af0611af692612586565b80610483565b5f611a14565b8154841015611bf057611b20611b128584612cbb565b50546001600160a01b031690565b93611b3e86611b2f8386612cbb565b5001546001600160a01b031690565b90883b15610300578251633d38067960e21b8152808d018f81526001600160a01b0380891660208301529093166040840152915f90839081906060010381838d5af18015610f005787968793611bca92611bdd575b50611bb181611ba2858d6135fa565b6001600160a01b039091169052565b6001600160a01b03165f90815260208790526040902090565b54611bd5828c6135fa565b5201936119c6565b80611af0611bea92612586565b5f611b93565b6119cb565b80611af0611c0292612586565b5f6119bd565b60029150611c1581610636565b145f611916565b34610300576020366003190112610300576004355f52600260205260405f20600c600a820154910154908181018082116109645760609260405192835260208301526040820152f35b9081518082526020808093019301915f5b828110611c84575050505090565b83516001600160a01b031685529381019392810192600101611c76565b34610300576020366003190112610300576004355f526002602052600460405f20018054611cce816135c8565b915f5b828110611cee57604051602080825281906107e090820187611c65565b80611cfb60019284612cbb565b50828060a01b03905416611d0f82876135fa565b5201611cd1565b9b999693909e9d9c9a989592979491976101c08d019f8d528c600160a01b60019003809a16906020015260408d015260608c015260808b015260a08a01611d5c91610654565b60c089015260e0880152610100870152166101208501526101408401526101608301526101808201526101a00152565b34610300576020366003190112610300576004355f908152600260205260409020805460018201546107e0906001600160a01b03169260028101549060038101546008820154611de0600984015460ff1690565b600a840154600b850154600c860154600d8701549092906001600160a01b031693601088015495601189015497601460128b01549a01549a6040519e8f9e8f611d16565b34610300576020366003190112610300576004355f5260026020526020601460405f200154604051908152f35b3461030057602036600319011261030057600435611e6e816102ef565b611e766139b8565b6001600160a01b03908116908115611ec957600154826bffffffffffffffffffffffff60a01b821617600155167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b604051631e4fbdf760e01b81525f6004820152602490fd5b34610300575f366003190112610300576020604051620f42408152f35b34610300575f36600319011261030057602060405160328152f35b15611f2057565b60405162461bcd60e51b8152602060048201526015602482015274496e76616c6964206368616e6e656c20737461746560581b6044820152606490fd5b15611f6457565b60405162461bcd60e51b8152602060048201526011602482015270139bdd0818481c185c9d1a58da5c185b9d607a1b6044820152606490fd5b15611fa457565b60405162461bcd60e51b815260206004820152602360248201527f546f6b656e206d7573742062652045524332302074617267657420636f6e74726044820152621858dd60ea1b6064820152608490fd5b15611ffc57565b60405162461bcd60e51b815260206004820152601d60248201527f616d6f756e74206d7573742062652067726561746572207468616e20300000006044820152606490fd5b1561204857565b60405162461bcd60e51b815260206004820152602160248201527f6e6f6e204552433230207374616e64617264207472616e73666572206c6f67696044820152606360f81b6064820152608490fd5b634e487b7160e01b5f52601160045260245ffd5b9062127500820180921161096457565b9190820180921161096457565b156120cf57565b60405162461bcd60e51b81526020600482015260136024820152723ab730baba3437b934bd32b21031b0b63632b960691b6044820152606490fd5b1561211157565b60405162461bcd60e51b81526020600482015260146024820152734e6f7420696e20636c6f73696e6720737461746560601b6044820152606490fd5b1561215457565b60405162461bcd60e51b815260206004820152601760248201527f496e73756666696369656e74207369676e6174757265730000000000000000006044820152606490fd5b9190820391821161096457565b5f52600260205260405f20600c600a820154910154810180911161096457804210156121d9574281039081116109645790565b505f90565b156121e557565b60405162461bcd60e51b815260206004820152601460248201527337b7363c9037bbb732b91037b9103632b0b232b960611b6044820152606490fd5b1561222857565b60405162461bcd60e51b815260206004820152601260248201527110da185b9b995b081b9bdd0818db1bdcd95960721b6044820152606490fd5b1561030057565b634e487b7160e01b5f52604160045260245ffd5b9060438202918083046043149015171561096457565b8054905f8155816122a2575050565b6001906001600160ff1b0383168303610964575f5260205f209160011b8201915b8281106122cf57505050565b5f808255828201556002016122c3565b8181106122ea575050565b5f81556001016122df565b80545f825580612303575050565b610311915f52600160205f20910160011c8101906122df565b90600160401b811161238057815481835580821061233957505050565b610311925f52600160205f20916010828501831c84019460041b1680612366575b500160011c01906122df565b5f19908186019182549160200360031b1c1690555f61235a565b612269565b80545f825580612393575050565b610311915f5260205f20908101906122df565b90600182811c921680156123d4575b60208310146123c057565b634e487b7160e01b5f52602260045260245ffd5b91607f16916123b5565b8054905f8155816123ed575050565b5f526020805f20918201915b82811061240557505050565b80612412600192546123a6565b8061241f575b50016123f9565b601f9081811184146124375750505f81555b5f612418565b8361245092845f52865f20920160051c820191016122df565b5f8181526020812081835555612431565b90600160401b81116123805781549181815582821061247f57505050565b5f5260205f2091820191015b818110612496575050565b806124a3600192546123a6565b806124b0575b500161248b565b601f9081811184146124c85750505f81555b5f6124a9565b836124e8926124da855f5260205f2090565b920160051c820191016122df565b5f81815260208120818355556124c2565b6016610311915f81555f60018201555f60028201555f600382015561252060048201612293565b5f60088201555f60098201555f600a8201555f600b8201555f600c8201555f600d820155612550600e82016122f5565b61255c600f8201612385565b5f60108201555f60118201555f60128201555f6014820155612580601582016123de565b016123de565b6001600160401b03811161238057604052565b90601f801991011681019081106001600160401b0382111761238057604052565b60405190604082018281106001600160401b0382111761238057604052565b6001600160401b0381116123805760051b60200190565b9081546125fc816125d9565b90604061260c6040519384612599565b81835282946020809401905f52835f20915f915b84831061262f57505050505050565b8151865f92865492612640846123a6565b8082526001948086169081156126ae5750600114612676575b50612668816001960382612599565b815201940192019192612620565b5f8981528481209650905b8082106126975750810183019450612668612659565b8654838301860152958501958b9490910190612681565b60ff19168584015250151560051b810183019450612668612659565b98959792949990939196335f52602093600360205260ff60405f2054161561298057335f9081526004602052604090206127109061270b90611390906103b1565b6129b6565b600389101580612975575b612724906129fa565b61272f848a14612a46565b610e1088101580612968575b61274790979697612a86565b6005549b8c9a60019960018d0161275d90600555565b335f9081526004602052604090208e908e90805460ff1916600117905561278c905f52600260205260405f2090565b9d8e5560018e0180546001600160a01b0319166001600160a01b03909216919091179055600d8d0180546001600160a01b0319163317905542600a8e0155600c8d01556127dc91600e8d01612adf565b6127e991600f8b01612bd5565b60098801805460ff191660011790556014880155600587019260048801600689015f5b8981106128795750505050505050505061283161282a60119261227d565b6064900490565b9101908082551561286f575b506001600160a01b0316817feded733012be80deb8a1833d57ded6191b80e449b4bb9bf5af555208236e0b7e5f80a390565b600190555f61283d565b8061296261289161288c8c948e8d612c58565b612c6d565b6128b96128b46113906103b184899060018060a01b03165f5260205260405f2090565b612c77565b6128f76128ca61288c858b8b612c58565b6128f16128d56125ba565b6001600160a01b0385168152916001600160a01b0316828d0152565b87612cd4565b6001600160a01b0381165f9081526020869052604090206129179061151f565b61294361292861288c858b8b612c58565b6001600160a01b039092165f90815260208c90526040902090565b80546001600160a01b0319166001600160a01b03909216919091179055565b0161280c565b5062093a8088111561273b565b50603289111561271b565b60405162461bcd60e51b815260206004820152600e60248201526d139bdd08185d5d1a1bdc9a5e995960921b6044820152606490fd5b156129bd57565b60405162461bcd60e51b815260206004820152601560248201527410da185b9b995b081b1a5b5a5d081c995858da1959605a1b6044820152606490fd5b15612a0157565b60405162461bcd60e51b815260206004820152601a60248201527f496e76616c6964207061727469636970616e74206e756d6265720000000000006044820152606490fd5b15612a4d57565b60405162461bcd60e51b81526020600482015260116024820152704d69736d6174636865642061727261797360781b6044820152606490fd5b15612a8d57565b60405162461bcd60e51b815260206004820152600f60248201526e125b9d985b1a59081d1a5b595bdd5d608a1b6044820152606490fd5b6001600160801b0381160361030057565b3561111781612ac4565b91906001600160401b03821161238057612b0790612afd838561231c565b925f5260205f2090565b60018260011c925f5b848110612b8557506001198116900380612b2c575b5050505050565b93905f945f5b818110612b49575050505001555f80808080612b25565b90916020612b7a8598612b5c8497612ad5565b908560041b60031b916001600160801b03809116831b921b19161790565b970193929101612b32565b5f805b60028110612b9c5750848201558201612b10565b96906020612bcc8692612bae85612ad5565b908b60041b60031b916001600160801b03809116831b921b19161790565b92019701612b88565b906001600160401b03831161238057600160401b8311612380578154838355808410612c28575b50905f526020805f20905f5b848110612c16575050505050565b83358382015592810192600101612c08565b612c3e90835f528460205f2091820191016122df565b5f612bfc565b634e487b7160e01b5f52603260045260245ffd5b9190811015612c685760051b0190565b612c44565b35611117816102ef565b15612c7e57565b60405162461bcd60e51b8152602060048201526015602482015274111d5c1b1a58d85d19481c185c9d1a58da5c185b9d605a1b6044820152606490fd5b8054821015612c68575f5260205f209060011b01905f90565b8054600160401b81101561238057612cf191600182018155612cbb565b612d2a57815181546001600160a01b039182166001600160a01b0319918216178355602090930151600190920180549093169116179055565b634e487b7160e01b5f525f60045260245ffd5b15612d4457565b60405162461bcd60e51b81526020600482015260136024820152722737ba103632b0b232b91037b91037bbb732b960691b6044820152606490fd5b15612d8657565b60405162461bcd60e51b815260206004820152602160248201527f496e76616c69642067726f7570207468726573686f6c64207369676e617475726044820152606560f81b6064820152608490fd5b15612ddc57565b60405162461bcd60e51b815260206004820152601e60248201527f4465706f736974206d7573742062652067726561746572207468616e203000006044820152606490fd5b15612e2857565b60405162461bcd60e51b815260206004820152601860248201527f546f6b656e206d7573742062652073657420746f2045544800000000000000006044820152606490fd5b15612e7457565b60405162461bcd60e51b815260206004820152600d60248201526c496e76616c696420737461746560981b6044820152606490fd5b15612eb057565b60405162461bcd60e51b815260206004820152601660248201527513db9b1e481b195859195c8818d85b881cdd589b5a5d60521b6044820152606490fd5b903590601e198136030182121561030057018035906001600160401b03821161030057602001918160051b3603831361030057565b15612f2a57565b60405162461bcd60e51b81526020600482015260166024820152754d69736d617463686564206c6561662061727261797360501b6044820152606490fd5b15612f6f57565b60405162461bcd60e51b8152602060048201526012602482015271125b9d985b1a59081b1958598818dbdd5b9d60721b6044820152606490fd5b903590601e198136030182121561030057018035906001600160401b0382116103005760200191813603831361030057565b90821015612c6857612ff29160051b810190612fa9565b9091565b15612ffd57565b60405162461bcd60e51b815260206004820152601860248201527f496e697469616c2062616c616e6365206d69736d6174636800000000000000006044820152606490fd5b1561304957565b60405162461bcd60e51b815260206004820152601d60248201527f42616c616e636520636f6e736572766174696f6e2076696f6c617465640000006044820152606490fd5b9190601f811161309d57505050565b610311925f5260205f20906020601f840160051c830193106130c7575b601f0160051c01906122df565b90915081906130ba565b91906130dd8284612461565b5f92835260208084209091805b8486106130f957505050505050565b6131038183612fa9565b6001600160401b03819392931161238057859261312a8261312488546123a6565b8861308e565b5f90601f831160011461317857826001959386959361315e935f9261316d575b50508160011b915f199060031b1c19161790565b86555b019301950194916130ea565b013590505f8061314a565b601f9493941983169161318e885f5260205f2090565b925f5b8181106131d157509160019693918588979694106131b8575b505050831b83018655613161565b01355f19600384901b60f8161c191690555f80806131aa565b8284013585558a966001909501949283019201613191565b90816020910312610300575180151581036103005790565b81835290916001600160fb1b0383116103005760209260051b809284830137010190565b805480835290929161323e90602001935f5260205f2090565b5f935b6001908382870110156132765782546001600160801b038116825260801c602082015260029190604001920194019390613241565b939492919050549181811061329a575b1061328f575090565b60801c815260200190565b6001600160801b0383168452926001906020019301613286565b9081548082526020809201925f5260205f20915f905b8282106132d8575050505090565b8354855293840193600193840193909101906132ca565b809a9998969594929391938060c0830160c084525260e0820194905f5b81811061336857505050936133398460a0999794613347948860206133639c9a6133559a03910152613201565b908b820360408d0152613225565b9089820360608b01526132b4565b918783036080890152613201565b930152565b919560019193506001600160801b03873561338281612ac4565b168152602080910196019101918c9261330c565b6040513d5f823e3d90fd5b156133a857565b60405162461bcd60e51b815260206004820152601060248201526f24b73b30b634b2102d2590383937b7b360811b6044820152606490fd5b906103116133f492604051938480926132b4565b0383612599565b1561340257565b60405162461bcd60e51b815260206004820152600a602482015269139bdd0818db1bdcd95960b21b6044820152606490fd5b1561343b57565b60405162461bcd60e51b815260206004820152601160248201527020b63932b0b23c903bb4ba34323930bbb760791b6044820152606490fd5b908160209103126103005751611117816102ef565b1561349057565b60405162461bcd60e51b8152602060048201526014602482015273130c881859191c995cdcc81b9bdd08199bdd5b9960621b6044820152606490fd5b90816020910312610300575190565b9291608094979695926134fb92855260a0602086015260a0850191613201565b95604083015260608201520152565b1561351157565b60405162461bcd60e51b815260206004820152601460248201527324b73b30b634b21036b2b935b63290383937b7b360611b6044820152606490fd5b1561355457565b60405162461bcd60e51b8152602060048201526013602482015272115512081d1c985b9cd9995c8819985a5b1959606a1b6044820152606490fd5b1561359657565b60405162461bcd60e51b815260206004820152600a6024820152692737ba103632b0b232b960b11b6044820152606490fd5b906135d2826125d9565b6135df6040519182612599565b82815280926135f0601f19916125d9565b0190602036910137565b8051821015612c685760209160051b010190565b9161362b9061111794928452606060208501526060840190611c65565b9160408184039101526110a9565b60025f54146136485760025f55565b604051633ee5aeb560e01b8152600490fd5b6040516370a0823160e01b80825230600483015260209492936001600160a01b0316918581602481865afa938415610f005786915f95613747575b506040516323b872dd60e01b81526001600160a01b0390961660048701523060248701526044860152929391928280606481015b03815f875af1918215610f0057859261372a575b5060405190815230600482015291829060249082905afa908115610f0057611117935f9261370d575b5050612199565b6137239250803d10611685576116768183612599565b5f80613706565b61374090833d8511610ef957610eeb8183612599565b505f6136dd565b6136c994955061376390833d8511611685576116768183612599565b9493613695565b1561377157565b60405162461bcd60e51b815260206004820152601960248201527f496e76616c6964207061727469636970616e7420636f756e74000000000000006044820152606490fd5b156137bd57565b60405162461bcd60e51b81526020600482015260126024820152710a8d0e4cae6d0ded8c840dad2e6dac2e8c6d60731b6044820152606490fd5b5f52600260205260405f206012810154601182015480911061389a5780156138555761383961282a6004613847940154613834600382101561376a565b61227d565b90811561384c575b146137b6565b600190565b60019150613841565b60405162461bcd60e51b815260206004820152601b60248201527f496e76616c6964207265717569726564207369676e61747572657300000000006044820152606490fd5b50505f90565b5f9291156139af5780355f1a9060c082106139a65760019160f7811161399a575b506001910180355f1a607f8111613965575b500180355f1a906080821060011461396057608082146001146139595760b88210613940575b60b78211613905575050565b9091925061010090600181013560b619840160031b83031c92602084116139375760b519910101359160031b90031c90565b60045f5260205ffd5b6001810135607f19830160031b610100031c93506138f9565b505f925050565b509150565b60b8811061398e575b60b78111156138d35760018201355f90811a90910160b5190192506138d3565b607e198101925061396e565b60f5190191505f6138c1565b60025f5260205ffd5b60015f5260205ffd5b6001546001600160a01b031633036139cc57565b60405163118cdaa760e01b8152336004820152602490fdfea264697066735822122065b12332a83f77e399f5748fb707840e91d2fb36fcccd19e043433deb665ba2564736f6c63430008170033000000000000000000000000708fbfe3acc1f65948304015f1789a05383a674b000000000000000000000000ef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
        "nonce": "0x10d",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    },
    {
      "hash": "0x3d55abe950e8f25658a377c598d75512435b61b91b5997470a67fc5f0cb552c2",
      "transactionType": "CALL",
      "contractName": "MerkleTreeManager4",
      "contractAddress": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
      "function": "setBridge(address)",
      "arguments": [
        "0xa9BE9BA80802EaDFFEee5dc1fF46B0ED7da8a19D"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "to": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
        "gas": "0x10065",
        "value": "0x0",
        "input": "0x8dd14802000000000000000000000000a9be9ba80802eadffeee5dc1ff46b0ed7da8a19d",
        "nonce": "0x10e",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    }
  ],
  "receipts": [
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x1b8d37b",
      "logs": [],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x14395d21d193c2e09ab4e708c85c8a8b5186be2898f6c906c4dfe549664e13df",
      "transactionIndex": "0x9f",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0x396d22",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0xa22a3ce2e3eb5865acdca8980f95c8eaa87ef4a1"
    },
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x1d60164",
      "logs": [
        {
          "address": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
          "topics": [
            "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb"
          ],
          "data": "0x",
          "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
          "blockNumber": "0x8a740a",
          "blockTimestamp": "0x68aebd10",
          "transactionHash": "0x9f4c2dc61cadae8e450e06f9e24eb6b7cabd0914eabd6a2a308c039409823c08",
          "transactionIndex": "0xa0",
          "logIndex": "0x154",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000000000000000000000000000000000404000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000140000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x9f4c2dc61cadae8e450e06f9e24eb6b7cabd0914eabd6a2a308c039409823c08",
      "transactionIndex": "0xa0",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0x1d2de9",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2"
    },
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x2089fe2",
      "logs": [
        {
          "address": "0xa9be9ba80802eadffeee5dc1ff46b0ed7da8a19d",
          "topics": [
            "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb"
          ],
          "data": "0x",
          "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
          "blockNumber": "0x8a740a",
          "blockTimestamp": "0x68aebd10",
          "transactionHash": "0xfa59790b17e4a7432b1016cd9045f204d13dee446262525a0854e9d1a712c17c",
          "transactionIndex": "0xa1",
          "logIndex": "0x155",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000010000000000000000000000000000000000000000000000000000000000000000000000020000000000000002000040000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0xfa59790b17e4a7432b1016cd9045f204d13dee446262525a0854e9d1a712c17c",
      "transactionIndex": "0xa1",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0x329e7e",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0xa9be9ba80802eadffeee5dc1ff46b0ed7da8a19d"
    },
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x2095982",
      "logs": [
        {
          "address": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
          "topics": [
            "0xa49730bff544fd0b716395c592e39c6fd2d2481a19b9229b5b240483db95a495",
            "0x000000000000000000000000a9be9ba80802eadffeee5dc1ff46b0ed7da8a19d"
          ],
          "data": "0x",
          "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
          "blockNumber": "0x8a740a",
          "blockTimestamp": "0x68aebd10",
          "transactionHash": "0x3d55abe950e8f25658a377c598d75512435b61b91b5997470a67fc5f0cb552c2",
          "transactionIndex": "0xa2",
          "logIndex": "0x156",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000404000000004000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x3d55abe950e8f25658a377c598d75512435b61b91b5997470a67fc5f0cb552c2",
      "transactionIndex": "0xa2",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0xb9a0",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
      "contractAddress": null
    }
  ],
  "libraries": [],
  "pending": [],
  "returns": {},
  "timestamp": 1756282185,
  "chain": 11155111,
  "commit": "551d364"
}


================================================
FILE: broadcast/Deploy.s.sol/11155111/run-latest.json
================================================
{
  "transactions": [
    {
      "hash": "0x14395d21d193c2e09ab4e708c85c8a8b5186be2898f6c906c4dfe549664e13df",
      "transactionType": "CREATE",
      "contractName": "Poseidon4",
      "contractAddress": "0xa22a3ce2e3eb5865acdca8980f95c8eaa87ef4a1",
      "function": null,
      "arguments": null,
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x4aa779",
        "value": "0x0",
        "input": "0x6080806040523461001657614307908161001b8239f35b5f80fdfe604060808152600480361015610013575f80fd5b5f3560e01c80636ebd052f146109cd5780639116466d146107c45780639bf03e34146106c6578063c02c648a146104ad578063e10b107d1461028c5763e24372e11461005d575f80fd5b34610288575f36600319011261028857610075610a2c565b9060803683375f8252602082015f81528383015f815260608401915f835261009b6109f8565b9460a03687375f865251602086015251858501525160608401525160808301526100c3610c6c565b90602082519201519260a0366100d76109f8565b37925f925f5b83811061020957505f5b603881106101a757505f935b8385106101065760208787519051908152f35b90919293945f5b600581106101635750835f5b60058110610139575061012e90600192614210565b9501939291906100f3565b6001915061015061014a8285610c47565b516141be565b61015a8285610c47565b52018490610119565b916101a06001915f805160206142b28339815191526101828686610c47565b5161018d838961418a565b51900861019a8686610c47565b5261419c565b920161010d565b949180939491925f5b600581106101dd5750600191816101ca6101d193516141be565b8152614210565b950193929190936100e7565b928192506101ff905f805160206142b283398151915261018286600195610c47565b92019084916101b0565b945f94919293945b600581106102625750835f5b6005811061023e575061023290600192614210565b950193929190936100dd565b6001915061024f61014a8285610c47565b6102598285610c47565b5201849061021d565b916102816001915f805160206142b28339815191526101828686610c47565b9201610211565b5f80fd5b509034610288575f366003190112610288576102a6610a2c565b91608036843760019081845260208401600281528385016003815260608601918383526102d16109f8565b9660a03689375f885251602088015251858701525160608601525160808501526102f9610c6c565b90602082519201519460a03661030d6109f8565b37945f925f5b83811061042d57505f5b603881106103d257505f935b83851061033c5760208789519051908152f35b909192939480975f5b60058110610395575084825f5b6005811061037157505061036591614210565b97950193929190610329565b90915061038161014a8285610c47565b61038b8285610c47565b5201828691610352565b926103cb83915f805160206142b28339815191526103b38786610c47565b516103be838a61418a565b51900861019a8786610c47565b9301610345565b948281985f96939495965b60058110610402575090816101ca6103f593516141be565b979591949392910161031d565b93819250610423905f805160206142b28339815191526103b3878795610c47565b93019085916103dd565b9480975f95929394955b60058110610488575084825f5b6005811061046457505061045791614210565b9795919493929101610313565b90915061047461014a8285610c47565b61047e8285610c47565b5201828691610444565b926104a683915f805160206142b28339815191526103b38786610c47565b9301610437565b5090346102885760a0366003190112610288573660231215610288576104d16109f8565b9060a4823682116102885784905b8282106106b65750505060a0366104f46109f8565b376104fd610c6c565b928351906020809501519360a0366105136109f8565b37935f925f5b83811061063757505f5b603881106105dc57505f935b83851061055f57855187895f835b6005821061054a5760a085f35b8280600192865181520194019101909261053d565b90919293955f5b600581106105b65750835f5b60058110610592575061058790600192614210565b96019392919061052f565b600191506105a361014a8285610c47565b6105ad8285610c47565b52018490610572565b916105d56001915f805160206142b28339815191526101828686610c47565b9201610566565b959180939491925f5b6005811061060b5750600191816101ca6105ff93516141be565b96019392919093610523565b9281925061062d905f805160206142b283398151915261018286600195610c47565b92019084916105e5565b955f94919293945b600581106106905750835f5b6005811061066c575061066090600192614210565b96019392919093610519565b6001915061067d61014a8285610c47565b6106878285610c47565b5201849061064b565b916106af6001915f805160206142b28339815191526101828686610c47565b920161063f565b81358152602091820191016104df565b503461028857608036600319011261028857803560243560443591606435935f805160206142b28339815191528083101561077657808410156107765780851015610776578510156107285760208661072187878787610a4c565b9051908152f35b608490602087519162461bcd60e51b8352820152602260248201527f506f736569646f6e344669656c643a20696e70757420697320746f6f206c6172604482015261676560f01b6064820152fd5b865162461bcd60e51b8152602081840152602260248201527f506f736569646f6e344669656c643a20696e70757420697320746f6f206c6172604482015261676560f01b6064820152608490fd5b5034610288575f366003190112610288576107dd610a2c565b906080368337607b8252602082016101c881528383016103158152606084019162018af8835261080b6109f8565b9460a03687375f86525160208601525185850152516060840152516080830152610833610c6c565b90602082519201519260a0366108476109f8565b37925f925f5b83811061094e57505f5b603881106108f357505f935b8385106108765760208787519051908152f35b90919293945f5b600581106108cd5750835f5b600581106108a9575061089e90600192614210565b950193929190610863565b600191506108ba61014a8285610c47565b6108c48285610c47565b52018490610889565b916108ec6001915f805160206142b28339815191526101828686610c47565b920161087d565b949180939491925f5b600581106109225750600191816101ca61091693516141be565b95019392919093610857565b92819250610944905f805160206142b283398151915261018286600195610c47565b92019084916108fc565b945f94919293945b600581106109a75750835f5b60058110610983575061097790600192614210565b9501939291909361084d565b6001915061099461014a8285610c47565b61099e8285610c47565b52018490610962565b916109c66001915f805160206142b28339815191526101828686610c47565b9201610956565b5090346102885760803660031901126102885761072160209260643590604435906024359035610a4c565b6040519060a0820182811067ffffffffffffffff821117610a1857604052565b634e487b7160e01b5f52604160045260245ffd5b604051906080820182811067ffffffffffffffff821117610a1857604052565b929190610a57610a2c565b9360803686378452602084019081526040840191825260608401928352610a7c6109f8565b9360a03686375f8552516020850152516040840152516060830152516080820152610aa5610c6c565b602081519101519160a036610ab86109f8565b37915f905f5b60048110610bca57505f5b60388110610b7857505f925b60048410610ae557505050505190565b909192935f5b60058110610b3a5750825f5b60058110610b165750610b0c90600192614210565b9401929190610ad5565b60019150610b2761014a8285610c47565b610b318285610c47565b52018390610af7565b93610b716001915f805160206142b2833981519152610b598886610c47565b51610b64838861418a565b51900861019a8886610c47565b9401610aeb565b935f939192935b60058110610ba45750610b9983826101ca600194516141be565b940192919092610ac9565b93610bc36001915f805160206142b2833981519152610b598886610c47565b9401610b7f565b935f939192935b60058110610c215750825f5b60058110610bfd5750610bf290600192614210565b940192919092610abe565b60019150610c0e61014a8285610c47565b610c188285610c47565b52018390610bdd565b93610c406001915f805160206142b2833981519152610b598886610c47565b9401610bd1565b906005811015610c585760051b0190565b634e487b7160e01b5f52603260045260245ffd5b604080519067ffffffffffffffff9082810182811184821017610a1857612840840181811084821117610a185782526128009081368237845260209485850192610cb46109f8565b935f5b60a080821015610cda57908991610ccc6109f8565b903682378188015201610cb7565b50509384528051959691959094919287929082019190821181831017610a18577f5e876f8493c339c36750caa31382bea4a90d6928976a3f996a30a3f1af778f639186527f5c5bec06aa43ca811a9c78919fe505276e4625b2dc92b86947cc4d7726c77d3d81527f6268bc5f9031edb5b6bc2edbbe091cce714d51abbba4301fa0a19319da4ca232848201527f4572aeff3e581883c3333a4fcb784afdd0f4b81f0d34e36835fd9a2644342b6a868201526060907f2c44402b93c5ac82bc8bb58e947fca107e865d85b1cb0f1f32f0c05cdaf439f8828201526080937f023eb54d53e89505d0c9258bee0de17bb0a11e451b48d22d88549e05e2018403858301527f5c3c49994dfe7863f506ee54719e6ee22a8136da7b276fd95b222de90b48feec60a08301527f349b3f7366f89983b3858e40a22f53fa2e62ad46932303ce85d42591ca5141a360c08301527f0b383428a756701b8c1c1c38c9c3abbb4df3b6fbb5a581fe9bba326455776e9160e08301527f6814d01a7834e8f1f53b89bae25702ed6c864c49ffba3820e6106185e81a85e16101008301527f382d39c6bdbba256b12d3fa4476187c14c4867255ea999c6503e92f520e9a9186101208301527f507aa38edca7a8d6925c668abc3a17a3252efb8f94740a7775db0bb328d1061e6101408301527f3bd1bbe1f40eb3fa7def818257305e9c50a675d756e6aed051fc4e7b7b132d8b6101608301527f4ddaf59374164d01c4c07ac09d306653f607cb880ab16330c680994321df3f4a6101808301527f36a92b9f74005c1802eb60930a7135d4af73fc20a535506093f98fa0aa1fbd916101a08301527f1eeb8e80a4a1382bda0c063aa61dad5da57fa80865d0beeb2b9e69a07b5965f46101c08301527f245c1c6d6f21bf7dd2abd1626514169678fa53bd900f6bd2cd854a9a965cb77b6101e08301527f4fee9d33743fa477a4fe71f77e5c95778db9c7efee51846f4a2d369e18a15cdd6102008301527f1a1492b84929e7080f0b6c8b1c46e9164beed12136837032670d44165d269c696102208301527f64f9e3fa689c48974257c4e505827bb9c0babbe89366dfcbb3162eafab4e8b076102408301527f0b0a1a2b2762612d71d2f2d692c632218b5e47f3f0e38d638cfd365c313dbd486102608301527f05b20208ea0377139f322767d36fea854d28ccedb083ab8901f4054f822c51016102808301527f0710c608d8a48043e99dd94a0b1d22906b67dafb6bc5b95adf8c2f24ce81b0cd6102a08301527f68e5bf430d23864f21836ccefc1fac4801bdc00cc43de2608532d788c7fb45e76102c08301527f09221b8a932a7820912b20bf5b919b7e0a22b3c9d2a1f0d9832ca03b0fc0ed9f6102e08301527f65ac3ba4cbab3d2622b373ef54c1dfb299e7fb992555478d5c1c44ee786329536103008301527f114be59c06f561e8324e306a28896fb1dd3802773891f54f0b8243718ef125426103208301527f61d96c0b2e0683a2d7ffcd9e0b3a58b86fb3ecca7941391e597efc13f38ff5036103408301527f103454e35e0f4d690d8d1ab122b4c5c92e0512004f1af1e3140694c686cbeba96103608301527f2d2d628ded9373dcfc3ad59072a51b9a2d6c8c470753066195b77ca3a821fe476103808301527f2b0bf337fd4454a5e38344e0e711b9ae2281545fd99ad3fe46da2e1e4b9c98ce6103a08301527f0575c431f72a40242de5963e47cc7dad1aced5d9a1c9de5ac7ab5c22fad3cd676103c08301527f0ec8f181daf128e716d3d7726dcf8ecbdddadca0063dc726196baec197eb36126103e08301527f33779259084a94462f31c2650f6affd717ea200e62d2349f07fba50dd64b48756104008301527f122bdda32a00e4a3335a55fb2af4a24044fe2b223bebbbde2b32e09ef1add1016104208301527f14884ad16b1f79e5ba9d3c24b2f3f76272411ddfaa9bafb421ef4d583ba736bc6104408301527f323f85cbba64efc38ccc35c5fa9d673fef3ff652da7f2f93e176a40de61e1e706104608301527f1a3fac3af20c37aed0e41f6fa6f1a488401f16c61fc3a4e86cda951a0e3795e36104808301527f1d927c14cd47e25613656bc80171954894d2e882e35a4dc804cbc0803d47a8146104a08301527f22f1a2a2ade490e188fea20d062700568123e4b54290ab6a695584f3ec971eab6104c08301527f2c04db231c81645f30937dc5546efb30690acea9ef5769ce42000f486f893a456104e08301527f21385b6f914a8c6f421629278dfa84f2ccdcf621b05013247341438237ad3fc16105008301527f2f00090ff1cb76eaf3b6cf23718ae736af07c34cac823388e0234420247e31606105208301527f455e8b0828f3667021a434761d5b6a5fb2e90635a6b038e4315f8a30dda4af006105408301527f028b320c702e077887d5556c7c879c7d54c6c681497a1d4fa5f2045fc553211f6105608301527f2502f751749978112c96e7321ff1c0b76b3ff74190dadba0b67eac15462079f46105808301527f0a02577f723a21ced13408ed76b38ad8bbdfcc8132bb6dfbbbea8ece52e0e8106105a08301527f55d052b889557f2fc0e61e83b82261a759b75cfbec4c6f97b1104301163753b76105c08301527f450a0821b86175e4877ccb7e8b1918bbe3e88819bc9ed36ce30cca14b8eeb9116105e08301527f4a399ec4758d73d11ab365f26081aea3a61d156ec6f0185a18702e8ee1631f186106008301527f1305a1f607f37901c0a88b2b7f23672efec118296f4550a058f4f94c25b660926106208301527f08e98ff1f10c0092b41a881d5663d8d85b081830f3f5bc904dc9b2a88969344d6106408301527f1a986478818b795d1a509aff8d2ac2588342e320b77c1ebda86c5be7b03894876106608301527f3a68e478946a5cfc6c3a21c7416ad4afa64f7130ddf8986935942d6835665edd6106808301527f115b2ef9469d91408b6e1d46e671d335aabac9d8882cdf17d1afb385b1051e3e6106a08301527f0b7fe376d67252e90d9f06b43947fca03a50072c24d8598b7248fbc8b0d64e9e6106c08301527f621fba0544792a4910a92402dc5c56630bbdc50cad3edc99ee6e5466b72950426106e08301527f47ea2bb0150f7e51992433be07d695f5ee93a948cdee6fe573b5ddd9702ac19f6107008301527f3333d094869d1f23f0ae3787ad1c105122e8338b51b7a970260ea700d409d55e6107208301527f36291942b0c4d1329fa0db7230b3ef9be3e8e4b1b51897631bed81ef4d4053276107408301527f548bdc2c8e44774efaa30d0df03cd307b25ef86fe73bfd7de1c16116afa8d4326107608301527f2ff0b6bb42027bb7b5eff8a312df92db0928c4fd5f47b6cdd87a13c5983b50b56107808301527f4765640bd361f949a2ba640706c1f1436dc29d769c57a31b027bd6dd4c1c799b6107a08301527f311b329ed3aafeae007cabd2bd3cf506698ea4248dc684145e0d2a2fd789a8b86107c08301527f18cf391449564ad053c4af0b0734e6c1f1de59d415ede6c4ded5a29e644205656107e08301527f030053d7aa258bd41e80bc261fbea820091418b2fe5121ce24e12c1ad57cfe126108008301527f347d2cc8b97eca81ed23167c5c2f6cb214972cc54cb86f93e5e49b52ab79ef816108208301527f73e40cea4c8924cc70d7555087c7384af177bf4ba4fcd4d923c3bd78072bf4376108408301527f5d26bfff868d80acb7185d70543557aca3886e17dc537ca7997b834939f345256108608301527f41ebe1430659e09fcb9a8ae6be869b51bb1261dfda863efc4ccb60ab9d2d3dea6108808301527f32f72f5fabe91e618ef627a08e9d8667a9180a22c10aa859d70b80239bfc8cc66108a08301527f0ffdf50ad0cb49c17906f3cc43ee935b6a82cd5ac4574beb8d9df72eab4e806c6108c08301527f61374dc1b440ea38ca2bc3c49d6060f4f0e32ba7669040e30388caf2ab833e116108e08301527f27ec5217fa23b99f059a21d5ef05e9e477bd68025545246edce72bd7d70acb4b6109008301527f6a91bd2230a5d48e7496d52dc84436e077f89f44bd08d883e74257df856440ce6109208301527f4988f6b46cff4106095f3a8b6e07fc1a50f8f419b0778645b564e69638fb7e346109408301527f5255dfc95d1c0ca86a7ed39bbe02112cf62e4ee518b40901768e0ea5a2c30bcf6109608301527f35491d836b717f64d348e449d958bada0f89479479c18787c9046c846261de246109808301527f5f28561407a056594276543ccfbfedb72892cadd7eb63c4fe00d3120372e19226109a08301527f397ccc5ef29caa6de873609650e9bea17ac048e52e4f8c86cbfdbbdc9f5eea9a6109c08301527f6431baeb99d486abd0c30bd23eedbb7aaf863dfe32cdc6ea6a29a62a49ec5fa26109e08301527f09afe5011abd7c99753eec059463d6cd5c91dd494afe903b1ddbd0fa74cd1753610a008301527f28f1cec0ec97fe7aa7d4642897e1c51ce50fe46b5f28650bc41e523b370033d5610a208301527f0cb26f0ca4624dddbdf19003dae43f28d0e2b75e2df657d9acea9140d860e51a610a408301527f373bf8d7205b2684fbf374dc8d8535d7f278815f7cfd857f6ee064e8c96c3454610a608301527f42927ab0937f41bce0d6f843b523605c78e4d283bad74f846fbe8b8d7abf1ef5610a808301527f5ee3c0e954d211a4bdd47823cfdb7bca087c95b7a4d250200a9754d316f59aff610aa08301527f678615cf67212c3a2993577659d4263655b9dd58708ccfa20afe9083b6ecb662610ac08301527f3c54727f944cca495d23c1777e7536c6321f871326092e6beb94d87444157ddc610ae08301527f53c65020af3f5abda95860ad9383f77f10d5a8e7dc1975b74346db78de0b49eb610b008301527f5f5dd3df34ccc64f794d16acbc63bed0c4ce2cd38089e11dc95c9871c2a7ae31610b208301527f09637e652e915ae0bc1d62b7da1c9d8b973bf8f23f4322bab6bcc7b4a4406a9f610b408301527f546b9e395dee0a9466918ed255f76df4cd2c7c19681f2f712d4c16107b461351610b608301527f18cb6e5d6d0959114085a657a62004d6d4bac25ae567ca63501cd280f915de1d610b808301527f58782afd4a8a938bed95f04b985f4711efb2dacb8427fd6f8de78eb619ae9cad610ba08301527f072db66d8b16ae3aeb6d9e932e4de43e2e5cbfaaf34c7a0aa24dd9cf2a8e41b9610bc08301527f577832f774c67cddd7505cf603ca2e8fec342531bd0a1dbdde6d2e0728d565ec610be08301527f08c6f1218fd35bfd0e6b5b50735a0c9a6d284f4051672f41c0fe39465f0a3af2610c008301527f0eba8169994d61a6f1d3f5a7be72a0229f10693847f87734cd5305b77749240c610c208301527f04851fb71ef33d8a5df10bf40b43519035055256714de067c7d845304d464145610c408301527f2a5da7e9bf73c9479fa6e5f71288d31cefb6894921ac1e76d1e82be69ec4fed3610c608301527f58a009a0ea2c67b5923aa87f30a79f448b66d6c21507d07354991eef394c7d1a610c808301527f580d5aa604771bdf66ce0092f4c7174819c96b5e92499f48fe0199c4200060c0610ca08301527f72542655258cd87a0d0044f4e93d58584e6cf0009edb87f8175eb9c4e5778f85610cc08301527f22fc306957bf2306ac57ac3301b2d32dccdc860a7c0ceaddafd6727747e42034610ce08301527f47ea3e54e528ddc6e63b7ee7f14f80082b1df4719a68c4c9444a4aa640b21fa6610d008301527f2e237e775ea78f7f7b0843e916f0837b99e5f2543628d0b9050be31e16fffaf0610d208301527f254faafb9e2c37d7918e6a9f7b627db4f5317e83cd293ee6d62acc483806a7ca610d408301527f20efada29ea259911ca23420027e98b8c5af2a2f202903c7149a7167d6b0ce6c610d608301527f184a55e01875861e661289b3ad905293239eeae97ee5db99332b37e8f6c307e1610d808301527f6acbe53e7aced8a5a614cf26a175397f136c25f2fb2e7b0a58caa97b1009f1ea610da08301527f264991a53ef2e9918551c6b90ef7bb8339cd2f898e2322f44acff18b9b9a66d6610dc08301527f5078f86a7da7702a4cc8a3223da343beab035793b9434c39321da9d3691f999a610de08301527f39a8104ab4e2622b9523a3a9f9ee3b41a8397ea953823e419e06269fb3d2c1eb610e008301527f35728c2b81c712a34f3fe53c4393021ae73795035bcf1e631c0a99f44bf5639b610e208301527f41d7615f8bd97f178282eac27dbdc3215b7a2606a86122827c44bad1e42c67e9610e408301527f233bd5884457b5a4e1b4d1298f4695e172e6193afc096e78af06c474e85b13fa610e608301527f2f967109b61b2b2eb441e9a7132308cf975724cdc241eb94655d5480b6a45cae610e808301527f64f73e5667bde7037ddb61a224bfca795a61fbf0f78ea04019183161b0237c77610ea08301527f3829281d031f932f1ae9a2067bf6513dc51d5455b6dfa2955b16373596a7989b610ec08301527f52954070f8e0b8f4eb729b51e0c391101bcc120bb503d2578914d110355746d6610ee08301527f03b69267b12f495332d5c8a466cf1323221b891669924d118a44e89c0df8f1a4610f008301527f1d33c92e7d3ee1749755786f52ec76c7bd7a9a4b772174702a35fad10d40b2e1610f208301527f08d86c442959963e62deb44bd05d10e51e37c66c524c90b18fb3537ffc3fee70610f408301527f24194a8ccf272dee642baf29a85cdb203bddf6da1348fa538abde1d28b1e170c610f608301527f1c0b6f25101f49faa88022f8c83bac53ea9f160f62b6d19bbe321b5fede43ea9610f808301527f5965df1635254bb73a2d95bdc456a1957c797f02a6351a3f7ff22e4b014bdb17610fa08301527f6fecddfd9ffaf803e45405fac3529a15a0093ac87afa05c50915bd154ef0cf6d610fc08301527f6c5a8175e24da73409ded2913dc27396cc1da85c947683186df43b33f92d55e2610fe08301527f40e211d645b6bdee48d4b4faa0f0b3180a6c6dc54ef620477c0384b0610fee606110008301527f42adc6f65f9df8036a34dd4fa987a26497a6526dda4b90f49de337c149748d706110208301527f73185cb8f8642b0eb4449590423d9e65bd29805945dacf6d59c8e8a0babd987f6110408301527f1999004fd6cd12e05fabf2d5b9f0cfa062c0eb4a90413894e2d1b70e5b5d527e6110608301527f4f89f26b5f08f1aab934b63ddc6a25942475ae3ed15b5c36c55ec579af3b0ecd6110808301527f12a5fbf0400a087aba86a4226a836325339c3c95375a0cb09db74905ca5d968a6110a08301527f11a3fa42d518e20448aaeba3783c045f368a3d002723e10676a541a9e12a78ce6110c08301527f2f59f158b1c60bf12bbb4d956ff1dc9442aad7e876e2562d4438dfd2e2655ba06110e08301527f48956231bc3a0c3581112417097659b50d06c16b511c535c2decc1a3bce340b36111008301527f2849b06e476443c43bd47dd906fccdf2728c537a7a5f0f6938e168bbd8149a0e6111208301527f58d1184212a2fe71f72bb99b925e9c1432179bd4c8ff918daf4dfd7e7cee91ed6111408301527f3fc33989242fa44cbd5172dc768de9a6c9d4a142d6fa7b99679735aea4e3cc616111608301527f04609e4a1be08e45a07d3cab7478c170a88cdbf32e124721cf6b8b1292be02c46111808301527f51a47f35ce630b8a01599a2f45d141496e6babe83c19f1e58f34cedae71a48196111a08301527f011de2c7cafc96dc5d5919ae288780167e017d27067288f8c79bd2344700d97e6111c08301527f5505b08ca4fbe52ad9fe89d2a797f975bb9605b25b399741248aa4b29da00b666111e08301527f0764417ff69a6cdf71ed5ca55be442dcf7b9c23364cedc4830ce28a8d31fe6176112008301527f1ea443addd653c9a0eb5f9a7dfee8d543f3f4e413067c6bda7fe278f6f0a69946112208301527f30e8242b2eb26dde1277a06df6c4a335e18c3819df2e71cad28c1082a1c94dfc6112408301527f4be93987573b6cfc6fd56c56cba5e12bb539818aa40f1fdc8c611d29f80481846112608301527f42b770b2264660e60e59d224e4a050d5d7f1f31a45690ff2577f28e3dbe299866112808301527f08a27e30763aad74f3d3f24b6e19d4a3bfabca120244698d3f4b7bb2ad4919a86112a08301527f2cc5903961de4dcbbd0933b1961ce0f9e11eb86626dc332f1787954597b456276112c08301527f47e985d487ee6e1e26bacd792ac5ba28d4509c9dd7c39ef7416951e9647a4dbc6112e08301527f2b93f9997e71be645215084ba7e08d2ff99b8f839f800caefe3a30661396ce616113008301527f712d0469727032af24d88a999b60638a9c04e2fad716a68868dd6d2f5c8bf1af6113208301527f6bdaebef7927e6c195dc585eb0520a55d565a8c26107503341497c7a5098d7cd6113408301527f66c00c9738eaa31d7b0b8a2fe0b1de81d8b42fc536383a40509079e97615197d6113608301527f1fcfaf860b9f60eea753e8a2d79c344bf94384942cd898fd9a254acb40469c506113808301527f28b4dc5e4f2550e929ed53c414e2cfea1ca76b137f7ebec54533c4652105b9386113a08301527f472b0e17b62a901a4747be944d427c0e3a501de3403e4551c1cd29a04090e6aa6113c08301527f52f256eaa5ed5afc5b02bfd70dc7c70eaedbc3f89d72140b4374c36741c17f726113e08301527f604a77f3a748eb226cf823c3ee35009d95a99eeae0d0b59513fef0356204b9b16114008301527f0b6e82f7e448979b1f794e2449f4cf865d12dd0515ce061ecc2de699ab8f93646114208301527f08ac469169f16f69d9953b3f0060e6356abcc7eaf46216a83146e6470d0f34076114408301527f593ae35f24590d6e1125e9a4e968e2a03424e6527173002e20f10da98739be876114608301527f1842a0080d610897631657769cfe98480828c5af6f8ab0454e1fc5181871abfb6114808301527f1b4617ab22cbbeb10c39493e2dc4b465e17e795b82ebb9c986a18ea0c5f713126114a08301527f12f49e7b20d1b518f36f2d3aea11fd8b60f19cf5b0a2416076f12a8b203f18546114c08301527f2930f273fa05d398e9439d14b49ae806649b330696b98864d603dae3afb0ec376114e08301527f0bd3c0be6e783e92b477cc3429c27de9c532f3269d540c49be9ea939d7a1a68b6115008301527f58cca0bc2eaee337303a1035429216b5f5b23acdcafd5496e30b85806a64ed516115208301527f22f54df37e0c28d9ff08bfad67c572127f657256b93974992e90c362b84c142d6115408301527f4f227e82309f2af0243a3840e8d3a457b328e00c00b6d58a76dd7ad245e792d76115608301527f4fa65b781e4c2ed965b74c201e8af52a835bc991db3ae610be9ece0778221fab6115808301527f6168f0439fe970f7cc596c8a18bdf3e7285c9eb52e3372afa9084df3cbadcb2c6115a08301527f2ee0f0f1b7fae6d6ec9851629b8410c9b0d80ffa0e6bca06d6009c174b4cde766115c08301527f463de84b0649f8fc6c262e00e6a950a656604a8ca21a527950f6eee511e7118a6115e08301527f5fb8be949ded20fddbca6db6105d2a0b64e527932a3924fad59a96a58b34bf8e6116008301527f0c2e0aa86422baebfbd0e70123222cf86ab85010684f0d6d4b7fbf8e2b9680016116208301527f5f8726f651ad2518b78c6fe100462dc0c13d8acf6e42651d682297cea73fc8686116408301527f51c95bf666ff8fecf4e0b85bb58b834d2218d9f20170bf1be5d3c9aec43def386116608301527f3c4a879d04291aec2897628e731f3f63e04a8c7cd382a8c0fb014a62bbe8be616116808301527f4e3f2713561dd6e4b5071e0759eaa9545eab7b6335466e7c618d3988d1bad5046116a08301527f1158d86cddece49c18d48e32822fb977de5033e0e902c45601f8852193e4a6046116c08301527f02263730859a58ba2d3db60d5d7c7466824850b3207435e476ba35890a37fd2c6116e08301527f4d439b61a3703c36425888a3acf85639085b9a95429dcedd1b046c0a4a78acc56117008301527f1330cb0c5d2fa075aabb6bfb28276a9bbb44fb43306a63246aae25e1527868bd6117208301527f16b95b643081cb043bdae50355f91df79c9b588c43e59038e6e6d0cc1698b5a56117408301527f1fb8d50108e2fb3ea1f80aa372da950a36eca4571240be90aa5b3fccfef3c3216117608301527f4a53ec9735e16f6183934f1a7813d75cd11bbde409d8b262273bdfe5bc5dcc506117808301527f079ba56e1ca1d8c8eade23e8273e2db2a486901dbce8cd86caf41ae406fa21d56117a08301527f38ed6aa3cc88a95fb845db9d5ef043ecacbfac58a8bb5cd9bce8e4d1e5967c686117c08301527f2aae4dacc5a04fc32d1abd33601ee1c23c2986cc24dd63bf6d63be3a996fc5f46117e08301527f4d34a394da7c0ecb24de0dff84192c35090ba8748d5690272f9948efd2d095b46118008301527f42b103442e734014097c5c63f509110dbc1872226e7db81b19c474c4c406aa186118208301527f48a2063c98229fdaa1768185d6a3f4dea3db1ce1de6b7b121794580993f5c78c6118408301527f6ce4def3b2ebbdc1a4cf7f1a57d58467b1c48be6aa9c55c21696456dd58f03bb6118608301527f195ce730b876d5929a76a7c5d69bf1911280dab5a69c2cd38ee4b61dadfc00e26118808301527f63bf1167c90f8dd2360d3e401c7fbed17da04b327ea2c94875739591bdc7d5dc6118a08301527f5db879cb0bbf165c80452e14073c8b96ab8fb608a22b43c3cf267419c0dbf3c86118c08301527f472b50d6fb5d632e95ae0c5dd5f071ec8b6b4ee1407e5f3996a3b6e9c2a3d5876118e08301527f3cb873e98b29b2ed4d8066a06315d673bdff53c907b9adfbf52b37bd9799521c6119008301527f0793192ee98e2f57a73911ddb781380b061b92218fb0d79416ff47ce679703c36119208301527f3c159af2d3c008156298b33d8cab5ec2e8cd70773d81414266812783cdabe19a6119408301527f1c065141b64831c3ca0dcaf2d805bca7fa9473b9b163fa4c35fa3c83d2f933eb6119608301527f23943e9e8a571aeb36c24eea0d3ee5f097aef800b3b8744189c74c6abe4f34076119808301527f3e9bf606619c174b6b417a2fd7bcf68269a082c5bd72fd8dd668bb3be7cbea166119a08301527f480648a70c24e511be0e6d05d6d9a465877d3fd3428aa4b1a9e9e41de5c6b4406119c08301527f4324bdda4691820deb1481dbda3abb1cd5a05ccedf764b01317deabfd3e044f16119e08301527f6f2915f09c70fb227bb6c0a4e7f134e85629d9a5b547de9a9cf74fb851384641611a008301527f5f6d84cceaa1d3d3100a850dff27eb37f63db619532cf27291d5b35713ff215b611a208301527f2fcbf6ae9d4cdb276ea017df3d2ebec767c2b7fe1bb8558e9a6e3322ae63a62b611a408301527f408c45f73c4165b6cd00567331a72b4e26d79dfc305da5da9b8fd34311bcff9c611a608301527f67799ccf850146c5f1ff10669a69189d943448ad0efea1c614133324e1505a5e611a808301527f51ec52ac5329ecfed2a65bf7694212c04f47f4628de8c011d93afdad53ac9d4d611aa08301527e6e70e25eb8093bdcf955a5364a868b75d3729d057e78ad8358204ee3b1f8fb611ac08301527f50d01794d6f55e78fd516d212da55c3bb16f616032c3a8c284c60d61f877090f611ae08301527f1f74c3f88a37452f5fcd729af8fa1716e1d434d5a394e0457094f0563c31755b611b008301527f019487e8c5dbb68aa598be6e60a580aa186baca856104373fce6ef6cd87fddce611b208301527f4832ef55d38c938a015350f39b5b2185107dacce78ee4f85c47bbe5658e09ab8611b408301527f4a85d06c39d9c8c00baa1c5dfb59ff29ba80099912a56e9e8add6884763cd068611b608301527f41488ae48b74da505eb63124cc93220a6528420430bcc57338be26231ba3755b611b808301527f21b5d82ddd050ecca07247349ae1aa49c63d1d52941fbab73e5060fe8595e30d611ba08301527f5c9b5273d97bbb50dc4cb6b754f15da0c9ff93a61d75f4395f02f0f4d173067a611bc08301527f0a062f37f718f4c37a8c2bf9ef2f7c4a2119ba043eb6ffed51e0b5c55b7a247c611be08301527f159f9276bd128ed2d5b09f5fdaba71bf13806df7a17df30e6ed08086b8dace0e611c008301527f397cf7ac45224459e819581c1f2ba6412dd078820337ecec0d6a883b83370198611c208301527f32e654ddc435855db6a681a4134ce1a7f85525d0dde7a8e7365f36d6b8acb385611c408301527f07245288af44bddd2f744d5e093ea7f100de626fa216bc3044516254939edd3e611c608301527f61266cbaef88498a8255902e3a0efd2e45563158c8d47c75ec9af41d62fe128e611c808301527f73157756a167275b89ecb982dc3d2fab484c7eee1d0800df9ea07712048c9d2d611ca08301527f0c0b409aaa3a87cf5c0504c624b23570dad7fc9ae30f1f056996bb6a7b2b5c53611cc08301527f03801ea9c955bbc5c32ff8d8d3174bcc2f4f3249b711090a4c963a784e06c554611ce08301527f17690270da56baeba4e614f7e8780b3b15201ac3d7ae406eb4dbe811f8b13956611d008301527f0779f987f90f1c4f8e319418659d4bd33ac790e8eb07c153c28aa089775dcf38611d208301527f2f74df84cb03f57ca5946f15f2fb134d42a3288f32a5d5ffb1a9fe1d2a391bfd611d408301527f6ddaa41db23ce0405078e68938a27c0386674531648061bbd79359c91f32aac2611d608301527f2f49ab87e23a5d392c5e457337342795f3066a07f987de091f325ac32b8ba72c611d808301527f0efc38d20700d5b5a3b055be496dbdf82b0ab3e07dda2a0df3b16c07b02dabb4611da08301527f6f5ab923c9d18fd41b977c0f544cb9af853dddd00734b01f9280145a1dc7cfc9611dc08301527f0903ed0675157f6629cff37a2055f827bdbea9801a09fa7ee01c66b108265b8b611de08301527f700f5c0c5990d42434a15bc34c228500c52f0441de8419783a1509045d2aaf8b611e008301527f6a0e3381e15190acf36abed91ee25dc7fde5c90a3c5154a4329b2662188c2cb8611e208301527f4757ddbab350afd9c61e7a748d936388aa9ff3709c64a080ab9f28646d1d7181611e408301527f60f9d0c0c463bffe9c08d557dfd5d1054a98f32c04eaa80c49290cd45897b2a7611e608301527f0720379ef288498c5e6100d19258c915b32fd1f76a7878fd3575137b695e5789611e808301527f2265c46e022a5ef8ff8e9293803aff7f15ce0814a9edee3b1d546c7865407e3c611ea08301527f1206dc6f2948499c0a2d173e0ce4850870a8b1957d362ce6aad3603084cfb48a611ec08301527f3497b1b2410e8b30f6c09dd43d54aa9755c4bdaa743f8af7df57486dc70786c2611ee08301527f1ac1322d723d7d2c9e8a475140bc3991e124c7752dbe38d83ee03985cab3ec06611f008301527f06d7e810be67618152bb71fe9246ed8390e61d21fdaf4d357d67bb5de77df230611f208301527f0ee137d56d3c1f10af868ae52affaa93f1900ef4b93656322c7f295f3949436f611f408301527f21da6fd7aaca1d900c16ab0292cbda61f3c784d2ab0efe4fb1b87d443b54a76a611f608301527f1db1c07b4c58b4bada79593314f41f0050a88831ff9f9073fb31114e0e67285d611f808301527f5898c5429b336972114192ac64c5226082c3b2fee5a63a862fddba0789d6a473611fa08301527f6ce149f5c89369cbae1a7da096eb5b0ffdb885dc1916c9884dbbae22e6db34e8611fc08301527f312b1c75d7428aa4ddecc9229f9bfccfd4be6ef3ba7b16e04c6021255d1de0d5611fe08301527f08ac2c7ded2c05ddb49ae7ac6102c229dde9275c3589a88b40069c8c3cf236ee6120008301527f1725748fd880aabb1d6453669335fba232e6b2d25e69f3d56a504a3e5b05d76e6120208301527f248998a735f44fc524d9a3854e5d49e3dd1487e334ab8609558b89a5db5855586120408301527f51327888436d6fa1820a24f5106403e6f3cf35a5b2ef9148ff6aa6eceef4656e6120608301527f0c8b5a14aa194279b5d7676414246a40756786c8718d30a87d643d9320c4ec436120808301527f4dc96baa6c646df7036040dde9349b3f2ee384cafad6de954f4cd861069b24816120a08301527f718209ea4f77c3f76ecb439d05adf0b70294bad752b6c7f9af5711ce87be65a16120c08301527f639a0d20110526eaa343c723af04d126cd523ec21cf43d38b35398a0c56265b06120e08301527f2532f06a0066838b5c4cb4ddbd2e619bd7a9a4e37d4def67d20cd24cb8e672066121008301527f6b6d6b0887e56bebac8bd69265d4ce6a00ba7470d0168d65a2d25523900917c06121208301527f49f013fd9c831d3bbb0a371937ccfc302a424cc46d4ec08b5f45ac52ac31e8cd6121408301527f394e2a96c15cfa8f3ffcf5cb63264101b5c86f3fe92be4f842eb456d57295fe86121608301527f1ac743d177683ccc6719998182d6b7f431f1251f47a8446dc256830a359a789f6121808301527f3e3e342fba7c149018bcd2cc36ccff80a7eb3284f044cb5dbb9fb325f3b4b9f46121a08301527f3acc235e3731adafb4e9d9ef258e17f27329ac022a49b127205de91ea9322c8a6121c08301527f608afd9af0e5cfe07f12bf3316628eb8b9942121bfbd43ff7fe22a479aaad6046121e08301527f0ff89b10a1c9e65ef3a74ed5f7ac9892ac86faefc74731fd2b600834b186aac46122008301527f52f4e44f6d3341b5bf59399c6d53490fa8908e38e24a6142b90e5cbabae262926122208301527f38ee391b76fd73893fb64102547ca12c03cae780df15bf46727e57d07720575e6122408301527f3aea1da1370f5f1a3e7bec277a3cb39f286f3f00e82b701a359c041bcf6d9b806122608301527f21527c01d8037ea85f26001543e0caaa27114f3d00a155fcd4038a1fef06f0d96122808301527f60fc95ccdb1cf5a2700a6d66c7178bab18c5aaafd1d84329ef0521f72a45ca716122a08301527f5ab6a484d0d3ecfd4bf7d02da51f2d335fbc16bcc6d24beb6c2cd1730ed46c1a6122c08301527f4ea32259f9226d6e3d829d55ef0dfad8e8c7b83293358e0b9f899b54ad0bb82b6122e08301527f05b6e5b66f488a0378388224ad8c50eb6764df75505e02e713c95dfeb07da0756123008301527f31712374e5e6154ad9e2c9d26e6b2b804755971130c2d1b9bacc151872e69e196123208301527f1e579ccdcfed1c91d2fbf8b171f7c5352a986493bf227e5a9b1b8128a512646c6123408301527f2a2acebc6ea9b7b1170331b1f5fa73176ac647a25f590752552d88120ad535d06123608301527f49153077b745ebc3292e66fce38393f30524d2d3514b284aed7475e849d74e326123808301527f5375d9a81513c847f8c5f072049c59011dcacc7a8ded4dfb0ce8d89e3a997f146123a08301527f435d971e1eb8e44821c6c1ba05116256fa79c35db080a09ef7e24f59f420dd456123c08301527f58503b3a94f096941dad28f1caf856e5ce8f43a87505bc82ec4eab08149fd5d96123e08301527f3875898530fddee93f088fff6afe6998548c24552e1ce79bfd6989a34f91dba16124008301527f19380c553178569b69ba13e029af8a40e2753db62df5a0a70c13b6105f1e3daf6124208301527f1c00372679acb24658db79cde4b98711447ea35fe771de55c9addc7ccbcfcbfd6124408301527f6b5dbfea22d86bd8bbfdb5d787f2d58830ae60032ff2e4639e1508c8fc6b5d806124608301527f4607d1076850ad704386a117a214e6e7cd0fe5ffa9d88eb0d26b3e803201e6416124808301527f0f91e67891be0164227f53bbb878dcf24262bd48a3003e35adc2a55de5a47db66124a08301527f45996205840c4b3d5c410afd195a0646c8300255f65f994e608dc7889d9f2e5b6124c08301527f3ead3e9e499d91be44dfb36a1ec2d0e606a736e0ab546d4454e12835352fc1156124e08301527f1598c26031f70feec9e034f64b1d9a36a695d767a26bfa59cee0cb445eb4b3076125008301527f1cc0c0f8eaffe3789e3b439093440f1a60b921721763d41055c78922b871b03a6125208301527f48703d4aa9bf7adc5e911c7817d88968569bc88162ad297ed48fb428931500476125408301527f5593e8d4c35eb09c60c8b0f998419159d552513affaa6ab9c34a07c3a577fc786125608301527f1d0edcbd6dcddf3ae0a64a0cd44eb759f2330f172cd4ed007a041ac18c5de8506125808301527f328371fd8f5642affaa80772e382ba086b4aeae25cf32cb1fd6a03f4c17434e36125a08301527f37941017b7862dedd6d93c13b7f08bb932defcd29c70d1b1d5724ca40c29cc726125c08301527f10c59d50cb8d8d939b2b97163b5ce65d63d4b0a58522ff95addfc01620ef01006125e08301527f0d5b533b43b0b27d9b64551c7ceaee9fb0b6b9061d13326147360615dda112126126008301527f636375e8e3a62551030f9dbe7811775d90b697a1619360756afec469adc3f4686126208301527f16ff3d1de7193f4b98611664a8b64cbc4fe39ddbd74337d8e347e4bca730cd946126408301527f1cc95775b2716b3cdd35e56a7c7b2497564f9f44f202e18baf52d064877a4eab6126608301527f36daf37534506831829b7229f6b34c5020846e98e02eef2db84136c910ba15946126808301527f61a68e2455dce0f6783ef9e5131db78a998c62b695a83078485b414f5f605e5a6126a08301527f12b11dd703fc60f2ede9f64b5050371c32fe393d86a3341996fc4210069d2a226126c08301527f27bf254291de0508e8b83ca24a6f9412b5eb98ea795b87bb1040e411c2a823c96126e08301527f35f4aa5fe745e6e65654e48e4b395290b2e872dde27245f08910ef4e0ff34b2a6127008301527f24fdbbb549e57cbccc5914748a55d3f64778f957b6024162b89b3a3de13b19116127208301527f22485592115c7396684ea68c47390d13e784c29e5c2f1d15997bbad58557a29f6127408301527f2056b61a624a856030a66e540f7a878f418adf12317d378869140919a33d02f66127608301527f38df7ffa7f9be7b2e80f05da1af774693bb3f59d13c3570b242096fccc6b16016127808301527f35b15b6c4c7bf09e1d9eebea32d2c9abe4fd1abd978480c637aa42b430e356376127a08301527f255267e1ead997f166dcf53f0d0cd7e69a8199a11950ceb2515f8f8667d067636127c08301527f3fd6bd225026a4673ee244b3ba4e49f9ff5dddea1238c4db69e1bf5d88a850206127e0830152527f707fbbeb0bf2b5aa6ed7573b46506eff64c69ce781aa7fa616e3d53390922a1e613dfe6109f8565b96613e076109f8565b7f5edc4de43ff07c60ace8f91ac726180f38604b5bb2f2ab2c27aa2a4d53cf708181527f21c0f632624d48a11931e2bcb8695897e5cb1d7cec432d115df1b25ea0d9d4a3878201527f4243ff5f4a234a2256286afa4ec59b4c9c32439c0869f1aa0b92a5ab82ee1b38828201527f7344ba891ca71591e07e7e6aa563931b9d07b548c816668af7f6170e5c8cd073848201527f20c42fc15a32ed98b81609d1e9de98f255e4b46414af1dad036bfe255d3d2f19868201528852613ec86109f8565b7f68186626fb0239ce09c22fe4ec756ab3dede54596e3cc426ac7ec1f5c38881f281527f1cdfe1f1de4a7290ab39316b544da5e6576d4d1c05eaf0719c3c60867fab0372878201527f1992e57fe5537033e0b3711c4aba9a6630fdf87a5962a442e926718e92f7e573828201527f5033856a6fe61acbb5a95e6f8e1d6e5aca6e1d2125d0c03d864e8fecdb3ccd4a848201527f09e7c08b5c3289751cf3e30a7ab45c59aaca49585c3f08fb39a67bc9466cceb28682015286890152613f8b6109f8565b7f73ac6ff5f192940a6a3198b94a158121172678891e35c8895c6a20f4164f7c9381527f03ac6b5eccedc5da43ff372db13fa55ac197bb9592e15d4feb74ee152e90e952878201527f1574427d32abdcde8a24db9e42219c68f84d89f342f0eb455309c7937054f842828201527f21fcae8d9f8f62a956217b8fd134560fc2654527ee9e5359beefb95b2c59288d848201527f06ca0c88a61632956a1d3e91999c842f03b6e7f121df734ce75682fbfa1ef7f9868201528189015261404e6109f8565b7f4ce4f0699adf8172f73b8cd2407d7db698a2625bf837b95a35abbf4eddcbd7dd81527f1a0f8b3e444c78fcc67ce285e743094a787745b2761df2203979fc08d3ab3a99878201527f40a3f19fa4064fd9c119dd0acaea02ea3ae33a5df8b181867ff6b705f159e4af828201527f051d14de8bbf745f9f8a20682c4104c48a0198e8f604ae06b45de4051d90065c848201527f294ce128d90968ca910a8cc18c9ab58d41a0a91df79bed878952aa88f7433a8086820152838901527f35151e81622f69dec5eedf76619630dc42997eeaf162fdda7644ce726da53c3b6141326109f8565b967f637e4ac13df1eefbc7ee982d5a044b89a20d383b17fa5a23bfe25a7915d8885f88528701528501528301527f121909e9d5554a3b3d207272ad07359bb49136e23fe6f0d1c62c3bf940ca5bcd8183015283015252565b90610140811015610c585760051b0190565b5f1981146141aa5760010190565b634e487b7160e01b5f52601160045260245ffd5b6001809190600591825b6141d25750505090565b8183166141f5575b805f805160206142b2833981519152910991811c91826141c8565b925f805160206142b2833981519152848192099390506141da565b60a061421a6109f8565b3690376142256109f8565b60a03682375f5b6005808210156142a9575f6142418385610c47565b525f5b81811061425557505060010161422c565b6001906142628486610c47565b5161427782614271878b610c47565b51610c47565b51905f805160206142b28339815191528092614293858b610c47565b51900990086142a28587610c47565b5201614244565b50509150509056fe73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001a2646970667358221220e706740d4cac649155f238450602209c539ff114bec34405aea1cbb73c97ed1864736f6c63430008170033",
        "nonce": "0x10b",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    },
    {
      "hash": "0x9f4c2dc61cadae8e450e06f9e24eb6b7cabd0914eabd6a2a308c039409823c08",
      "transactionType": "CREATE",
      "contractName": "MerkleTreeManager4",
      "contractAddress": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
      "function": null,
      "arguments": [
        "0xA22A3cE2e3eb5865ACdCA8980F95C8EAA87eF4a1"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x25eee2",
        "value": "0x0",
        "input": "0x60c03461010a57601f61224438819003918201601f19168301916001600160401b0383118484101761010e5780849260209460405283398101031261010a57516001600160a01b03908181169081900361010a5733156100f2575f543360018060a01b03198216175f55604051923391167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3608052600360a0526121219081610123823960805181818161098801528181610c9b01528181611667015281816117220152611983015260a0518181816105ee01528181610d1701528181610d58015281816113b7015261153a0152f35b604051631e4fbdf760e01b81525f6004820152602490fd5b5f80fd5b634e487b7160e01b5f52604160045260245ffdfe6080806040526004361015610012575f80fd5b5f3560e01c9081630fc3cec01461182c5750806310af81eb14611805578063110b6444146117515780631fd2333d14610557578063331b6ab31461170d57806338bf282e1461160457806339afd14e146115df5780633fe98de5146115c457806342b6834b1461155e578063631c56ef1461151e578063715018a6146114c757806374012968146114835780637410ad081461136f578063890586cf14611340578063891ac401146113115780638a82b4b514610a955780638da5cb5b146112ea5780638dd14802146111f75780639f67003914610ade578063a6f51d4a14610ab3578063b091b31a14610a95578063b0a7945914610a6f578063b6b2060e1461090b578063bfcb0e9e146108db578063cd87a3b4146108c0578063ce03fdab14610896578063cfb2893d1461059b578063d302b4ac14610557578063da561fd814610518578063e1d5deb414610454578063e78cea921461042c578063e829558814610406578063ec1b740f146103eb578063ed85b328146103c4578063eff8ba5914610394578063f2a991541461037a578063f2fde38b146102f5578063f4e019e4146102725763fef1deb4146101c9575f80fd5b3461026e576101d736611856565b90805f52600b60205260ff60405f20541615610256575f52600960205260405f20805482101561021b5760209161020d91611a1f565b90546040519160031b1c8152f35b60405162461bcd60e51b8152602060048201526013602482015272496e646578206f7574206f6620626f756e647360681b6044820152606490fd5b6024906040519063ea17a6a560e01b82526004820152fd5b5f80fd5b3461026e57606036600319011261026e5760043561028e61186c565b6001600160a01b03604435818116939084900361026e576102b482600154163314611a48565b805f52600b60205260ff60405f20541615610256575f52600860205260405f2091165f5260205260405f20906001600160601b0360a01b8254161790555f80f35b3461026e57602036600319011261026e5761030e611882565b610316611fc9565b6001600160a01b03908116908115610362575f54826001600160601b0360a01b8216175f55167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b604051631e4fbdf760e01b81525f6004820152602490fd5b3461026e575f36600319011261026e5760206040515f8152f35b3461026e57602036600319011261026e576004355f526005602052602063ffffffff60405f205416604051908152f35b3461026e575f36600319011261026e5760206040515f805160206120cc8339815191528152f35b3461026e575f36600319011261026e57602060405160038152f35b3461026e57602036600319011261026e576020610424600435611ce4565b604051908152f35b3461026e575f36600319011261026e576001546040516001600160a01b039091168152602090f35b3461026e57602036600319011261026e57600435805f52600b60205260ff60405f20541615610256575f52600660205260405f20805461049381611c9e565b9061049d81611c9e565b925f5b8281106104d5576104c3846104d1876040519384936040855260408501906118c9565b9083820360208501526118c9565b0390f35b806104e260019284611ad8565b50828060a01b03809154166104f78388611cd0565b52826105038386611ad8565b500154166105118288611cd0565b52016104a0565b3461026e57602036600319011261026e57600435805f52600b60205260ff60405f20541615610256575f526009602052602060405f2054604051908152f35b3461026e57604036600319011261026e57602061057261186c565b6004355f526008825260405f2060018060a01b038092165f52825260405f205416604051908152f35b3461026e5760a036600319011261026e576024600435813567ffffffffffffffff811161026e576105d0903690600401611898565b9091805f52600b60205260ff60405f2054161561087f5750604435917f000000000000000000000000000000000000000000000000000000000000000063ffffffff16915f9160643591835b8585106106325760208760405190608435148152f35b600396848816806107115750828210156106df57610651828486611ac8565b3590600183018084116106cc57610669908587611ac8565b3560028401928385116106b95761068461068b948789611ac8565b3592611927565b9681018091116106a657600190935b60021c9401939261061c565b87634e487b7160e01b5f5260116004525ffd5b8b634e487b7160e01b5f5260116004525ffd5b8a634e487b7160e01b5f5260116004525ffd5b60019194975061070b906106f287611ce4565b6106fb88611ce4565b9061070589611ce4565b92611927565b9661069a565b6001908082036107915750838310156107735761072f838587611ac8565b359083018084116106cc57610745908587611ac8565b3560028401928385116106b957610684610760948789611ac8565b9681018091116106a6576001909361069a565b5060019194975061070b9061078787611ce4565b906106fb88611ce4565b60029290830361080757848410156107de576107ae848688611ac8565b359184018085116106b9576107c4908688611ac8565b35928401928385116106b957610684610760948789611ac8565b905060019295985061070b91506107f487611ce4565b906107fe88611ce4565b61070589611ce4565b90848410156108525761081b848688611ac8565b359084018085116106b957610831908688611ac8565b35928401928385116106b95761084b610760948789611ac8565b3591611927565b5060019295985061070b915061086787611ce4565b61087088611ce4565b61087989611ce4565b91611927565b83906040519063ea17a6a560e01b82526004820152fd5b3461026e57602036600319011261026e576004355f52600a602052602060405f2054604051908152f35b3461026e575f36600319011261026e576020604051601e8152f35b3461026e57602036600319011261026e576004355f526004602052602063ffffffff60405f205416604051908152f35b3461026e57606036600319011261026e57610924611882565b6001600160a01b03908116905f805160206120cc833981519152906044359082821015610a1f5782841015610a1f576040516326fc0f8d60e21b81526004810192909252602482018490525f604483018190526064830152602090829060849082907f0000000000000000000000000000000000000000000000000000000000000000165afa908115610a14575f916109e1575b506020928280926024359009900890808210156109d9575b50604051908152f35b9006826109d0565b90506020813d602011610a0c575b816109fc60209383611905565b8101031261026e575160206109b8565b3d91506109ef565b6040513d5f823e3d90fd5b60405162461bcd60e51b815260206004820152602260248201527f506f736569646f6e344669656c643a20696e70757420697320746f6f206c6172604482015261676560f01b6064820152608490fd5b3461026e57604036600319011261026e576020610424610a8d61186c565b600435611be3565b3461026e57602036600319011261026e576020610424600435611a8b565b3461026e57604036600319011261026e576020610ad4602435600435611af1565b6040519015158152f35b3461026e57606036600319011261026e5760243567ffffffffffffffff811161026e57610b0f903690600401611898565b9060443567ffffffffffffffff811161026e57610b30903690600401611898565b91610b4660018060a01b03600154163314611a48565b6004355f52600b60205260ff60405f205416156111de578284036111c9576004355f52600660205260405f20546111b0575f5b848110610bc15784610b8c600435611a8b565b60405191825260208201527fe8f75c77455801acfd20f8b159f4f665b5f9c79b63cec4391c567272c0ba3e7d604060043592a2005b610bd081868497959697611ac8565b35906001600160a01b038216820361026e576004355f9081526008602090815260408083206001600160a01b0386811685529252909120541691821561119e57610c1b828888611ac8565b356004355f52600960205260405f20805480155f1461117e5750505f5b5f805160206120cc833981519152811015610a1f575f805160206120cc833981519152851015610a1f576040516326fc0f8d60e21b81526004810191909152602481018590525f6044820181905260648201526020816084816001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000165afa908115610a14575f9161113f575b505f805160206120cc8339815191529182910984085f805160206120cc83398151915281101561112a575b6004355f52600560205263ffffffff60405f2054169163ffffffff610d3c817f000000000000000000000000000000000000000000000000000000000000000016611ff4565b16831015611111575f9583835b63ffffffff89169063ffffffff7f000000000000000000000000000000000000000000000000000000000000000016821015610ef457896003841680610de1575050633fffffff610dd160019263ffffffff946004355f52600260205260405f20815f526020528160405f2055610dbf81611ce4565b610705610dcb83611ce4565b92611ce4565b935b60021c169901169790610d49565b60018103610e28575050633fffffff610e2260019263ffffffff946004355f52600260205260405f20815f5260205260405f205491610705610dcb83611ce4565b93610dd3565b9091906002908103610e7357600192633fffffff9263ffffffff95610e22936004355f5260205260405f20815f52602052610705610e6d60405f20549460043561209e565b91611ce4565b91506004355f528160205260405f20835f5260205260405f205492610e9a8c60043561209e565b926004355f5260205260405f209163ffffffff6107d0830111610ee05763ffffffff94600194633fffffff94876107d0610e229601165f5260205260405f205491611927565b634e487b7160e01b5f52601160045260245ffd5b94939298505050989796986004355f526004602052601e63ffffffff610f1f8160405f205416612089565b16066004355f52600460205263ffffffff60405f20911663ffffffff19918183825416179055600360205260405f20905f526020528360405f2055610f6385612089565b906004355f52600560205263ffffffff60405f20921690825416179055600960205260405f208054600160401b8110156110fd57610fa691600182018155611a1f565b9080549160031b5f19928387831b921b19161790556004355f52600a60205260405f20908154908114610ee05760010190556004355f52600660205260405f20610ff1868b8b611ac8565b356040519788606081011067ffffffffffffffff60608b0111176110fd576060890160405260018060a01b0384168952602089015260408801528054600160401b8110156110fd5761104891600182018155611ad8565b6110ea5760026040600198898060a01b038151166001600160601b0360a01b90818654161785558a8501908b8060a01b036020840151169082541617905501519101556004355f52600760205260405f2090868060a01b03165f526020528360405f2055604051928352602083015260408201527fe9c05509de49ff5cb0ca8d4402e6d5b43be3de99140366db16d00f74f0e14d27606060043592a201610b79565b634e487b7160e01b5f525f60045260245ffd5b634e487b7160e01b5f52604160045260245ffd5b604051635d271a2760e11b815260048101849052602490fd5b5f805160206120cc8339815191529006610cf6565b90506020813d602011611176575b8161115a60209383611905565b8101031261026e57515f805160206120cc833981519152610ccb565b3d915061114d565b5f198101908111610ee05761119291611a1f565b90549060031b1c610c38565b60405163232a9e3d60e11b8152600490fd5b60246040516329ca47b160e01b81526004356004820152fd5b6040516001621398b960e31b03198152600490fd5b602460405163ea17a6a560e01b81526004356004820152fd5b3461026e57602036600319011261026e57611210611882565b611218611fc9565b6001549060ff8260a01c166112b0576001600160a01b0316908115611272576001600160a81b0319168117600160a01b176001557fa49730bff544fd0b716395c592e39c6fd2d2481a19b9229b5b240483db95a4955f80a2005b60405162461bcd60e51b8152602060048201526016602482015275496e76616c696420627269646765206164647265737360501b6044820152606490fd5b60405162461bcd60e51b8152602060048201526012602482015271109c9a5919d948185b1c9958591e481cd95d60721b6044820152606490fd5b3461026e575f36600319011261026e575f546040516001600160a01b039091168152602090f35b3461026e57602036600319011261026e576004355f52600b602052602060ff60405f2054166040519015158152f35b3461026e5761134e36611856565b905f52600260205260405f20905f52602052602060405f2054604051908152f35b3461026e5760208060031936011261026e576004359061139a60018060a01b03600154163314611a48565b815f52600b815260ff60405f20541661146a576113dc63ffffffff7f000000000000000000000000000000000000000000000000000000000000000016611ce4565b825f526003825260405f205f8052825260405f2055815f526009815260405f2090815491600160401b8310156110fd578261143d9160017f1ff5410102c1974ab4242cb28f3001d2d6401c8e655d96fe6c013715d29ffb0e95018155611a1f565b8154905f199060031b1b19169055825f52600b815260405f20600160ff198254161790556040515f8152a2005b604051630c13c1df60e41b815260048101839052602490fd5b3461026e57604036600319011261026e5761149c61186c565b6004355f52600760205260405f209060018060a01b03165f52602052602060405f2054604051908152f35b3461026e575f36600319011261026e576114df611fc9565b5f80546001600160a01b0319811682556001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b3461026e575f36600319011261026e57602060405163ffffffff7f0000000000000000000000000000000000000000000000000000000000000000168152f35b3461026e57602036600319011261026e57600435805f52600b60205260ff60405f20541615610256575f52600960205260405f2080549081156115b2575f198201918211610ee05760209161020d91611a1f565b60405163ac0a938760e01b8152600490fd5b3461026e575f36600319011261026e57602060405160048152f35b3461026e575f36600319011261026e57602060ff60015460a01c166040519015158152f35b3461026e57604036600319011261026e576004356024355f805160206120cc833981519152808310156116f4578110156116dc576040516326fc0f8d60e21b8152600481019290925260248201525f6044820181905260648201526020816084817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa8015610a14575f906116a9575b602090604051908152f35b506020813d6020116116d4575b816116c360209383611905565b8101031261026e576020905161169e565b3d91506116b6565b60249060405190630c62327960e31b82526004820152fd5b604051630c62327960e31b815260048101849052602490fd5b3461026e575f36600319011261026e576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b3461026e5760208060031936011261026e57600435805f52600b825260ff60405f20541615610256575f526009815260405f20604051908183825491828152019081925f52845f20905f5b868282106117f15786866117b282880383611905565b60405192839281840190828552518091526040840192915f5b8281106117da57505050500390f35b8351855286955093810193928101926001016117cb565b83548552909301926001928301920161179c565b3461026e57608036600319011261026e576020610424606435604435602435600435611927565b3461026e5760209061183d36611856565b905f526003835260405f20905f52825260405f20548152f35b604090600319011261026e576004359060243590565b602435906001600160a01b038216820361026e57565b600435906001600160a01b038216820361026e57565b9181601f8401121561026e5782359167ffffffffffffffff831161026e576020808501948460051b01011161026e57565b9081518082526020808093019301915f5b8281106118e8575050505090565b83516001600160a01b0316855293810193928101926001016118da565b90601f8019910116810190811067ffffffffffffffff8211176110fd57604052565b9291905f805160206120cc83398151915280851015611a0657808210156119ed57808310156116f4578310156116f4576040516326fc0f8d60e21b815260048101949094526024840152604483015260648201526020816084817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa908115610a14575f916119be575090565b90506020813d6020116119e5575b816119d960209383611905565b8101031261026e575190565b3d91506119cc565b604051630c62327960e31b815260048101839052602490fd5b604051630c62327960e31b815260048101869052602490fd5b8054821015611a34575f5260205f2001905f90565b634e487b7160e01b5f52603260045260245ffd5b15611a4f57565b60405162461bcd60e51b815260206004820152601460248201527313db9b1e48189c9a5919d94818d85b8818d85b1b60621b6044820152606490fd5b805f52600b60205260ff60405f20541615610256575f52600360205260405f20600460205263ffffffff60405f2054165f5260205260405f205490565b9190811015611a345760051b0190565b8054821015611a34575f52600360205f20910201905f90565b90815f526020600b60205260409060ff60405f20541615611bca578215611bc257835f9492939452600493600460205263ffffffff938460405f2054169384600195866001905b611b4b575b505050505050505050505f90565b15611bb3575b5f90835f5260038752845f2089821690815f528852855f20548714611ba55790899115611b9d575b168015611b8a575f19019087611b38565b60118a634e487b7160e01b5f525260245ffd5b50601e611b79565b505050505050505091505090565b8188821603611b515780611b3d565b505050505f90565b60405163ea17a6a560e01b815260048101859052602490fd5b90815f52600b60205260ff60405f20541615611c6d57815f52600760205260405f209060018060a01b0380911691825f5260205260405f2054925f52600660205260405f20918254841091821592611c54575b5050611c4e57600291611c4891611ad8565b50015490565b50505f90565b909150611c618484611ad8565b50541614155f80611c36565b60405163ea17a6a560e01b815260048101839052602490fd5b67ffffffffffffffff81116110fd5760051b60200190565b90611ca882611c86565b611cb56040519182611905565b8281528092611cc6601f1991611c86565b0190602036910137565b8051821015611a345760209160051b010190565b80611d0e57507f0d823319708ab99ec915efd4f7e03d11ca1790918e8f04cd14100aceca2aa9ff90565b60018103611d3b57507f170a9598425eb05eb8dc06986c6afc717811e874326a79576c02d338bdf14f1390565b60028103611d6857507f273b1a40397b618dac2fc66ceb71399a3e1a60341e546e053cbfa5995e824caf90565b60038103611d9557507f16bf9b1fb2dfa9d88cfb1752d6937a1594d257c2053dff3cb971016bfcffe2a190565b60048103611dc257507f1288271e1f93a29fa6e748b7468a77a9b8fc3db6b216ce5fc2601fc3e9bd6b3690565b60058103611def57507f1d47548adec1068354d163be4ffa348ca89f079b039c9191378584abd79edeca90565b60068103611e1c57507f0b98a89e6827ef697b8fb2e280a2342d61db1eb5efc229f5f4a77fb333b80bef90565b60078103611e4957507f231555e37e6b206f43fdcd4d660c47442d76aab1ef552aef6db45f3f9cf2e95590565b60088103611e7657507f03d0dc8c92e2844abcc5fdefe8cb67d93034de0862943990b09c6b8e3fa27a8690565b60098103611ea357507f1d51ac275f47f10e592b8e690fd3b28a76106893ac3e60cd7b2a3a443f4e835590565b600a8103611ed057507f16b671eb844a8e4e463e820e26560357edee4ecfdbf5d7b0a28799911505088d90565b600b8103611efd57507f115ea0c2f132c5914d5bb737af6eed04115a3896f0d65e12e761ca560083da1590565b600c8103611f2a57507f139a5b42099806c76efb52da0ec1dde06a836bf6f87ef7ab4bac7d00637e28f090565b600d8103611f5757507f0804853482335a6533eb6a4ddfc215a08026db413d247a7695e807e38debea8e90565b600e8103611f8457507f2f0b264ab5f5630b591af93d93ec2dfed28eef017b251e40905cdf798368980390565b600f8103611fb157507f170fc161bf1b9610bf196c173bdae82c4adfd93888dc317f5010822a3ba9ebee90565b6024906040519063112517f360e21b82526004820152fd5b5f546001600160a01b03163303611fdc57565b60405163118cdaa760e01b8152336004820152602490fd5b801561208357600190602081108216604e8210831617612070578190600480935b808311612030575050508163ffffffff048111610ee0570290565b9091938063ffffffff04811161205d57818516612054575b800293811c9190612015565b80930292612048565b601183634e487b7160e01b5f525260245ffd5b905060040a9063ffffffff8211610ee057565b50600190565b90600163ffffffff80931601918211610ee057565b5f52600260205260405f20906103e863ffffffff80921601818111610ee057165f5260205260405f20549056fe73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001a2646970667358221220163ebe247b4245a347669140d1d720a95d628eb3f17aea03c9f26a632588f28e64736f6c63430008170033000000000000000000000000a22a3ce2e3eb5865acdca8980f95c8eaa87ef4a1",
        "nonce": "0x10c",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    },
    {
      "hash": "0xfa59790b17e4a7432b1016cd9045f204d13dee446262525a0854e9d1a712c17c",
      "transactionType": "CREATE",
      "contractName": "RollupBridge",
      "contractAddress": "0xa9be9ba80802eadffeee5dc1ff46b0ed7da8a19d",
      "function": null,
      "arguments": [
        "0x708fbfE3acC1F65948304015f1789a05383a674b",
        "0xef249e41F6DC67BdfdBe44f4690cB4527d65CdD2"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x41ce0a",
        "value": "0x0",
        "input": "0x60c0346200010657601f62003b4e38819003918201601f19168301916001600160401b038311848410176200010a57808492604094855283398101031262000106576200005a602062000052836200011e565b92016200011e565b9060015f553315620000ee5760018054336001600160a01b031982168117909255604051936001600160a01b03939092849283167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3166080521660a052613a1a9081620001348239608051818181610e650152611844015260a0518181816104a2015281816113c101526119580152f35b604051631e4fbdf760e01b81525f6004820152602490fd5b5f80fd5b634e487b7160e01b5f52604160045260245ffd5b51906001600160a01b0382168203620001065756fe60806040526004361015610011575f80fd5b5f3560e01c80630a9306d7146102ea5780630ec107bd146102e557806311a00fc2146102e0578063175b0284146102db578063181e0124146102d65780631878d1f1146102d15780631d7a4993146102cc5780631f48d924146102c757806329e58659146102c25780632befa771146102bd57806332f1abe9146102b857806337427b221461021357806339410508146102b35780633a984bc5146102ae5780633b250b0f146102a957806349925ecc146102a45780635358fbda1461029f5780635b7ca75f1461029a5780635beb7cba146102955780635c820bd514610290578063715018a61461028b57806378d8fdc814610286578063794715b01461028157806379b53ebe1461025e5780637add14121461027c5780638043ca6614610277578063865887ee146102725780638da5cb5b1461026d578063921f27fa14610268578063981a131d14610263578063bc803dcc1461025e578063bde0a39214610259578063bf67d43514610254578063c3a079ed1461024f578063cf96cb3c1461024a578063d6df096d14610245578063d8625b0714610240578063df1097e21461023b578063e295c7e314610236578063e328412014610231578063e5949b5d1461022c578063ef7c8f9c14610227578063f2fde38b14610222578063f3a11da71461021d578063f3baf070146102185763f4606f0014610213575f80fd5b610908565b611efe565b611ee1565b611e51565b611e24565b611d8c565b611ca1565b611c1c565b6118bb565b611873565b61182f565b6117f8565b6117db565b6117ae565b611768565b61121f565b611733565b611706565b6116de565b6112ef565b61129f565b61125f565b611137565b611074565b611019565b610faf565b610f19565b610c51565b610b67565b610a5f565b6109b4565b610969565b610925565b6108a9565b610809565b610702565b6106cc565b610661565b61061b565b6105f5565b61051f565b6104d1565b61048d565b610313565b6001600160a01b0381160361030057565b5f80fd5b60043590610311826102ef565b565b3461030057606036600319011261030057602435600435610333826102ef565b7f984a71c9d95fd4794aeba33ae72edfec22053fde75488d63abef9dc69ee795af610448604435610362613639565b6008610376855f52600260205260405f2090565b6103986001610389600984015460ff1690565b61039281610636565b14611f19565b335f90815260068201602052604090206103bd906103b8905b5460ff1690565b611f5d565b6103fa836103f4816001600160a01b038b16600181141580610456575b6103e390611f9d565b6103ee821515611ff5565b3361365a565b14612041565b335f90815260078201602052604090206104158482546120bb565b9055016104238282546120bb565b9055604080516001600160a01b03909616865260208601919091523394918291820190565b0390a361045460015f55565b005b5060018601546103e39061047a906001600160a01b03165b6001600160a01b031690565b821490506103da565b5f91031261030057565b34610300575f366003190112610300576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b346103005760403660031901126103005760206024356104f0816102ef565b6004355f9081526002835260408082206001600160a01b03938416835260050160205290205416604051908152f35b3461030057602036600319011261030057600435610545815f52600260205260405f2090565b600d81015461055c906001600160a01b031661046e565b331480156105e1575b61056e906120c8565b6105b5600982016105946004610585835460ff1690565b61058e81610636565b1461210a565b6105a860128401546011850154111561214d565b805460ff19166005179055565b600b429101557ffa82118a5bf7ca3641b351a388555187c7f3c78269df3dd0280c6a99f18b5bc95f80a2005b506001546001600160a01b03163314610565565b346103005760203660031901126103005760206106136004356121a6565b604051908152f35b34610300575f36600319011261030057602060405160018152f35b6006111561064057565b634e487b7160e01b5f52602160045260245ffd5b9060068210156106405752565b34610300576020366003190112610300576004355f52600260205260a060405f20600180831b036001820154169060ff6009820154169060048101546106bb60036002840154930154936040519586526020860190610654565b604084015260608301526080820152f35b34610300576020366003190112610300576004355f5260026020526040805f206003600282015491015482519182526020820152f35b346103005760203660031901126103005760043561077f610777600b610730845f52600260205260405f2090565b6001546001600160a01b0316331480156107e4575b61074e906121de565b6107706005610761600984015460ff1690565b61076a81610636565b14612221565b01546120ab565b421015612262565b610799610794825f52600260205260405f2090565b6124f9565b335f908152600460205260409020805460ff19169055604051907f9b17bc5e2d37eeef74a4fa6e5f52445d4246a339a9f3e7372b33c8972520bf1c5f80a260018152602090f35b0390f35b50600d81015461074e90610800906001600160a01b031661046e565b33149050610745565b34610300575f36600319011261030057602060405160438152f35b9080825180825260208092019180808360051b8601019501935f905b8382106108505750505050505090565b90919293949583601f198084840301885288518051908185525f5b8281106108955750505f818501840152601f01169091018101968101950193929160010190610840565b81810185015186820186015288940161086b565b34610300576020366003190112610300576004355f5260026020526108fa60405f206107e06108e660166108df601585016125f0565b93016125f0565b604051938493604085526040850190610824565b908382036020850152610824565b34610300575f366003190112610300576020600554604051908152f35b34610300576020366003190112610300576004355f52600260205260405f20600c600a8201549101548101809111610964576020906040519042118152f35b612097565b34610300575f36600319011261030057602060405160038152f35b9181601f84011215610300578235916001600160401b038311610300576020808501948460051b01011161030057565b346103005760e0366003190112610300576109cd610304565b6001600160401b03602435818111610300576109ed903690600401610984565b9260443583811161030057610a06903690600401610984565b9460643585811161030057610a1f903690600401610984565b90608435968711610300576107e097610a3f610a4f983690600401610984565b95909460c4359860a435986126ca565b6040519081529081906020820190565b34610300576040366003190112610300576001600160401b03600435602435828111610300573660238201121561030057806004013592831161030057602436918460061b01011161030057805f5260026020527f2ee02df5a60e88925a03b4a97c2dc2cfda07bd3e99e240b012ee9d9cfd6a6078610b4e601160405f20610af3600460ff60098401541661058e81610636565b600d810154610b0a906001600160a01b031661046e565b33148015610b53575b610b1c90612d3d565b856012820155610b33610b2e866137f7565b612d7f565b01546040805195865260208601919091523394918291820190565b0390a3005b506001546001600160a01b03163314610b13565b602036600319011261030057600435610b7e613639565b6008610b92825f52600260205260405f2090565b610ba56001610389600984015460ff1690565b335f9081526006820160205260409020610bc2906103b8906103b1565b610bcd341515612dd5565b600181810154610be8916001600160a01b0390911614612e21565b335f9081526007820160205260409020610c033482546120bb565b905501610c113482546120bb565b9055604051907f984a71c9d95fd4794aeba33ae72edfec22053fde75488d63abef9dc69ee795af3392806104483482919060206040840193600181520152565b346103005760031960403682011261030057602435906004356001600160401b038311610300576101008360040192843603011261030057610c9b815f52600260205260405f2090565b9160098301610ccc610cae825460ff1690565b610cb781610636565b60028114908115610f05575b50959195612e6d565b600d840154610cee90610ce7906001600160a01b031661046e565b3314612ea9565b60c48101610cfc8184612eee565b949050610d1a60e4840195610d118787612eee565b91905014612f23565b610d34610d278386612eee565b9050600488015414612f68565b5f968793845b610d448588612eee565b90508a1015610d9457610d8b610d79600192610d73610d6d8e610d678b8e612eee565b90612fdb565b906138a0565b906120bb565b96610d73610d6d8d610d678d8d612eee565b99019894610d3a565b88610dea610de060a4969a610dda610dd060209a610dca610e61999a9d610e3799610dc460088b01548214612ff6565b14613042565b8d612eee565b90601587016130d1565b8a612eee565b90601684016130d1565b610e0d88359788601084015560248601356003840155600460ff19825416179055565b610e1a6044850189612eee565b929091610e2a606487018b612eee565b92909a6084880190612eee565b9390926040519b8c998a996317f8535960e21b8b52013596600e600f860195019360048b016132ef565b03817f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03165afa908115610f0057610a4f610ecc927fa8977c3509942b265a162041f3c634a9747979778b29a612e6df75b0bf6364d2945f91610ed1575b506133a1565b0390a2005b610ef3915060203d602011610ef9575b610eeb8183612599565b8101906131e9565b86610ec6565b503d610ee1565b613396565b60039150610f1281610636565b145f610cc3565b34610300576020366003190112610300576004355f90815260026020908152604091829020600881015460019091015483519182526001600160a01b031691810191909152f35b9591949099989793610f91610100989461012089019c895260018060a01b0380981660208a01526040890190610654565b6060870152608086015260a085015260c08401521660e08201520152565b34610300576020366003190112610300576004355f52600260205260405f2080546107e060018060a01b03806001850154169360ff60098201541691600482015460088301546011840154916014601286015494600d8701541695015495604051998a998a610f60565b34610300575f366003190112610300576110316139b8565b600180546001600160a01b031981169091555f906001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b34610300576020366003190112610300576004355f526002602052602060018060a01b03600d60405f20015416604051908152f35b9081518082526020808093019301915f5b8281106110c8575050505090565b8351855293810193928101926001016110ba565b909291604082019160408152845180935260608101926020809601905f5b81811061111a5750505061111793945060208184039101526110a9565b90565b82516001600160801b0316865294870194918701916001016110fa565b3461030057602080600319360112610300576004355f52600290600260205260409060405f2091600e83019060405192839061118661117c8554809760209181520190565b945f5260205f2090565b915f945b6001908782880110156111ba5784546001600160801b038116825260801c8482015295890195930192840161118a565b6111e7600f8a6111e18680958c8e8c5491818110611205575b106111f7575b500385612599565b016133e0565b906107e0604051928392836110dc565b60801c8152602001876111d9565b6001600160801b03831684529260019060200193016111d3565b346103005760203660031901126103005760043561123c816102ef565b60018060a01b03165f526003602052602060ff60405f2054166040519015158152f35b346103005760203660031901126103005760043561127c816102ef565b60018060a01b03165f526004602052602060ff60405f2054166040519015158152f35b346103005760403660031901126103005760206112e66024356112c1816102ef565b6004355f5260028352600760405f20019060018060a01b03165f5260205260405f2090565b54604051908152f35b346103005760803660031901126103005760048035602435606435926001600160401b038411610300576113296114189436908301610984565b949091611334613639565b611346855f52600260205260405f2090565b6113686005611359600984015460ff1690565b61136281610636565b146133fb565b60138101906113996113946113906103b133869060018060a01b03165f5260205260405f2090565b1590565b613434565b335f90815260068201602052604090206113b6906103b8906103b1565b60018060a01b0394857f0000000000000000000000000000000000000000000000000000000000000000166040998a5191631fd2333d60e01b83528a838060209a8b9333908c84019092916020906040830194835260018060a01b0316910152565b0381845afa8015610f0057888c8e61145b965f946116af575b5061143f8d85161515613489565b51809681926342b6834b60e01b83528c83019190602083019252565b0381855afa938415610f005789918e8d925f9761168c575b5051635b59030760e11b81526001600160a01b039091168a820190815260208101929092526040820195909552849081906060015b0381845afa938415610f00578b8d8a955f97611659575b506114e8908a60038a015491519889978896879663cfb2893d60e01b88526044359488016134db565b03915afa8015610f005760019361150d61151f9261152c945f9161163c575b5061350a565b335f9081526020919091526040902090565b805460ff19166001179055565b0180549093166001600160a01b0316905f1982016115b05750505081611590610448926115835f8080807fe5df19de43c8c04fd192bc68e484b2593570925fbb6ad8c07ccafbc2aa5c37a19933620f4240f161354d565b546001600160a01b031690565b94516001600160a01b039095168552602085015233939081906040820190565b865163a9059cbb60e01b815233918101918252602082018690529294929391859185919082905f90829060400103925af1908115610f00577fe5df19de43c8c04fd192bc68e484b2593570925fbb6ad8c07ccafbc2aa5c37a194610448946115909361161e575b5050611583565b8161163492903d10610ef957610eeb8183612599565b505f80611617565b6116539150893d8b11610ef957610eeb8183612599565b5f611507565b6114e891975061167e90873d8911611685575b6116768183612599565b8101906134cc565b96906114bf565b503d61166c565b6114a89197506116a890853d8711611685576116768183612599565b9690611473565b6116d0919450833d85116116d7575b6116c88183612599565b810190613474565b925f611431565b503d6116be565b34610300575f366003190112610300576001546040516001600160a01b039091168152602090f35b34610300576020366003190112610300576004355f5260026020526020600360405f200154604051908152f35b34610300576020366003190112610300576004355f526002602052602060405f20601160128201549101541115604051908152f35b34610300576020366003190112610300576004355f52600260205260405f20600b600a820154910154906107e06040519283928360209093929193604081019481520152565b34610300576020366003190112610300576004355f5260026020526020601060405f200154604051908152f35b34610300575f366003190112610300576020604051621275008152f35b34610300576020366003190112610300576004355f526002602052602060ff600960405f2001541661182d6040518092610654565bf35b34610300575f366003190112610300576040517f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602090f35b3461030057602036600319011261030057600435611890816102ef565b6118986139b8565b6001600160a01b03165f908152600360205260409020805460ff19166001179055005b346103005760203660031901126103005760048035906118d9613639565b6118eb825f52600260205260405f2090565b90600982016118fb815460ff1690565b61190481610636565b61191c60019160018114908115611c08575b50612e6d565b600d84015461193e90611937906001600160a01b031661046e565b331461358f565b828401805461195561194f826135c8565b916135c8565b927f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031692833b156103005760408051630e8215a160e31b81528881018b8152919290915f90839081906020010381838a5af1918215610f00578492611bf5575b505f9260078b01925b611afc575b5050505050813b1561030057604051639f67003960e01b8152925f91849182916119f991908b8a850161360e565b038183855af1908115610f0057611a35946020938893611ae3575b50604051635848d98d60e11b81529081019283529485928391829160200190565b03915afa908115610f00577f5e9c8d64d9b3e1e9b9aaad80273ff6f8b37a48c391c9d889ac590aab00b79ae693611aa2935f93611abf575b506002019182556001611a81825460ff1690565b611a8a81610636565b14611aae575b50546040519081529081906020820190565b0390a261045460015f55565b805460ff191660021790555f611a90565b6002919350611adc9060203d602011611685576116768183612599565b9290611a6d565b80611af0611af692612586565b80610483565b5f611a14565b8154841015611bf057611b20611b128584612cbb565b50546001600160a01b031690565b93611b3e86611b2f8386612cbb565b5001546001600160a01b031690565b90883b15610300578251633d38067960e21b8152808d018f81526001600160a01b0380891660208301529093166040840152915f90839081906060010381838d5af18015610f005787968793611bca92611bdd575b50611bb181611ba2858d6135fa565b6001600160a01b039091169052565b6001600160a01b03165f90815260208790526040902090565b54611bd5828c6135fa565b5201936119c6565b80611af0611bea92612586565b5f611b93565b6119cb565b80611af0611c0292612586565b5f6119bd565b60029150611c1581610636565b145f611916565b34610300576020366003190112610300576004355f52600260205260405f20600c600a820154910154908181018082116109645760609260405192835260208301526040820152f35b9081518082526020808093019301915f5b828110611c84575050505090565b83516001600160a01b031685529381019392810192600101611c76565b34610300576020366003190112610300576004355f526002602052600460405f20018054611cce816135c8565b915f5b828110611cee57604051602080825281906107e090820187611c65565b80611cfb60019284612cbb565b50828060a01b03905416611d0f82876135fa565b5201611cd1565b9b999693909e9d9c9a989592979491976101c08d019f8d528c600160a01b60019003809a16906020015260408d015260608c015260808b015260a08a01611d5c91610654565b60c089015260e0880152610100870152166101208501526101408401526101608301526101808201526101a00152565b34610300576020366003190112610300576004355f908152600260205260409020805460018201546107e0906001600160a01b03169260028101549060038101546008820154611de0600984015460ff1690565b600a840154600b850154600c860154600d8701549092906001600160a01b031693601088015495601189015497601460128b01549a01549a6040519e8f9e8f611d16565b34610300576020366003190112610300576004355f5260026020526020601460405f200154604051908152f35b3461030057602036600319011261030057600435611e6e816102ef565b611e766139b8565b6001600160a01b03908116908115611ec957600154826bffffffffffffffffffffffff60a01b821617600155167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b604051631e4fbdf760e01b81525f6004820152602490fd5b34610300575f366003190112610300576020604051620f42408152f35b34610300575f36600319011261030057602060405160328152f35b15611f2057565b60405162461bcd60e51b8152602060048201526015602482015274496e76616c6964206368616e6e656c20737461746560581b6044820152606490fd5b15611f6457565b60405162461bcd60e51b8152602060048201526011602482015270139bdd0818481c185c9d1a58da5c185b9d607a1b6044820152606490fd5b15611fa457565b60405162461bcd60e51b815260206004820152602360248201527f546f6b656e206d7573742062652045524332302074617267657420636f6e74726044820152621858dd60ea1b6064820152608490fd5b15611ffc57565b60405162461bcd60e51b815260206004820152601d60248201527f616d6f756e74206d7573742062652067726561746572207468616e20300000006044820152606490fd5b1561204857565b60405162461bcd60e51b815260206004820152602160248201527f6e6f6e204552433230207374616e64617264207472616e73666572206c6f67696044820152606360f81b6064820152608490fd5b634e487b7160e01b5f52601160045260245ffd5b9062127500820180921161096457565b9190820180921161096457565b156120cf57565b60405162461bcd60e51b81526020600482015260136024820152723ab730baba3437b934bd32b21031b0b63632b960691b6044820152606490fd5b1561211157565b60405162461bcd60e51b81526020600482015260146024820152734e6f7420696e20636c6f73696e6720737461746560601b6044820152606490fd5b1561215457565b60405162461bcd60e51b815260206004820152601760248201527f496e73756666696369656e74207369676e6174757265730000000000000000006044820152606490fd5b9190820391821161096457565b5f52600260205260405f20600c600a820154910154810180911161096457804210156121d9574281039081116109645790565b505f90565b156121e557565b60405162461bcd60e51b815260206004820152601460248201527337b7363c9037bbb732b91037b9103632b0b232b960611b6044820152606490fd5b1561222857565b60405162461bcd60e51b815260206004820152601260248201527110da185b9b995b081b9bdd0818db1bdcd95960721b6044820152606490fd5b1561030057565b634e487b7160e01b5f52604160045260245ffd5b9060438202918083046043149015171561096457565b8054905f8155816122a2575050565b6001906001600160ff1b0383168303610964575f5260205f209160011b8201915b8281106122cf57505050565b5f808255828201556002016122c3565b8181106122ea575050565b5f81556001016122df565b80545f825580612303575050565b610311915f52600160205f20910160011c8101906122df565b90600160401b811161238057815481835580821061233957505050565b610311925f52600160205f20916010828501831c84019460041b1680612366575b500160011c01906122df565b5f19908186019182549160200360031b1c1690555f61235a565b612269565b80545f825580612393575050565b610311915f5260205f20908101906122df565b90600182811c921680156123d4575b60208310146123c057565b634e487b7160e01b5f52602260045260245ffd5b91607f16916123b5565b8054905f8155816123ed575050565b5f526020805f20918201915b82811061240557505050565b80612412600192546123a6565b8061241f575b50016123f9565b601f9081811184146124375750505f81555b5f612418565b8361245092845f52865f20920160051c820191016122df565b5f8181526020812081835555612431565b90600160401b81116123805781549181815582821061247f57505050565b5f5260205f2091820191015b818110612496575050565b806124a3600192546123a6565b806124b0575b500161248b565b601f9081811184146124c85750505f81555b5f6124a9565b836124e8926124da855f5260205f2090565b920160051c820191016122df565b5f81815260208120818355556124c2565b6016610311915f81555f60018201555f60028201555f600382015561252060048201612293565b5f60088201555f60098201555f600a8201555f600b8201555f600c8201555f600d820155612550600e82016122f5565b61255c600f8201612385565b5f60108201555f60118201555f60128201555f6014820155612580601582016123de565b016123de565b6001600160401b03811161238057604052565b90601f801991011681019081106001600160401b0382111761238057604052565b60405190604082018281106001600160401b0382111761238057604052565b6001600160401b0381116123805760051b60200190565b9081546125fc816125d9565b90604061260c6040519384612599565b81835282946020809401905f52835f20915f915b84831061262f57505050505050565b8151865f92865492612640846123a6565b8082526001948086169081156126ae5750600114612676575b50612668816001960382612599565b815201940192019192612620565b5f8981528481209650905b8082106126975750810183019450612668612659565b8654838301860152958501958b9490910190612681565b60ff19168584015250151560051b810183019450612668612659565b98959792949990939196335f52602093600360205260ff60405f2054161561298057335f9081526004602052604090206127109061270b90611390906103b1565b6129b6565b600389101580612975575b612724906129fa565b61272f848a14612a46565b610e1088101580612968575b61274790979697612a86565b6005549b8c9a60019960018d0161275d90600555565b335f9081526004602052604090208e908e90805460ff1916600117905561278c905f52600260205260405f2090565b9d8e5560018e0180546001600160a01b0319166001600160a01b03909216919091179055600d8d0180546001600160a01b0319163317905542600a8e0155600c8d01556127dc91600e8d01612adf565b6127e991600f8b01612bd5565b60098801805460ff191660011790556014880155600587019260048801600689015f5b8981106128795750505050505050505061283161282a60119261227d565b6064900490565b9101908082551561286f575b506001600160a01b0316817feded733012be80deb8a1833d57ded6191b80e449b4bb9bf5af555208236e0b7e5f80a390565b600190555f61283d565b8061296261289161288c8c948e8d612c58565b612c6d565b6128b96128b46113906103b184899060018060a01b03165f5260205260405f2090565b612c77565b6128f76128ca61288c858b8b612c58565b6128f16128d56125ba565b6001600160a01b0385168152916001600160a01b0316828d0152565b87612cd4565b6001600160a01b0381165f9081526020869052604090206129179061151f565b61294361292861288c858b8b612c58565b6001600160a01b039092165f90815260208c90526040902090565b80546001600160a01b0319166001600160a01b03909216919091179055565b0161280c565b5062093a8088111561273b565b50603289111561271b565b60405162461bcd60e51b815260206004820152600e60248201526d139bdd08185d5d1a1bdc9a5e995960921b6044820152606490fd5b156129bd57565b60405162461bcd60e51b815260206004820152601560248201527410da185b9b995b081b1a5b5a5d081c995858da1959605a1b6044820152606490fd5b15612a0157565b60405162461bcd60e51b815260206004820152601a60248201527f496e76616c6964207061727469636970616e74206e756d6265720000000000006044820152606490fd5b15612a4d57565b60405162461bcd60e51b81526020600482015260116024820152704d69736d6174636865642061727261797360781b6044820152606490fd5b15612a8d57565b60405162461bcd60e51b815260206004820152600f60248201526e125b9d985b1a59081d1a5b595bdd5d608a1b6044820152606490fd5b6001600160801b0381160361030057565b3561111781612ac4565b91906001600160401b03821161238057612b0790612afd838561231c565b925f5260205f2090565b60018260011c925f5b848110612b8557506001198116900380612b2c575b5050505050565b93905f945f5b818110612b49575050505001555f80808080612b25565b90916020612b7a8598612b5c8497612ad5565b908560041b60031b916001600160801b03809116831b921b19161790565b970193929101612b32565b5f805b60028110612b9c5750848201558201612b10565b96906020612bcc8692612bae85612ad5565b908b60041b60031b916001600160801b03809116831b921b19161790565b92019701612b88565b906001600160401b03831161238057600160401b8311612380578154838355808410612c28575b50905f526020805f20905f5b848110612c16575050505050565b83358382015592810192600101612c08565b612c3e90835f528460205f2091820191016122df565b5f612bfc565b634e487b7160e01b5f52603260045260245ffd5b9190811015612c685760051b0190565b612c44565b35611117816102ef565b15612c7e57565b60405162461bcd60e51b8152602060048201526015602482015274111d5c1b1a58d85d19481c185c9d1a58da5c185b9d605a1b6044820152606490fd5b8054821015612c68575f5260205f209060011b01905f90565b8054600160401b81101561238057612cf191600182018155612cbb565b612d2a57815181546001600160a01b039182166001600160a01b0319918216178355602090930151600190920180549093169116179055565b634e487b7160e01b5f525f60045260245ffd5b15612d4457565b60405162461bcd60e51b81526020600482015260136024820152722737ba103632b0b232b91037b91037bbb732b960691b6044820152606490fd5b15612d8657565b60405162461bcd60e51b815260206004820152602160248201527f496e76616c69642067726f7570207468726573686f6c64207369676e617475726044820152606560f81b6064820152608490fd5b15612ddc57565b60405162461bcd60e51b815260206004820152601e60248201527f4465706f736974206d7573742062652067726561746572207468616e203000006044820152606490fd5b15612e2857565b60405162461bcd60e51b815260206004820152601860248201527f546f6b656e206d7573742062652073657420746f2045544800000000000000006044820152606490fd5b15612e7457565b60405162461bcd60e51b815260206004820152600d60248201526c496e76616c696420737461746560981b6044820152606490fd5b15612eb057565b60405162461bcd60e51b815260206004820152601660248201527513db9b1e481b195859195c8818d85b881cdd589b5a5d60521b6044820152606490fd5b903590601e198136030182121561030057018035906001600160401b03821161030057602001918160051b3603831361030057565b15612f2a57565b60405162461bcd60e51b81526020600482015260166024820152754d69736d617463686564206c6561662061727261797360501b6044820152606490fd5b15612f6f57565b60405162461bcd60e51b8152602060048201526012602482015271125b9d985b1a59081b1958598818dbdd5b9d60721b6044820152606490fd5b903590601e198136030182121561030057018035906001600160401b0382116103005760200191813603831361030057565b90821015612c6857612ff29160051b810190612fa9565b9091565b15612ffd57565b60405162461bcd60e51b815260206004820152601860248201527f496e697469616c2062616c616e6365206d69736d6174636800000000000000006044820152606490fd5b1561304957565b60405162461bcd60e51b815260206004820152601d60248201527f42616c616e636520636f6e736572766174696f6e2076696f6c617465640000006044820152606490fd5b9190601f811161309d57505050565b610311925f5260205f20906020601f840160051c830193106130c7575b601f0160051c01906122df565b90915081906130ba565b91906130dd8284612461565b5f92835260208084209091805b8486106130f957505050505050565b6131038183612fa9565b6001600160401b03819392931161238057859261312a8261312488546123a6565b8861308e565b5f90601f831160011461317857826001959386959361315e935f9261316d575b50508160011b915f199060031b1c19161790565b86555b019301950194916130ea565b013590505f8061314a565b601f9493941983169161318e885f5260205f2090565b925f5b8181106131d157509160019693918588979694106131b8575b505050831b83018655613161565b01355f19600384901b60f8161c191690555f80806131aa565b8284013585558a966001909501949283019201613191565b90816020910312610300575180151581036103005790565b81835290916001600160fb1b0383116103005760209260051b809284830137010190565b805480835290929161323e90602001935f5260205f2090565b5f935b6001908382870110156132765782546001600160801b038116825260801c602082015260029190604001920194019390613241565b939492919050549181811061329a575b1061328f575090565b60801c815260200190565b6001600160801b0383168452926001906020019301613286565b9081548082526020809201925f5260205f20915f905b8282106132d8575050505090565b8354855293840193600193840193909101906132ca565b809a9998969594929391938060c0830160c084525260e0820194905f5b81811061336857505050936133398460a0999794613347948860206133639c9a6133559a03910152613201565b908b820360408d0152613225565b9089820360608b01526132b4565b918783036080890152613201565b930152565b919560019193506001600160801b03873561338281612ac4565b168152602080910196019101918c9261330c565b6040513d5f823e3d90fd5b156133a857565b60405162461bcd60e51b815260206004820152601060248201526f24b73b30b634b2102d2590383937b7b360811b6044820152606490fd5b906103116133f492604051938480926132b4565b0383612599565b1561340257565b60405162461bcd60e51b815260206004820152600a602482015269139bdd0818db1bdcd95960b21b6044820152606490fd5b1561343b57565b60405162461bcd60e51b815260206004820152601160248201527020b63932b0b23c903bb4ba34323930bbb760791b6044820152606490fd5b908160209103126103005751611117816102ef565b1561349057565b60405162461bcd60e51b8152602060048201526014602482015273130c881859191c995cdcc81b9bdd08199bdd5b9960621b6044820152606490fd5b90816020910312610300575190565b9291608094979695926134fb92855260a0602086015260a0850191613201565b95604083015260608201520152565b1561351157565b60405162461bcd60e51b815260206004820152601460248201527324b73b30b634b21036b2b935b63290383937b7b360611b6044820152606490fd5b1561355457565b60405162461bcd60e51b8152602060048201526013602482015272115512081d1c985b9cd9995c8819985a5b1959606a1b6044820152606490fd5b1561359657565b60405162461bcd60e51b815260206004820152600a6024820152692737ba103632b0b232b960b11b6044820152606490fd5b906135d2826125d9565b6135df6040519182612599565b82815280926135f0601f19916125d9565b0190602036910137565b8051821015612c685760209160051b010190565b9161362b9061111794928452606060208501526060840190611c65565b9160408184039101526110a9565b60025f54146136485760025f55565b604051633ee5aeb560e01b8152600490fd5b6040516370a0823160e01b80825230600483015260209492936001600160a01b0316918581602481865afa938415610f005786915f95613747575b506040516323b872dd60e01b81526001600160a01b0390961660048701523060248701526044860152929391928280606481015b03815f875af1918215610f0057859261372a575b5060405190815230600482015291829060249082905afa908115610f0057611117935f9261370d575b5050612199565b6137239250803d10611685576116768183612599565b5f80613706565b61374090833d8511610ef957610eeb8183612599565b505f6136dd565b6136c994955061376390833d8511611685576116768183612599565b9493613695565b1561377157565b60405162461bcd60e51b815260206004820152601960248201527f496e76616c6964207061727469636970616e7420636f756e74000000000000006044820152606490fd5b156137bd57565b60405162461bcd60e51b81526020600482015260126024820152710a8d0e4cae6d0ded8c840dad2e6dac2e8c6d60731b6044820152606490fd5b5f52600260205260405f206012810154601182015480911061389a5780156138555761383961282a6004613847940154613834600382101561376a565b61227d565b90811561384c575b146137b6565b600190565b60019150613841565b60405162461bcd60e51b815260206004820152601b60248201527f496e76616c6964207265717569726564207369676e61747572657300000000006044820152606490fd5b50505f90565b5f9291156139af5780355f1a9060c082106139a65760019160f7811161399a575b506001910180355f1a607f8111613965575b500180355f1a906080821060011461396057608082146001146139595760b88210613940575b60b78211613905575050565b9091925061010090600181013560b619840160031b83031c92602084116139375760b519910101359160031b90031c90565b60045f5260205ffd5b6001810135607f19830160031b610100031c93506138f9565b505f925050565b509150565b60b8811061398e575b60b78111156138d35760018201355f90811a90910160b5190192506138d3565b607e198101925061396e565b60f5190191505f6138c1565b60025f5260205ffd5b60015f5260205ffd5b6001546001600160a01b031633036139cc57565b60405163118cdaa760e01b8152336004820152602490fdfea264697066735822122065b12332a83f77e399f5748fb707840e91d2fb36fcccd19e043433deb665ba2564736f6c63430008170033000000000000000000000000708fbfe3acc1f65948304015f1789a05383a674b000000000000000000000000ef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
        "nonce": "0x10d",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    },
    {
      "hash": "0x3d55abe950e8f25658a377c598d75512435b61b91b5997470a67fc5f0cb552c2",
      "transactionType": "CALL",
      "contractName": "MerkleTreeManager4",
      "contractAddress": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
      "function": "setBridge(address)",
      "arguments": [
        "0xa9BE9BA80802EaDFFEee5dc1fF46B0ED7da8a19D"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "to": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
        "gas": "0x10065",
        "value": "0x0",
        "input": "0x8dd14802000000000000000000000000a9be9ba80802eadffeee5dc1ff46b0ed7da8a19d",
        "nonce": "0x10e",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    }
  ],
  "receipts": [
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x1b8d37b",
      "logs": [],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x14395d21d193c2e09ab4e708c85c8a8b5186be2898f6c906c4dfe549664e13df",
      "transactionIndex": "0x9f",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0x396d22",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0xa22a3ce2e3eb5865acdca8980f95c8eaa87ef4a1"
    },
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x1d60164",
      "logs": [
        {
          "address": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
          "topics": [
            "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb"
          ],
          "data": "0x",
          "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
          "blockNumber": "0x8a740a",
          "blockTimestamp": "0x68aebd10",
          "transactionHash": "0x9f4c2dc61cadae8e450e06f9e24eb6b7cabd0914eabd6a2a308c039409823c08",
          "transactionIndex": "0xa0",
          "logIndex": "0x154",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000000000000000000000000000000000404000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000140000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x9f4c2dc61cadae8e450e06f9e24eb6b7cabd0914eabd6a2a308c039409823c08",
      "transactionIndex": "0xa0",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0x1d2de9",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2"
    },
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x2089fe2",
      "logs": [
        {
          "address": "0xa9be9ba80802eadffeee5dc1ff46b0ed7da8a19d",
          "topics": [
            "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb"
          ],
          "data": "0x",
          "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
          "blockNumber": "0x8a740a",
          "blockTimestamp": "0x68aebd10",
          "transactionHash": "0xfa59790b17e4a7432b1016cd9045f204d13dee446262525a0854e9d1a712c17c",
          "transactionIndex": "0xa1",
          "logIndex": "0x155",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000010000000000000000000000000000000000000000000000000000000000000000000000020000000000000002000040000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0xfa59790b17e4a7432b1016cd9045f204d13dee446262525a0854e9d1a712c17c",
      "transactionIndex": "0xa1",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0x329e7e",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0xa9be9ba80802eadffeee5dc1ff46b0ed7da8a19d"
    },
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x2095982",
      "logs": [
        {
          "address": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
          "topics": [
            "0xa49730bff544fd0b716395c592e39c6fd2d2481a19b9229b5b240483db95a495",
            "0x000000000000000000000000a9be9ba80802eadffeee5dc1ff46b0ed7da8a19d"
          ],
          "data": "0x",
          "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
          "blockNumber": "0x8a740a",
          "blockTimestamp": "0x68aebd10",
          "transactionHash": "0x3d55abe950e8f25658a377c598d75512435b61b91b5997470a67fc5f0cb552c2",
          "transactionIndex": "0xa2",
          "logIndex": "0x156",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000404000000004000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x3d55abe950e8f25658a377c598d75512435b61b91b5997470a67fc5f0cb552c2",
      "transactionIndex": "0xa2",
      "blockHash": "0x2fe9e91df2a8c25b2b18ea48ac0aea490e19020761d92b70a1552cff792b56ec",
      "blockNumber": "0x8a740a",
      "gasUsed": "0xb9a0",
      "effectiveGasPrice": "0x31e7b6f",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": "0xef249e41f6dc67bdfdbe44f4690cb4527d65cdd2",
      "contractAddress": null
    }
  ],
  "libraries": [],
  "pending": [],
  "returns": {},
  "timestamp": 1756282185,
  "chain": 11155111,
  "commit": "551d364"
}


================================================
FILE: broadcast/DeployStateTransitionVerifier.s.sol/11155111/run-1750594176.json
================================================
{
  "transactions": [
    {
      "hash": "0x060f263bc43bd1ee4f22a756ae80ca446797deb8c9f2ccbf89ea6dfddc7a6a0c",
      "transactionType": "CREATE",
      "contractName": "StateTransitionVerifier",
      "contractAddress": "0x58239c80a164e368e79177b89aaadb9641b9803f",
      "function": null,
      "arguments": [
        "0x708fbfE3acC1F65948304015f1789a05383a674b"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x70ba6",
        "value": "0x0",
        "input": "0x6080346100df57601f61057b38819003918201601f19168301916001600160401b038311848410176100e3578084926020946040528339810103126100df57516001600160a01b03808216918290036100df5733156100c7575f549060018060a01b03199133838216175f55604051913391167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a382156100b8575060015416176001555f60025560405161048390816100f88239f35b633f9fc00160e11b8152600490fd5b604051631e4fbdf760e01b81525f6004820152602490fd5b5f80fd5b634e487b7160e01b5f52604160045260245ffdfe604060a0815260049081361015610014575f80fd5b5f3560e01c8063715018a6146103715780638da5cb5b1461034a57806397fc007c146102f3578063ac2eba98146102d5578063f2fde38b146102465763f404d2021461005e575f80fd5b346101c3576020608052600319608051813601126101c35782359067ffffffffffffffff908183116101c357828501906101008185360301126101c3576024840135600254810361023057506001546100e7929187916001600160a01b0316906100cb60648801856103c8565b95906100da60848a01876103c8565b92909660a48b01906103c8565b929096888c51998a9863133af45d60e21b8a52606060648b01918b0152526084880193905f5b8181106101ec575050509261013483869389979688978861014798030160248901526103fe565b91848303016044850152608051976103fe565b03915afa9182156101e2575f92610180575b5050156101725760440135600255516001815260805190f35b5051630640964d60e41b8152fd5b6080519192503d82116101da575b601f8201601f19168301908111838210176101c75784528160805191810103126101c3575180151581036101c3575f80610159565b5f80fd5b604186634e487b7160e01b5f525260245ffd5b3d915061018e565b84513d5f823e3d90fd5b91809697989950949092939435906fffffffffffffffffffffffffffffffff82168092036101c3579081526080518b9998979691810195949391019160010161010d565b8660249187519163e31f880f60e01b8352820152fd5b50346101c35760203660031901126101c3576001600160a01b038235818116939192908490036101c357610278610422565b83156102bf5750505f54826bffffffffffffffffffffffff60a01b8216175f55167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b905f6024925191631e4fbdf760e01b8352820152fd5b50346101c3575f3660031901126101c3576020906002549051908152f35b5090346101c35760203660031901126101c35780356001600160a01b03811692908390036101c357610323610422565b821561033d57600180546001600160a01b03191684179055005b51633f9fc00160e11b8152fd5b50346101c3575f3660031901126101c3575f5490516001600160a01b039091168152602090f35b346101c3575f3660031901126101c357610389610422565b5f80546001600160a01b0319811682556001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b903590601e19813603018212156101c3570180359067ffffffffffffffff82116101c357602001918160051b360383136101c357565b81835290916001600160fb1b0383116101c35760209260051b809284830137010190565b5f546001600160a01b0316330361043557565b60405163118cdaa760e01b8152336004820152602490fdfea2646970667358221220951297a45f2034c79027183740edea87ab2d62f0e349c94253610e56cfa5725464736f6c63430008170033000000000000000000000000708fbfe3acc1f65948304015f1789a05383a674b",
        "nonce": "0xca",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    }
  ],
  "receipts": [
    {
      "status": "0x1",
      "cumulativeGasUsed": "0xfd848c",
      "logs": [
        {
          "address": "0x58239c80a164e368e79177b89aaadb9641b9803f",
          "topics": [
            "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb"
          ],
          "data": "0x",
          "blockHash": "0x1e7f1af1559c3bc0b8069cd9d6c75bf622407c698f34f15beaf7f6b198672057",
          "blockNumber": "0x834a7c",
          "blockTimestamp": "0x6857f268",
          "transactionHash": "0x060f263bc43bd1ee4f22a756ae80ca446797deb8c9f2ccbf89ea6dfddc7a6a0c",
          "transactionIndex": "0xd4",
          "logIndex": "0xdd",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000800000000000000000020000000000000000400000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000020000000004000000000040000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x060f263bc43bd1ee4f22a756ae80ca446797deb8c9f2ccbf89ea6dfddc7a6a0c",
      "transactionIndex": "0xd4",
      "blockHash": "0x1e7f1af1559c3bc0b8069cd9d6c75bf622407c698f34f15beaf7f6b198672057",
      "blockNumber": "0x834a7c",
      "gasUsed": "0x56b6c",
      "effectiveGasPrice": "0x18ab35",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0x58239c80a164e368e79177b89aaadb9641b9803f"
    }
  ],
  "libraries": [],
  "pending": [],
  "returns": {},
  "timestamp": 1750594176,
  "chain": 11155111,
  "commit": "0268293"
}


================================================
FILE: broadcast/DeployStateTransitionVerifier.s.sol/11155111/run-latest.json
================================================
{
  "transactions": [
    {
      "hash": "0x060f263bc43bd1ee4f22a756ae80ca446797deb8c9f2ccbf89ea6dfddc7a6a0c",
      "transactionType": "CREATE",
      "contractName": "StateTransitionVerifier",
      "contractAddress": "0x58239c80a164e368e79177b89aaadb9641b9803f",
      "function": null,
      "arguments": [
        "0x708fbfE3acC1F65948304015f1789a05383a674b"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "gas": "0x70ba6",
        "value": "0x0",
        "input": "0x6080346100df57601f61057b38819003918201601f19168301916001600160401b038311848410176100e3578084926020946040528339810103126100df57516001600160a01b03808216918290036100df5733156100c7575f549060018060a01b03199133838216175f55604051913391167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a382156100b8575060015416176001555f60025560405161048390816100f88239f35b633f9fc00160e11b8152600490fd5b604051631e4fbdf760e01b81525f6004820152602490fd5b5f80fd5b634e487b7160e01b5f52604160045260245ffdfe604060a0815260049081361015610014575f80fd5b5f3560e01c8063715018a6146103715780638da5cb5b1461034a57806397fc007c146102f3578063ac2eba98146102d5578063f2fde38b146102465763f404d2021461005e575f80fd5b346101c3576020608052600319608051813601126101c35782359067ffffffffffffffff908183116101c357828501906101008185360301126101c3576024840135600254810361023057506001546100e7929187916001600160a01b0316906100cb60648801856103c8565b95906100da60848a01876103c8565b92909660a48b01906103c8565b929096888c51998a9863133af45d60e21b8a52606060648b01918b0152526084880193905f5b8181106101ec575050509261013483869389979688978861014798030160248901526103fe565b91848303016044850152608051976103fe565b03915afa9182156101e2575f92610180575b5050156101725760440135600255516001815260805190f35b5051630640964d60e41b8152fd5b6080519192503d82116101da575b601f8201601f19168301908111838210176101c75784528160805191810103126101c3575180151581036101c3575f80610159565b5f80fd5b604186634e487b7160e01b5f525260245ffd5b3d915061018e565b84513d5f823e3d90fd5b91809697989950949092939435906fffffffffffffffffffffffffffffffff82168092036101c3579081526080518b9998979691810195949391019160010161010d565b8660249187519163e31f880f60e01b8352820152fd5b50346101c35760203660031901126101c3576001600160a01b038235818116939192908490036101c357610278610422565b83156102bf5750505f54826bffffffffffffffffffffffff60a01b8216175f55167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b905f6024925191631e4fbdf760e01b8352820152fd5b50346101c3575f3660031901126101c3576020906002549051908152f35b5090346101c35760203660031901126101c35780356001600160a01b03811692908390036101c357610323610422565b821561033d57600180546001600160a01b03191684179055005b51633f9fc00160e11b8152fd5b50346101c3575f3660031901126101c3575f5490516001600160a01b039091168152602090f35b346101c3575f3660031901126101c357610389610422565b5f80546001600160a01b0319811682556001600160a01b03167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b903590601e19813603018212156101c3570180359067ffffffffffffffff82116101c357602001918160051b360383136101c357565b81835290916001600160fb1b0383116101c35760209260051b809284830137010190565b5f546001600160a01b0316330361043557565b60405163118cdaa760e01b8152336004820152602490fdfea2646970667358221220951297a45f2034c79027183740edea87ab2d62f0e349c94253610e56cfa5725464736f6c63430008170033000000000000000000000000708fbfe3acc1f65948304015f1789a05383a674b",
        "nonce": "0xca",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    }
  ],
  "receipts": [
    {
      "status": "0x1",
      "cumulativeGasUsed": "0xfd848c",
      "logs": [
        {
          "address": "0x58239c80a164e368e79177b89aaadb9641b9803f",
          "topics": [
            "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
            "0x0000000000000000000000000000000000000000000000000000000000000000",
            "0x00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb"
          ],
          "data": "0x",
          "blockHash": "0x1e7f1af1559c3bc0b8069cd9d6c75bf622407c698f34f15beaf7f6b198672057",
          "blockNumber": "0x834a7c",
          "blockTimestamp": "0x6857f268",
          "transactionHash": "0x060f263bc43bd1ee4f22a756ae80ca446797deb8c9f2ccbf89ea6dfddc7a6a0c",
          "transactionIndex": "0xd4",
          "logIndex": "0xdd",
          "removed": false
        }
      ],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000800000000000000000020000000000000000400000000000004000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000020000000004000000000040000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x060f263bc43bd1ee4f22a756ae80ca446797deb8c9f2ccbf89ea6dfddc7a6a0c",
      "transactionIndex": "0xd4",
      "blockHash": "0x1e7f1af1559c3bc0b8069cd9d6c75bf622407c698f34f15beaf7f6b198672057",
      "blockNumber": "0x834a7c",
      "gasUsed": "0x56b6c",
      "effectiveGasPrice": "0x18ab35",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": null,
      "contractAddress": "0x58239c80a164e368e79177b89aaadb9641b9803f"
    }
  ],
  "libraries": [],
  "pending": [],
  "returns": {},
  "timestamp": 1750594176,
  "chain": 11155111,
  "commit": "0268293"
}


================================================
FILE: broadcast/UpdateState.s.sol/11155111/run-1750594477.json
================================================
{
  "transactions": [
    {
      "hash": "0x8dd6fa058d5d516ab163c1f0041e9ccddec2336a653717b573c17ebcb47188d0",
      "transactionType": "CALL",
      "contractName": null,
      "contractAddress": "0x58239c80a164e368e79177b89aaadb9641b9803f",
      "function": "verifyAndCommitStateUpdate((bytes32,bytes32,bytes32,uint128[],uint256[],uint256[],bytes[],address[]))",
      "arguments": [
        "(0x0000000000000000000000000000000000000000000000000000000000000000, 0x0000000000000000000000000000000000000000000000000000000000000000, 0x0000000000000000000000000000000000000000000000000000000000000001, [17987268335810811752681719227744821565, 21573579369987947817268720490115381377, 13214259852387214277350517661361109508, 31628287323743117564862263913205613468, 7585682751859532719034609452121480560, 24832698259195424023461270423068691812, 11832408041741517903694651843972742903, 24994089372755143429047717411529509835, 16199404994379045954833001281052865388, 967651547177592153670347629950771025, 22361329231361696085954212201328480434, 26915669394790434216543730031663606075, 17347809834173516266089996151744108683, 2348150419787868084078617086315695799, 31972019103924065556191879252156388851, 26500409307839304335469244871121018533, 15655819665282032570647544548350359309, 14596416675799749153983742585200133738, 6030755587220272850824797018926512563, 14560709134200666587850769509870032366, 25094268189456595889776213338158611613, 28071169610486298816966327203698103340, 10531607837464123293333257304896872353, 29881567563326121320717165142013321456, 12329114032864415466826961292826223186, 26033318852126302332338127657019748363, 10273109755837481993793990762835806615, 26157778995165314084097187045481358379, 6764563689553992804972216756840417455, 32999827528504255919823657026845431283, 29996246920890355692632206080645719551, 6996860710627484590741429192596375017, 14334598938379413189243500345796567865, 29789972189095316489602100076421267079, 30811061197155448238229268467238640352, 31533389654734849330910205063337882266, 14334598938379413189243500345796567865, 29789972189095316489602100076421267079, 11318826586462928210170760048747490730, 20486164572367621851800545729205845577, 12614564783037801795354140916765870200, 21672061591951913720452571360306502175], [84890533003216386765372717327314113550522590156516125931456902557827929917480, 110032958205277640617137747466254825643749109231308885318370641563488053489264, 53778350095136207486038197937727018441778418839577786547618576737820329363287, 55567794289794855886184874513245435067197953961742247941124328663467518617912, 8571181901552726876002019243903902438356389697969690009765132983236587895730, 95237055230971714055363985482340205835362326828164878357499293750567656304320, 11004529733171175471305565617982823628754908213491313304627666263379090488917, 38721093577514212080967015412949619479426592919228485358869119364850414819680, 80042421352353354819227064544855727482902681186166439463316511137128523771205, 39891341507561057954120994677451968297658316450648212551666353912239631706773, 106024503582713740083543902327021548846496268638954471243016572926279403123694, 30315723354529293557318037650879979322818872846021415003914973785408334676196, 69759774108641995897916910254287811599302566965815692567771829120614797581525, 103717775575976938358407571119233347403652384357896335487911026424059104775151, 19081220125407694063400368155910050685945664116411715661436660491368125730445, 26301056089462017939170151725205432440916330439856173990961989254551266709231, 106831605933748289741830385682693568895468869121605764907647359171831922527213, 114830644686265836710320958713569318457500003184378685475935043689204276017456, 2114655823100241696144723702137344500905407789920118221835627951996821650861, 71541788107684625361418803231430604805830127092941346539295384571277329038769, 25563664871883469971694153574765518717572156755767659271364354482903104979108, 60867663827318976118625868042994726027895697410232601835116069008877178378849, 69301824280182781991118248616022173964447591908442572628414735588328626901589, 115763119837604604222072989349915577521485900253634194997220981232541188393515, 91454324176155887287161240066173315366170584866401949937050754724118577722306, 48110500272136201351158482381789352100748885049555877803631990795409234139369, 22462075219114457592426418748016533380001263062334377101284658098456007327821, 61840911730020450376949496512537620002859885647844949935983047438836973804083, 75146646921104955459355749947063370790086765169464131624657720145344059999528, 104428942243684078125175299462707978134398549453683243673047508467929298368164, 67500015039779273431631649282785311177924112531066632723282454490828096094765, 44582445904832949646247393308478642483101115774882961419734486753866498461389, 4124625511048616529897361046573550895495945227610587202766153858357073685783, 66049351422034583384106613738824107742889725143203380500951914060510549543879, 24718628758995747438712535746882606066740663898192383165473600545247152149672, 96445722887248207792615652295751429211269400792613579696748170641010272902414, 4124625511048616529897361046573550895495945227610587202766153858357073685783, 66049351422034583384106613738824107742889725143203380500951914060510549543879, 98859466641019794283094250691203915946371404223073266609642158140610190094169, 70702253415910254498165571276412727188878229869003533033215052180634925308245, 35009565374387900679191465244557459172534023170568859833431530130441531603735, 29416268599743711322167529816730998472900716415795227411679795780420130875362, 38641732292850299485437762247708952861147393153367680625018239751661650901854, 37412218391108249385192262263819591713347561096778765002291220723671932120075, 29591376875651481866415354065864879317636662387411415404883437814090362956850, 8605569258840583697274222122274570987051676164726151113276391631387742010647], [75984986997759496130460489286348161549, 3267563129, 0, 0, 75984986997759496130460489286348161549, 3267563129, 0, 0, 282694985723695679721431686460036218601, 216594121, 0, 0, 282694985723695679721431686460036218601, 216594121, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 43444099025669499945336077053482574676, 330994406577124033388575503736174532386, 43444099025669499945336077053482574676, 330994406577124033388575503736174532386, 41965763516282199620223477354772544688, 172742390719562423757525674462176597416, 41965763516282199620223477354772544688, 172742390719562423757525674462176597416, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0x30, 0x31], [0x15759359e60a3b9e59eA7A96D10Fa48829f83bEb, 0x15759359e60a3b9e59eA7A96D10Fa48829f83bEb])"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "to": "0x58239c80a164e368e79177b89aaadb9641b9803f",
        "gas": "0x154c93",
        "value": "0x0",
        "input": "0xf404d2020000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006600000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000001c600000000000000000000000000000000000000000000000000000000000001d40000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000d8838cc826baa7ccd8cfe0692e8a13d00000000000000000000000000000000103aeb959c53fdd5f13b70a3503638810000000000000000000000000000000009f0f94fd2dc8976bfeab5da30e1fa040000000000000000000000000000000017cb62f5e698fe087b0f334e2fb2439c0000000000000000000000000000000005b4f308ff641adb31b740431cee5d700000000000000000000000000000000012ae9a8d3ec9c65c98664e311e634d640000000000000000000000000000000008e6d6c1e6691e932692e3942a6cbef70000000000000000000000000000000012cdafbf7bf8b80338459969b4c54bcb000000000000000000000000000000000c2fe4549b4508fa6db64b438661f36c0000000000000000000000000000000000ba5ce79b6c3ee1f9323076cd019f510000000000000000000000000000000010d2a2a6b5d9b0f74e5ca7207cbb10b200000000000000000000000000000000143fc4f52ca987f2e47885310ca5693b000000000000000000000000000000000d0d110f829d162dc4e1e76a7544188b0000000000000000000000000000000001c43cc10d4ec71dd398bcdbbd6f8eb700000000000000000000000000000000180d963ee9bd02f3e9367614105c95f30000000000000000000000000000000013efcb0e014478ce79000206e8b39ea5000000000000000000000000000000000bc733812b8bba788f2f4fff4751f70d000000000000000000000000000000000afb2ae78cb743b453868f07e92b466a0000000000000000000000000000000004897b34fcba759c43efbe8834f279b3000000000000000000000000000000000af44a63032292984463891d0c1555ee0000000000000000000000000000000012e0faf1eaaca9e9e0f5be64eb013c9d00000000000000000000000000000000151e4f845009fdef5cf50bde3c38d42c0000000000000000000000000000000007ec505b12d1d7337382721371829fa100000000000000000000000000000000167afb06ffb4c89b5e04a598139f20f00000000000000000000000000000000009468040e794eaa40c964c3b8f4fa252000000000000000000000000000000001395d5b79c0a1e3915974a4899d5b00b0000000000000000000000000000000007ba876a95322207b596d39ed04909970000000000000000000000000000000013adce13779790b3bfbee74b54bfa42b000000000000000000000000000000000516cebd5e7b3d9eca97a4959737c8af0000000000000000000000000000000018d3891d0f746a6e4de8d9f0973c55f30000000000000000000000000000000016911127fce9f466f95506edd9eae5ff0000000000000000000000000000000005438bddfb750e22c41a713494c7c5e9000000000000000000000000000000000ac8be4b1cb6a9c8354fcf35e5d7a3390000000000000000000000000000000016695706d77185cdfdad3d70e8d73e8700000000000000000000000000000000172dfe9a0767dda975f5fbde45ed1ae00000000000000000000000000000000017b91c24ec6ce0e74426041d668c329a000000000000000000000000000000000ac8be4b1cb6a9c8354fcf35e5d7a3390000000000000000000000000000000016695706d77185cdfdad3d70e8d73e87000000000000000000000000000000000883ed3c97b3e674ebfc683481742daa000000000000000000000000000000000f697de543d92f067e8ff95912513e4900000000000000000000000000000000097d7a0fe6430f3dfe4e10c2db6ec87800000000000000000000000000000000104de32201c5ba649cc17df4cf759a1f000000000000000000000000000000000000000000000000000000000000002ebbae56c781b300594dac0753e75154a00b83cc4e6849ef3f07bb56610a02c828f3447285889202e7e24cd08a058a758a76ee4c8440131be202ad8bc0cc91ee7076e577ad778dc4476b10709945e71e289be5ca05c412ca04c133c485ae8bc7577ada41cb993109dc7c194693dbcc461f8512755054966319bcbdea3a1da8693812f31df6476c99289584549ae13292a824df5e10f546a9659d08479cf55b3bb2d28e43565c5c0a0b6d625a4572e02fbb6de2b255911ebe90f551a43a48c52ec0185457d5b78e0dd03fb83b4af872c2f9800e0d4d3bbb1e36ca85a9d8ce763e55559b5cc09730db68b632e905b9ff96bbaffedfdf89e91dadbd7b49dbe2d89960b0f667aff5ec036e5324a9e11b04f1390d31e422fb358943b6e9834ceafc2d455831b2fcca492d422c2c5b78cfd02bbb55bd9ef574d764400661c44345712a95ea67be102035f7f79a8e8ebd8cffb3ce8dd14458c20a93e1a99e31e6756f33ee430617634aa53978ade5412f3ebdb29a91d21a1ddb39eab112df55ef2d2740e49a3aa207f182acea8ec2ab6fdbe9a293e2996e1770815135af9dc7dcab829cd5e54e2e3f05333664792be98ebfe73b8b224acc83074196478593e852ceb2cbef2a2f967e8490650c5dd5893db46c1f61a6bf38ead27c0065c44077656ac88e8d3a25dec62a83cf44cb5356420caf0dcbc4d94b9a0025349a2680b67582d4ceefec308bd22c38acd83cb466e91c0a977b03bc7ab87b5655e1a844c97fa1ad8bedfddfd77793b5af2206625e7dbd3840d179aae985bf5673d02484a0685b80393004acda4fdb36bb30b7aea7540d1fd469fdcb01b32b2ba74de53870a6fbd93dad9e2b3794cd4fe439fe02788fac15f5d5de8a38a35431df4d17b817bd091ffdb138848585c4de95f0ccd6c77cbcb630593e9bf245e78d126978b1229e771580a48691e07a7670c43a463111b013e9050325b870219c35603d55bc09e800c0da6199377148bd378731f820de792040dc114dbac2a120de8e26820cb39c24f2d255ffef9a993e7c0e2e1991d0722671e8c1544d336bbcaff45e94d80a2fd4a68a2bca315029695dcddb58ec2ffab2e8931a9f0cdfe16456a5ddaa820f129566b3c26a5d94033876ebad48b9d9f3af72e0b39eac4d020bd642e21571e9eb88d918e931a915839974262e523f24f696dd93c7928481d3765e8f70454d3fe7ea9cc04d88b8b73587f6030d3a536801b4376a684b428f0cf2c9a10b74b874e342bd9a33a6237eb1a20b4a5602933a791965281782f0311ba6c490b6f3909ca35bfd0528e6e0afccccf07f40dc377094e188610dd3fda0bc42131d84c3512ef14a7df6a4953ba795920785f216d6016142f26c42c17ce081c0637c35b13f8896345f422d6290c529a10345bc54f7ac860765dc9a6b1fbaf282e6e58ead695c718b484ecd091e748f260d20003c2a1a29d6f58cfb8f28c065bbeee13a4a51d71e91922d1792069bad6f6cf9ce5c4623a2799e610dbee116e00ca9247881d67ccd5b808bc736a63f824b54a0f7379d756244f27bbb31cefb4600be600034454e3d93f194a8d53a583d68a44600fa4150e55c74c5def7a96ccc4ea89602f25942eb479e1d0e091e748f260d20003c2a1a29d6f58cfb8f28c065bbeee13a4a51d71e91922d1792069bad6f6cf9ce5c4623a2799e610dbee116e00ca9247881d67ccd5b808bc7da9079a92f7bfe749313cd11fd1faf480cbd6829a27de4e182a9c699a459af599c500eac60a728c7e61f88269a1ed9317e763608e3917f78a9697bda457c99554d66b638321b58bbfdf6b0a17a44a9d9cda67b1a74eea5d0846a99769f18bb174109049c345548f5d1c05fc481a4594d4764dc966bb22dd42a45cc10cd38a7e2556e7206f0462de3787e80eba2a7ea0eaced54f3bc4386e7f442a2227caafb5e52b690b1abedd5d98d6dc1da501896a0d24d16b4ac50b2b91705c9eacbf4ac0b416c2033250efefa6a38b627ba05c7ba67e800b681f9783a079f27c15f2aac32130694604026116d02cbb135233c3219dce6a8527f02960cb4217dc0b8b17d17000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000392a2d1a05288b172f205541a56fc20d00000000000000000000000000000000000000000000000000000000c2c30e790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000392a2d1a05288b172f205541a56fc20d00000000000000000000000000000000000000000000000000000000c2c30e790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d4ad12e56e54018313761487d2d1fee9000000000000000000000000000000000000000000000000000000000ce8f6c90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d4ad12e56e54018313761487d2d1fee9000000000000000000000000000000000000000000000000000000000ce8f6c9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020af07748adbb0932a59cfb9ad01235400000000000000000000000000000000f903343320db59a6e85d0dbb1bc7d7220000000000000000000000000000000020af07748adbb0932a59cfb9ad01235400000000000000000000000000000000f903343320db59a6e85d0dbb1bc7d722000000000000000000000000000000001f924fe321c5cf7ad7a47b57891fbcb00000000000000000000000000000000081f4f96b68c216b824fb32a8c09bd5a8000000000000000000000000000000001f924fe321c5cf7ad7a47b57891fbcb00000000000000000000000000000000081f4f96b68c216b824fb32a8c09bd5a8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000001300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb",
        "nonce": "0xcb",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    }
  ],
  "receipts": [
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x14aaa98",
      "logs": [],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x8dd6fa058d5d516ab163c1f0041e9ccddec2336a653717b573c17ebcb47188d0",
      "transactionIndex": "0xac",
      "blockHash": "0x8b0702fc4da7917ab1cb6a2b6c1a3f5698b8d26cd6b72da8eb00ce8ab7ddeda3",
      "blockNumber": "0x834a97",
      "gasUsed": "0xe9042",
      "effectiveGasPrice": "0x19e5b8",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": "0x58239c80a164e368e79177b89aaadb9641b9803f",
      "contractAddress": null
    }
  ],
  "libraries": [],
  "pending": [],
  "returns": {},
  "timestamp": 1750594477,
  "chain": 11155111,
  "commit": "0268293"
}


================================================
FILE: broadcast/UpdateState.s.sol/11155111/run-latest.json
================================================
{
  "transactions": [
    {
      "hash": "0x8dd6fa058d5d516ab163c1f0041e9ccddec2336a653717b573c17ebcb47188d0",
      "transactionType": "CALL",
      "contractName": null,
      "contractAddress": "0x58239c80a164e368e79177b89aaadb9641b9803f",
      "function": "verifyAndCommitStateUpdate((bytes32,bytes32,bytes32,uint128[],uint256[],uint256[],bytes[],address[]))",
      "arguments": [
        "(0x0000000000000000000000000000000000000000000000000000000000000000, 0x0000000000000000000000000000000000000000000000000000000000000000, 0x0000000000000000000000000000000000000000000000000000000000000001, [17987268335810811752681719227744821565, 21573579369987947817268720490115381377, 13214259852387214277350517661361109508, 31628287323743117564862263913205613468, 7585682751859532719034609452121480560, 24832698259195424023461270423068691812, 11832408041741517903694651843972742903, 24994089372755143429047717411529509835, 16199404994379045954833001281052865388, 967651547177592153670347629950771025, 22361329231361696085954212201328480434, 26915669394790434216543730031663606075, 17347809834173516266089996151744108683, 2348150419787868084078617086315695799, 31972019103924065556191879252156388851, 26500409307839304335469244871121018533, 15655819665282032570647544548350359309, 14596416675799749153983742585200133738, 6030755587220272850824797018926512563, 14560709134200666587850769509870032366, 25094268189456595889776213338158611613, 28071169610486298816966327203698103340, 10531607837464123293333257304896872353, 29881567563326121320717165142013321456, 12329114032864415466826961292826223186, 26033318852126302332338127657019748363, 10273109755837481993793990762835806615, 26157778995165314084097187045481358379, 6764563689553992804972216756840417455, 32999827528504255919823657026845431283, 29996246920890355692632206080645719551, 6996860710627484590741429192596375017, 14334598938379413189243500345796567865, 29789972189095316489602100076421267079, 30811061197155448238229268467238640352, 31533389654734849330910205063337882266, 14334598938379413189243500345796567865, 29789972189095316489602100076421267079, 11318826586462928210170760048747490730, 20486164572367621851800545729205845577, 12614564783037801795354140916765870200, 21672061591951913720452571360306502175], [84890533003216386765372717327314113550522590156516125931456902557827929917480, 110032958205277640617137747466254825643749109231308885318370641563488053489264, 53778350095136207486038197937727018441778418839577786547618576737820329363287, 55567794289794855886184874513245435067197953961742247941124328663467518617912, 8571181901552726876002019243903902438356389697969690009765132983236587895730, 95237055230971714055363985482340205835362326828164878357499293750567656304320, 11004529733171175471305565617982823628754908213491313304627666263379090488917, 38721093577514212080967015412949619479426592919228485358869119364850414819680, 80042421352353354819227064544855727482902681186166439463316511137128523771205, 39891341507561057954120994677451968297658316450648212551666353912239631706773, 106024503582713740083543902327021548846496268638954471243016572926279403123694, 30315723354529293557318037650879979322818872846021415003914973785408334676196, 69759774108641995897916910254287811599302566965815692567771829120614797581525, 103717775575976938358407571119233347403652384357896335487911026424059104775151, 19081220125407694063400368155910050685945664116411715661436660491368125730445, 26301056089462017939170151725205432440916330439856173990961989254551266709231, 106831605933748289741830385682693568895468869121605764907647359171831922527213, 114830644686265836710320958713569318457500003184378685475935043689204276017456, 2114655823100241696144723702137344500905407789920118221835627951996821650861, 71541788107684625361418803231430604805830127092941346539295384571277329038769, 25563664871883469971694153574765518717572156755767659271364354482903104979108, 60867663827318976118625868042994726027895697410232601835116069008877178378849, 69301824280182781991118248616022173964447591908442572628414735588328626901589, 115763119837604604222072989349915577521485900253634194997220981232541188393515, 91454324176155887287161240066173315366170584866401949937050754724118577722306, 48110500272136201351158482381789352100748885049555877803631990795409234139369, 22462075219114457592426418748016533380001263062334377101284658098456007327821, 61840911730020450376949496512537620002859885647844949935983047438836973804083, 75146646921104955459355749947063370790086765169464131624657720145344059999528, 104428942243684078125175299462707978134398549453683243673047508467929298368164, 67500015039779273431631649282785311177924112531066632723282454490828096094765, 44582445904832949646247393308478642483101115774882961419734486753866498461389, 4124625511048616529897361046573550895495945227610587202766153858357073685783, 66049351422034583384106613738824107742889725143203380500951914060510549543879, 24718628758995747438712535746882606066740663898192383165473600545247152149672, 96445722887248207792615652295751429211269400792613579696748170641010272902414, 4124625511048616529897361046573550895495945227610587202766153858357073685783, 66049351422034583384106613738824107742889725143203380500951914060510549543879, 98859466641019794283094250691203915946371404223073266609642158140610190094169, 70702253415910254498165571276412727188878229869003533033215052180634925308245, 35009565374387900679191465244557459172534023170568859833431530130441531603735, 29416268599743711322167529816730998472900716415795227411679795780420130875362, 38641732292850299485437762247708952861147393153367680625018239751661650901854, 37412218391108249385192262263819591713347561096778765002291220723671932120075, 29591376875651481866415354065864879317636662387411415404883437814090362956850, 8605569258840583697274222122274570987051676164726151113276391631387742010647], [75984986997759496130460489286348161549, 3267563129, 0, 0, 75984986997759496130460489286348161549, 3267563129, 0, 0, 282694985723695679721431686460036218601, 216594121, 0, 0, 282694985723695679721431686460036218601, 216594121, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 43444099025669499945336077053482574676, 330994406577124033388575503736174532386, 43444099025669499945336077053482574676, 330994406577124033388575503736174532386, 41965763516282199620223477354772544688, 172742390719562423757525674462176597416, 41965763516282199620223477354772544688, 172742390719562423757525674462176597416, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0x30, 0x31], [0x15759359e60a3b9e59eA7A96D10Fa48829f83bEb, 0x15759359e60a3b9e59eA7A96D10Fa48829f83bEb])"
      ],
      "transaction": {
        "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
        "to": "0x58239c80a164e368e79177b89aaadb9641b9803f",
        "gas": "0x154c93",
        "value": "0x0",
        "input": "0xf404d2020000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000006600000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000001c600000000000000000000000000000000000000000000000000000000000001d40000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000d8838cc826baa7ccd8cfe0692e8a13d00000000000000000000000000000000103aeb959c53fdd5f13b70a3503638810000000000000000000000000000000009f0f94fd2dc8976bfeab5da30e1fa040000000000000000000000000000000017cb62f5e698fe087b0f334e2fb2439c0000000000000000000000000000000005b4f308ff641adb31b740431cee5d700000000000000000000000000000000012ae9a8d3ec9c65c98664e311e634d640000000000000000000000000000000008e6d6c1e6691e932692e3942a6cbef70000000000000000000000000000000012cdafbf7bf8b80338459969b4c54bcb000000000000000000000000000000000c2fe4549b4508fa6db64b438661f36c0000000000000000000000000000000000ba5ce79b6c3ee1f9323076cd019f510000000000000000000000000000000010d2a2a6b5d9b0f74e5ca7207cbb10b200000000000000000000000000000000143fc4f52ca987f2e47885310ca5693b000000000000000000000000000000000d0d110f829d162dc4e1e76a7544188b0000000000000000000000000000000001c43cc10d4ec71dd398bcdbbd6f8eb700000000000000000000000000000000180d963ee9bd02f3e9367614105c95f30000000000000000000000000000000013efcb0e014478ce79000206e8b39ea5000000000000000000000000000000000bc733812b8bba788f2f4fff4751f70d000000000000000000000000000000000afb2ae78cb743b453868f07e92b466a0000000000000000000000000000000004897b34fcba759c43efbe8834f279b3000000000000000000000000000000000af44a63032292984463891d0c1555ee0000000000000000000000000000000012e0faf1eaaca9e9e0f5be64eb013c9d00000000000000000000000000000000151e4f845009fdef5cf50bde3c38d42c0000000000000000000000000000000007ec505b12d1d7337382721371829fa100000000000000000000000000000000167afb06ffb4c89b5e04a598139f20f00000000000000000000000000000000009468040e794eaa40c964c3b8f4fa252000000000000000000000000000000001395d5b79c0a1e3915974a4899d5b00b0000000000000000000000000000000007ba876a95322207b596d39ed04909970000000000000000000000000000000013adce13779790b3bfbee74b54bfa42b000000000000000000000000000000000516cebd5e7b3d9eca97a4959737c8af0000000000000000000000000000000018d3891d0f746a6e4de8d9f0973c55f30000000000000000000000000000000016911127fce9f466f95506edd9eae5ff0000000000000000000000000000000005438bddfb750e22c41a713494c7c5e9000000000000000000000000000000000ac8be4b1cb6a9c8354fcf35e5d7a3390000000000000000000000000000000016695706d77185cdfdad3d70e8d73e8700000000000000000000000000000000172dfe9a0767dda975f5fbde45ed1ae00000000000000000000000000000000017b91c24ec6ce0e74426041d668c329a000000000000000000000000000000000ac8be4b1cb6a9c8354fcf35e5d7a3390000000000000000000000000000000016695706d77185cdfdad3d70e8d73e87000000000000000000000000000000000883ed3c97b3e674ebfc683481742daa000000000000000000000000000000000f697de543d92f067e8ff95912513e4900000000000000000000000000000000097d7a0fe6430f3dfe4e10c2db6ec87800000000000000000000000000000000104de32201c5ba649cc17df4cf759a1f000000000000000000000000000000000000000000000000000000000000002ebbae56c781b300594dac0753e75154a00b83cc4e6849ef3f07bb56610a02c828f3447285889202e7e24cd08a058a758a76ee4c8440131be202ad8bc0cc91ee7076e577ad778dc4476b10709945e71e289be5ca05c412ca04c133c485ae8bc7577ada41cb993109dc7c194693dbcc461f8512755054966319bcbdea3a1da8693812f31df6476c99289584549ae13292a824df5e10f546a9659d08479cf55b3bb2d28e43565c5c0a0b6d625a4572e02fbb6de2b255911ebe90f551a43a48c52ec0185457d5b78e0dd03fb83b4af872c2f9800e0d4d3bbb1e36ca85a9d8ce763e55559b5cc09730db68b632e905b9ff96bbaffedfdf89e91dadbd7b49dbe2d89960b0f667aff5ec036e5324a9e11b04f1390d31e422fb358943b6e9834ceafc2d455831b2fcca492d422c2c5b78cfd02bbb55bd9ef574d764400661c44345712a95ea67be102035f7f79a8e8ebd8cffb3ce8dd14458c20a93e1a99e31e6756f33ee430617634aa53978ade5412f3ebdb29a91d21a1ddb39eab112df55ef2d2740e49a3aa207f182acea8ec2ab6fdbe9a293e2996e1770815135af9dc7dcab829cd5e54e2e3f05333664792be98ebfe73b8b224acc83074196478593e852ceb2cbef2a2f967e8490650c5dd5893db46c1f61a6bf38ead27c0065c44077656ac88e8d3a25dec62a83cf44cb5356420caf0dcbc4d94b9a0025349a2680b67582d4ceefec308bd22c38acd83cb466e91c0a977b03bc7ab87b5655e1a844c97fa1ad8bedfddfd77793b5af2206625e7dbd3840d179aae985bf5673d02484a0685b80393004acda4fdb36bb30b7aea7540d1fd469fdcb01b32b2ba74de53870a6fbd93dad9e2b3794cd4fe439fe02788fac15f5d5de8a38a35431df4d17b817bd091ffdb138848585c4de95f0ccd6c77cbcb630593e9bf245e78d126978b1229e771580a48691e07a7670c43a463111b013e9050325b870219c35603d55bc09e800c0da6199377148bd378731f820de792040dc114dbac2a120de8e26820cb39c24f2d255ffef9a993e7c0e2e1991d0722671e8c1544d336bbcaff45e94d80a2fd4a68a2bca315029695dcddb58ec2ffab2e8931a9f0cdfe16456a5ddaa820f129566b3c26a5d94033876ebad48b9d9f3af72e0b39eac4d020bd642e21571e9eb88d918e931a915839974262e523f24f696dd93c7928481d3765e8f70454d3fe7ea9cc04d88b8b73587f6030d3a536801b4376a684b428f0cf2c9a10b74b874e342bd9a33a6237eb1a20b4a5602933a791965281782f0311ba6c490b6f3909ca35bfd0528e6e0afccccf07f40dc377094e188610dd3fda0bc42131d84c3512ef14a7df6a4953ba795920785f216d6016142f26c42c17ce081c0637c35b13f8896345f422d6290c529a10345bc54f7ac860765dc9a6b1fbaf282e6e58ead695c718b484ecd091e748f260d20003c2a1a29d6f58cfb8f28c065bbeee13a4a51d71e91922d1792069bad6f6cf9ce5c4623a2799e610dbee116e00ca9247881d67ccd5b808bc736a63f824b54a0f7379d756244f27bbb31cefb4600be600034454e3d93f194a8d53a583d68a44600fa4150e55c74c5def7a96ccc4ea89602f25942eb479e1d0e091e748f260d20003c2a1a29d6f58cfb8f28c065bbeee13a4a51d71e91922d1792069bad6f6cf9ce5c4623a2799e610dbee116e00ca9247881d67ccd5b808bc7da9079a92f7bfe749313cd11fd1faf480cbd6829a27de4e182a9c699a459af599c500eac60a728c7e61f88269a1ed9317e763608e3917f78a9697bda457c99554d66b638321b58bbfdf6b0a17a44a9d9cda67b1a74eea5d0846a99769f18bb174109049c345548f5d1c05fc481a4594d4764dc966bb22dd42a45cc10cd38a7e2556e7206f0462de3787e80eba2a7ea0eaced54f3bc4386e7f442a2227caafb5e52b690b1abedd5d98d6dc1da501896a0d24d16b4ac50b2b91705c9eacbf4ac0b416c2033250efefa6a38b627ba05c7ba67e800b681f9783a079f27c15f2aac32130694604026116d02cbb135233c3219dce6a8527f02960cb4217dc0b8b17d17000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000392a2d1a05288b172f205541a56fc20d00000000000000000000000000000000000000000000000000000000c2c30e790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000392a2d1a05288b172f205541a56fc20d00000000000000000000000000000000000000000000000000000000c2c30e790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d4ad12e56e54018313761487d2d1fee9000000000000000000000000000000000000000000000000000000000ce8f6c90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d4ad12e56e54018313761487d2d1fee9000000000000000000000000000000000000000000000000000000000ce8f6c9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020af07748adbb0932a59cfb9ad01235400000000000000000000000000000000f903343320db59a6e85d0dbb1bc7d7220000000000000000000000000000000020af07748adbb0932a59cfb9ad01235400000000000000000000000000000000f903343320db59a6e85d0dbb1bc7d722000000000000000000000000000000001f924fe321c5cf7ad7a47b57891fbcb00000000000000000000000000000000081f4f96b68c216b824fb32a8c09bd5a8000000000000000000000000000000001f924fe321c5cf7ad7a47b57891fbcb00000000000000000000000000000000081f4f96b68c216b824fb32a8c09bd5a8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000001300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb00000000000000000000000015759359e60a3b9e59ea7a96d10fa48829f83beb",
        "nonce": "0xcb",
        "chainId": "0xaa36a7"
      },
      "additionalContracts": [],
      "isFixedGasLimit": false
    }
  ],
  "receipts": [
    {
      "status": "0x1",
      "cumulativeGasUsed": "0x14aaa98",
      "logs": [],
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "type": "0x2",
      "transactionHash": "0x8dd6fa058d5d516ab163c1f0041e9ccddec2336a653717b573c17ebcb47188d0",
      "transactionIndex": "0xac",
      "blockHash": "0x8b0702fc4da7917ab1cb6a2b6c1a3f5698b8d26cd6b72da8eb00ce8ab7ddeda3",
      "blockNumber": "0x834a97",
      "gasUsed": "0xe9042",
      "effectiveGasPrice": "0x19e5b8",
      "from": "0x15759359e60a3b9e59ea7a96d10fa48829f83beb",
      "to": "0x58239c80a164e368e79177b89aaadb9641b9803f",
      "contractAddress": null
    }
  ],
  "libraries": [],
  "pending": [],
  "returns": {},
  "timestamp": 1750594477,
  "chain": 11155111,
  "commit": "0268293"
}


================================================
FILE: groth16/README.md
================================================
# Tokamak Groth16 zkSNARK Production Implementation

This directory contains a production-ready Groth16 zero-knowledge SNARK implementation for Tokamak's storage proof verification system, supporting up to 50 participants.

## Architecture

The circuit implements a quaternary Merkle tree using Poseidon4 hashing over the BLS12-381 curve to prove storage state consistency across channel participants.

## Generating Proofs with snarkjs

### Prerequisites

1. Install snarkjs globally:
```bash
npm install -g snarkjs
```

2. Ensure you have the required files:
   - Circuit WASM file: `circuits/build/merkle_tree_circuit_js/merkle_tree_circuit.wasm`
   - Final proving key: `trusted-setup/merkle_tree_circuit_final.zkey`
   - Verification key: `trusted-setup/verification_key.json`

### Input Format

Create an input JSON file with your Merkle tree data:

```json
{
  "merkle_keys": ["1", "2", "3", ...],
  "storage_values": ["100", "200", "300", ...]
}
```

**Note**: All arrays must contain exactly 50 elements (padded with zeros if needed).

### Generate a Proof

1. **Calculate witness**:
```bash
snarkjs wtns calculate circuits/build/merkle_tree_circuit_js/merkle_tree_circuit.wasm input.json witness.wtns
```
This generates `witness.wtns` - a binary file containing all the intermediate values (witness) computed by the circuit for your specific input.

2. **Generate the proof**:
```bash
snarkjs groth16 prove trusted-setup/merkle_tree_circuit_final.zkey witness.wtns proof.json public.json
```

This creates:
- `proof.json`: The zero-knowledge proof
- `public.json`: Public inputs/outputs

### Verify a Proof

Verify the proof using the verification key:

```bash
snarkjs groth16 verify trusted-setup/verification_key.json public.json proof.json
```

### Example Workflow

```bash
# 1. Create input file
echo '{
  "merkle_keys": ["1", "1", "1", ..., "1"],
  "storage_values": ["1", "1", "1", ..., "1"],
}' > input.json

# 2. Calculate witness
snarkjs wtns calculate circuits/build/merkle_tree_circuit_js/merkle_tree_circuit.wasm input.json witness.wtns

# 3. Generate proof
snarkjs groth16 prove trusted-setup/merkle_tree_circuit_final.zkey witness.wtns proof.json public.json

# 4. Verify proof
snarkjs groth16 verify trusted-setup/verification_key.json public.json proof.json
```

### Proof Format

The generated proof follows the Groth16 format for BLS12-381:

```json
{
  "pi_a": ["...", "...", "1"],
  "pi_b": [["...", "..."], ["...", "..."], ["1", "0"]],
  "pi_c": ["...", "...", "1"],
  "protocol": "groth16",
  "curve": "bls12381"
}
```

### Integration with Smart Contracts

The verification key and proofs are compatible with Ethereum smart contracts using the generated Solidity verifier:
- `trusted-setup/merkle_tree_verifier.sol`




================================================
FILE: groth16/CLAUDE.md
================================================
# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is the BLS12-Poseidon-Merkle-tree-Groth16 package, a production-ready Groth16 zero-knowledge SNARK implementation for Tokamak's storage proof verification system. The project implements a quaternary Merkle tree using Poseidon4 hashing over the BLS12-381 curve to prove storage state consistency across channel participants.

## Development Commands

### Circuit Development

```bash
# Navigate to circuits directory
cd circuits

# Compile circuit (N5 configuration for 1024 leaves)
npm run compile

# Run circuit tests
npm test

# Test specific circuit functionality
node test/circuit_test.js
```

### Proof Generation

```bash
# Navigate to specific leaf configuration directory
cd prover/64_leaves_groth  # or 16_leaves_groth, 32_leaves_groth, 128_leaves_groth

# Generate proof using existing script
node generateProof.js

# Generate witness manually with snarkjs
snarkjs wtns calculate ../../circuits/build/circuit_N6_js/circuit_N6.wasm input.json witness.wtns

# Generate proof manually with snarkjs
snarkjs groth16 prove ../../trusted-setup/64_leaves_vk/circuit_final.zkey witness.wtns proof.json public.json

# Verify proof
snarkjs groth16 verify ../../trusted-setup/64_leaves_vk/verification_key.json public.json proof.json
```

### Verifier Contract Development

```bash
# Navigate to verifier directory
cd verifier

# Build contracts
forge build

# Run all verifier tests
forge test

# Run specific test suite
forge test --match-path test/64_leaves/Groth16Verifier64LeavesTest.t.sol

# Run with verbose output
forge test -vv

# Deploy verifier contract (example)
forge create src/Groth16Verifier64Leaves.sol:Groth16Verifier64Leaves --constructor-args <IC_CONTRACT_ADDRESS>
```

## Architecture Overview

The project consists of four main components that work together to provide complete zkSNARK functionality:

### 1. Circuits (`circuits/`)
- **Parameterized Circom circuits** with configurable tree depth N (supports 4^N leaves)
- **Current configurations**: N4 (256 leaves), N5 (1024 leaves), N6 (4096 leaves), N7 (16384 leaves), N8 (65536 leaves)
- **Main template**: `TokamakStorageMerkleProof(N)` - computes Merkle root from split L2 public key coordinates
- **Core dependency**: `poseidon-bls12381-circom` for BLS12-381 optimized Poseidon hashing
- **Input format**: Split L2 public keys (x,y coordinates), storage slots, and values (4^N elements each)

### 2. Prover Scripts (`prover/`)
- **Organized by leaf count**: Separate directories for 16, 32, 64, 128 leaf configurations
- **Automated proof generation**: `generateProof.js` scripts that handle witness calculation and proof generation
- **Input examples**: `input_example.json` files showing proper data format for each configuration
- **snarkjs integration**: Uses snarkjs for witness calculation and Groth16 proof generation

### 3. Trusted Setup (`trusted-setup/`)
- **Powers of Tau ceremonies**: Pre-computed `pow_of_tau/` files for different constraint sizes (pow15-pow20)
- **Circuit-specific keys**: Separate verification keys and proving keys for each leaf configuration
- **Key files**: `circuit_final.zkey` (proving key) and `verification_key.json` for each configuration

### 4. Verifier Contracts (`verifier/`)
- **Solidity verifiers**: BLS12-381 compatible Groth16 verifiers for each leaf configuration
- **Foundry test suite**: Comprehensive tests for each verifier contract
- **Split verification key storage**: Constants split into PART1/PART2 for BLS12-381 48-byte field elements
- **IC (Input Commitment) contracts**: Separate contracts storing large IC arrays for gas optimization

## Circuit Configuration Guide

The circuits are parameterized by depth N, which determines capacity:

- **N=4**: 256 leaves (4^4) - Current production configuration
- **N=5**: 1024 leaves (4^5) - Default compile target
- **N=6**: 4096 leaves (4^6) - Large channels
- **N=7**: 16384 leaves (4^7) - Extra large channels  
- **N=8**: 65536 leaves (4^8) - Maximum supported

To change configuration:
1. Modify compile script in `circuits/package.json` to target desired `circuit_N*.circom`
2. Ensure corresponding trusted setup files exist in `trusted-setup/`
3. Use matching prover scripts in appropriate `*_leaves_groth/` directory

## Key Implementation Details

### Circuit Input Format
Each circuit expects exactly 4^N elements for each input array:
- `L2PublicKeys_x[4^N]`: X coordinates of L2 public keys  
- `L2PublicKeys_y[4^N]`: Y coordinates of L2 public keys
- `storage_slots[4^N]`: Storage slot identifiers for each leaf
- `storage_values[4^N]`: Storage values for each leaf

### Cryptographic Parameters
- **Curve**: BLS12-381 (254-bit scalar field)
- **Hash function**: Poseidon with 4 inputs, 128-bit security
- **Merkle tree**: Quaternary (4-way branching)
- **Privacy**: Merkle keys computed internally from public key coordinates and slots

### Performance Characteristics
- **Constraint count**: ~550K for N=4, scales as ~4^N Ã— 288 constraints
- **Proving time**: ~25s for N=4 configuration with 256 leaves
- **Memory usage**: ~2.5GB for N=4, scales with constraint count
- **Verification**: Constant ~83K gas regardless of leaf count

## File Organization

```
circuits/src/          # Circom circuit files (circuit_N4.circom to circuit_N8.circom)
prover/*/              # Proof generation scripts organized by leaf count
trusted-setup/*/       # Verification keys and proving keys by configuration
verifier/src/          # Solidity verifier contracts 
verifier/test/*/       # Foundry test suites organized by leaf count
```

## Testing Strategy

1. **Circuit tests**: Verify constraint satisfaction and output correctness
2. **Proof generation tests**: Ensure proofs can be generated for valid inputs
3. **Solidity verifier tests**: Test on-chain proof verification with real proof data
4. **Cross-validation**: Verify that circuit outputs match verifier expectations

## Common Development Workflows

### Adding New Circuit Configuration
1. Create new `circuit_N*.circom` file with desired N parameter
2. Add corresponding compile script to `circuits/package.json`
3. Generate trusted setup for new configuration
4. Create Solidity verifier contract
5. Add test suite for new verifier

### Updating Proof Generation
1. Modify input format in prover scripts
2. Update witness calculation paths
3. Ensure trusted setup files match circuit changes
4. Update verifier contract constants if needed

### Debugging Circuit Issues
1. Use `console.log` in circuit tests for signal inspection
2. Check constraint satisfaction with circom compiler warnings
3. Validate witness generation with known good inputs
4. Cross-reference with working configurations


================================================
FILE: groth16/convert_proof.py
================================================
#!/usr/bin/env python3
"""
Convert Groth16 proof from decimal to BLS12-381 format (PART1/PART2 split)
"""

import json
import sys

def split_field_element(value):
    """Split a field element into BLS12-381 48-byte format (PART1 with 32 zeros + 16 bytes, PART2 with 32 bytes)"""
    if isinstance(value, str):
        val = int(value)
    else:
        val = int(value)
    
    # Convert to hex (remove 0x prefix)
    hex_val = hex(val)[2:].zfill(96)  # Pad to 96 hex chars (48 bytes)
    
    # Split into high 16 bytes and low 32 bytes
    high_part = hex_val[:32]  # First 32 hex chars = 16 bytes
    low_part = hex_val[32:]   # Last 64 hex chars = 32 bytes
    
    # Add 16 zero bytes (32 hex chars) prefix to high part
    part1 = "0x" + "0" * 32 + high_part
    part2 = "0x" + low_part
    
    return part1, part2

def get_expected_signal_count(public_signals):
    """Determine expected signal count based on input size"""
    input_count = len(public_signals)
    
    # Map input sizes to expected test sizes based on actual needs
    if input_count <= 35:
        return 35  # 16-leaf
    elif input_count <= 68:  # 32-leaf public.json has 68, needs 67
        return 67  # 32-leaf  
    elif input_count <= 132:  # 64-leaf public.json has 132, needs 131
        return 131  # 64-leaf 
    else:  # 128-leaf public.json has 260, needs 259
        return 259  # 128-leaf

def pad_signals_for_test(public_signals, target_count):
    """Pad signals to match test expectations with zero padding"""
    input_count = len(public_signals)
    
    # Handle specific cases where we need to truncate
    if target_count == 67 and input_count >= 68:
        # 32-leaf: Remove the last element if we have 68+ values but need 67
        return public_signals[:67]
    elif target_count == 131 and input_count >= 132:
        # 64-leaf: Remove the last element if we have 132+ values but need 131
        return public_signals[:131]  
    elif target_count == 259 and input_count >= 260:
        # 128-leaf: Remove the last element if we have 260+ values but need 259
        return public_signals[:259]
    elif len(public_signals) >= target_count:
        return public_signals[:target_count]
    
    # Otherwise pad with zeros
    padded = list(public_signals)
    while len(padded) < target_count:
        padded.append("0")
    
    return padded

def convert_proof(proof_file, public_file):
    """Convert proof and public signals to Solidity test format"""
    
    # Load proof
    with open(proof_file, 'r') as f:
        proof = json.load(f)
    
    # Load public signals
    with open(public_file, 'r') as f:
        public_signals = json.load(f)
    
    # Convert pi_a (G1 point)
    pa_x_part1, pa_x_part2 = split_field_element(proof['pi_a'][0])
    pa_y_part1, pa_y_part2 = split_field_element(proof['pi_a'][1])
    
    # Convert pi_b (G2 point) - note: coordinates may need to be swapped
    pb_x0_part1, pb_x0_part2 = split_field_element(proof['pi_b'][0][1])  # x0 = second element
    pb_x1_part1, pb_x1_part2 = split_field_element(proof['pi_b'][0][0])  # x1 = first element
    pb_y0_part1, pb_y0_part2 = split_field_element(proof['pi_b'][1][1])  # y0 = second element  
    pb_y1_part1, pb_y1_part2 = split_field_element(proof['pi_b'][1][0])  # y1 = first element
    
    # Convert pi_c (G1 point)
    pc_x_part1, pc_x_part2 = split_field_element(proof['pi_c'][0])
    pc_y_part1, pc_y_part2 = split_field_element(proof['pi_c'][1])
    
    # Generate Solidity constants
    print("// Updated proof constants from prover proof.json")
    print(f"uint256 constant pA_x_PART1 = {pa_x_part1};")
    print(f"uint256 constant pA_x_PART2 = {pa_x_part2};")
    print(f"uint256 constant pA_y_PART1 = {pa_y_part1};")
    print(f"uint256 constant pA_y_PART2 = {pa_y_part2};")
    print()
    print(f"uint256 constant pB_x0_PART1 = {pb_x0_part1};")
    print(f"uint256 constant pB_x0_PART2 = {pb_x0_part2};")
    print(f"uint256 constant pB_x1_PART1 = {pb_x1_part1};")
    print(f"uint256 constant pB_x1_PART2 = {pb_x1_part2};")
    print()
    print(f"uint256 constant pB_y0_PART1 = {pb_y0_part1};")
    print(f"uint256 constant pB_y0_PART2 = {pb_y0_part2};")
    print(f"uint256 constant pB_y1_PART1 = {pb_y1_part1};")
    print(f"uint256 constant pB_y1_PART2 = {pb_y1_part2};")
    print()
    print(f"uint256 constant pC_x_PART1 = {pc_x_part1};")
    print(f"uint256 constant pC_x_PART2 = {pc_x_part2};")
    print(f"uint256 constant pC_y_PART1 = {pc_y_part1};")
    print(f"uint256 constant pC_y_PART2 = {pc_y_part2};")
    print()
    
    # Determine target signal count and apply padding
    target_count = get_expected_signal_count(public_signals)
    padded_signals = pad_signals_for_test(public_signals, target_count)
    
    # Generate public signals array
    print(f"// Public signals from public.json ({len(public_signals)} values, padded to {target_count})")
    print(f"uint256[{target_count}] memory _pubSignals = [")
    for i, signal in enumerate(padded_signals):
        comma = "," if i < len(padded_signals) - 1 else ""
        print(f"    uint256({signal}){comma}")
    print("];")
    print()

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python convert_proof.py <proof.json> <public.json>")
        sys.exit(1)
    
    convert_proof(sys.argv[1], sys.argv[2])


================================================
FILE: groth16/circuits/README.md
================================================
# Tokamak Groth16 Merkle Tree Circuit
## Overview

This document provides comprehensive technical documentation for the Tokamak Groth16 zero-knowledge circuit implementation in `circuit.circom`. The circuit is **parameterized by tree depth N** and enables efficient Merkle root computation for channel initialization in the Tokamak zkEVM with **variable participant capacity**.

## System Design

### Channel Initialization Workflow

The circuit serves a specific purpose in the Tokamak channel opening process:

1. **Channel Leader** requests onchain verifiers to open a channel
2. **Onchain Verifiers** possess integrity-guaranteed MPT keys and values from previous onchain blocks
3. **Channel Leader** computes Merkle root off-chain and generates Groth16 proof
4. **Onchain Verifiers** verify the proof to confirm honest root computation

### Verifier Interface

**Inputs**: 
- Split L2 public key coordinates (x, y) for each leaf
- Per-leaf storage slot identifiers
- Storage values for each leaf
- ZKP (Groth16 proof)

**Output**: Computed Merkle root
**Tree Capacity**: 4^N leaves (configurable at compile-time)

### Circuit Architecture

```
Public Inputs (4^N Ã— 4)                                              Parameterized Circuit Components
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ L2PublicKeys_x[4^N] â”‚           â”‚ merkle_root         â”‚             â”‚   Merkle Key Computation    â”‚
â”‚ L2PublicKeys_y[4^N] â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ (output)            â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚
â”‚ storage_slots[4^N]  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ Poseidon4(L2PublicKey_x,    â”‚
â”‚ storage_values[4^N] â”‚                                               â”‚   L2PublicKey_y,            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚   storage_slot, 0)          â”‚
                                                                      â”‚ â†’ computed_merkle_key       â”‚
Integrity-guaranteed from                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
onchain blocks                                                                     â”‚
                                                                                   â–¼
                                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                        â”‚   Leaf Computation          â”‚
                                                                        â”‚                             â”‚
                                                                        â”‚ Poseidon4(leaf_index,       â”‚
                                                                        â”‚   computed_merkle_key,      â”‚
                                                                        â”‚   storage_value, 0)         â”‚
                                                                        â”‚ â†’ leaf_hash                 â”‚
                                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                                     â”‚
                                                                                     â–¼
                                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                        â”‚ Poseidon4MerkleTree(N)      â”‚
                                                                        â”‚                             â”‚
                                                                        â”‚ Dynamic levels: N depth     â”‚
                                                                        â”‚ Capacity: 4^N leaves        â”‚
                                                                        â”‚ N=4: 256 leaves [CURRENT]   â”‚
                                                                        â”‚ 4-way branching factor      â”‚
                                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                                     â”‚
                                                                                     â–¼
                                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                        â”‚ Computed Root               â”‚
                                                                        â”‚ (Circuit Output)            â”‚
                                                                        â”‚                             â”‚
                                                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Core Components

The circuit consists of two main parameterized templates that work together to compute Merkle roots:

### 1. Poseidon4MerkleTree(N)

**Purpose**: Constructs an N-level parameterized quaternary Merkle tree for 4^N leaves

```circom
template Poseidon4MerkleTree(N) {
    var nLeaves = 4 ** N;
    signal input leaves[nLeaves];
    signal output root;
    
    // Calculate total components needed across all levels
    var totalComponents = 0;
    var temp = nLeaves;
    for (var level = 0; level < N; level++) {
        temp = temp \ 4;
        totalComponents += temp;
    }
    
    component hashers[totalComponents];
    signal levelOutputs[N][nLeaves \ 4];
    
    // Dynamic tree construction for N levels
    var componentIndex = 0;
    var currentLevelSize = nLeaves;
    
    for (var level = 0; level < N; level++) {
        var nextLevelSize = currentLevelSize \ 4;
        
        for (var i = 0; i < nextLevelSize; i++) {
            hashers[componentIndex] = Poseidon255(4);
            
            if (level == 0) {
                // First level: use input leaves
                hashers[componentIndex].in[0] <== leaves[i*4 + 0];
                hashers[componentIndex].in[1] <== leaves[i*4 + 1];
                hashers[componentIndex].in[2] <== leaves[i*4 + 2];
                hashers[componentIndex].in[3] <== leaves[i*4 + 3];
            } else {
                // Subsequent levels: use previous level outputs
                hashers[componentIndex].in[0] <== levelOutputs[level-1][i*4 + 0];
                hashers[componentIndex].in[1] <== levelOutputs[level-1][i*4 + 1];
                hashers[componentIndex].in[2] <== levelOutputs[level-1][i*4 + 2];
                hashers[componentIndex].in[3] <== levelOutputs[level-1][i*4 + 3];
            }
            
            levelOutputs[level][i] <== hashers[componentIndex].out;
            componentIndex++;
        }
        
        currentLevelSize = nextLevelSize;
    }
    
    // Root is the single output from the last level
    root <== levelOutputs[N-1][0];
}
```

**Parameterized Tree Structure**:
```
For N=4 (current configuration): 4â´ = 256 leaves

Level 3:                    Root (1 node)
                         /   |   |   \
Level 2:               4 nodes
                    / | | \ ... / | | \
Level 1:           16 nodes  
                / | | \ ...  / | | \
Level 0:       64 nodes (256â†’64 reduction)
            / | | \ ...   / | | \
Leaves:   256 leaf positions

Capacity: 4^N leaves (configurable)
Depth: N levels (configurable)
Branching factor: 4 (constant)

Common configurations:
- N=2: 16 leaves (small channels)
- N=3: 64 leaves (medium channels)  
- N=4: 256 leaves (large channels) [CURRENT]
- N=5: 1024 leaves (extra large channels)
```

### 2. TokamakStorageMerkleProof(N)

**Purpose**: Main parameterized circuit that computes Merkle root from split L2 public key coordinates, per-leaf storage slots, and values

```circom
template TokamakStorageMerkleProof(N) {
    var nLeaves = 4 ** N;
    
    // Public inputs - Split L2 coordinates and per-leaf data
    signal input L2PublicKeys_x[nLeaves];      // X coordinates of L2 public keys
    signal input L2PublicKeys_y[nLeaves];      // Y coordinates of L2 public keys
    signal input storage_slots[nLeaves];       // Storage slot for each leaf
    signal input storage_values[nLeaves];      // Storage values
    
    // Public output - the computed Merkle root
    signal output merkle_root;
    
    // Step 1: Compute merkle_keys for each leaf
    // merkle_key = poseidon4(L2PublicKey_x, L2PublicKey_y, storage_slot, 0)
    component merkle_key_hash[nLeaves];
    signal computed_merkle_keys[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_key_hash[i] = Poseidon255(4);
        merkle_key_hash[i].in[0] <== L2PublicKeys_x[i];
        merkle_key_hash[i].in[1] <== L2PublicKeys_y[i];
        merkle_key_hash[i].in[2] <== storage_slots[i];
        merkle_key_hash[i].in[3] <== 0;  // Zero pad
        computed_merkle_keys[i] <== merkle_key_hash[i].out;
    }
    
    // Step 2: Compute final leaves
    // leaf = poseidon4(index, computed_merkle_key, storage_value, 0)
    component leaf_hash[nLeaves];
    signal leaf_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        leaf_hash[i] = Poseidon255(4);
        leaf_hash[i].in[0] <== i;                         // Leaf index
        leaf_hash[i].in[1] <== computed_merkle_keys[i];   // Computed MPT key
        leaf_hash[i].in[2] <== storage_values[i];         // Storage value
        leaf_hash[i].in[3] <== 0;                         // Zero pad
        leaf_values[i] <== leaf_hash[i].out;
    }
    
    // Step 3: Compute Merkle tree
    component merkle_tree = Poseidon4MerkleTree(N);
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_tree.leaves[i] <== leaf_values[i];
    }
    
    // Output the computed root
    merkle_root <== merkle_tree.root;
}

// Example configurations:
// N=2: 16 leaves, 64 public inputs
// N=3: 64 leaves, 256 public inputs  
// N=4: 256 leaves, 1024 public inputs [CURRENT]
// N=5: 1024 leaves, 4096 public inputs

component main{public [L2PublicKeys_x, L2PublicKeys_y, storage_slots, storage_values]} = TokamakStorageMerkleProof(4);
```

**Processing Flow**:
1. **Merkle Key Computation**: Compute MPT keys using `poseidon4(L2PublicKey_x, L2PublicKey_y, storage_slot, 0)` for each leaf
2. **Leaf Computation**: Convert 4^N (index, computed_merkle_key, value) tuples â†’ Poseidon4 hashes
3. **Tree Construction**: Build N-level parameterized quaternary tree from 4^N leaves
4. **Root Output**: Output the computed Merkle root

**Key Features**:
- **Split coordinate inputs**: L2 public keys split into x,y coordinates for better field element representation
- **Per-leaf storage slots**: Each leaf can have different storage slot (maximum flexibility)
- **Parameterized capacity**: Tree depth N determines leaf count (4^N)
- **Internal key derivation**: MPT keys computed from coordinate pairs and storage slots
- **Direct root output**: Circuit outputs the computed Merkle root
- **Privacy preserving**: MPT keys are not exposed as public inputs
- **Compile-time configuration**: Change N parameter for different channel sizes

## Cryptographic Implementation

### External Poseidon BLS12-381 Library

**Library**: `poseidon-bls12381-circom` provides optimized Poseidon implementation

**Parameters**:
- **Curve**: BLS12-381 scalar field  
- **Field size**: 255 bits (p = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001)
- **Template**: `Poseidon255(4)` for 4-input hash function
- **Security**: 128-bit security level

**Advantages of External Library**:
- **Proven implementation**: Tested and optimized by the community
- **Reduced complexity**: Eliminates custom constant generation and round logic
- **Maintainability**: Updates and security patches handled by library authors
- **Smaller codebase**: Circuit focuses only on Merkle tree logic

## Circuit Constraints

### Constraint Analysis

**Current Constraints** (N=4 configuration):
- **Non-linear constraints**: 171,936
- **Linear constraints**: 382,080
- **Total constraints**: ~554,016
- **Template instances**: 69
- **Public inputs**: 1,024 (256 x-coords + 256 y-coords + 256 slots + 256 values)
- **Private inputs**: 0 (all inputs are public for transparency)
- **Tree capacity**: 256 leaves (4^4)

**Breakdown by Component**:

| Component | Usage | Description |
|-----------|--------|-------------|
| **Merkle key computation** | 4^N Poseidon255(4) instances | Hash (L2PublicKey_x, L2PublicKey_y, storage_slot, 0) into merkle_keys |
| **Leaf computation** | 4^N Poseidon255(4) instances | Hash (index, computed_merkle_key, value, 0) into leaves |
| **Poseidon4MerkleTree(N)** | Variable Poseidon255(4) instances | Build N-level quaternary tree |
| **Root output** | Direct assignment | Output computed root as circuit result |

**For N=4 (current configuration)**:
- **256 merkle key computations** + **256 leaf computations** + **85 tree nodes** = **597 total Poseidon instances**

**Total Poseidon instances**: 121 Ã— `Poseidon255(4)` from external library (50 key computation + 50 leaf computation + 21 tree construction)
**Enhanced privacy**: Merkle keys computed internally instead of being public inputs.

## Performance Metrics

### Compilation Statistics

```
Circuit: circuit.circom
Configuration: N=4 (parameterized)
Curve: BLS12-381
Circom version: 2.0.0
R1CS file size: ~91MB
Number of wires: 555,041
Number of labels: 998,444
Template instances: 69
Non-linear constraints: 171,936
Linear constraints: 382,080
Total constraints: 554,016
Tree capacity: 256 leaves (4^4)
Public inputs: 1,024 (256Ã—4: x-coords + y-coords + slots + values)
Private inputs: 0 (all inputs public for transparency)
Compilation time: <2 seconds
Merkle key format: poseidon4(L2PublicKey_x, L2PublicKey_y, storage_slot, 0)
Leaf format: poseidon4(index, computed_merkle_key, value, 0)
```

### Runtime Performance

**Proving Performance** (N=4 configuration):
- **Witness generation**: ~800ms-1.5s (due to 597 Poseidon instances)
- **Proof generation**: ~15-30 seconds (due to 554K constraints)
- **Memory usage**: ~2-3GB (due to large R1CS and 256-leaf capacity)
- **Proof size**: 128 bytes (unchanged - Groth16 constant)

**Verification Performance**:
- **On-chain gas cost**: ~83,000 gas (unchanged - verifier contract same)
- **Verification time**: ~5ms (unchanged)
- **Constant cost**: Independent of actual participant count (â‰¤256 participants)

**Scalability by Configuration**:

| N | Leaves | Constraints | Proving Time | Memory | Use Case |
|---|--------|-------------|--------------|--------|-----------|
| 2 | 16 | ~35K | ~2s | ~200MB | Small channels |
| 3 | 64 | ~140K | ~8s | ~800MB | Medium channels |
| 4 | 256 | ~550K | ~25s | ~2.5GB | Large channels [CURRENT] |
| 5 | 1024 | ~2.2M | ~100s | ~10GB | Extra large channels |


## Running Tests

```bash
# Compile the circuit with BLS12-381 curve
npm run compile

# Run comprehensive circuit tests
npm test

# Run individual test suites
node test/circuit_test.js      # Parameterized circuit functionality test

# The tests verify:
# - Circuit compilation with BLS12-381 curve and parameterized design
# - Merkle key computation from split L2 coordinates and per-leaf storage slots
# - Merkle root computation with variable tree depths
# - Circuit output consistency and determinism
# - Correct response to different coordinate and storage slot combinations
# - Parameterized tree construction for different N values
```


## Security Analysis

### Threat Model

The circuit defends against:

1. **Malicious prover attacks**:
   - False storage states
   - Invalid Merkle tree construction
   - Root forgery attempts

2. **Cryptanalytic attacks**:
   - Hash collision attacks
   - Preimage attacks
   - Algebraic constraint manipulation

### Security Guarantees

**Soundness**: Probability of accepting invalid proof â‰¤ 2â»Â¹Â²â¸

**Zero-knowledge**: Proof reveals no information about private inputs beyond their validity

**Completeness**: Valid storage states always produce valid proofs

## Implementation Files

### Updated Core Files

```
circuits/src/
â””â”€â”€ circuit.circom                          # CURRENT: Parameterized circuit with tree depth N
                                           # Supports split L2 coordinates and per-leaf storage slots
                                           # Configurable: TokamakStorageMerkleProof(N)
                                           # Current: N=4 (256 leaves, 1024 public inputs)

node_modules/poseidon-bls12381-circom/
â”œâ”€â”€ circuits/poseidon255.circom              # External Poseidon BLS12-381 implementation
â””â”€â”€ circuits/poseidon255_constants.circom    # External constants for BLS12-381 curve

test/
â””â”€â”€ circuit_test.js                         # Parameterized circuit functionality test
                                           # Tests N=4 configuration with 256 leaf capacity
                                           # Verifies split coordinates and per-leaf slots

build/
â”œâ”€â”€ circuit.r1cs                            # Compiled constraint system (91MB)
â”œâ”€â”€ circuit.sym                             # Symbol table
â””â”€â”€ circuit_js/                             # JavaScript witness generation
    â”œâ”€â”€ circuit.wasm                        # WebAssembly witness calculator
    â””â”€â”€ witness_calculator.js               # JavaScript interface

package.json                                # Updated for parameterized compilation
```

### Key Dependencies

```json
{
  "dependencies": {
    "circomlib": "^2.0.5",
    "poseidon-bls12381-circom": "^1.0.0"
  },
  "devDependencies": {
    "circom_tester": "^0.0.19"
  }
}
```

## Future Enhancements

### Immediate Next Steps

1. **Trusted Setup**: Generate proving/verification keys
2. **Solidity Verifier**: Deploy on-chain verification contract
3. **Integration**: Connect with Tokamak bridge system

### Long-term Optimizations

1. **Constraint Optimization**: Optimize Poseidon implementations to reduce constraint count
2. **Dynamic Batching**: Support multiple smaller proofs in one large tree
3. **Recursive Composition**: Aggregate multiple channel proofs using proof recursion
4. **Universal Setup**: Consider PLONK migration for universal setup benefits
5. **Hardware Acceleration**: Optimize for GPU proving with larger configurations

## Conclusion

The parameterized Tokamak Groth16 Merkle tree circuit (`circuit.circom`) provides production-ready zero-knowledge Merkle root computation for channel initialization:

### **Current Status: âœ… PRODUCTION READY**

- **Parameterized Design**: Tree depth N configurable at compile-time (4^N leaf capacity)
- **Current Configuration**: N=4 supporting 256 leaves with 1,024 public inputs
- **Split Coordinate Support**: L2 public keys represented as (x,y) coordinate pairs
- **Per-Leaf Storage Slots**: Maximum flexibility with individual slot assignment
- **554,016 total constraints** (171,936 non-linear + 382,080 linear) for N=4
- **128-bit security** via external `poseidon-bls12381-circom` library on BLS12-381 curve
- **Enhanced privacy**: Merkle keys computed internally from coordinates and slots
- **Scalable architecture**: Easy reconfiguration for different channel sizes

### **Latest Updates (âœ… Parameterized Design Complete)**:
âœ… **Parameterized tree depth** - Tree capacity configurable via N parameter (4^N leaves)
âœ… **Split L2 coordinates** - Public keys represented as separate x,y field elements
âœ… **Per-leaf storage slots** - Individual storage slot assignment for maximum flexibility
âœ… **Enhanced scalability** - Multiple configurations from 16 to 1024+ leaves
âœ… **Optimized for large channels** - N=4 configuration supports 256 participants
âœ… **Clean codebase** - Single parameterized circuit replaces multiple fixed variants  

### **Test Coverage**:
- **Parameterized circuit functionality**: âœ… Passed (N=4 with 256-leaf capacity)
- **Split coordinate support**: âœ… Passed (x,y coordinate processing)
- **Per-leaf storage slots**: âœ… Passed (individual slot assignment)
- **Large-scale testing**: âœ… Passed (256 leaves, 1024 public inputs)
- **Consistency verification**: âœ… Passed (deterministic output for same inputs)
- **Configuration flexibility**: âœ… Verified (easy N parameter changes)

The implementation is **fully tested and ready** for trusted setup and deployment in the Tokamak channel initialization system.


================================================
FILE: groth16/circuits/circom-2.0
================================================
[Binary file]


================================================
FILE: groth16/circuits/package.json
================================================
{
  "name": "tokamak-groth16-circuits",
  "version": "1.0.0",
  "description": "Groth16 circuits for Tokamak zkEVM storage proof verification",
  "scripts": {
    "compile": "./circom-2.0 src/circuit_N8.circom --r1cs --wasm --sym --output ./build/ --prime bls12381"
  },
  "dependencies": {
    "chai": "^6.2.0",
    "circomlib": "^2.0.5",
    "circomlibjs": "^0.1.7",
    "mocha": "^11.7.5",
    "poseidon-bls12381-circom": "^1.0.0",
    "snarkjs": "^0.7.5"
  },
  "devDependencies": {
    "circom_tester": "^0.0.19"
  },
  "author": "Tokamak Network",
  "license": "MIT"
}



================================================
FILE: groth16/circuits/src/circuit_N4.circom
================================================
pragma circom 2.0.0;

include "../node_modules/poseidon-bls12381-circom/circuits/poseidon255.circom";

// Parameterized Poseidon Merkle Tree based on tree depth N
// Tree capacity: 2^N leaves
template Poseidon2MerkleTree(N) {
    var nLeaves = 2 ** N;
    signal input leaves[nLeaves];
    signal output root;
    
    // Calculate total number of components needed across all levels
    var totalComponents = 0;
    var temp = nLeaves;
    for (var level = 0; level < N; level++) {
        temp = temp \ 2;
        totalComponents += temp;
    }
    
    component hashers[totalComponents];
    
    // Signals to store outputs for each level
    signal levelOutputs[N][nLeaves \ 2];
    
    var componentIndex = 0;
    var currentLevelSize = nLeaves;
    
    for (var level = 0; level < N; level++) {
        var nextLevelSize = currentLevelSize \ 2;
        
        for (var i = 0; i < nextLevelSize; i++) {
            hashers[componentIndex] = Poseidon255(2);
            
            if (level == 0) {
                // First level: use input leaves
                hashers[componentIndex].in[0] <== leaves[i*2 + 0];
                hashers[componentIndex].in[1] <== leaves[i*2 + 1];
            } else {
                // Subsequent levels: use previous level outputs
                hashers[componentIndex].in[0] <== levelOutputs[level-1][i*2 + 0];
                hashers[componentIndex].in[1] <== levelOutputs[level-1][i*2 + 1];
            }
            
            levelOutputs[level][i] <== hashers[componentIndex].out;
            componentIndex++;
        }
        
        currentLevelSize = nextLevelSize;
    }
    
    // Root is the single output from the last level
    root <== levelOutputs[N-1][0];
}

// Parameterized Tokamak Storage Merkle Proof based on tree depth N
template TokamakStorageMerkleProof(N) {
    var nLeaves = 2 ** N;
    
    // Public inputs - Fixed prefix, contract address, L2MPT storage keys and values
    signal input fixed_prefix;                 // Fixed prefix for contract identification
    signal input contract_address;             // Contract address
    signal input storage_keys_L2MPT[nLeaves];  // L2MPT storage keys
    signal input storage_values[nLeaves];      // Storage values
    
    // Public output - the computed Merkle root
    signal output merkle_root;
    
    // Step 1: Compute contract identifier
    // contract_id = poseidon2(fixed_prefix, contract_address)
    component contract_id_hash = Poseidon255(2);
    contract_id_hash.in[0] <== fixed_prefix;
    contract_id_hash.in[1] <== contract_address;
    signal contract_id <== contract_id_hash.out;
    
    // Step 2: Compute intermediate leaf values
    // intermediate = poseidon2(storage_key_L2MPT, storage_value)
    component intermediate_hash[nLeaves];
    signal intermediate_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        intermediate_hash[i] = Poseidon255(2);
        intermediate_hash[i].in[0] <== storage_keys_L2MPT[i];
        intermediate_hash[i].in[1] <== storage_values[i];
        intermediate_values[i] <== intermediate_hash[i].out;
    }
    
    // Step 3: Compute final leaves
    // leaf = poseidon2(contract_id, intermediate_value)
    component leaf_hash[nLeaves];
    signal leaf_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        leaf_hash[i] = Poseidon255(2);
        leaf_hash[i].in[0] <== contract_id;
        leaf_hash[i].in[1] <== intermediate_values[i];
        leaf_values[i] <== leaf_hash[i].out;
    }
    
    // Step 4: Compute Merkle tree
    component merkle_tree = Poseidon2MerkleTree(N);
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_tree.leaves[i] <== leaf_values[i];
    }
    
    // Output the computed root
    merkle_root <== merkle_tree.root;
}

// Example configurations:
// N=2: 2^2 = 4 leaves   (suitable for small channels)
// N=3: 2^3 = 8 leaves   (suitable for medium channels)  
// N=4: 2^4 = 16 leaves  (suitable for large channels)

// Change this line to configure for different tree depths:
component main{public [fixed_prefix, contract_address, storage_keys_L2MPT, storage_values]} = TokamakStorageMerkleProof(4);

// Tree depth N=4 gives us 16 leaves, which can support:
// - 16 users with 1 storage slot each, OR
// - 8 users with 2 storage slots each, OR
// - 4 users with 4 storage slots each, OR
// - 2 users with 8 storage slots each, OR
// - 1 user with 16 storage slots


================================================
FILE: groth16/circuits/src/circuit_N5.circom
================================================
pragma circom 2.0.0;

include "../node_modules/poseidon-bls12381-circom/circuits/poseidon255.circom";

// Parameterized Poseidon Merkle Tree based on tree depth N
// Tree capacity: 2^N leaves
template Poseidon2MerkleTree(N) {
    var nLeaves = 2 ** N;
    signal input leaves[nLeaves];
    signal output root;
    
    // Calculate total number of components needed across all levels
    var totalComponents = 0;
    var temp = nLeaves;
    for (var level = 0; level < N; level++) {
        temp = temp \ 2;
        totalComponents += temp;
    }
    
    component hashers[totalComponents];
    
    // Signals to store outputs for each level
    signal levelOutputs[N][nLeaves \ 2];
    
    var componentIndex = 0;
    var currentLevelSize = nLeaves;
    
    for (var level = 0; level < N; level++) {
        var nextLevelSize = currentLevelSize \ 2;
        
        for (var i = 0; i < nextLevelSize; i++) {
            hashers[componentIndex] = Poseidon255(2);
            
            if (level == 0) {
                // First level: use input leaves
                hashers[componentIndex].in[0] <== leaves[i*2 + 0];
                hashers[componentIndex].in[1] <== leaves[i*2 + 1];
            } else {
                // Subsequent levels: use previous level outputs
                hashers[componentIndex].in[0] <== levelOutputs[level-1][i*2 + 0];
                hashers[componentIndex].in[1] <== levelOutputs[level-1][i*2 + 1];
            }
            
            levelOutputs[level][i] <== hashers[componentIndex].out;
            componentIndex++;
        }
        
        currentLevelSize = nextLevelSize;
    }
    
    // Root is the single output from the last level
    root <== levelOutputs[N-1][0];
}

// Parameterized Tokamak Storage Merkle Proof based on tree depth N
template TokamakStorageMerkleProof(N) {
    var nLeaves = 2 ** N;
    
    // Public inputs - Fixed prefix, contract address, L2MPT storage keys and values
    signal input fixed_prefix;                 // Fixed prefix for contract identification
    signal input contract_address;             // Contract address
    signal input storage_keys_L2MPT[nLeaves];  // L2MPT storage keys
    signal input storage_values[nLeaves];      // Storage values
    
    // Public output - the computed Merkle root
    signal output merkle_root;
    
    // Step 1: Compute contract identifier
    // contract_id = poseidon2(fixed_prefix, contract_address)
    component contract_id_hash = Poseidon255(2);
    contract_id_hash.in[0] <== fixed_prefix;
    contract_id_hash.in[1] <== contract_address;
    signal contract_id <== contract_id_hash.out;
    
    // Step 2: Compute intermediate leaf values
    // intermediate = poseidon2(storage_key_L2MPT, storage_value)
    component intermediate_hash[nLeaves];
    signal intermediate_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        intermediate_hash[i] = Poseidon255(2);
        intermediate_hash[i].in[0] <== storage_keys_L2MPT[i];
        intermediate_hash[i].in[1] <== storage_values[i];
        intermediate_values[i] <== intermediate_hash[i].out;
    }
    
    // Step 3: Compute final leaves
    // leaf = poseidon2(contract_id, intermediate_value)
    component leaf_hash[nLeaves];
    signal leaf_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        leaf_hash[i] = Poseidon255(2);
        leaf_hash[i].in[0] <== contract_id;
        leaf_hash[i].in[1] <== intermediate_values[i];
        leaf_values[i] <== leaf_hash[i].out;
    }
    
    // Step 4: Compute Merkle tree
    component merkle_tree = Poseidon2MerkleTree(N);
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_tree.leaves[i] <== leaf_values[i];
    }
    
    // Output the computed root
    merkle_root <== merkle_tree.root;
}

// Example configurations:
// N=2: 2^2 = 4 leaves   (suitable for small channels)
// N=3: 2^3 = 8 leaves   (suitable for medium channels)  
// N=4: 2^4 = 16 leaves  (suitable for large channels)

// Change this line to configure for different tree depths:
component main{public [fixed_prefix, contract_address, storage_keys_L2MPT, storage_values]} = TokamakStorageMerkleProof(5);

// Tree depth N=5 gives us 32 leaves, which can support:
// - 16 users with 1 storage slot each, OR
// - 8 users with 2 storage slots each, OR
// - 4 users with 4 storage slots each, OR
// - 2 users with 8 storage slots each, OR
// - 1 user with 16 storage slots


================================================
FILE: groth16/circuits/src/circuit_N6.circom
================================================
pragma circom 2.0.0;

include "../node_modules/poseidon-bls12381-circom/circuits/poseidon255.circom";

// Parameterized Poseidon Merkle Tree based on tree depth N
// Tree capacity: 2^N leaves
template Poseidon2MerkleTree(N) {
    var nLeaves = 2 ** N;
    signal input leaves[nLeaves];
    signal output root;
    
    // Calculate total number of components needed across all levels
    var totalComponents = 0;
    var temp = nLeaves;
    for (var level = 0; level < N; level++) {
        temp = temp \ 2;
        totalComponents += temp;
    }
    
    component hashers[totalComponents];
    
    // Signals to store outputs for each level
    signal levelOutputs[N][nLeaves \ 2];
    
    var componentIndex = 0;
    var currentLevelSize = nLeaves;
    
    for (var level = 0; level < N; level++) {
        var nextLevelSize = currentLevelSize \ 2;
        
        for (var i = 0; i < nextLevelSize; i++) {
            hashers[componentIndex] = Poseidon255(2);
            
            if (level == 0) {
                // First level: use input leaves
                hashers[componentIndex].in[0] <== leaves[i*2 + 0];
                hashers[componentIndex].in[1] <== leaves[i*2 + 1];
            } else {
                // Subsequent levels: use previous level outputs
                hashers[componentIndex].in[0] <== levelOutputs[level-1][i*2 + 0];
                hashers[componentIndex].in[1] <== levelOutputs[level-1][i*2 + 1];
            }
            
            levelOutputs[level][i] <== hashers[componentIndex].out;
            componentIndex++;
        }
        
        currentLevelSize = nextLevelSize;
    }
    
    // Root is the single output from the last level
    root <== levelOutputs[N-1][0];
}

// Parameterized Tokamak Storage Merkle Proof based on tree depth N
template TokamakStorageMerkleProof(N) {
    var nLeaves = 2 ** N;
    
    // Public inputs - Fixed prefix, contract address, L2MPT storage keys and values
    signal input fixed_prefix;                 // Fixed prefix for contract identification
    signal input contract_address;             // Contract address
    signal input storage_keys_L2MPT[nLeaves];  // L2MPT storage keys
    signal input storage_values[nLeaves];      // Storage values
    
    // Public output - the computed Merkle root
    signal output merkle_root;
    
    // Step 1: Compute contract identifier
    // contract_id = poseidon2(fixed_prefix, contract_address)
    component contract_id_hash = Poseidon255(2);
    contract_id_hash.in[0] <== fixed_prefix;
    contract_id_hash.in[1] <== contract_address;
    signal contract_id <== contract_id_hash.out;
    
    // Step 2: Compute intermediate leaf values
    // intermediate = poseidon2(storage_key_L2MPT, storage_value)
    component intermediate_hash[nLeaves];
    signal intermediate_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        intermediate_hash[i] = Poseidon255(2);
        intermediate_hash[i].in[0] <== storage_keys_L2MPT[i];
        intermediate_hash[i].in[1] <== storage_values[i];
        intermediate_values[i] <== intermediate_hash[i].out;
    }
    
    // Step 3: Compute final leaves
    // leaf = poseidon2(contract_id, intermediate_value)
    component leaf_hash[nLeaves];
    signal leaf_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        leaf_hash[i] = Poseidon255(2);
        leaf_hash[i].in[0] <== contract_id;
        leaf_hash[i].in[1] <== intermediate_values[i];
        leaf_values[i] <== leaf_hash[i].out;
    }
    
    // Step 4: Compute Merkle tree
    component merkle_tree = Poseidon2MerkleTree(N);
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_tree.leaves[i] <== leaf_values[i];
    }
    
    // Output the computed root
    merkle_root <== merkle_tree.root;
}

// Example configurations:
// N=2: 2^2 = 4 leaves   (suitable for small channels)
// N=3: 2^3 = 8 leaves   (suitable for medium channels)  
// N=4: 2^4 = 16 leaves  (suitable for large channels)

// Change this line to configure for different tree depths:
component main{public [fixed_prefix, contract_address, storage_keys_L2MPT, storage_values]} = TokamakStorageMerkleProof(6);

// Tree depth N=6 gives us 64 leaves, which can support:
// - 16 users with 1 storage slot each, OR
// - 8 users with 2 storage slots each, OR
// - 4 users with 4 storage slots each, OR
// - 2 users with 8 storage slots each, OR
// - 1 user with 16 storage slots


================================================
FILE: groth16/circuits/src/circuit_N7.circom
================================================
pragma circom 2.0.0;

include "../node_modules/poseidon-bls12381-circom/circuits/poseidon255.circom";

// Parameterized Poseidon Merkle Tree based on tree depth N
// Tree capacity: 2^N leaves
template Poseidon2MerkleTree(N) {
    var nLeaves = 2 ** N;
    signal input leaves[nLeaves];
    signal output root;
    
    // Calculate total number of components needed across all levels
    var totalComponents = 0;
    var temp = nLeaves;
    for (var level = 0; level < N; level++) {
        temp = temp \ 2;
        totalComponents += temp;
    }
    
    component hashers[totalComponents];
    
    // Signals to store outputs for each level
    signal levelOutputs[N][nLeaves \ 2];
    
    var componentIndex = 0;
    var currentLevelSize = nLeaves;
    
    for (var level = 0; level < N; level++) {
        var nextLevelSize = currentLevelSize \ 2;
        
        for (var i = 0; i < nextLevelSize; i++) {
            hashers[componentIndex] = Poseidon255(2);
            
            if (level == 0) {
                // First level: use input leaves
                hashers[componentIndex].in[0] <== leaves[i*2 + 0];
                hashers[componentIndex].in[1] <== leaves[i*2 + 1];
            } else {
                // Subsequent levels: use previous level outputs
                hashers[componentIndex].in[0] <== levelOutputs[level-1][i*2 + 0];
                hashers[componentIndex].in[1] <== levelOutputs[level-1][i*2 + 1];
            }
            
            levelOutputs[level][i] <== hashers[componentIndex].out;
            componentIndex++;
        }
        
        currentLevelSize = nextLevelSize;
    }
    
    // Root is the single output from the last level
    root <== levelOutputs[N-1][0];
}

// Parameterized Tokamak Storage Merkle Proof based on tree depth N
template TokamakStorageMerkleProof(N) {
    var nLeaves = 2 ** N;
    
    // Public inputs - Fixed prefix, contract address, L2MPT storage keys and values
    signal input fixed_prefix;                 // Fixed prefix for contract identification
    signal input contract_address;             // Contract address
    signal input storage_keys_L2MPT[nLeaves];  // L2MPT storage keys
    signal input storage_values[nLeaves];      // Storage values
    
    // Public output - the computed Merkle root
    signal output merkle_root;
    
    // Step 1: Compute contract identifier
    // contract_id = poseidon2(fixed_prefix, contract_address)
    component contract_id_hash = Poseidon255(2);
    contract_id_hash.in[0] <== fixed_prefix;
    contract_id_hash.in[1] <== contract_address;
    signal contract_id <== contract_id_hash.out;
    
    // Step 2: Compute intermediate leaf values
    // intermediate = poseidon2(storage_key_L2MPT, storage_value)
    component intermediate_hash[nLeaves];
    signal intermediate_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        intermediate_hash[i] = Poseidon255(2);
        intermediate_hash[i].in[0] <== storage_keys_L2MPT[i];
        intermediate_hash[i].in[1] <== storage_values[i];
        intermediate_values[i] <== intermediate_hash[i].out;
    }
    
    // Step 3: Compute final leaves
    // leaf = poseidon2(contract_id, intermediate_value)
    component leaf_hash[nLeaves];
    signal leaf_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        leaf_hash[i] = Poseidon255(2);
        leaf_hash[i].in[0] <== contract_id;
        leaf_hash[i].in[1] <== intermediate_values[i];
        leaf_values[i] <== leaf_hash[i].out;
    }
    
    // Step 4: Compute Merkle tree
    component merkle_tree = Poseidon2MerkleTree(N);
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_tree.leaves[i] <== leaf_values[i];
    }
    
    // Output the computed root
    merkle_root <== merkle_tree.root;
}

// Example configurations:
// N=2: 2^2 = 4 leaves   (suitable for small channels)
// N=3: 2^3 = 8 leaves   (suitable for medium channels)  
// N=4: 2^4 = 16 leaves  (suitable for large channels)

// Change this line to configure for different tree depths:
component main{public [fixed_prefix, contract_address, storage_keys_L2MPT, storage_values]} = TokamakStorageMerkleProof(7);

// Tree depth N=7 gives us 128 leaves, which can support:
// - 16 users with 1 storage slot each, OR
// - 8 users with 2 storage slots each, OR
// - 4 users with 4 storage slots each, OR
// - 2 users with 8 storage slots each, OR
// - 1 user with 16 storage slots


================================================
FILE: groth16/circuits/src/circuit_N8.circom
================================================
pragma circom 2.0.0;

include "../node_modules/poseidon-bls12381-circom/circuits/poseidon255.circom";

// Parameterized Poseidon Merkle Tree based on tree depth N
// Tree capacity: 2^N leaves
template Poseidon2MerkleTree(N) {
    var nLeaves = 2 ** N;
    signal input leaves[nLeaves];
    signal output root;
    
    // Calculate total number of components needed across all levels
    var totalComponents = 0;
    var temp = nLeaves;
    for (var level = 0; level < N; level++) {
        temp = temp \ 2;
        totalComponents += temp;
    }
    
    component hashers[totalComponents];
    
    // Signals to store outputs for each level
    signal levelOutputs[N][nLeaves \ 2];
    
    var componentIndex = 0;
    var currentLevelSize = nLeaves;
    
    for (var level = 0; level < N; level++) {
        var nextLevelSize = currentLevelSize \ 2;
        
        for (var i = 0; i < nextLevelSize; i++) {
            hashers[componentIndex] = Poseidon255(2);
            
            if (level == 0) {
                // First level: use input leaves
                hashers[componentIndex].in[0] <== leaves[i*2 + 0];
                hashers[componentIndex].in[1] <== leaves[i*2 + 1];
            } else {
                // Subsequent levels: use previous level outputs
                hashers[componentIndex].in[0] <== levelOutputs[level-1][i*2 + 0];
                hashers[componentIndex].in[1] <== levelOutputs[level-1][i*2 + 1];
            }
            
            levelOutputs[level][i] <== hashers[componentIndex].out;
            componentIndex++;
        }
        
        currentLevelSize = nextLevelSize;
    }
    
    // Root is the single output from the last level
    root <== levelOutputs[N-1][0];
}

// Parameterized Tokamak Storage Merkle Proof based on tree depth N
template TokamakStorageMerkleProof(N) {
    var nLeaves = 2 ** N;
    
    // Public inputs - Fixed prefix, contract address, L2MPT storage keys and values
    signal input fixed_prefix;                 // Fixed prefix for contract identification
    signal input contract_address;             // Contract address
    signal input storage_keys_L2MPT[nLeaves];  // L2MPT storage keys
    signal input storage_values[nLeaves];      // Storage values
    
    // Public output - the computed Merkle root
    signal output merkle_root;
    
    // Step 1: Compute contract identifier
    // contract_id = poseidon2(fixed_prefix, contract_address)
    component contract_id_hash = Poseidon255(2);
    contract_id_hash.in[0] <== fixed_prefix;
    contract_id_hash.in[1] <== contract_address;
    signal contract_id <== contract_id_hash.out;
    
    // Step 2: Compute intermediate leaf values
    // intermediate = poseidon2(storage_key_L2MPT, storage_value)
    component intermediate_hash[nLeaves];
    signal intermediate_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        intermediate_hash[i] = Poseidon255(2);
        intermediate_hash[i].in[0] <== storage_keys_L2MPT[i];
        intermediate_hash[i].in[1] <== storage_values[i];
        intermediate_values[i] <== intermediate_hash[i].out;
    }
    
    // Step 3: Compute final leaves
    // leaf = poseidon2(contract_id, intermediate_value)
    component leaf_hash[nLeaves];
    signal leaf_values[nLeaves];
    
    for (var i = 0; i < nLeaves; i++) {
        leaf_hash[i] = Poseidon255(2);
        leaf_hash[i].in[0] <== contract_id;
        leaf_hash[i].in[1] <== intermediate_values[i];
        leaf_values[i] <== leaf_hash[i].out;
    }
    
    // Step 4: Compute Merkle tree
    component merkle_tree = Poseidon2MerkleTree(N);
    
    for (var i = 0; i < nLeaves; i++) {
        merkle_tree.leaves[i] <== leaf_values[i];
    }
    
    // Output the computed root
    merkle_root <== merkle_tree.root;
}

// Example configurations:
// N=2: 2^2 = 4 leaves   (suitable for small channels)
// N=3: 2^3 = 8 leaves   (suitable for medium channels)  
// N=4: 2^4 = 16 leaves  (suitable for large channels)

// Change this line to configure for different tree depths:
component main{public [fixed_prefix, contract_address, storage_keys_L2MPT, storage_values]} = TokamakStorageMerkleProof(8);

// Tree depth N=8 gives us 256 leaves, which can support:
// - 16 users with 1 storage slot each, OR
// - 8 users with 2 storage slots each, OR
// - 4 users with 4 storage slots each, OR
// - 2 users with 8 storage slots each, OR
// - 1 user with 16 storage slots


================================================
FILE: groth16/prover/README.md
================================================
# Tokamak ZK Proof Generator

This directory contains the proof generation script for the Tokamak Storage Merkle Proof circuit.

## Files

- `generateProof.js` - Main proof generation script
- `input.json` - Circuit input data (modify as needed)
- `input_example.json` - Example input data
- `proof.json` - Generated proof (output)
- `public.json` - Public signals (output)

## Prerequisites

- Node.js installed
- snarkjs installed globally: `npm install -g snarkjs`
- Compiled circuit files in `../circuit_js/`
- Trusted setup files in `../trusted-setup/`

## Usage

1. Navigate to the prover directory:
   ```bash
   cd prover
   ```

2. Ensure your input data is in `input.json` (or copy from `input_example.json`)

3. Run the proof generation script:
   ```bash
   node generateProof.js
   ```

## What the script does

1. **Generates witness**: Uses `snarkjs wtns calculate` to create witness from input
2. **Generates proof**: Uses `snarkjs groth16 prove` to create ZK proof
3. **Validates output**: Checks that proof and public signal files are created
4. **Provides summary**: Shows proof details and file locations

## Circuit Details

- **Circuit**: Tokamak Storage Merkle Proof (depth N=4)
- **Leaves**: 256 leaves (4^4)
- **Protocol**: Groth16
- **Curve**: BLS12-381
- **Hash function**: Poseidon

## Input Format

The input JSON should contain:
- `L2PublicKeys_x`: Array of 256 x-coordinates
- `L2PublicKeys_y`: Array of 256 y-coordinates  
- `storage_slots`: Array of 256 storage slot values
- `storage_values`: Array of 256 storage values

## Output Files

- `proof.json`: Contains the ZK proof (pi_a, pi_b, pi_c)
- `public.json`: Contains public signals (merkle_root)
- `witness.wtns`: Witness file (intermediate)


================================================
FILE: groth16/prover/128_leaves_groth/generateProof.cjs
================================================
#!/usr/bin/env node

const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

async function generateProof() {
    try {
        console.log('ðŸ”§ Starting proof generation process...');
        
        // Step 1: Generate witness
        console.log('ðŸ“ Generating witness...');
        execSync('snarkjs wtns calculate ../../circuits/build/circuit_N7_js/circuit_N7.wasm input.json witness.wtns', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Witness generated successfully');
        
        // Step 2: Generate proof
        console.log('ðŸ” Generating proof...');
        execSync('snarkjs groth16 prove ../../trusted-setup/128_leaves_vk/circuit_final.zkey witness.wtns proof.json public_temp.json', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Proof generated successfully');
        
        // Step 3: Create two versions of public signals
        console.log('ðŸ“ Creating public signals...');
        const input = JSON.parse(fs.readFileSync('input.json', 'utf8'));
        
        // Rename temp file to the standard public.json for snarkJS verification
        fs.renameSync('public_temp.json', 'public.json');
        
        // Load the actual circuit public signals and witness
        const wasm = fs.readFileSync('../../circuits/build/circuit_N7_js/circuit_N7.wasm');
        const witnessCalculator = require('../../circuits/build/circuit_N7_js/witness_calculator.js');
        
        async function createPublicSignalFiles() {
            const wc = await witnessCalculator(wasm);
            const witness = await wc.calculateWitness(input, 0);
            const merkleRoot = witness[witness.length - 1].toString();
            
            // Extract the 259 circuit public signals (witness[1] to witness[259]) - 258 inputs + 1 output
            const circuitPublicSignals = [];
            for (let i = 1; i <= 259; i++) {
                circuitPublicSignals.push(witness[i].toString());
            }

            console.log("number of witness elements:{}", witness.length);
                      
            // Also create a file with just the 259 circuit signals for snarkJS testing if needed
            fs.writeFileSync('public.json', JSON.stringify(circuitPublicSignals, null, 2));
        }
        
        await createPublicSignalFiles();
        
        // Step 3: Verify the generated files exist
        const proofPath = './proof.json';
        const publicPath = './public.json';
        
        if (fs.existsSync(proofPath) && fs.existsSync(publicPath)) {
            console.log('ðŸ“„ Generated files:');
            console.log(`  - Proof: ${proofPath}`);
            console.log(`  - Public signals: ${publicPath}`);
            
            // Display proof summary
            const proof = JSON.parse(fs.readFileSync(proofPath, 'utf8'));
            const publicSignals = JSON.parse(fs.readFileSync(publicPath, 'utf8'));
            
            console.log('\nðŸ“Š Proof Summary:');
            console.log(`  - Protocol: Groth16`);
            console.log(`  - Curve: BLS12-381`);
            console.log(`  - Circuit: 128 leaves (N=7)`);
            console.log(`  - Public signals count: ${publicSignals.length}`);
            console.log(`  - Proof components: pi_a, pi_b, pi_c`);
            
        } else {
            throw new Error('Generated proof files not found');
        }
        
        console.log('\nðŸŽ‰ Proof generation completed successfully!');
        
    } catch (error) {
        console.error('âŒ Error during proof generation:', error.message);
        process.exit(1);
    }
}

// Check if required files exist before starting
function checkRequiredFiles() {
    const requiredFiles = [
        '../../circuits/build/circuit_N7_js/circuit_N7.wasm',
        'input.json',
        '../../trusted-setup/128_leaves_vk/circuit_final.zkey'
    ];
    
    const missingFiles = requiredFiles.filter(file => !fs.existsSync(file));
    
    if (missingFiles.length > 0) {
        console.error('âŒ Missing required files:');
        missingFiles.forEach(file => console.error(`  - ${file}`));
        console.error('\nPlease ensure all required files are present before running this script.');
        process.exit(1);
    }
}

// Ensure output directories exist
function ensureDirectories() {
    console.log(`ðŸ“ Working in directory: ${process.cwd()}`);
}

// Main execution
if (require.main === module) {
    console.log('ðŸš€ Tokamak ZK Proof Generator (128 Leaves)');
    console.log('==========================================\n');
    
    checkRequiredFiles();
    ensureDirectories();
    generateProof();
}

module.exports = { generateProof };


================================================
FILE: groth16/prover/128_leaves_groth/input_example.json
================================================
{
  "fixed_prefix": "12345678901234567890123456789012345678901234567890123456789012345678",
  "contract_address": "0xa30fe40285B8f5c0457DbC3B7C8A280373c40044",
  "storage_keys_L2MPT": [
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789"
  ],
  "storage_values": [
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000"
  ]
}


================================================
FILE: groth16/prover/16_leaves_groth/generateProof.cjs
================================================
#!/usr/bin/env node

const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

async function generateProof() {
    try {
        console.log('ðŸ”§ Starting proof generation process...');
        
        // Step 1: Generate witness
        console.log('ðŸ“ Generating witness...');
        execSync('snarkjs wtns calculate ../../circuits/build/circuit_N4_js/circuit_N4.wasm input.json witness.wtns', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Witness generated successfully');
        
        // Step 2: Generate proof
        console.log('ðŸ” Generating proof...');
        execSync('snarkjs groth16 prove ../../trusted-setup/16_leaves_vk/circuit_final.zkey witness.wtns proof.json public_temp.json', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Proof generated successfully');
        
        // Step 3: Create two versions of public signals
        console.log('ðŸ“ Creating public signals...');
        const input = JSON.parse(fs.readFileSync('input.json', 'utf8'));
        
        // Rename temp file to the standard public.json for snarkJS verification
        fs.renameSync('public_temp.json', 'public.json');
        
        // Load the actual circuit public signals and witness
        const wasm = fs.readFileSync('../../circuits/build/circuit_N4_js/circuit_N4.wasm');
        const witnessCalculator = require('../../circuits/build/circuit_N4_js/witness_calculator.js');
        
        async function createPublicSignalFiles() {
            const wc = await witnessCalculator(wasm);
            const witness = await wc.calculateWitness(input, 0);
            const merkleRoot = witness[witness.length - 1].toString();
            
            // Extract the 35 circuit public signals (witness[1] to witness[35]) - 34 inputs + 1 output
            const circuitPublicSignals = [];
            for (let i = 1; i <= 35; i++) {
                circuitPublicSignals.push(witness[i].toString());
            }

            console.log("number of witness elements:{}", witness.length);
                      
            // Also create a file with just the 35 circuit signals for snarkJS testing if needed
            fs.writeFileSync('public.json', JSON.stringify(circuitPublicSignals, null, 2));
        }
        
        await createPublicSignalFiles();
        
        // Step 3: Verify the generated files exist
        const proofPath = './proof.json';
        const publicPath = './public.json';
        
        if (fs.existsSync(proofPath) && fs.existsSync(publicPath)) {
            console.log('ðŸ“„ Generated files:');
            console.log(`  - Proof: ${proofPath}`);
            console.log(`  - Public signals: ${publicPath}`);
            
            // Display proof summary
            const proof = JSON.parse(fs.readFileSync(proofPath, 'utf8'));
            const publicSignals = JSON.parse(fs.readFileSync(publicPath, 'utf8'));
            
            console.log('\nðŸ“Š Proof Summary:');
            console.log(`  - Protocol: Groth16`);
            console.log(`  - Curve: BLS12-381`);
            console.log(`  - Circuit: 16 leaves (N=4)`);
            console.log(`  - Public signals count: ${publicSignals.length}`);
            console.log(`  - Proof components: pi_a, pi_b, pi_c`);
            
        } else {
            throw new Error('Generated proof files not found');
        }
        
        console.log('\nðŸŽ‰ Proof generation completed successfully!');
        
    } catch (error) {
        console.error('âŒ Error during proof generation:', error.message);
        process.exit(1);
    }
}

// Check if required files exist before starting
function checkRequiredFiles() {
    const requiredFiles = [
        '../../circuits/build/circuit_N4_js/circuit_N4.wasm',
        'input.json',
        '../../trusted-setup/16_leaves_vk/circuit_final.zkey'
    ];
    
    const missingFiles = requiredFiles.filter(file => !fs.existsSync(file));
    
    if (missingFiles.length > 0) {
        console.error('âŒ Missing required files:');
        missingFiles.forEach(file => console.error(`  - ${file}`));
        console.error('\nPlease ensure all required files are present before running this script.');
        process.exit(1);
    }
}

// Ensure output directories exist
function ensureDirectories() {
    console.log(`ðŸ“ Working in directory: ${process.cwd()}`);
}

// Main execution
if (require.main === module) {
    console.log('ðŸš€ Tokamak ZK Proof Generator (16 Leaves)');
    console.log('==========================================\n');
    
    checkRequiredFiles();
    ensureDirectories();
    generateProof();
}

module.exports = { generateProof };


================================================
FILE: groth16/prover/16_leaves_groth/input_example.json
================================================
{
  "fixed_prefix": "12345678901234567890123456789012345678901234567890123456789012345678",
  "contract_address": "0xa30fe40285B8f5c0457DbC3B7C8A280373c40044",
  "storage_keys_L2MPT": [
    "123456789012345678901234567890",
    "987654321098765432109876543210",
    "111111111111111111111111111111",
    "222222222222222222222222222222",
    "333333333333333333333333333333",
    "444444444444444444444444444444",
    "555555555555555555555555555555",
    "666666666666666666666666666666",
    "777777777777777777777777777777",
    "888888888888888888888888888888",
    "999999999999999999999999999999",
    "101010101010101010101010101010",
    "121212121212121212121212121212",
    "131313131313131313131313131313",
    "141414141414141414141414141414",
    "151515151515151515151515151515"
  ],
  "storage_values": [
    "1000000000000000000000000000000",
    "2000000000000000000000000000000",
    "3000000000000000000000000000000",
    "4000000000000000000000000000000",
    "5000000000000000000000000000000",
    "6000000000000000000000000000000",
    "7000000000000000000000000000000",
    "8000000000000000000000000000000",
    "9000000000000000000000000000000",
    "1100000000000000000000000000000",
    "1200000000000000000000000000000",
    "1300000000000000000000000000000",
    "1400000000000000000000000000000",
    "1500000000000000000000000000000",
    "1600000000000000000000000000000",
    "1700000000000000000000000000000"
  ]
}


================================================
FILE: groth16/prover/32_leaves_groth/generateProof.cjs
================================================
#!/usr/bin/env node

const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

async function generateProof() {
    try {
        console.log('ðŸ”§ Starting proof generation process...');
        
        // Step 1: Generate witness
        console.log('ðŸ“ Generating witness...');
        execSync('snarkjs wtns calculate ../../circuits/build/circuit_N5_js/circuit_N5.wasm input.json witness.wtns', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Witness generated successfully');
        
        // Step 2: Generate proof
        console.log('ðŸ” Generating proof...');
        execSync('snarkjs groth16 prove ../../trusted-setup/32_leaves_vk/circuit_final.zkey witness.wtns proof.json public_temp.json', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Proof generated successfully');
        
        // Step 3: Create two versions of public signals
        console.log('ðŸ“ Creating public signals...');
        const input = JSON.parse(fs.readFileSync('input.json', 'utf8'));
        
        // Rename temp file to the standard public.json for snarkJS verification
        fs.renameSync('public_temp.json', 'public.json');
        
        // Load the actual circuit public signals and witness
        const wasm = fs.readFileSync('../../circuits/build/circuit_N5_js/circuit_N5.wasm');
        const witnessCalculator = require('../../circuits/build/circuit_N5_js/witness_calculator.js');
        
        async function createPublicSignalFiles() {
            const wc = await witnessCalculator(wasm);
            const witness = await wc.calculateWitness(input, 0);
            const merkleRoot = witness[witness.length - 1].toString();
            
            // Extract the 67 circuit public signals (witness[1] to witness[67]) - 66 inputs + 1 output
            const circuitPublicSignals = [];
            for (let i = 1; i <= 67; i++) {
                circuitPublicSignals.push(witness[i].toString());
            }

            console.log("number of witness elements:{}", witness.length);
                      
            // Also create a file with just the 67 circuit signals for snarkJS testing if needed
            fs.writeFileSync('public.json', JSON.stringify(circuitPublicSignals, null, 2));
        }
        
        await createPublicSignalFiles();
        
        // Step 3: Verify the generated files exist
        const proofPath = './proof.json';
        const publicPath = './public.json';
        
        if (fs.existsSync(proofPath) && fs.existsSync(publicPath)) {
            console.log('ðŸ“„ Generated files:');
            console.log(`  - Proof: ${proofPath}`);
            console.log(`  - Public signals: ${publicPath}`);
            
            // Display proof summary
            const proof = JSON.parse(fs.readFileSync(proofPath, 'utf8'));
            const publicSignals = JSON.parse(fs.readFileSync(publicPath, 'utf8'));
            
            console.log('\nðŸ“Š Proof Summary:');
            console.log(`  - Protocol: Groth16`);
            console.log(`  - Curve: BLS12-381`);
            console.log(`  - Circuit: 32 leaves (N=5)`);
            console.log(`  - Public signals count: ${publicSignals.length}`);
            console.log(`  - Proof components: pi_a, pi_b, pi_c`);
            
        } else {
            throw new Error('Generated proof files not found');
        }
        
        console.log('\nðŸŽ‰ Proof generation completed successfully!');
        
    } catch (error) {
        console.error('âŒ Error during proof generation:', error.message);
        process.exit(1);
    }
}

// Check if required files exist before starting
function checkRequiredFiles() {
    const requiredFiles = [
        '../../circuits/build/circuit_N5_js/circuit_N5.wasm',
        'input.json',
        '../../trusted-setup/32_leaves_vk/circuit_final.zkey'
    ];
    
    const missingFiles = requiredFiles.filter(file => !fs.existsSync(file));
    
    if (missingFiles.length > 0) {
        console.error('âŒ Missing required files:');
        missingFiles.forEach(file => console.error(`  - ${file}`));
        console.error('\nPlease ensure all required files are present before running this script.');
        process.exit(1);
    }
}

// Ensure output directories exist
function ensureDirectories() {
    console.log(`ðŸ“ Working in directory: ${process.cwd()}`);
}

// Main execution
if (require.main === module) {
    console.log('ðŸš€ Tokamak ZK Proof Generator (32 Leaves)');
    console.log('==========================================\n');
    
    checkRequiredFiles();
    ensureDirectories();
    generateProof();
}

module.exports = { generateProof };


================================================
FILE: groth16/prover/32_leaves_groth/input_example.json
================================================
{
  "fixed_prefix": "12345678901234567890123456789012345678901234567890123456789012345678",
  "contract_address": "0xa30fe40285B8f5c0457DbC3B7C8A280373c40044",
  "storage_keys_L2MPT": [
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "0",
    "0",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0"
  ],
  "storage_values": [
    "2000000000000000000000000000",
    "0",
    "0",
    "1000000",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0",
    "0"
  ]
}


================================================
FILE: groth16/prover/64_leaves_groth/generateProof.cjs
================================================
#!/usr/bin/env node

const { execSync } = require('child_process');
const fs = require('fs');
const path = require('path');

async function generateProof() {
    try {
        console.log('ðŸ”§ Starting proof generation process...');
        
        // Step 1: Generate witness
        console.log('ðŸ“ Generating witness...');
        execSync('snarkjs wtns calculate ../../circuits/build/circuit_N6_js/circuit_N6.wasm input.json witness.wtns', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Witness generated successfully');
        
        // Step 2: Generate proof
        console.log('ðŸ” Generating proof...');
        execSync('snarkjs groth16 prove ../../trusted-setup/64_leaves_vk/circuit_final.zkey witness.wtns proof.json public_temp.json', {
            stdio: 'inherit',
            cwd: process.cwd()
        });
        console.log('âœ… Proof generated successfully');
        
        // Step 3: Create two versions of public signals
        console.log('ðŸ“ Creating public signals...');
        const input = JSON.parse(fs.readFileSync('input.json', 'utf8'));
        
        // Rename temp file to the standard public.json for snarkJS verification
        fs.renameSync('public_temp.json', 'public.json');
        
        // Load the actual circuit public signals and witness
        const wasm = fs.readFileSync('../../circuits/build/circuit_N6_js/circuit_N6.wasm');
        const witnessCalculator = require('../../circuits/build/circuit_N6_js/witness_calculator.js');
        
        async function createPublicSignalFiles() {
            const wc = await witnessCalculator(wasm);
            const witness = await wc.calculateWitness(input, 0);
            const merkleRoot = witness[witness.length - 1].toString();
            
            // Extract the 131 circuit public signals (witness[1] to witness[131]) - 130 inputs + 1 output
            const circuitPublicSignals = [];
            for (let i = 1; i <= 131; i++) {
                circuitPublicSignals.push(witness[i].toString());
            }

            console.log("number of witness elements:{}", witness.length);
                      
            // Also create a file with just the 131 circuit signals for snarkJS testing if needed
            fs.writeFileSync('public.json', JSON.stringify(circuitPublicSignals, null, 2));
        }
        
        await createPublicSignalFiles();
        
        // Step 3: Verify the generated files exist
        const proofPath = './proof.json';
        const publicPath = './public.json';
        
        if (fs.existsSync(proofPath) && fs.existsSync(publicPath)) {
            console.log('ðŸ“„ Generated files:');
            console.log(`  - Proof: ${proofPath}`);
            console.log(`  - Public signals: ${publicPath}`);
            
            // Display proof summary
            const proof = JSON.parse(fs.readFileSync(proofPath, 'utf8'));
            const publicSignals = JSON.parse(fs.readFileSync(publicPath, 'utf8'));
            
            console.log('\nðŸ“Š Proof Summary:');
            console.log(`  - Protocol: Groth16`);
            console.log(`  - Curve: BLS12-381`);
            console.log(`  - Circuit: 64 leaves (N=6)`);
            console.log(`  - Public signals count: ${publicSignals.length}`);
            console.log(`  - Proof components: pi_a, pi_b, pi_c`);
            
        } else {
            throw new Error('Generated proof files not found');
        }
        
        console.log('\nðŸŽ‰ Proof generation completed successfully!');
        
    } catch (error) {
        console.error('âŒ Error during proof generation:', error.message);
        process.exit(1);
    }
}

// Check if required files exist before starting
function checkRequiredFiles() {
    const requiredFiles = [
        '../../circuits/build/circuit_N6_js/circuit_N6.wasm',
        'input.json',
        '../../trusted-setup/64_leaves_vk/circuit_final.zkey'
    ];
    
    const missingFiles = requiredFiles.filter(file => !fs.existsSync(file));
    
    if (missingFiles.length > 0) {
        console.error('âŒ Missing required files:');
        missingFiles.forEach(file => console.error(`  - ${file}`));
        console.error('\nPlease ensure all required files are present before running this script.');
        process.exit(1);
    }
}

// Ensure output directories exist
function ensureDirectories() {
    console.log(`ðŸ“ Working in directory: ${process.cwd()}`);
}

// Main execution
if (require.main === module) {
    console.log('ðŸš€ Tokamak ZK Proof Generator (64 Leaves)');
    console.log('==========================================\n');
    
    checkRequiredFiles();
    ensureDirectories();
    generateProof();
}

module.exports = { generateProof };


================================================
FILE: groth16/prover/64_leaves_groth/input_example.json
================================================
{
  "fixed_prefix": "12345678901234567890123456789012345678901234567890123456789012345678",
  "contract_address": "0xa30fe40285B8f5c0457DbC3B7C8A280373c40044",
  "storage_keys_L2MPT": [
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "6218676549690402052910318315276979534381485872621884367715834658603456243904",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "110580260996340110094785440981620907308337756065855730273934386618448660286152",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789",
    "123456789123456789123456789123456789123456789123456789123456789123456789"
  ],
  "storage_values": [
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000",
    "2000000000000000000000000000"
  ]
}


================================================
FILE: groth16/trusted-setup/128_leaves_vk/circuit_final.zkey
================================================
version https://git-lfs.github.com/spec/v1
oid sha256:f254125a56e4359ed42a768787760b1b958276766c9824685926d83d5a8f6716
size 148430284



================================================
FILE: groth16/trusted-setup/128_leaves_vk/verification_key.json
================================================
{
 "protocol": "groth16",
 "curve": "bls12381",
 "nPublic": 259,
 "vk_alpha_1": [
  "3268803271379567479725929986430337195428780722324274052854054578012888453542091572435851443215957417299656266605300",
  "3392298742634614249206175004023834481180248161036392887975305340670831619191289474946508657369286972980055942736748",
  "1"
 ],
 "vk_beta_2": [
  [
   "2708326569191065622710400310802069866496209079139901163169873281191253811056339865175778992090211281870433713873970",
   "702614572646459943157752146280498184274085028358884468499685148367174302569106906399386063396868819117865865568221"
  ],
  [
   "988575493575857144898892607482003659067488066420893303292709287854821515398774285443621626760932765403451353057632",
   "2853153319572298221538657007417219975645330519983395316509092592820148798421852299261970944086074436443653604627458"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_gamma_2": [
  [
   "352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160",
   "3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758"
  ],
  [
   "1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905",
   "927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_delta_2": [
  [
   "139370065248822647931843934248689171037218967156264779957482417294188799934017385707609719082702361187428013887543",
   "2406234397433959185146522545708131524568647519746563236476933563786373058875097228475620339450751338254094582470086"
  ],
  [
   "855953473722580387741597667846097398932511720613824987956528579618031836957139312463042396192808647565119131293506",
   "368742832459670934532344990447055116795579995265231905771230821479213710616603084744876931309443078551459849075181"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_alphabeta_12": [
  [
   [
    "1269043365717556898443114263930872315138074873624487102606224939815728578172505381804106517951045897416572902247930",
    "1598370388863469694803911625093718138550376115570888992040562367222218460708374283389465113261829629864666767326882"
   ],
   [
    "2903582638109749111753297468587271924496074677468510797114747953490076857159278189453543338372680445702039218193787",
    "1702536532161921181603881317394005458111393108127393689994511172822174871854710070988085451671102738354077369988210"
   ],
   [
    "754337170889685094210197164840321858963793953357281378884300321263109878336638135363631001258481859863360844339681",
    "1562451371278992763643452741793695634161392419255122249204441044598494151562361733160116669696229411376384050251943"
   ]
  ],
  [
   [
    "3077769270312256244556017322222991780515632134967355658514282387224674417825174201626644605590702566237281109417290",
    "3059032399060513337320757092035466274735871179004736785625580675696189036367063786640101709971710479996822120847780"
   ],
   [
    "782116002244851383735380850494789712609531829473790973605134344398753065385114068115937346000401209832559868359498",
    "1791962627930386212213670346588862773021569921776845340738867018900391174682988984023819388276824202354084681967286"
   ],
   [
    "2418121638742056546943332243829134394213484311272313514062273451554765246081900790423304616102082413502232722359248",
    "2222110295307213126460742119425712858835526872054125661884120574258692787264621222030784010278515337141243491532581"
   ]
  ]
 ],
 "IC": [
  [
   "195487454220640038288240909925934185571676077024489026321787687780589604296052929998301850306304761214932154149353",
   "1689013112226041332418434453150084625799028632141576119387609248599474426022247016650097523772161077184832279493734",
   "1"
  ],
  [
   "1260188011233321047173806662929238547747237369028278453294319568698865965669231302266238991115546173120951042815583",
   "583130716696060113747091670139725389054927601629288142091858006054851781963074135294578774162125200972998673622984",
   "1"
  ],
  [
   "166254706120237509758809604080474696965386054782406382921281598409934124917612545144099097869204134432727459224067",
   "903138463022813172269867030848733768747263681872636105528475463414170557574769993251345398227225699107888020718627",
   "1"
  ],
  [
   "3591765410025468811734684588694798277466684113679932400187436823281093225770977096367845175191268565136418536585888",
   "2005180172548350656028703586657067542244257968177883131720485700530239178417267143833887166259710926567126694091897",
   "1"
  ],
  [
   "1754738337951994535645555729187017766830855911327183943327763238584728308602837256831632957279263663665672791350183",
   "310066792714078137635277591302993865142327698264698752068226008900383741562531813178189460327697862749135971085973",
   "1"
  ],
  [
   "2225520309835845523095866442144332279451677490781773773671107490270804896493170215048965122937159466525660850753683",
   "1674092374003874975178414583482447292640786989463118441895128379683010345052657890551615458144918477839407486356715",
   "1"
  ],
  [
   "1843901941645063628623391901387008026777428606432768268317229865391600522131107521374212367850213564648441553658942",
   "1861507707859676568243416230392945616687014478500544579627839215741336266217547212830928759968601530241507357249491",
   "1"
  ],
  [
   "3092888163181570121361987819697824420788617640467633245734899780800292334180203831652583381793945255435893022126857",
   "1765249372401312427829128550696464280795505974839486431659664569787520840395370295611428365668130229819461470278498",
   "1"
  ],
  [
   "2279947217687337289579196646756274377883138819316954756008789864511826518498871726643876343899028327574548339108761",
   "2228543770898786616691480989431228558590745719565828575490994795153329468129487368758665614443521761501668776848538",
   "1"
  ],
  [
   "2364584165493959298141820824525828972952847434924061739895948053932535599236602279311839996971819597360297504059009",
   "3222261136851934129856121611351717463148646651427249660997115841445287327972649598737783199181746287007337594935146",
   "1"
  ],
  [
   "3224724740989859020634703331222278930422886224139320853489520033855867340922871788682737808592094166906997548312476",
   "265505217657968462783408000785931646642677919675122074047060958957947478322734677936672127371116889776299777592503",
   "1"
  ],
  [
   "2832285764843216019065073542188846506866277957052767292603144217299376402888871601228818441855607823301500214682911",
   "3640942581281578356536997465796086680228162244257274929591935938891847163053738333573358987617955574482543633172892",
   "1"
  ],
  [
   "2658756082759363980781481448737926268770739322867746327305486840893743706148799664240735640634836026263198959202187",
   "2253919154402866886500475377383696033958961432172022341893730649138678304005906044360462498012500216880556953355586",
   "1"
  ],
  [
   "820773406243635484664655425599026300535862204281631342982927224108260263273101164434554959153198368345315845976918",
   "804117040445462804833401923378660288550825157624479347795911252484878198825633254764985861328284100843327091620430",
   "1"
  ],
  [
   "2651447994954902286697873491401402022313561039842460554280213702521326753849808698270580873764316168314501903823136",
   "3028988738531910414227444449912064424781497894707479250247967128568278861860592004601412383981091901870627608871052",
   "1"
  ],
  [
   "1424360196494707308631999074328877472089191213351254577544162051793445046500498608361770762598513737491005435420841",
   "1113022395502143949479406183240275033882195515741871071696623498098507986268224387569117815941832535885907298793026",
   "1"
  ],
  [
   "3248804912621115330746434284891014254388019773764784161495130548920244273748527135530978877530934729485831973947143",
   "956651883011247988294831945855799893930262181035212546141714833533167005214709091354101239449608971208560857087056",
   "1"
  ],
  [
   "2951954625528982146993448484511503966894871847563545428684527330141751222435537116372749600809048480389356461456990",
   "3353716082564679190384375665398577375839176513072241978725888516839546926396499292524307737521523007115523726003911",
   "1"
  ],
  [
   "3533351604340420746840147768496788386468779465506994170897359552514751508217625477671554679450957103597628663955080",
   "2116417919486382254026656297509390714151907764555450780270762681873294539832165670884304458712751260299042192224321",
   "1"
  ],
  [
   "1528137259404267086086645619152866168748072525738497220061021461646157516753923153554167528068188996265656255856735",
   "937861166925246198416333265377478503526230768889651179595441032803966184854504596478674953351856135197624036770589",
   "1"
  ],
  [
   "2115291880600432709669656450307951820615981943170611131698428310889765938901550610066516087654552448874106110864480",
   "2431511824882396204622149989780496467808023065643954151728020758325526759084955199914155462223241709967186713329539",
   "1"
  ],
  [
   "1571254129975525217576760020259378120726410307755384599041278297893849453934739352094534116166352540782421673715094",
   "311570242068615079456658829042236257245475443762533924358699147069333720110933343766439193605549492044286328955819",
   "1"
  ],
  [
   "1503497644196062235776266315772989157439801830300643260227825651650719129212675986556838246384236410034324094618142",
   "947668372522381110747097993699090037324183574908183107830971804577030904207920590698694151425368837742695859503560",
   "1"
  ],
  [
   "1361398853922073014541279283420706960735770980378019169585800113349859252843562571389294375171967538558620006045024",
   "3953727230503680607519977127030927052225286565183259536321184693412757082155359651508780412935110201114023586172072",
   "1"
  ],
  [
   "2547002370925007709820250702122817208019792830270761546148993424539949532192339224888741336220163900907032592161149",
   "3957096949286024316074778735411100149120844223542740290519329847410657910825047737792851196282022517764892017056262",
   "1"
  ],
  [
   "48110294003433043483478073041727067920793794536692048354255212442516174242657295364418308020152203451510924132999",
   "2325541248624579537565808377631918621750893207901920359662293302951224356297294689168998646538342749341731133843950",
   "1"
  ],
  [
   "2868709659145553357710253764415082795093833217439127346644744196697899457910276930272785887666625144051732223796178",
   "1150336773173310514273849306059938056423762162641194600156113805538791858747009417936181717684821141136637528780418",
   "1"
  ],
  [
   "1237831784502348507618318217198899823929010570901908789359012010173319382664208303994383757546157283421422016595324",
   "381985333069047931078807937647487553577738895739698978583389708241855934923820337993915881209921880122215962123228",
   "1"
  ],
  [
   "1765606807774476768340398943140857688505489362332689524881815604779255131185576453186233520220339972671062238514505",
   "3622615174006495228338210220056344079615433069530879221189022803529927692069074434194709443828144207796283830526617",
   "1"
  ],
  [
   "3477844978331865454348616509882334090791335870434397420466232355536282520636431622800102329113298569409053175543359",
   "2604723544096038858983986776433262937660209446616273959753524071725895689232432020369835161605418516600831058488020",
   "1"
  ],
  [
   "2782025493214473939064328882834697784054180434566067484748903869592928532644400288795705995344446937016803946797246",
   "2777458141905695861754218999624944954238812503560292569171758285488094644745758674320095472209071141395669294036133",
   "1"
  ],
  [
   "259359654661566228958101299947587940529514531638175490045995799606320416153480993604298628030316848846532692846941",
   "2527943746346828687957928091014156713833009599143704021023227399322758519653447051895823342601104905968363528619714",
   "1"
  ],
  [
   "1054874970187928666795316800689301201390486744241287483328201387608741196211269535886926784048036470876678169511646",
   "754623406119385875607897404905836588835400006407285824979306926560003749391218070318349893222495509697174272412628",
   "1"
  ],
  [
   "2584787356953644501087098211688368374866944320864593118743974627934308660119112454996285102374866622463345903943836",
   "602544809158491466381692891987719936575054824903932935533381480853351821901760678834472689744942506933079654263740",
   "1"
  ],
  [
   "584978377171089516466457223699434235289990578260160837726434178628629747862133072624953889081284518270005027688999",
   "530349786529522802972080492152164248596034128731755336415874399009245720578898436631904022552457313386297278553410",
   "1"
  ],
  [
   "1441360989281828238408452268454871894316350228357719495059293199943588922379502820025080654270312838071509032928236",
   "2877716663202386580364406511324750868212248196502451480951137712794591898988855230353292009446349813729329644420594",
   "1"
  ],
  [
   "2274708625588146764819169777093065355038591239175890174201087198374170025532150062976264175875527403655119127591467",
   "3622957163192593390391692176629175185327906327722151047474989564371554021137567391791684249894853793306657606883452",
   "1"
  ],
  [
   "298252522046416490581922069019168007443029723619582731694007509481279406194124090439992161208114939485419389695825",
   "2488961880271947134611190307074511473590616014032640608785810599093733022110068449624157462869774917550586664037282",
   "1"
  ],
  [
   "2660756329183793843397364851973428606566899979672342347587130540379847503952012551656189541903863547877795337452650",
   "2409005045536681514266964933693833553150556318246639161560424203799608828902430270319485175593543309587441255841178",
   "1"
  ],
  [
   "3083146683405521788126681858545020259741933887400469769375243750067684047027072895871863103447531967756261738729767",
   "1778351891742852631878499578354265856010922929574495501240957344306893883251718948926810527200604705037805693560020",
   "1"
  ],
  [
   "1043971279576791372035321943716096268713918432326171138751981766274625561198658933843489728035604552695417647416052",
   "300544545140643580842335483814611917268201865687216266893964638835318896648141506251122558113711211473903033002352",
   "1"
  ],
  [
   "1927676500298022298430107506231931518647472700102082626766853327077199638235317766920808178031677830940002040732531",
   "1034935939178828075725802937520384216863763145836240117365824346491608056207175766592892475525251172119613153545548",
   "1"
  ],
  [
   "3700718911995347765931858223620276364801113469752355456220828659853637529251987185566571387820200076303266850699462",
   "2351694083262095139468533389175941064821122291972788761181813489213164834948432597274298990841563207379723005375054",
   "1"
  ],
  [
   "1167150827783646331261141926216145677095925487202471532384882413648708824627400672077688510492818623378248613735573",
   "2373718666115130238679260765130310576453173536822157528830436315863141837555059767827157828080132010551652946999427",
   "1"
  ],
  [
   "666352633395225026812613540661274832078830962287928411733926938326110780645602122098198940405130612848681433963337",
   "308430286071548987577801726712792381815485244963547270859507073347882871780499215314072762717756227769611475548683",
   "1"
  ],
  [
   "1841463942297689737562608928652608492086327815611336964565145321410954196717879615882502337122542610974575148422143",
   "1215195585515973329184917832205624659154004337606231186299309930586062247432987135229548089140485713077182160316761",
   "1"
  ],
  [
   "3924660482552027358217068640103097561155162677243895722678837322668997412859638870399807008341866125439984974399860",
   "487829010115701384342100561381871870171911868429886577207069142569468737858680245169808359404263318628766996821705",
   "1"
  ],
  [
   "676171644186292655229801621386546531174824563641826345280776665433426724301712945192542365123486849742904513165153",
   "1694386876202933690074651643786342805094621089157403464871508163784455107274942268319021821253549514377345152372072",
   "1"
  ],
  [
   "686923410425302306121955899573379394981768052611582082606983864629014680955769711073782065828211586296956975354760",
   "148090537106514291410466143809164929208949903376784589778371524183516296602101541975106742260401502824551672910680",
   "1"
  ],
  [
   "1344686312072128213381116988541056323726726144773172639946987747377884470722800354121687555739805484578282936604971",
   "1118749077985702802402824481722984815069937071054211001726043233470592628553930518358065010634688594911115037740031",
   "1"
  ],
  [
   "1811046510110920752690902974933152105910119545754943243130282360482567832339978455898905961962314720341695900627294",
   "1451460924391355124105587964553336805663649786846202593858598994753979700512835031681703040711676741906085941706327",
   "1"
  ],
  [
   "3324815601999635430565682908959347302339901259612204472864347662479382230315175033451744886193500884033831963150054",
   "2523305037450888685499356243974974848752858189524810321733898067775933419155378071552775555476057497436540198896345",
   "1"
  ],
  [
   "2470833481563058452096886410003118678829878869126468347060875156907320775182794582771722547453983438887317542119669",
   "3336758806085068637148963987150338464441178828630089769060793422339302535090675023148478506162387565321289355841179",
   "1"
  ],
  [
   "2951300096289413138474510904096605373852675873940955958508408548077313068264413955525818843537019291207701324737338",
   "14300135244979944022303706205818227272291424566857083521947711622924110118528250551820926508129674250943880318045",
   "1"
  ],
  [
   "2652441730153870511707137936128276897445576371319773760662669843214829613076115246576128431896498968233543936111638",
   "2440256329306205903646779887949209008907375049053996507744533463618927469338368669099035566771579270002379122169940",
   "1"
  ],
  [
   "1818098239900293339098925536585269432282666726768628540091271777661545741972170383139340131152520136863105024308830",
   "921806359508083793823733468202785336549285816219053707208486272398293550525143741778683635965952592333606662909960",
   "1"
  ],
  [
   "3201994638900850780431972939220574151586610132595556393490795458103840570185325231066278145748826431945599762675832",
   "1300942693689045746978473339395628163497187996927652830534197298311279785266055095215856877669121097131558258391816",
   "1"
  ],
  [
   "3207097037279535254589859885793865701974037965078772448809732469490944219092728349197038962547406004014179717766506",
   "838225676718386191306848920351025731346919005958200806396545126264705261406110591220058831938080646116464857098545",
   "1"
  ],
  [
   "2768456465008598043543734047213994302364502604048154191294787668459609536309027394027381962222920524114369207735194",
   "2693863650491395147866078384480188501561950532152916649438286462102581994439376313557629123992051400456946094750284",
   "1"
  ],
  [
   "3035296305004045500995230162836626507976784966808379156529523952571831492036855607110559089021695716046685913163723",
   "1112460619700946942569232697637900040841345976221689828391781651292075841395608114327650646122623416411113708105046",
   "1"
  ],
  [
   "3958705021281087889337568503313625300184631855419487694808725049052182687334838843926770431327267697515704685643755",
   "2836385832254748235436097013674628038330039209657433638308052688314511673691250733293290984089533214803426311547729",
   "1"
  ],
  [
   "3848853084897297384283586203259665004979039075160362636953308259370594793690580148443022415000739283610603424865760",
   "2919179832577687060450799857560609936034294061728620852974739585775248186725398103894387167026812793205196829643605",
   "1"
  ],
  [
   "958383418297447093581053033694634007303153160152225811849259433346931623831034947111995379707970011012546992898370",
   "1842942073136972096720833870871293023970219373480736117011854050195107312633338751460570297490069458495038645123145",
   "1"
  ],
  [
   "3066897753175304052428389133760594569991356295184574274136131434517283985515987974754199096204957342818150964742557",
   "1436723144476747620783354290057796272142597276611480843383754332195935472336915318381698890317124212307946806444967",
   "1"
  ],
  [
   "3122913903192624817844978291287722947362317369057799617702799869812799440045848686847033105697959730039241968551537",
   "3733002664799495825645417352645609575972028519617228433011880918753699143436845664387196096978148799584831602230283",
   "1"
  ],
  [
   "1549294035775262668122725093975716122596981747106408879461598813145975348023144966766767036301983494095608626373260",
   "647705942876567556754571103580280486308363666351934266777313663372996401098119185424020814215029544276404434378082",
   "1"
  ],
  [
   "2149002811982901531639989023486401531878244468235698645902983991606536619359875697267513439201644016038517028302244",
   "2426968426945722693182891593064361417487044489964879192891915434276140860807773180454971155728202779152730879641474",
   "1"
  ],
  [
   "2450839685096127930927691364343169220216503432307895432048936118504502088097811787265285148107169438276521639078326",
   "3339044284238691213631015693748622433138653899010472638309045308843606392345062705173263836034229968859567166245417",
   "1"
  ],
  [
   "3531561691024739659450675268562796251826387226717789391360384127434184728191988835526073071001991602821668626320753",
   "1421598483320970012991251937712064957570910366045129284162672317456710295668099672132662049663036743529978114614737",
   "1"
  ],
  [
   "820526075776479639535645950606493710533422720138547588995600819474822867653756394093062349512021483621843206408340",
   "3357186697659545522450017904691310902079007379520901865741415291745139523710175580617388585153454015709453226115385",
   "1"
  ],
  [
   "2267711363782059702272951824212569051048472282796762943689255208098651939581974090733400893687465868845311459996558",
   "182170378172073810446073354733860725503676660159503355657749241545570213690160773750007069473695481817652011162509",
   "1"
  ],
  [
   "21018057947447034453591483768159266612287275732076536077723277975399007624716573331238078506538495530812216985229",
   "3510225359428065961146099559127981604448573351774088849135259795157242595332192625569812942326161591467353450335094",
   "1"
  ],
  [
   "521372582656700178005090985460967428183888669464105157823845069000429636416670919284611829819532977193763542170335",
   "869993135670465016069397056176358421278816868475659180201591465663092587903027715200904248437043690084767202717878",
   "1"
  ],
  [
   "100742886731272401305178561276686615783368617889282723161818530156251419766485821061997112624351069450644842633852",
   "2375514813072761047563186913915153960325891318430012244865173317933458181014675094895398784085837940426906253708987",
   "1"
  ],
  [
   "2580022007107214209564095363942143669180859014257537969458295032172303581581492946728001465619622011212273001996138",
   "1600028517497208899953367587196993048602852950611593271089657247606260350340246054990454830072567439413609712794856",
   "1"
  ],
  [
   "2832833693125681901110701417996383286242543523963050249214879350621516222694295031896444286536222947466522017258523",
   "772337924840115767122887692519925343634395045676475120758940596907736185252858863786415525142530821470688848242349",
   "1"
  ],
  [
   "3821516459862846262888169975311765514026323898498549948147650639193761620720282207502065692821135382353119803742901",
   "808411828788622847870300242672225045336080921491697245825398437810518346188365937722001510801120096132202064275965",
   "1"
  ],
  [
   "2942406906248137192119210677816669113322353105282924416654102381760971566901088611136047531698473732005336248447721",
   "2040365972346670826053746444234156507773601622486905520980752596505734307336749812456794719577375678245189434997517",
   "1"
  ],
  [
   "3425856745252928760028428410997735604156986696019157350397106108820806323253469692537487782015945153104077634763513",
   "2403651747454686027019218998940213383236983099821139945515717058176257489713973639992326937723367503616575322213439",
   "1"
  ],
  [
   "2619363822336382722234903823793038092486368780738993621949811491911579346862472814080996356183597670624528137029196",
   "281812260063592916963095731597460121339164401827815465216225900279206493836911403281166733569341543297130707705735",
   "1"
  ],
  [
   "2394878888805475281096756738414888725606810732099745411132334096653345389724334434717238006765298612797864631477968",
   "3041456944363970804125444524167264429349880104721255771210328011059660361507806100784056409905529418679901312748141",
   "1"
  ],
  [
   "2487031363120566599088055547240620426511642151700836174608111483851357103702309283634104313934278966539536107639460",
   "24389130738390691864909013043798935754188008505365798956043407157744797698375499647086541090206211767559694937223",
   "1"
  ],
  [
   "1143341319320220107409314903421889702094126409494984719601901240543412113051477552039479225218784883639849549387642",
   "1786083627505201133776923635425361739258785277373610383168401679134453235701558222960187685797012409848561031749641",
   "1"
  ],
  [
   "1551163620594772372234193324395395847108370038143276711906712466805805504032699771166488584420281697988952620686726",
   "1468776442067160603509306691461652075722288746814353860164524550153075829141309845674272255679350439637350476448293",
   "1"
  ],
  [
   "3727533708231886559807290968328837621422713563784790667999164970386551380768064085878081623221081832752553182026756",
   "1269599822878757680640691965663433132092095145022343580338416798570643194046984833585363523038888430234724895062497",
   "1"
  ],
  [
   "1194107742978426102781957655181976962296277005210128736328335258980508246482111942237790155131403351880276662608534",
   "913741451573005181317256618740276674979545295483939349373819807462059990678936802444768765373147590429835143720607",
   "1"
  ],
  [
   "423679999046379478866719153028596066096420813509522792936432622805198354894687082767228347444912263764646411890887",
   "2499872885779948647099871268805258797664071822304632838106300871492607618379687513104329534223664952314364072609445",
   "1"
  ],
  [
   "2378098819780986126608183577149044526225481512218666385831124779209871705242318736452630362854228787141308626149461",
   "250435939350780916564582725968566656064494120130787037703786203293046546804223030505467227007576285382306402518301",
   "1"
  ],
  [
   "2912556397493712545917788660286130035350577996314395211050962811280285244545561273283111887918459637740929154337971",
   "2971112727093695099020670771105378112696215326219704187006634651803289105972845518561013916868691860579582198548719",
   "1"
  ],
  [
   "1674103882309560614749789346041248862397771562107773941787216186820145286336316599733746425148464595508163807170772",
   "479500819114508981080667060954749765105888235201254819755911666861918230744933419961049573773106973438042992835643",
   "1"
  ],
  [
   "2595064878709317634089301130183501082287089841810001083613597728349978601866372375654103542749735646347866396957499",
   "863643160919131329537209005911206422251314017460406764476853671432751524295369792157231305658487380558969139979250",
   "1"
  ],
  [
   "3072485805885124506161903691849957257034900460997712871542017000930126435230564475898411026077509405234981878330913",
   "1786046616763925093815700131883967688679113504204851541681317466288284760080462939546323759899220779872571291516401",
   "1"
  ],
  [
   "2369061755883412253647824206414976419946919678813874141360753572002193080731898873514603538614884192913508277658557",
   "2370806282412476537742856081694936646858386605767439095055692610770714851849957052854391650622378924335814333291295",
   "1"
  ],
  [
   "472038996598076718623927110323164210318468059542591380078235697797890255449156460031137867865944745277082630041500",
   "2984426684398896714996756636521962782557108821002209593106019840066107315904527178365538103382927910471515836769852",
   "1"
  ],
  [
   "2096281162675216443877405111194437114830623048648104855874673139446301867985860697711538005034792509287147623751672",
   "2905811804247114881890667929184604473843036779187993675477769972771137122537930079817126572323952618523938027665536",
   "1"
  ],
  [
   "47238998746409331953808380768716181879468661624627860243874005237678364833869235297524052125325788039215078236111",
   "3144699215149014503604868710511081415385801915406237175308502745109563863131414619649651807918872788325036389616974",
   "1"
  ],
  [
   "2752729690037524303454209335666316593418957170559576279837413431009083305254726858144872088508904462448641366068468",
   "3859225408740361229050636535442028281014181150494827224614615106846170910794807888331672856318937371244180856722938",
   "1"
  ],
  [
   "3017343297776010939697295128593025723336275323561054939082851295311867062470015992646214441239568486050169718268398",
   "2833198115037252932685170911573211413202864897134274134695284653762887134319645637888078291197254847088123526834110",
   "1"
  ],
  [
   "2980222378188865045413708502227942235521140559542079221089126352099710020133341886870067661961827456565938525040564",
   "3433923533810313759899469483038742096303453358051003522269209456133982258982820164868345874047847200960994184052127",
   "1"
  ],
  [
   "1694758994086396115575195509365824244086764212639383636739308199542383894705910133801378246294014786035825158629552",
   "327961860424609190949225080683983162114307616774304466628840483349276846474058684882939741391195522033212083725444",
   "1"
  ],
  [
   "1269543835423616138816295608340763192793509465034549211677392607373687124036292535467257256451155076855240060578131",
   "1688639338720316877921301439971268798886846540301479993517310423282326120546265538902055403636145144011581943084000",
   "1"
  ],
  [
   "2018640455796486637333101709641698458223229174736730852285576968753489993364724494158624804897531788974300806481051",
   "481353199918617243535813054913746650836102202277703727180209029847114055323592212249053003346798267160196670327317",
   "1"
  ],
  [
   "3901942507339582437548276978508010970360565022484095375421841746084415319849448678225075758324063083339679303165259",
   "1798058412464183209267132240696686608808848555605104221443271145958282727889880741639219500492030764592257839955608",
   "1"
  ],
  [
   "3545779365037256648408024181028551326268869611094956585540731662685435874566301009825019732452102682331973217025443",
   "3894913172077109819488371802310903992125931659564853193981672068886479698208935739694980995311439917204060216674327",
   "1"
  ],
  [
   "3634712005443852377568765750774460615544493989257621756949553473447272733391956357372095011482563895060026120372296",
   "1348073499988761183073502719664581710218267513903159193799133446438172073258850748679257307115873300084270392377805",
   "1"
  ],
  [
   "1580747834754365274054899617286445910312460482385070235766902237154627778163662108098628879043135460241032321160321",
   "841895570009707857994736653351975706758371123195946671800861075318198610294688645986335683734549925929478529280674",
   "1"
  ],
  [
   "1809865478478771474000227156228609716486809141003959097605646762207093426353003072601626985638601661078890074326749",
   "3419183392045108599191470745243340751012058529191134782217311409406328419259740859619649358101959647322849573129520",
   "1"
  ],
  [
   "166677522885212381537924855554066781952449630733384901051675266057828173111408792552961047568374759143798902122111",
   "1143724896415031286867482981098738918635915930966074669599790287914413024472128147650437881122101797090773551667699",
   "1"
  ],
  [
   "2440655755830611791060995508098165491323785575351588312085665409737657701749987351094572544327045147612890836717854",
   "1062147484636527704974166875307045752922753899946463841446661028965476168151657240725530567727076616294344466231318",
   "1"
  ],
  [
   "380949027316820651110470833261990972202554788507839208024498304688502573457903820944253918199641606370648939669406",
   "982233710882095074834794825013034329795029264995883118366762588877112217326589906478945622815368466093626169642382",
   "1"
  ],
  [
   "1161527703817388479554832348355786001241382549013422860643603094895561203471841019949706918471543373156096911708429",
   "617400085405445792087088608495066451006091150638898383698219909727717335783482609121252590205780355707764751536632",
   "1"
  ],
  [
   "1427174571925681280407479427741838365850276764688408500406360175812584872024218713598603597140806045990272324035583",
   "3728691085545714742772544508442478138176350443684733149146468019991559872973383424909084174584282228036458244692253",
   "1"
  ],
  [
   "3331073111560918144089000707180395161839140028401576059042417584294763495559054277276121739556554708838259462803196",
   "2202911300116907255771772062287872769430740211974518418786440845345271849633040822508606155042796428203110493546305",
   "1"
  ],
  [
   "686528884968926345356952537842930092872193411540339464379405819719098692991482676587801155812848868540208934723826",
   "2366794653858206012156663012348185229226466681719876616563840592956734848313242253532757035411403890746215845790242",
   "1"
  ],
  [
   "2713988153843272144663287450248831564320760242186151241183446301090337750298700947884248304822366632198170370274293",
   "1516888390249009698547312276339151832255352734246898654654424460694914730472962363557132355585868418680293474737719",
   "1"
  ],
  [
   "1046904517973158662812697669662639882057869497745928361413371047557003404975054986429495097444787121909675080886818",
   "3019528326917622694961958027452011085740492276239830716851681086225302356095082553032701336200330521229477932612015",
   "1"
  ],
  [
   "1545386830724832088289920356284503235135694090089731034293365662590263992083927786614175624189115264551421790180913",
   "3977662453181455591643969794832902695806575487867922383813474121639573278150879118754917630971421056401562267245193",
   "1"
  ],
  [
   "480074377368057395427711054060292648006223119932181224583375503393683845644858754393653832683870822626790391729608",
   "1739408681986390625904622148510890288095360324333685500729685972325851195140839442793497231540782436654288490109826",
   "1"
  ],
  [
   "3918565992129411292912559059974231707389945061783366389158881814114444434784204248629888117146937911147405299807685",
   "3932164327366380393309191172335236667092290539425414982233692242134320884472418144697425080195083488949860861987",
   "1"
  ],
  [
   "2820899092139552175981669981828880968194526869179941343950835679757755081547183977070670629457326824765396693696647",
   "2221177168227010608149223798925705125569958211903481463313790041444612670345515324983798688657770956751580000714950",
   "1"
  ],
  [
   "1988187263634856931482666964675805376474282672382864329299275848567361572085181495927027055098055543307874777419906",
   "2400280452181701401560580650355614119238702541224105218978117521904448533224992757152450749052623330655665369939099",
   "1"
  ],
  [
   "1087350466445249601497380830243159118561870523810438732376624361525383356838484944555486089142461665277685727965755",
   "273388668192210036559151120054452847312115512738279830518028894184500694026098729253880352501043221960147096680361",
   "1"
  ],
  [
   "1564257076652157540805068699428672900063570339593648454147175041183793024182450646922004980384750210466417266910943",
   "3978437787937547243788486710138264827308238918551662843509346070136364404676366764512784733003526976057002197944927",
   "1"
  ],
  [
   "3853275632579698571884597664181748640681816608105052905221669523686783883011152301860667253435721698031831537171408",
   "3319285717279782490365421411138404590810614295480691639096014404102602789333979277280731647308773574170546120142938",
   "1"
  ],
  [
   "2835390290105694816342515680153767825334053532286177263091618094388547377543945127904897747018962003433851165308087",
   "2591037850770849700504865893399274414644880103320331855665028197863857912323471656956532440895145469644549235594236",
   "1"
  ],
  [
   "2179862869847934089729722564257717221503699131386532791129812318830639592847299863168764863009568891092430961027001",
   "1211314024519090760946787302762683969681695975833383198871752777958410683093888274826088290699443251738716195647637",
   "1"
  ],
  [
   "3358042031470088097899876803921773050148143283655356151460517457665879109711365888444401641679724771893783922894757",
   "891603074483380239150074862529435489722619721632286155073020477563004393287880380149066289973717658505164645123233",
   "1"
  ],
  [
   "577597714912525754366775056955107240486246530854355781667681316931373309786983688866605909503982769846657090441932",
   "640176705618867328671798612954974453906827848880429417160531709259071492880826267251934755280147597171159355305327",
   "1"
  ],
  [
   "3935838140447800342382506556203934703070571396758077274253425351055506115999823744325765241914359043390369551722846",
   "1280663440104641782337056546880025877814640921551632686912579154759734002802811603763094502817355163639952145684251",
   "1"
  ],
  [
   "1463258939664474990102013516066598463493097767865727650390576412081833426124177755911355535915854711652755071725312",
   "1403220160604674758969852231597159660851597737528366752684962381242333239618725745667764525068900299151439593622001",
   "1"
  ],
  [
   "3921831923136274490688454185023775371633538608174423978077650870123948397651426100167969694363123737579956953913083",
   "136805184590186912850407690114801961627689955004149788031116774241549875267883729130549453992087376185406377232004",
   "1"
  ],
  [
   "3700801252815675512985735497342105560274504761957843773370426974040159873316004110309585905353002764604735831796411",
   "3689760427961478673722137761076288909325751533260311897143836474852160474693718753562995115345836152126777638598644",
   "1"
  ],
  [
   "2121559667721961344806464177421562891012723878700262694870984328494738067675556215610000236090794420898210346369389",
   "822224543253235759408584842277437220921551115905899121612924803290758088246328887727363347590597595427926819143170",
   "1"
  ],
  [
   "774399121858457912233853955841861593870598726993602709252562625137242506084247371182753685721166530301466838993325",
   "1364909633799456262397810541069849304055181139191381975941144652166927332034722047620440630869629906386982692162257",
   "1"
  ],
  [
   "2832500718583269812656296783926741297523939927241554783590752524138498611418166110448130658573325596766163129662105",
   "1050373176497831739325858597899158596824079663689363005837442898936138993536454664650906990012130346836916179792105",
   "1"
  ],
  [
   "185613426109305149260964446047592329479716050859011861765078952521286806699433841119697292154544148447075514552239",
   "3113075267890375178455736933135245101049846645638170814326604890191289507787256398561193029747132193291434920396376",
   "1"
  ],
  [
   "686742274524943822371797562842490028558454066579367270587552191926886471157070087578273044845324796739700631375325",
   "2012759860421270509250986265571763301645277429967232196583779187026512366814819265418087174112226163376505733996616",
   "1"
  ],
  [
   "3987451384298999017771294673804869934244517301072291330808091568012116829175437468937053073966478008775196884439056",
   "1442580657285923099194846137737154361314873249901585082711191442349393890267910817998674134687769058746882301786445",
   "1"
  ],
  [
   "3934559397339795062759809596671958451378485928288730531982721485336062174322308560448038922911313369336476999521111",
   "3220042717254289632857649730374369546581859642364707889643956141191953028135477630413844642621606671250243575250890",
   "1"
  ],
  [
   "3342852960302595519113019119286534533446893370310900290217822321509701240717399026243013548727412369311432930094580",
   "1524143579473635969128983594960608496569326641310229447596602281036718111295761225978903169321092506433224895796194",
   "1"
  ],
  [
   "3704680664957497446894782401061867949121748371068153483184285832657986598970962922560776406701981474033411594486299",
   "1611158336139288396846453537397880279807127472260687450321382864092075231441671941637335577959705020181759232353615",
   "1"
  ],
  [
   "842934517977810649231783961124416013112679800721563816099733792998580604353954836875497411465218310739159903295180",
   "1561722251694816528792693876261240834469880126027433180978937867846723918894743709915129846128947139564643695058824",
   "1"
  ],
  [
   "3536719277184344736018377375235167671809620289717361240577788384457115134847861097937645255031881450515427180732860",
   "3733021108870155524833507537051049785553921773314042238200968057989781570948725310292047679161648707101699348448102",
   "1"
  ],
  [
   "2079095584501955709635681282571572431916135505092588533248442496180238371598735117495597691804060987716269369475495",
   "3718518922193729892041847779436085206415091376607354747119490378257678039051601417100135222222830338712731770414117",
   "1"
  ],
  [
   "2629061088693688684423292359487658920136401866455018775289615436144412308882845217349081262104521861952998582494832",
   "588461648500332023589133665879770799746874434070408389408515354794194048149926295574264513147786009235497556633060",
   "1"
  ],
  [
   "2042409588711883353279940828018609794551525875616298131207075931073946178373502776641305517976437387405993348588802",
   "3148202504065246752155413652371457347774526987133023864644544535497897174891483457714727875393113910920769241536227",
   "1"
  ],
  [
   "30572179941426813339225817763298840257691780019866667904263083806987411417412177521921960425491170845878430563287",
   "2202055095899250228673967456264058607169276090831422228360977733941375912767092242326532506680212527318262788245983",
   "1"
  ],
  [
   "2944173038647388939074569281605022916937960120040166752189468654530575727141765252233476655266017817238762281366785",
   "3861868758643734615025584323291599591451015993788556739689293883441763246379925690819597122544298024276473593412451",
   "1"
  ],
  [
   "1351512304377847657485394130607621589335556380391798340579939448907558191646208438119958186100697320213116619304303",
   "3083379206446455157647923769557532580157806394545343995103958254307002455418506889298108221285424578856829270688710",
   "1"
  ],
  [
   "2433656197679870487381531997429787831588961985959839748635918272984998913119973821416356442802587649765366307685058",
   "2981551628213575277007806891655393683797231827094219225425435740549786302019148118408655274742624363838960401451049",
   "1"
  ],
  [
   "2600467118168665811727598147653988793785891123966162801008623016792930897336992754426788448924510640333633996994340",
   "1219673061575922597110070526698593481774779037710844661027687951723838311015985218862534658085241656987695804382639",
   "1"
  ],
  [
   "2540549935095300145384311964876638613686058481769280448112095384450806708637789081434122470009476786721918212466242",
   "3455797035849756828161093571512870236944746834652871289735687648476461415343819030594928366042457022473678742159643",
   "1"
  ],
  [
   "1782672742115922001180771375755847252636674532121912547144223494894543509982751217604236335807653976371097504278065",
   "2056625777839624295357396785160419033234196488535287367093307858408478724239723023163923696155521013063051129369407",
   "1"
  ],
  [
   "3487688355895127327155861556377832018303914298107612844897815407289780837276585282698235545700335260002223758410765",
   "1546423027299799687888323271431506009770305378240974571478463940645630913587466774196734582690179484177042408415119",
   "1"
  ],
  [
   "3118460496773508865416725335247000525064504779348075371293590737704386227202883463310657729806049694067669311926161",
   "1961892220114837616834107711477858115192607520986215067081930207169016667341397659085357463701224706878021046938094",
   "1"
  ],
  [
   "1398732353058359754906970910057870851567614292935641804863829118565696970604422256198785808760458476410021329834928",
   "1010694198082319377714666413995880685781992621961084395643533334549041134084985694514176927516143428777618314508440",
   "1"
  ],
  [
   "3177217629895345581459490318133896961054186457366189808793865225127653083889588645746959679670543340826955525495670",
   "937531538246796949694457159404886589657951421857360173854472347684156971046501700435152913725108234846802962263367",
   "1"
  ],
  [
   "3077452072895288849998141312717223237403972009964004230321107372310172750989101298443398151892523233250086399822828",
   "653832705413995003342727315583889307740130735235118241553182683136304296751918493376216385282889587067493815568081",
   "1"
  ],
  [
   "19040734527884064151116992360191490218150311486408927191120952360887746977913795349602919062682124597325207633229",
   "3715226842336020143494289295187098128122385389264628902050891775657040422499193287366936356862573953147098918039235",
   "1"
  ],
  [
   "266612616976653941038816760901928652100068152561573610004294158513860057900156723136720109492220958497771846167370",
   "1743000153866194013392054327640718377670104636153674247064428397580939104426825613783905418035814426166586275628319",
   "1"
  ],
  [
   "1364153817745971179272357911871518556411433075543143846286218630626600199831638759055849525648081889561201836360988",
   "1171669800716645192108414746573712659794560024950180955707029731552389463071052843659555933972623363458487773318084",
   "1"
  ],
  [
   "3835077596425239398987182148485305275384729172589775951304712617820684282654778018898933013344466337232218911946049",
   "3869122653294353256173165456517400441404722427706919661726234212180820851664949839443965442956534723472933741173728",
   "1"
  ],
  [
   "1788441066989743450762144438071253719335837263116441898917401001153113504843290260621731537279228984681926700524745",
   "4000050504175734846100534419451228179537323160740448044740087148236594518681822313102852270394282961032634156060519",
   "1"
  ],
  [
   "895077734880347398583175845816735464460946419472725920209765447441824875724789251442360053292907557162069173978158",
   "3783418839399650242115717841940290196019259611983184890017954977745622169591991604197464849026985500102904228535449",
   "1"
  ],
  [
   "133859302395737953123792906178427072438757268116162781116519440311137148242853751509930128974507423492534353358323",
   "3613129359749364178955832704224289387754558875581008410236650549841210534446475731922158267114398431658154744636880",
   "1"
  ],
  [
   "2225911599687253434017136971614540670252268382360030042828480055010568251585114360306420418550846732630473691918027",
   "457429763172641245560413084320657513843293320183032796754501952281607917107093023332205112804686822222643391366339",
   "1"
  ],
  [
   "2866780468703431124365618199200029066370691159625974536597673884197011894103790236474154659058030513701881301898201",
   "156846265928794496823170220037509751286125824630372427649400072279554865832374481517313809923567190842443327694620",
   "1"
  ],
  [
   "2411814459011699430666235553972468773049893197086008517173738858423131282428467159323093046153957116177277847137015",
   "467546672666833524357974636236595180863136483806667793742424809301204442981915460323441984926978086807790718228566",
   "1"
  ],
  [
   "2623478083282021291552040688893792114467016098014188909965916683758652851541845396390083899183825092289809309240858",
   "109108783401146846155009219091161647749685037347405224627776988461877054695409365195493633878929690086224175138518",
   "1"
  ],
  [
   "1948423326072146028958064095980803740041268278511966124947069820543131084153716185353649467207174346904321622724234",
   "1864914215031045060149583893787954407280230194669122727534071324542679254108562876314642835798986827595916456658038",
   "1"
  ],
  [
   "3298342437648542358041664994883491408559689709044179071114167869270903548103908482748898658431471828903363250213698",
   "3634263789137930147179038609471912427702179388159837996174252692006711624745021424641196612632942194301508300820917",
   "1"
  ],
  [
   "2686909377967255864421809786266748615149006939346457119255316681432011021564473035755231084388317875168306472331289",
   "2567460715493275061783591737416482026487504592775934055360022812667025035254028113204969489242632508834095559871387",
   "1"
  ],
  [
   "647960226652107751606191744783182735861813436287473938807443344870279659450004575053820913802666233654770667038310",
   "1323925031002300383316480398032805434368401590814229440099917978849632775870232632686633048420791228825750896767583",
   "1"
  ],
  [
   "702822615044915984842874117627034734445869277202074825602179796552097646805181576775698676627701102260933461120988",
   "2896431763296228769255971807762721065006388584770712676904573944949181564972360138591703541050048490131429391363732",
   "1"
  ],
  [
   "3909985136538897706061580979380716885618401812999721308601061802032250806155404250823568852891075179089677790546419",
   "649572819114086040600474044896783788702798313765663504244731625873283471378584548342191125156190300381739130590853",
   "1"
  ],
  [
   "3460765470498877091804311088042609380951030042435632948467186005611875178866391482426203593596403625136802321705702",
   "1780666845867781183187551708538294818930562352826782752880475187744289361676733274525619716196061832664786641401197",
   "1"
  ],
  [
   "2516016185150711189371911534771554353499420350797502398029528689385178749642046746123049459349419685383201458976663",
   "2882060884080394927078421915866183267231894872854897117837848877402739450649092681508255525060876274339071224353667",
   "1"
  ],
  [
   "3203550827829592571968919929169563475477028921432024128943972386015530291535966388105390757987939514255213387830153",
   "3829883989208717638734217701098967429925343315409465415330412689842621795943575209423103862759607160300350332882495",
   "1"
  ],
  [
   "1682145525945730693935799320933116261482105186298313480905313106539528016791207856099970296025192535532234168617251",
   "2127740505543606428324368606761158996141789751119067444128234149821198814314184950524248460118614995107433222977274",
   "1"
  ],
  [
   "730475814215218761828889134168819331092943511400383865457080498773040483802143709693360726891615319135212548400562",
   "959559689632807991759255611297873279613232821156413408879883876335894550941934890937201894954841368891346811537004",
   "1"
  ],
  [
   "985971192983241942440963826074544584441940466347689254846860358234394263473804151717960397940283630598126829020213",
   "3806499725808366631123699379821023989025765547564842289321981846746281348672986062579282991257723703407893133154013",
   "1"
  ],
  [
   "963778766823171516681894092838873607976879441062177872900972876524863093469964574551395721314171662292757663104102",
   "393722527036901365881193516936606967075224785971917596895470611606329290855682266365566096584145860503359870686338",
   "1"
  ],
  [
   "1805757642144880994261671684950127282945334898897562482908731977627647665010418864133278780295745745870096503966672",
   "1142193999822684411758454972144657741137920830183327046328514101618199413185156826943491691600105914000299562507956",
   "1"
  ],
  [
   "504694033053023975475497114413724736146074232745850187538503759713614900569266642173435520596864883586029581906234",
   "2424193829665568017201107651689566514847898207502739955115992891624378280410121350191361496185381986656575761542638",
   "1"
  ],
  [
   "483328392060595280245008223931214860650347047758955083035911513153945165459705729534424917817342145902555208412693",
   "489252022191387402515242762311032043524252076708347339032157313303797013114372164896042392314229126903519788593591",
   "1"
  ],
  [
   "1649470003334380896057931033250406628520217260247222280949052778003065997411698504565970942201665524975219380542865",
   "3490103057741054689030919908451772970935837644091484770419309285340553269276328748399861092201836074704478457579877",
   "1"
  ],
  [
   "1937741793026140127563642799397618369908840285237219932620117935538981974378757544786450779730636911303889831738361",
   "1406894081517051688842271509928652349558937436335711616887370865790653927148296818854256573087392906026430110379824",
   "1"
  ],
  [
   "726175115594191999176181052723828137393806862464513349827506817423843863481177328525612220467439596432694146873807",
   "2956848732790288945608238066301461547226242101377654068946138030386001257367312043568131906815341850008749001697750",
   "1"
  ],
  [
   "3102545032366463877959854437733286837663959816784102025770413282178662117127739254531710968009447781604203876852905",
   "2453597072965921753224725745763256401961290183151186727554107422061613150885863646473503830799033072563169109849200",
   "1"
  ],
  [
   "3168525291150307764868225412516529986069980506488279228227940576722807057707471251214953544473430160706920824372945",
   "2050614345885129543269591005467761844077445443473099701588081590331230309760079856901672054855148079893351896501992",
   "1"
  ],
  [
   "797521579383458281836349609821173756396492901985840052346353461044636268077951541076007735800598667956886932481451",
   "1978009863959415437288122325521399530494315182387613167294630667420503491777369379468708613015421460087194473969046",
   "1"
  ],
  [
   "2801677158320094323625539269110037649885169794903690324335242417397758757134639542981202737827129121095723477499444",
   "933703449891876460904900748382131271645604057188886286455983685142069221630675527860148488263363998551614191693873",
   "1"
  ],
  [
   "967449784058928271065421907581212054446693739081946215130135314456871095629900262279959334009614751333874155693330",
   "246158773544760420746292459200858217348074989796472277697024852011152448181552381053196880231573505039819260591362",
   "1"
  ],
  [
   "3742720909448037349277518095177829320793939273772415524945951873102620540337190284367310285141853342366163856614249",
   "2493626733016484648623968747909075565213217686499122992399937574185961701894964315602895741020716789958363549790084",
   "1"
  ],
  [
   "3114580941299838533231542678115199047821865901332903615591613680937834333661456919263528690902553925952079774103752",
   "3258368028996705725355419720988472814929636644977400882707889071747433709793800224300052494920564631783310698687229",
   "1"
  ],
  [
   "1697676049261822932003081135938670105297566325447659046521173165715479987129817920073518444404420665158635776242691",
   "885043953044922058197258070817331985150318689198161809072224335006771692023730830501117339150697953459365843350218",
   "1"
  ],
  [
   "2671062892777283615267453505016532680138660382112116620957011948197631624913233055307494446382529567183751856034651",
   "2671261430923493757186914790594057061853824109768399716247720072197024593220006698267470420814845883650910094048078",
   "1"
  ],
  [
   "147470207536284644876751104956973624603486094056628539980216232762482585943125317830934167599855512105283952735498",
   "1227015715499773980828956049201626371441461145448346384618764747170349894763042171484210185065276523396751848764187",
   "1"
  ],
  [
   "2114996545733387149285322017262556972574593419081150555382096296365193524882868154506564284700235154306314838253090",
   "2060631434111916828700238802241194870189646464754929907705128213548639154382439334250050278552472419917184732412251",
   "1"
  ],
  [
   "310743417821074808656870163255765292933312016250515991224261312380506643553830588712477548924004654129706055142749",
   "1584819101082875332011852639208425671569037035493307352928057889973308407926431985733980918822173600521513320014106",
   "1"
  ],
  [
   "1000961290443022490701018207845169305797903126589208893686122858152473817870482324057856778992307796130689886488459",
   "2669963679314585789503238437418812282602242762140730900236096021749369512481966626115928535543533932680708683830328",
   "1"
  ],
  [
   "3826011232657563151627288711616580912129083239163401246644001733645993703831165071828882539242592442957298171379742",
   "2737477444270669571610352638742491790645916260014406340918814818604964889937429884889094786793191455823803408069751",
   "1"
  ],
  [
   "248109858192289009270159301474906461416555871724355643038746462941762867011583669682391137350923036075030077764905",
   "2968481121773622545578488870618491826144677584188881903817284935578818659946833158501412766650020422670825288226462",
   "1"
  ],
  [
   "3830817806385181785585371556382503078832718654061555605411972391216007520886026555856070116486329563048366143623632",
   "2823464156550392329581212020852439004840229383227936342016936177249298304385777642928068631899848140592669655138951",
   "1"
  ],
  [
   "1380439841348602918885106049784400040244961150877641950257659816632938674580434208148695004769280574035501398688659",
   "284825739294016427658052171366976692476492585103568702311185716291671615104329331583860485346213976819595988244283",
   "1"
  ],
  [
   "729504862044490998022399580540283314896363015138184201230208977483154323454344686014039334260468291457643596927563",
   "2122713098302010887482149800748222472095863992838674705053650079099167787036175177950091429695573137637662176272515",
   "1"
  ],
  [
   "425321886216922636434632860907866833502008352634407522926877465515661598815068060273833171061741645897436817327581",
   "176972023920761282259770892952885610902455372263808566029454533939910966711761624782116430584194655341850030673354",
   "1"
  ],
  [
   "1333617797504757985114179998179484190222198929016321269917731992148882638327152116164652256839583556429696461791337",
   "3411707787326010862433097560295527765594085081595410738258071606751801406951288688678465553751336143700429806077555",
   "1"
  ],
  [
   "2827851929215259256926784022466128467453492938406441911211811295352023588476394346092412220018951136761711805047881",
   "134479584884956234929727354880644600586980006069090934961800234898744033257150115702102685384826043216239672115192",
   "1"
  ],
  [
   "2258643279670694674909664924576108120631524750679517107753992245014638218754352793334877442688457014753836160225834",
   "2988100944847172063308922188049185828102585810104352610815232569840204595414668215334120862543983050028362932563417",
   "1"
  ],
  [
   "3091089344655234520604405028444139912008645912173382771060174099506149808399833916403898102421132675835744189753",
   "1794024946202675684968116138675875324890718913241671127957544609241627811810398625632400034694967775449871296425039",
   "1"
  ],
  [
   "2419287037771161776505297492739481160818404576803780769076913687861522950015368517659513845616433074193716052768312",
   "2035110898211440874157592233007167070286111233435733161006030574043175209184375010865136003111777636408354954236433",
   "1"
  ],
  [
   "1198220592157012354154882864645587288423777254933817914028176916373564300468565217161386045564567751784547428993280",
   "3885364732448247156931152342408746268705799302762434771831910301800477170882182053084105987497087680919530805350948",
   "1"
  ],
  [
   "3061457816414455118803539341482917941188213094467750426468583405903623634819735107042145469975913735831547376636637",
   "556695723757112583278138556912555278166054601174596943490770278613177293150847765548234359899610814039626896611035",
   "1"
  ],
  [
   "1318287131650366604685021777550317333428922917754172624987059133953690468139144773051345441996166220079087684341727",
   "3690377914434898032685692516510285164063709674612724744976242972539318573470036560030555067493309407554338419149285",
   "1"
  ],
  [
   "3559074003753675845038704565481600346010947475446081729535945419390719579508815555827890621035787996358857195862396",
   "1204110254084665379317603982938600427230525159112518322504806705436176131196848294248722972169467334355136372799350",
   "1"
  ],
  [
   "2763111007903818004327077761464380628884214736879811456869018263681155413948091136684172951527671660235751141249606",
   "1838794426668817121756358008504318483776145651372543450786921950210373282998342390951411244105977620083003849397067",
   "1"
  ],
  [
   "3078052435665220964425902638796286487245132778242786087980868084021619445680087680979409971647520337172068690283772",
   "2065788284394800630841904944911298847107408049748110025581854949439592365100854019770195161182566839228302703160006",
   "1"
  ],
  [
   "3192946380559398345211540917128933391505420826866168599621755594309697600767333449877215019449787048907186234673711",
   "1033855389608266592070395599748591744141974009986979251244974938826693184261332468502433895775076027464300903176167",
   "1"
  ],
  [
   "3254062865029591733705393979987811276359410221807114974878833309339423386860331432953188196279024983124367720952580",
   "3003479901334201160637251874281439124515404432151091013464210822613829979829536541158612607858681210514174665458974",
   "1"
  ],
  [
   "3608881365636698850609874571678845872142939790473983880208932132157500098281401658257123466264351972370878507114830",
   "256998169500965610801174657743497015975227420374888242573403548934100852039898460270552929689923639045431855849273",
   "1"
  ],
  [
   "3151885211574039416244491963815997331653251240620381564829182745538164080824094351723025609945038815190673139911121",
   "3902713317621108934635361605511337077648853536849712333034201075781827549641168193601144468946133983159874054131468",
   "1"
  ],
  [
   "826837413291472286925303510568788361983488660392294752692923303602052600917928608212454252474584270257318771103484",
   "706405372985855074961880425408600677924750330359914762954837694179752786577437652331234863994005681825717358645136",
   "1"
  ],
  [
   "127228214350314269096935438629192822398230496059691856807465609587431938558077793860667248273641724054671854115290",
   "47839608548329151840486942766024706084531015864241322479450774730615902224069295829315415601388934556636860143182",
   "1"
  ],
  [
   "566579622628649804590420713837540495706213997032749813199107462212316224563533813317098564434359965205731360823257",
   "1346191120660508171989980174518682716481060012997846696895591342004147617002105071576032198778566306445480792565387",
   "1"
  ],
  [
   "3325211035605973548865896544726593518851536549494057980596940448699107935412884070354950686762421013329111311112942",
   "1766867984023068928136310563245118379566979783639850307213280074401452491826322409441378985618476438440286711252732",
   "1"
  ],
  [
   "1367790042659595805690246799298964425594068748816651210250861105117882911983115803182631948228521767639541351421685",
   "2354626398040762331136066742424277892152511857542134532542544376176500887948173562399896178964034972493583481696921",
   "1"
  ],
  [
   "3939110761334002287005673593101332181774051939560307587226156515159427356645206671557959200670452864646277381287463",
   "2258603681880655278355325033225845877375511576492393337064410594352137744666502722676506490017421463420165049021134",
   "1"
  ],
  [
   "1687576311213603571851386996700002526787437999276140462422419022445659919856993823801731773724249579190608350442427",
   "2444690707459800202295198183346059285963609247780343359310105787747392835004961965868520239939363618674934539247403",
   "1"
  ],
  [
   "360503086976410504195654988894767881877963174211411219215238956408500244311518428499272608560734133238050189385439",
   "1783906577172832093969155444393252417911129369135150033362517941272619135474240714905962726458360126432683832968052",
   "1"
  ],
  [
   "626681560051771975801882256825241778152581903022993984803525489295625517739409299708408093799474406370232831858579",
   "629518033535774922326586238464555855050508336044612884265382705605643433767043661032887737930443362087087790279825",
   "1"
  ],
  [
   "843462862669378455782157528709542827333766844789826055831270529454491853224070486731346105128118976460248492449947",
   "327190262833034082931185554290850214527860319251783857194281132819546621843606727453891099174118779405729326561196",
   "1"
  ],
  [
   "2126323170028843415681042220389485961973062933240793921713100750582638627569508715366192169617355173499219449048355",
   "50430425417043894397569829059465888527541715357798941154434857498838345987428807506760390342881073114902732857164",
   "1"
  ],
  [
   "2659031956234966093066814731726724904471509254684027906105185996362798821816945024979976617125045180731491672353813",
   "1743486324768046047889886231286879509265820629265825987853428825255089801897044012796616804189090825577673924210619",
   "1"
  ],
  [
   "2732171816615424651224658253705278111839340297147044278445561742945839552121191314262028832154034521573318152524347",
   "2128059159866951462647861397594906412868522910914380281112888659056671601139633716408771711611283046764729373832792",
   "1"
  ],
  [
   "1984956569663859765102383060159208838338349796757335714172250353462165256026854983872684460057013707894950965417409",
   "2697702733518772734375689159092086717567972882377331813037287219410847033967441626699410390001711144040987245371233",
   "1"
  ],
  [
   "2105369606388733058923897450946057828179387494800450885030648421950907910888466094196297705616561360125614956094289",
   "3363798141833346500645460917439311316239998579710457749501293143300567123114754580264197190395239870318902743163016",
   "1"
  ],
  [
   "499230105382198115900258314233508915050784667606269842833635315415833800296149612482362612026925221989740096588172",
   "3863056215010493134613738512864557288987692522500804092096693379986690251059068973026817508543428904846840584473654",
   "1"
  ],
  [
   "1525474555862731404164092794864572802664762680974655742435462531381339970383649527242267227625229466766326686785861",
   "3773918451271267139683871981225590161312865215795863598771674403002991381083097117036651771719736204869516381363184",
   "1"
  ],
  [
   "1060179815645241775229688247078435347186194553889526045878666061641321573713205930846398401183613217043315684334202",
   "2364537332280549837097091021338083303841524192459286889036978494749282069833995631588742799887806040568401813246306",
   "1"
  ],
  [
   "2191558778978725522500273990298781436560459280809308568526927863420394110671003027998078170176733547922783819080018",
   "464740901561592547171522864396808718978469110939490313748507761301709643389302233487556983273523873482531780193836",
   "1"
  ],
  [
   "2041802991195363410148137520367040248103608372081159306594392431323812322449069131177061502828259737422836058662303",
   "2636956502299944090063656160759562342631109094481240524789645068238350944269724391014659134465115545035689754868400",
   "1"
  ],
  [
   "1381899158422379462695276385176050148212433934501412028215689890716197123384399475170806900236811739431884188615997",
   "464932218787912396319500398295616783629831558286997206966538966048555480039250922928277522983910057944421360438598",
   "1"
  ],
  [
   "1949148182637306201136035549282659192513641023796770523358638903018261209001815258792295513588597677949522171712545",
   "707130179593742601469695618675419913421802727353502754271674964424222784558460646435706942642972404953846811995883",
   "1"
  ],
  [
   "3358097065966427698905440484112165599959469586348873709767232779175939411228525238844028095110544501258554656885121",
   "1637813901867755713580594228429131382811419136810187196835164935817142562890733363826836618241997812868375755444985",
   "1"
  ],
  [
   "3514697853550407854147712224668681526847089728515363487880638690986016425263020538522853227331999281821360136427097",
   "3421624253775896769136101444850821596510903414747782138006161613911959953691008767764239948773425457023969903844777",
   "1"
  ],
  [
   "3786101159010843382534755508131607956684519070413352908697575766860520892170189846597988268567609874019196305767926",
   "2397472260090614118550718692899822783334836422466313719184371943100715873858727449016359353665419997011535762042323",
   "1"
  ],
  [
   "2688506912140068830837300009713781762147684412631441797986390067106490566863604568701393332407067221148751608924687",
   "1820644344021656899729879614051166313876321873668328912968949404468315590618280418359247138355118089924998566511687",
   "1"
  ],
  [
   "680343470864685056233618562877304596026018479578198432952642716864784278291415848945375214083039533763589570931291",
   "1037256470714188190017179200829766672524394136190439271637230707497111091081465699217810847711037824906043382869997",
   "1"
  ],
  [
   "2461599137492036206848326880073554676240567885609069745802139801052171958182675092524865733398203255942280597405537",
   "3767511347888011573710925828696177286077313875458401301774664733087637799472769536247579733509191782308555198122652",
   "1"
  ],
  [
   "3013584599023867791389544359729580864071916935010198838659501401996742393035201903887968950494399093932439241863759",
   "3901431752626060349564771491181073570157954809539583870273101243591986085490726744807626083573871018525423217365643",
   "1"
  ],
  [
   "336475561037486188630717751260244088193976846744083614557774078242047287087790105147154673291244384235586390826248",
   "2983816741842722371124678563864053899731138961182458989931705461210504043395986875586777827880638738926443969466591",
   "1"
  ],
  [
   "2918820584893576938612659477777286622822186227539727021706318057865698906859446165372856712491053326149306603895224",
   "1541305513212231806081076327831554531984197338184668892093375458518746775464999522928969243572282034433449112757739",
   "1"
  ],
  [
   "2291365214832625897590079861314510743444392055810841035364345711713449486768484018851436895225679902899882972043564",
   "706230717336118751717023998586611765956726992424113670636779881203183338859728826373076582525212232146422224198610",
   "1"
  ],
  [
   "2993487877856665362197246268192310041116619615373528108431021222717486352290932104273288029573890144560365897278561",
   "3991703813015024730165527668572218028223779977667001178374136502163048817792423424512122769309811694065787916847257",
   "1"
  ],
  [
   "3702763919847575871339602567898929240747923344669584880521098433843127212394432024391950610607401006270131463888944",
   "243041791740277923415691763570082569221151733132458215791598335501907232751673160947166897880009546860211597297844",
   "1"
  ],
  [
   "873768260897844786947120767163569035067032617811847199926673619134546554682692934079649004026864366837034354772408",
   "3761908805104571958336808070627768772209386100610170523757778241387308058346351889806397416533560964362268327536458",
   "1"
  ],
  [
   "652148632269791831022163967054924388289876331452988936902710394881268313549199004235179796645800617206830092186683",
   "3382073845171915748706367807084378925564734240053392315420879821953113549862288367786962636058423784024307713209923",
   "1"
  ],
  [
   "3201434819996661333369629008408275568436516176124726253412691653849794615299341086696590303406985946238994305655450",
   "2123413819551861275119526966904814352120659530189832721583169265756485954444629526095660602998935278755613675302463",
   "1"
  ],
  [
   "160993816670448432424597432384944749169300555869083119422662284254972291454379960670276700370606551786451716548758",
   "2475394140512000172642737547660601816802314973279183580662876462480004936010783959553334366559840090401523350688361",
   "1"
  ]
 ]
}


================================================
FILE: groth16/trusted-setup/16_leaves_vk/circuit_final.zkey
================================================
[Binary file]


================================================
FILE: groth16/trusted-setup/16_leaves_vk/verification_key.json
================================================
{
 "protocol": "groth16",
 "curve": "bls12381",
 "nPublic": 35,
 "vk_alpha_1": [
  "3981966757452716976893124276236975201058851331715985905074844436842854031784019831833244905153785862805067701562723",
  "198845203485505817716284769462206507062739181564988145052200638961370812955502930899816628145044962896640568760376",
  "1"
 ],
 "vk_beta_2": [
  [
   "2830814352466663466845253122603715133721914305785828707520926698916769818691867854472623089286050688820672426848014",
   "942083209846822486906862408308732175493874072543639080938607318004104951184347047076168091600373888960549464231180"
  ],
  [
   "3762661934742322535382617952476190550599920001908590028843314588418289107131752044550737928481207627835235034908323",
   "1610363978260518077405042120915735533852302479679725313362071239225477053869656652933890881271839567407306208012312"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_gamma_2": [
  [
   "352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160",
   "3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758"
  ],
  [
   "1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905",
   "927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_delta_2": [
  [
   "387633384191533822712725581191036785700807681696218143556626495926441220259660084137336333954805423101738533326926",
   "2053226782939253201961816462336298423144900189969772295643996057984599265439215744119420283882053778389307084580692"
  ],
  [
   "530721605952801702582499773426702162885684551854178368479590058899580748550525439748358707290376968763904705435405",
   "3828808503185896048852679532135687186727505180719454444734075424325649316164426609316800544991371780723813615973469"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_alphabeta_12": [
  [
   [
    "2238223316133009849563673677283584589557205070581798242179644512609215440048849485397830593573664886827648766256075",
    "2756897337309483678487524155343279195994797374243370782124077038734575880275793912828792238877454472508930211422381"
   ],
   [
    "3672160613320355189967266872932998931018845543952498909733884456216720370736389228163455357281732645467093600214039",
    "3790276595079374756462924943722084137735727489730157074399452360521192396872462165895108250619470725861217614502622"
   ],
   [
    "1919060113363138309567590023192739608738657207563720080569374750871377241936975293987678944213319745638996788609391",
    "855322626524150678634602481292545142926791281980314121916273522108995974267708019770733138059177828423511556854577"
   ]
  ],
  [
   [
    "2051480982428935748733084624010683544369627863853200959851802510417295953547997529767881670216520436006382851071246",
    "3776905150627334440276238601176371108600744345739461948353270594287054340973875895965894399668854103765146958565571"
   ],
   [
    "2078727279426454480935277644476064629933514499597724153080090408330173097790348915478196691770402247595929941696712",
    "1882881875100439434070226485705079808092574577356015122407875624060612632328021646090732845588800256083853336331933"
   ],
   [
    "587374589543223550617865407243296941790792843235731705211100328392862786932039735096301991959519693509477184338625",
    "1014338795349899062453787577655034194608402346490089168831010210518727914838146818912786726983522432756432717317251"
   ]
  ]
 ],
 "IC": [
  [
   "1902031867677116025541552590466968746386149184267404133135343595580704149696606942377133205846006323153380447705629",
   "113905493805133026982273208799928893694061210684154569283619339764784688535311154361516057604896051206240940433300",
   "1"
  ],
  [
   "2559029151228421155892061745291934148366232372031551942558028503966174252614985502512222892315247037842185034960782",
   "22969032348347326171648765098237883607204933599879796731346338705807904212955466456321138038406438343693315573372",
   "1"
  ],
  [
   "3446225733862393162571137721747703522943556091341375129358995755954206191580125275331111545313044121369201385500170",
   "2920841335754173995296478365951495025213899393457272599794912398265211363323313717959119629503872550796936519387147",
   "1"
  ],
  [
   "80228860966486329691705049330278292220659076345997322994253206346801954280892615056717597588494321316281114872145",
   "3059446522244176663469294924320945263812441094556948968334598047056938602939799491462548536175287753793052112704592",
   "1"
  ],
  [
   "2033961927229725860055043551022886991527522300439827178033290928300047799123042490571637033058655346460721750179874",
   "933552664066651516177336700810018949869792307987719420295798356578045412362152813753193592692607463232855554509251",
   "1"
  ],
  [
   "2571296615199471697448832506822923504735096975571240348934428844454198992730894350850446950760742855191613405977874",
   "414980971206680693260233773584296233194151427780867828972027018740906225386494494261965173639625469191147021109971",
   "1"
  ],
  [
   "2329724807405424525301584638495547987117978358539185701562962193517926491812428812799254958379961192346717017849762",
   "1784780932657008107211409300661532504175209266293224547417980795824054497978143392048650214094621376236627038744891",
   "1"
  ],
  [
   "2706802325838697415607518718973398042620414479534712925679964401220470234037062443696325085783226458722505619432219",
   "2664556327762535449972066971836837546266646797859485545692969893193424673286334217175871194857148734755126769243092",
   "1"
  ],
  [
   "2254150892933469870415826485765449680344368847150941267492385192623194043468744879804352706112866344428396407209499",
   "2575743932910061633972609436052999841636721592306504018873382551395674438839220008762336057685438418871213818147954",
   "1"
  ],
  [
   "2342456308851513268133769104610019765341764398577589354364982924722966100201517054803682000787080569744647183572126",
   "2029923074258062330902988852933422058537036701403824177568856608189912688406483789524060801878010728546072225967385",
   "1"
  ],
  [
   "516542907243805636877320410824620407267723799953179305287698849141039905388661077833671045617635816950018949693130",
   "3100093717588587200721593395944158085812556765970312223371387086617749305347449829555641931441461733487357601158228",
   "1"
  ],
  [
   "3044082196194535668506203636398411388105198887158862870336412381682601722466187463422607682542297782312900948950310",
   "1892736645564427617207063176696031840479874043106009878359346864950047843099982305818120160214744646354878246081081",
   "1"
  ],
  [
   "3624949550080700674829234633051010480818222189649459053670096823918305727068992027735928239643102046623454089365346",
   "3603301403289355186526297794389841112771252907204741519936916620999505889358306568751994988206998340461490637659186",
   "1"
  ],
  [
   "467673607943384944759615764268580881739819222874627235761886782494560681077714227117098321199514047398083124445333",
   "3787576836398756035047231072573901422405788293924424187636913455068120480526680644092204860295906660278038752974572",
   "1"
  ],
  [
   "217663477570640015790883658639845933367616475812574673241638631306865376945798096448278606523708951913113278605288",
   "3780072793462519550793142346055613375923893223320198497806498705095315961129435623811528635824867930285602192541750",
   "1"
  ],
  [
   "578743819487466102905019716132699487534958842780402054060945688657330038915120507695377060868415344210698475698323",
   "3491037002857178424531096667012446215730344935052832663226760734462037650345937970963430071839053268517673325931253",
   "1"
  ],
  [
   "3299961612885129025149815438324687583549418548443930642758488082484322901535799675637776613104344383852415914245155",
   "2501715011877341166246892227072300307202129562121796848939724340459460106774120228500932164852306296063209056868704",
   "1"
  ],
  [
   "779444070448715194014039324241052902900257083479400075459608940162538789064081467189022346712654833000496735452688",
   "2650288654363925927041003703934002696154564908609259027114448222728506617570205941180626183576423766813454308646977",
   "1"
  ],
  [
   "1169959973269977264882243865801000579686478698692987286085605545486392360588336272153345024425649543693679798494392",
   "1870014962569597314345834318031654438603523919204354492188124853259410594954671476631004061565588044924695648750033",
   "1"
  ],
  [
   "1765407311993766949858557587268844246292903905168237777172871174243304136490750269195176629292381489478399389626277",
   "16181598782169468687560728462479990265670978171100635558558057303442906366729078237490272606539183799648927481385",
   "1"
  ],
  [
   "2254574920868985685020336129459025118804328314620123752062896150919708696846350671594918575985215791657047099377940",
   "1279592480873482344170763978481355424987950218738836307522963821255011106935068339878005816141781609094799377837254",
   "1"
  ],
  [
   "168070827579551756192812613404087345613994659317522426601148885711054938348861226818799165584779023326448150438789",
   "1032213612781670087673211742104062584425346694174263568657159707124829776343016994622445678919737161283037574326944",
   "1"
  ],
  [
   "2320398639603501205317736926079219571837091221987679132313523523116366556633938717734732943050840913832134782938004",
   "1011699336542930170233383136640631764230741026119114434728842555417819156870361258930833722432246632124336671672674",
   "1"
  ],
  [
   "1532491189083822201556503720164957808980755970270427434964136025046950172330582964644794365137045212416522637300696",
   "465629120335564144984688497209215351439229397604392586353930072121904591902269393122575554252261271567078383928175",
   "1"
  ],
  [
   "814020769776833068024947061287299777631520123368409453446042012647464410465165807954969423184796658531923115769725",
   "1143043189382696709960690085797984255457516124402941382684202832275925797869936075378623806648320653865448843268562",
   "1"
  ],
  [
   "3145487197319221459515558802320501100291122415410471960170837732707565586313467673966002100268021042780546163098874",
   "3246562464746684663325025368859216673897969444551496965779814164689861270302553557358078160338238311536572954968077",
   "1"
  ],
  [
   "3301011582365957233320454117392746110994649866285559210625642220230398123897087054666782926275581411834222347119805",
   "926918347107125482783737002864728406299275358111252700226506657168508533625872262198674636716835515754559304492367",
   "1"
  ],
  [
   "344105529301410209480112091755192509113739472048403868842535732502634162998002279928867371986759199420708873324577",
   "314426402720351499413831576528472628338195804829310175790402241340160513248576426049135996745263224525363917983907",
   "1"
  ],
  [
   "3696746725916932822697290774735128831292411224519521077961862545859082206376443734314773510355236601218253162264493",
   "913121606852895763681158705674045386011473456578997091756961673218655592398324646060847699127401159095518403764167",
   "1"
  ],
  [
   "2207221478210754095728587732536192403151012783979220868557935271322563925330280669932369814631866863164150008338806",
   "2368374349414452317834941157982480286733578146996822667936229440685905160627865245308330049875637429313725399227511",
   "1"
  ],
  [
   "303341280464749760694713201578859234554572889839119135982551403665257564034691798225047646602679542316360433463262",
   "3101114037374767152116279710627905050594333505807737995798567240062599195228679013636021510128267773899840596978262",
   "1"
  ],
  [
   "210681445951172872252230466866045708470889460401232095279824377522413356032995430898215304908992027544935626419614",
   "156706414342638557791197584918757121713152855030089521280143815810196729626889752973035741524521878214195912337243",
   "1"
  ],
  [
   "3598319477429974471072453236144530061079885465375838455640170467421381364246878303414252487537030072840205023761517",
   "468137280767559367362220363604163369555275962552336124735338455050240547849740200162621616882589631826145510426698",
   "1"
  ],
  [
   "1681002611640591752317059556050476800227873545921096673476914573840000186412126338696755411622851089291949732426332",
   "2194004361872516836995408457108942757024403639781338797294067921948456831499164240052089179885699553613978702927926",
   "1"
  ],
  [
   "2561801624224521177113132180991525753016877266760062896188463525570236546863152993770995298231403273618495534965962",
   "3469139868917288862328315887153453566206444746374458007322028190275611846334417278888836526456167215724824521066246",
   "1"
  ],
  [
   "3168431974211171833829403768129753216563455150918767161552176179912026238954570226574575324889984290763145103131842",
   "1372193487107031820072047403385990883038898517997384942837463179380245377061133698516386023898512153142342476203724",
   "1"
  ]
 ]
}


================================================
FILE: groth16/trusted-setup/32_leaves_vk/circuit_final.zkey
================================================
[Binary file]


================================================
FILE: groth16/trusted-setup/32_leaves_vk/verification_key.json
================================================
{
 "protocol": "groth16",
 "curve": "bls12381",
 "nPublic": 67,
 "vk_alpha_1": [
  "39490231255006619279273302450509927191232193249983767883423715719161925482537778863341494801619636187091975729435",
  "2727532210051523312170437053086979836698815765359506344447119200202682660984994923270553601945483513018278853785875",
  "1"
 ],
 "vk_beta_2": [
  [
   "3319053487492199266326605148251833319178340283313464664176979525852260789359224487891418676071215944938100946027458",
   "3547970641313975515695165014959802098712016164650091121168202851810412431578647081411010194375115509954468226798211"
  ],
  [
   "2138370894854317154727847801949847004812631934561780473696491041671186556423978373124121449226455687052206095639041",
   "2468389708263182301496532489288348139087814068588009822574827065173035857462609545419792811568374471492023696019422"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_gamma_2": [
  [
   "352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160",
   "3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758"
  ],
  [
   "1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905",
   "927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_delta_2": [
  [
   "3858090886760489457337920000203735902279064529253683096697158552732847693737558596571234198998877524629928305417846",
   "1975611148458832618953035119137839809368297912111807851815945366686698510494355313465980515043160630121427975266243"
  ],
  [
   "3130228548925001790553404251277250050006457233444588671206135626476782070255215774467012820570443761563904704400930",
   "1361136704170611846964661448639954290490552348723219775561466283793212763868534197646197187948375274068661408239228"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_alphabeta_12": [
  [
   [
    "2746683253838449140735712111027130338037348006493006503410498537305442099584426704073507738301190001915807689959735",
    "1123394703615164364179376465921051674074745287274033037405521316052137671235948038504786408865015279038154703206205"
   ],
   [
    "206182400803476672298895776576483441409593396259876052692010540300088687424524508814817718524449717976116319808488",
    "1881223242590359469326310508785951858799534109720521109555126933182183419422779369409788886069268215393486193255097"
   ],
   [
    "245161282832347105619856040210974344557365037056948667322158124688281267302571925592126710413079236310213419226600",
    "1569642941411915255441706114109145819232028490867676453902971165562526720568820571275724801854469249200318424831738"
   ]
  ],
  [
   [
    "1486559318934762113268330546821240087399305405963237360304213749196479946991757942661862721507061935751244447568004",
    "1404416131016013354060011239893198390718023543278761799599996220664389881940091275864652720676009390913439161095056"
   ],
   [
    "3474372124167878927099442867879368577925806790834534308547847617418104668607400928397514044010691737876306116799699",
    "3465860596022383746937104077079163676122439062060323480313179608649202699494975940997288528056637624060584419152037"
   ],
   [
    "299199172686606293990216870549043645130008847247204559219703858365532586239816470629757288101415828116704709384847",
    "818719432548516669277032565234193109725511403391763729364262628767449498347844309015857218649008192643988756466763"
   ]
  ]
 ],
 "IC": [
  [
   "1667709684385338022430301354675446554904468305258106434980774058132540011516307306252943473755441051596922450168653",
   "2731248657804978426045742908606035293228891922981609419241656315026798327763695681171621660273002443435473862839271",
   "1"
  ],
  [
   "1711356634839412918201912707692607776293210952371113911281621897251163115550099285233511214788395039399069032236895",
   "1715614176027410137220580432003069138166736113967587936056720566671225330902391845898442903392869705715914157099426",
   "1"
  ],
  [
   "2084039669514107594828794420776960966348220405895141144215111916924885555054598718538454944752494541508929830920089",
   "1867188336381532600302646634380667702314926344416939082708518547643784594626199857451358688397666494762309776171218",
   "1"
  ],
  [
   "3581077845469734742923093431648846459089754991624044893506480960965282724411859531799464849554072808625495047701380",
   "3263453862222648519628051911178036151012865075810269449206478036130870538395824224839106174346251373619657730106338",
   "1"
  ],
  [
   "2768518486041743474242731656899030104974105260843692717770399779781278127319422840264560939094948255640002097634073",
   "2051688341670842618996161728789167050043919308917218737328136504429752594803063640851102030607589506103735908061459",
   "1"
  ],
  [
   "1534901404103302472598519382997802971805505735532049887213432327536043088288272477638756306931459009991977197370019",
   "1617838634463372618940280757141746393161113307209164345278002328126002199911598490326437878195006411006696943064535",
   "1"
  ],
  [
   "333296991686145989124927481959820683623128454647702901022121916391262869553585134887616735051052793804343510959727",
   "495689646186537118833874254064739189641152750162487818411956610909467342223266097839409423680269375011124223102153",
   "1"
  ],
  [
   "2550065522150760925591700519751532685900322183053823897263532715031941443353477283760392302245481373148291348230379",
   "1879899182173603742190686559522983495950727243393031903974690893866348932536463717585787160831964407315235391683725",
   "1"
  ],
  [
   "3736964540464959173870408230860229833349390255530870880260694442825305198047255392537875186619115563433410165493210",
   "3932253037868856685553800864418160375971459499478620292500674097785223418925887482413006029869266359940428819662401",
   "1"
  ],
  [
   "3865235475870952940952758194174469633315075178445133042488065988181801599701598006076060689351159357830487651863939",
   "2546637552712397524849986364576356401676622031949493144463715875568707279515177602693412141034410446306825368698618",
   "1"
  ],
  [
   "680474643809595794515754226965082386995112383135116342933407340379824471883664461209847120135544581283765980728275",
   "1302595017149703806227210929081556688252843997322342662381295197854239767071018544089261022092621380044783071538825",
   "1"
  ],
  [
   "1056160653248292247238840278756892706133638050550841250586385654953831404880305266833090117976876070014283864129077",
   "3646931928763491983348843546396388463749658156397864253564582804493887925685409291020209093622206326052080291716369",
   "1"
  ],
  [
   "2987040456851543880452512339737532619561927653438133880021418256933746235671242796104445415890929036588901405746699",
   "2475776018670200498487790099707196796456920280758853404867806782441141905717040924865968244143601773412974112516498",
   "1"
  ],
  [
   "2620374087646960520346402943617406365223316989511995453530046593832658168739952779364220160874998288673853457455995",
   "3871727801071839331373229456372656866369892882975284330395508515826557924727082952518991537333912192304413369163593",
   "1"
  ],
  [
   "1721976376911396221022482364509545624100403591317171926632786298745842098817122231991757833144180491702000900155377",
   "965023728842728849075675941224125744544062283319618200837357390956987277840532225459504380347327743296994378685823",
   "1"
  ],
  [
   "2028259506652809265661375649002811466926820113323396879730386996338603682188916476584189716591484644610672594023181",
   "2721379678182515019433432762807284244452631405514998165424016814957388945385053152457849730154464114232505927308131",
   "1"
  ],
  [
   "2179744153330616501214453116636970550618619171723405505203898701793464497760058429202106194499946788605780670470921",
   "2506576238202804468067225822306153021861998072683955020578277698853798017610863419450135072525379454712537666177768",
   "1"
  ],
  [
   "3881569645237989008331898151550004836468643872786498435767878469184957107142492023862168752250383384702240572313793",
   "1038230518674288590638676952401999057916860699765071682895025275640457094596386536868927220681839932905600520732737",
   "1"
  ],
  [
   "2105417893003674069696306272837349599976859697254753882896126201014964947863195133005449546267475197239743306881729",
   "1060629390399662566692634745884595919518005301937925232902239354889707496523827554914468649318373883555017961447523",
   "1"
  ],
  [
   "3735185759806455145829294033512482795539265946125248447538300049786370786296288068160279674999520421027614645842804",
   "666536851896903211707259999571339435473724421062271816859443644554387248833230612231157144831120243619758630657382",
   "1"
  ],
  [
   "2855818979903442525556538999770913216558462754421427895364003834255654257210808599679592681002777495954908801660827",
   "2088427781686238468910627209708345288528910598801079713516732984172771285770645918860161278337227043800917321213009",
   "1"
  ],
  [
   "1321096905328829587561503676377086899045143675139266319567988071096920347817172327208421767058992013872412691807578",
   "73537717430550858135981147392709836693711807474564015169250024745439478039347955980695207957913692181746438416028",
   "1"
  ],
  [
   "748800436387079150247584628656616114385575529097051388849928027193324634080214975796587174568240209345339375535650",
   "3797212449402868530053510003645425492316343929808943911041404637970798672702605419071288542547845200448746372237580",
   "1"
  ],
  [
   "2463814719378323654778170652095247762271458719604240929495301432272253233416394587085515580951464776533266628494545",
   "3525970813768314282995167420665160529189521894668854787617347988937931214476314472762398983602540158746128552367455",
   "1"
  ],
  [
   "1887241533785529780134030512023162458245258170537585683737008738372151066594389265091192179409853342639232453371751",
   "2076557469541259336437357729759005207352062481618242863016003506362844583701954066657074983481211115278347756792684",
   "1"
  ],
  [
   "1241076820576304108887522794258112924576933719913334510932579813470262626475598473246119253445465090165409123439339",
   "569872597894890370156221345156348274854401618503280475810541799804132560882049519907964453125450853477465986786004",
   "1"
  ],
  [
   "3965331144310726867390116059900055576719098065485353056860484960485109273796267437686004048928813182573631050268426",
   "711054155262781133486016746089148160364982503287316064370112994699988734144721423743423565768353191181807922683112",
   "1"
  ],
  [
   "3781051884999458998698720973921735949410059898926357915052080460156985388581072121058833899726139316773201316976014",
   "3793582971603807428510178136609632763307735078681755542448720092440550523543953883878960772025861721562197986304472",
   "1"
  ],
  [
   "218134720585713353116351123769822524966595886070106127436940720661916467303009770358224855670629951569006371148324",
   "448097580069203392349720832675475675136489546580451546300596690440330472756159725864044941762772587543913165882212",
   "1"
  ],
  [
   "2547851068451232257643565780758073768643248549219350591914874617273570963421000164663107835202316922961990422679014",
   "2269696653461396725099601508025423769634124544868362427770963736301961829107480339843712536870002508980991913706267",
   "1"
  ],
  [
   "1033474595913581672337390799809337358164723684661848703055051007472086319042897951435196946887429470174469447768526",
   "828642840514277998392590496309167660611860092082904977522939123962555901326110785353121065788995578946352031909006",
   "1"
  ],
  [
   "1350106742315516341250981042649895465563564562839717039351603876608523728254139756729881859128363014224909896779352",
   "1381434182477883115003286860183517953812476320294191385394024285872130469144198711497867211899945079958172525577900",
   "1"
  ],
  [
   "1325839664729738061301105307819982391379472354906975556216899016978669851323451281137880673153735169354354242151930",
   "1164339374590623083412120860451036020143209448401025250436273906776583497845264426799443983331122001388412874039223",
   "1"
  ],
  [
   "793364344534841942412266989557387870885075640606043101705826450414180878019411729269241672184137911325610172873841",
   "435234034148057805388614580291932911379462285812758136410426721429424960525934590746573838365079575925824474964570",
   "1"
  ],
  [
   "1416366174214439084387223457304057274051095063704966507514739781035399295480729584834656522996632999252895030088179",
   "3375918599088607649890275763736031858580825839996240712719072609292420088664986621106420584517246770138252813221924",
   "1"
  ],
  [
   "2256497029623166669202534110058579859069520637777005128231798445291009073714158735670050389642234264582230588443832",
   "2442716727152787757046074290996372408706560812456102995342555064415828283977400426533802049554707844465316383002054",
   "1"
  ],
  [
   "3418051008946037804681038017046815219275955007491273295918984888359987683317358990841854348396113821505699028592824",
   "540212088904081564183516062965762767517639489491944531970078105055338157850521516272386698514590660974193639317261",
   "1"
  ],
  [
   "1717452722106507220489672021783584781196231805855905787114402779319948939576039620068926250924437814831331474022777",
   "3157528212567267407152409125130698695214567090207117606967599419091990030922613616396943210024352673080631348733419",
   "1"
  ],
  [
   "3981329363596402297532901216855169825890531206208266059782785000622931859560301951806873964207808047664533341215779",
   "3827050865485129854887090222600448281807429557939242667083937925216397389056519285620672473462440488727312429392539",
   "1"
  ],
  [
   "1197211625132056134583759718307371386814131057662504333650382547143631585057790909166621147602710264713395120931598",
   "3948958394035792925417267309226633291376073709426673538151096333111739437818827996678563850001403561467043905212778",
   "1"
  ],
  [
   "2788130130525218738574967439682726658403417491528963551852736946961767519963841131344699252981500869690711836967225",
   "2552098238721393988784491753028828851151591844275336798138245402290227992094938029413478569642799157495442828873216",
   "1"
  ],
  [
   "91102105858788415615253680135333072619713138908100966178647496497364746216276125980278947536712508865011873652333",
   "2539096049029524176716942643767533644304008251959282805737108338178563938253885806791015836722553024779403446549079",
   "1"
  ],
  [
   "3109402321725242293277689487886527304248137344340560377427873849440663274074718701849616028340342403717047994262386",
   "2785737950572051833662289193149594566696380518814926165626727672390942503794910644975258543990375442015172511524984",
   "1"
  ],
  [
   "804075051771568001047618276171795011373902980076750724183320872095460788718928347014013242361607752603854717274489",
   "1178699928717624151630805313160144467567865297088190405491812294129936705548571266975880800278309942098926899699789",
   "1"
  ],
  [
   "3096563399823961292642885709965124871063974835482104953505641773467085057927860067212246960864945550614633633631182",
   "2238134943272942619701585760235276679088403245907104565889219702249791038425203100994917315236073973109591346709623",
   "1"
  ],
  [
   "806236318168655138938039443387259717935592049971720784680603570838775476341427130208373947151487051856920420944599",
   "2666034709425424171216135293346744181629331430705442618323504382225627380534723559275835944250142442382646588478571",
   "1"
  ],
  [
   "3743862065655328334905663052579367631844574852191392874452148821784544640479866360196290652639595720308009249912390",
   "1125856550164865465003683165188944572134563304776684993084701335052519655564493553553852802173428981830954874310724",
   "1"
  ],
  [
   "305989267183703268441377276080820196321180683961879167601474212481455716391971051815768696806253702821390310230589",
   "2860239217846199449849744134265733606558563854768385194221665051137460210551559693296491672612498119974720604152620",
   "1"
  ],
  [
   "1733518135394721412055323784688508854103239026930251464113570286843112127704007184379870028664226193426064381893656",
   "855374350568631423382893165597394296740381361749073886479165830483200357785150888017569208383691557196771349636702",
   "1"
  ],
  [
   "1317956745165549996368631221803590830917306502726344261360577353955542000124731476563421456235137581893590181036806",
   "2049958779269055242070253291242869120560957683429750787769458809306475808148491445341143159739432752009043544366357",
   "1"
  ],
  [
   "355118398506692277234371853009478404013839376406961750162929556262306502722775522308133666198046839053209633164804",
   "3391151296594161392101910466837949793721346797350448586905844041620952492548595765840173097844209504424943049703313",
   "1"
  ],
  [
   "2940712778798062592623733539429625199626802326163668921560841649034288456374072763297492274835777762724996496786296",
   "2413693565470525682289892887793848307708052798751916557488408996897949138584743327312616069582757195826824538994656",
   "1"
  ],
  [
   "1000979105008537671468420644409907245599289480961521046454840879024402500319571356617880517804357616991824080543515",
   "2740379312038856166809967666505746379555263901183638677031542947041627962760491634051825353272525511461619360769761",
   "1"
  ],
  [
   "1077299569403597267312077999201326467215373794157384949481773392748604954764276396418062286150894542738464456004789",
   "2076583874824616466259596824342506930082564341880011287507782495395001240970965330345035093676069432042451027645164",
   "1"
  ],
  [
   "1773896644292809106697307694897892061269984647927837987378314648080813941429594748471195649850913983370815846796749",
   "1442442282478671230074395512213444792880177715105411961938199140843737161771884965717753237052013406931926432829149",
   "1"
  ],
  [
   "316539397016778316772129398871578565150271349219935227018756447944240420272807532100708572700635301458904884493328",
   "592106190902710661265044514401898444501440438419859647391789454435090077067427597090154707033831418509279799393103",
   "1"
  ],
  [
   "632550525400333928025209726535464082002309636991389112282653190281097466938468123474045889537357496052531412526646",
   "3594219813222216966559981330986079660054663904075096919926986463501595020351525586402407170590089902011930051177930",
   "1"
  ],
  [
   "2583474051099411424672288957306678928902462067347787633147663895528254497684434589986362570989062666573428885931603",
   "977610805397473044164276566172357708404193838550878997354098914287229580513339427058161434322883452576822399945498",
   "1"
  ],
  [
   "1033622489557457726477631461774169189744560798453769142413971209983760874293727512909187101470052976346166776431767",
   "3225154412321966459449617572499388251535746312449710359506633432270914386958976466542642713318953771228696620023768",
   "1"
  ],
  [
   "1296437396335731352719165257879556180997588837794942318909456516997306219825599882914897455132295972284564508607183",
   "3452894700290134981708034569948298756888971503355368063242947985837020330916578260764229151536440566298433458985513",
   "1"
  ],
  [
   "1997170628510307732093078026671485796502796085110055365123564919393643584386286677203358921199464204086057477082077",
   "91445951120371617861844433082595425775224162616939208974332316981869902059340543886884677501868839268920799782657",
   "1"
  ],
  [
   "893251998896175916704062554919207548562476436313841694683858309960437670860340001562722544221044402746529729604282",
   "3189979292399111922761842403982047308606189949913000961386295552416898484231504466447629919399830333200924130240250",
   "1"
  ],
  [
   "1156456963637864111456540828111157864029249394266389081604829960350654706590419534040139653608544406106460252547710",
   "2215199499130942885872069667190043362716292298361119318638697694870318152543944221669506745604587440269263282524947",
   "1"
  ],
  [
   "3604757619961427431994259377706381751641633648074369673403346774100847083338574415171520343276422409543734489904444",
   "3084315194034593467454771438244468928344203636527424255422348284107998412216690664088717950828794634976412729567445",
   "1"
  ],
  [
   "1134552646796298155538809344395036729157073089507346577377638980488188255741014635788234979069991451338721622738623",
   "1943478489641609512474906474778686245290392696671824510317001400863678307230781849921475041406307346350573340754724",
   "1"
  ],
  [
   "291217835813003292120249091591471472198192060131444984902476876191428484942262423021666631036217086104847437207871",
   "3586308777001726078432443694409470773315251420677105899670997702270038627478096538645994056384187227982441318222585",
   "1"
  ],
  [
   "3002925305973690793967138231668288061291100714651020269103499692329380823981240441395693390116279571043196443207938",
   "161415275520300742658822134167237396832282040987227254470401137952661359377352023535876673324694950053903036722612",
   "1"
  ],
  [
   "560964801988785697101454847225139992172293411244380696957854601203000637884667212041485651741193182364658202860670",
   "114364295778964936391240753006991882741300322210887432521897769429751836415609494877844947377799981909688056777709",
   "1"
  ]
 ]
}


================================================
FILE: groth16/trusted-setup/64_leaves_vk/circuit_final.zkey
================================================
version https://git-lfs.github.com/spec/v1
oid sha256:0af17c4b4c67531b01eb9f4c026a213535027bc14ea29976cd485f43a9b4e0e5
size 74217420



================================================
FILE: groth16/trusted-setup/64_leaves_vk/verification_key.json
================================================
{
 "protocol": "groth16",
 "curve": "bls12381",
 "nPublic": 131,
 "vk_alpha_1": [
  "1753629745456667721868787198320952809720667448238730753397045509307224398391788176410593269089844481068677970395389",
  "1492005193733197894540583191857413011279577533526018167677215686986035012289661270923012684957030109597590553992006",
  "1"
 ],
 "vk_beta_2": [
  [
   "1145067133898501945749953704699197203944824162545089340577105906275181183143340205780332777055046404381438157589635",
   "43887851643004554649564182869603707093217329405395510500474974136605612800574013214669415801082573790020133339113"
  ],
  [
   "506077315500045954841381216981945267299923507279094424999859877253286324901256676501404803273754823125929110526502",
   "1670819458451569670463148011745995408760831501364256761238771520936030862901738125649143510693701870313636996524576"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_gamma_2": [
  [
   "352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160",
   "3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758"
  ],
  [
   "1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905",
   "927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_delta_2": [
  [
   "2386665141959682753518930101538160580552719528613085786227456005980207117608752096976525831590089010479398536489380",
   "680658645988013713922974359909991404823611908160961157043677176898424307651331028492330378901394188797094217222909"
  ],
  [
   "1643135795427017472399159404666212207784964677563523996198758795098967823173948042830128347840195152748604713471088",
   "3774776259636826587877463467691695078977480927871510062225010444370841822013665790111542749929255025880795518194289"
  ],
  [
   "1",
   "0"
  ]
 ],
 "vk_alphabeta_12": [
  [
   [
    "3241506465691997461222546881187099736420402017851317782093877497583756162411215268747605837567141910695983300910510",
    "2865620381696335955512761514255399199550115429786779408831406362092045502428231997449232206078567310839466300467891"
   ],
   [
    "3484111466637709075097180476493277785468986867712360053165073632848227018648321984564431771867730307831155358086444",
    "3819683722675049085627165096591466263058956070830304561080578473111401113338248123827346281329203925865152682014220"
   ],
   [
    "2008207483293196538534186143942148460432909159040570756407034412040503685301819218293728558027124980158452842629512",
    "2272029950401518677623289354207225426862710950414584586736077461824190789725316365295733012098580523282678323143472"
   ]
  ],
  [
   [
    "2242193819721747298079364656546602386490911120665904506332162985368093489948512404838671675950381491590945636174532",
    "3399911816625192882526645121974264305970455852022670274316893578553671014786057048016334287552241616935216882851976"
   ],
   [
    "1959551122249138465621416799976237661699251944295033532798220343069168469710821506954557073315633317551868237398775",
    "1820497769452493313900214304520882487049490299455118866673776124598926260991029930078793859437977909380548667489210"
   ],
   [
    "2023385696309350731266730211869144023637804479157003235762178737947219438950010225824594921521672303763872769832313",
    "2900032347597781702214908202967984973262504185465095731921359731231053955837960449973056703324823854071743168667147"
   ]
  ]
 ],
 "IC": [
  [
   "3624914326467427614854529845530414791851729659234974386149345231442272645782943609607343721393056672777987146316427",
   "1245877678804191283892935154730101978293928183875528980726612009617681373339695672945950408898663757195977180943979",
   "1"
  ],
  [
   "2840973636106888708229553134265988912115613218765004364008590816637615523639518976923774928775653748010861157621195",
   "2957439700066450085458164362496974821031635851432815911642843933572725193970939563879378509081096079019252999831376",
   "1"
  ],
  [
   "2827157025576080015635913458732151533611273010387984474755416064130137973234561341987515453927263078415631144736181",
   "2844134152410113223419897024929575428361289647227124929438850755988547780570959175011641976571545744985754407930782",
   "1"
  ],
  [
   "1776815271938187801849530233131186720048387640421585388155362099403212461490104779590765929345553484803385489993622",
   "2630150495908313415455592028052210799391135085930852519731718593136229176408252060369742960696273237548169035209647",
   "1"
  ],
  [
   "3579238517632849903382375768559418994970798385415584107168711775426160954944556769498176921027242168183494715579029",
   "2749866010792327821249312026541197491524200323210888803615484871706050807572699427155192118915611665363472618315395",
   "1"
  ],
  [
   "2473344155876217811125837162835515910909747770150868262790245551693574191924062011135102917649742106280650825744991",
   "1365606880849524270763319814545851390527699449944984147204734570733120197431840656771982423189804326787894858186929",
   "1"
  ],
  [
   "2675084366153694483071018343801403219582828678147585399336366777923438595117335523903340364703526113435483125198993",
   "805785932937044356799798289769083157484580654634420807592800973146155585480488329188817296880767046517526646016035",
   "1"
  ],
  [
   "2381109676563790685839205068915086610937735005677533934030186301762618648949298989355344521690022992346029196378977",
   "250570196091470879919991026243638601736562419788523871192272524200911487669568583856301791153659930952230453174223",
   "1"
  ],
  [
   "3743480576183574525551499442897250148986219131482742073937477139274969580633503451165463869088885972105411775067217",
   "3903244971758145635069575317466689131594451691037102841738521356540103567566946822086289379687090684453757802139191",
   "1"
  ],
  [
   "3250370858361702813063597511164653717555214776053343236293386107079465116392559683278061523227381571936768053742856",
   "1560621652463165470774774976008404065769968019695806299050310188018010067417690288727845005258025335930774207124109",
   "1"
  ],
  [
   "3714517451960938840196093710425653255552114449648007606003722105157542510581637755331417290145743621452280033059403",
   "1739893228516965544437740194196424991168987251550928070387650752960128788288106177639396128576482881008875996831436",
   "1"
  ],
  [
   "2966341239295704751416690519433456240362346657861366793006375097185516924869518363423625726807556792324731145122583",
   "841695011160995023127329768684572262169936088015065068238615128985049248521639476848416926072218056182020948504671",
   "1"
  ],
  [
   "3017408168231064387818121051417542969142651289331512511818897675943360004090159640449280509643738857779458086556087",
   "439110095410901671520518833301570357160333705416990018060496072231503028562749595123295824443528224345227726006858",
   "1"
  ],
  [
   "3659537593022631638448300296207718176267330652911521285470027982310207763381227685111400845338459393585207023796602",
   "3831856539079762897292049904501010906660141872076950565127736145630424471476745902431982296857620841048471145388971",
   "1"
  ],
  [
   "1292998797011205685959181113780494202111368589049942348789217449013003527855749034142681103553812758955780305247617",
   "2700441363066708981352709602653766108987970287929682650282534254078588177837956333567630315757064366214054271250914",
   "1"
  ],
  [
   "1403470509244335289682987985302312251975810732186928305436990060789689650942072771301001476041437429675097474449257",
   "121244495147620535978608338299264362211400863366410843288288398138295467085079188556050088577723066594309533084665",
   "1"
  ],
  [
   "952952344145625702150447332910530927507249944917968186701036361592492959984122077680631065959895614493533876908353",
   "578060048659582203526180920053271929436521841516034687791397214520602676148125770680728907687486779588474360535140",
   "1"
  ],
  [
   "3238518695910807057973367976359569026210482957700068004487992513829369223315061720035492665957439104354112782751422",
   "3450137212775927530280828018374511700347011508309962788355440380000960733365706747589237348669795663389916995593846",
   "1"
  ],
  [
   "3434053869021561125582660866065971426700004274103302336898651133473531025423964429538266404853113337041229781242261",
   "417822424944410549072363426243816985961146264953079938221403371559879022780165344880439556444711691232856598755069",
   "1"
  ],
  [
   "3583577523505692479479323786257624737466580286101111985799329340391814562583425394555540397081500308291499649664178",
   "2915051785442726550316144173238605514628073167735248207982073650666212857094945298539374028858287263295583397000182",
   "1"
  ],
  [
   "2884350193281914770935376006350255892872323979974508797522602078320702376762867899851533159389129225506256744473279",
   "1016792036007357005632207522722113051909172698201338094703830053563813650854779165696586040687203054213177706437561",
   "1"
  ],
  [
   "716475131724240107361022972358327586770775273962857936070973932602331158467579136606276613598477059838300190663400",
   "1956623364619653082661700667830125789055358495118879636398836373563511742719566212849862327655803068768142378584858",
   "1"
  ],
  [
   "3001879960018981639539543756773405975110891368464504780782382172289013238248355367801460028799821202875973019296013",
   "3950708778632733355935892470364924346006463290102956548994322500743152036367003241923526482573922559495917525836381",
   "1"
  ],
  [
   "486359354550195986538149450430288345852407135693670168142153538404840101651420721658369986655998000504103807300611",
   "1475725158454558701079386990357769433429927340751709086508805533382118322209948276870726991077254604845944717292566",
   "1"
  ],
  [
   "420458506529910244663781161046773733151567311778207514351511597002645616366690894022027298348289749220895554473400",
   "1106591236050618355163386318611860647199590066614379597248813721145613962609214069379389233777119924152032507924924",
   "1"
  ],
  [
   "2620169086260113927992858042303564959024472870606223403326330362861677998107510644245166225996417711110474404693756",
   "3722243464944806791256217017144805266325977757388779704045631552772780334592231413373483819102307117999280475495029",
   "1"
  ],
  [
   "1114946733350257032400511242248526619382477718741361920644467168723019901473271807647446313265483840579070035865289",
   "3113055700163548453868037886658125833576765101466982447941830628696618254074451778710829806309763859318816652166087",
   "1"
  ],
  [
   "343732618055266336904992526289877213556078047377950574595104239224649668149717934577301121790158336636355307162290",
   "771139888512728681007549832744907936536823572099928061678755748478447637555035107364409573895965484750665371818021",
   "1"
  ],
  [
   "2933609041152234572490784995046943567975878209483889196425059216280446695954273225354908892656182617177259228097731",
   "3520664770529926496639380973267462541110125188926854260498654944902051155575968263400177483241613993256095620345075",
   "1"
  ],
  [
   "3179960973405048630538543423996248814413114177831135950958755248245821478703099807328106044952518198909188900473386",
   "689815616157836176711282465094126554094608404000706606509118003825697830246145141846010446989763901274070393700423",
   "1"
  ],
  [
   "2928277399256598253759796321209212418005973699622235396726721102096277148456215589264274198047264416570784831890332",
   "2010543883186262603390233865017999373775061220492263291809719171040412565349999730040965578402717194893080674382772",
   "1"
  ],
  [
   "3893481619624045565568266128524131490382534146912806147770043416553803457304314396338761589745366283706905166357486",
   "2270903986459217247681615338010048102450206115225988748714998742496253237990746989905204150347692024975307045822505",
   "1"
  ],
  [
   "2264076312248430466391340422373025347963970735049163778627931751697670414318123116207716150770696683753287348477961",
   "1871381533278013284948498924679996340785513680688033202434287142901587303852133286001596759588069418568142128099257",
   "1"
  ],
  [
   "3030562890327790500280132790901399396234014408001572350383887217247201335298111604694800214793368938467646365286011",
   "3054549692195430229377281821546598519277461714962352708617643149314324332282701901683163854282592387542387582004443",
   "1"
  ],
  [
   "324396785054530713497414304461062928147943478466112870139327249834423578339887978844526397745496355750733729289216",
   "2254930209992886361728592635544602801970096770587979543479068304462007206935523496861746947472593386791231897651165",
   "1"
  ],
  [
   "945123696645296108572521220548036360572483547572633748724983435071778391912770679941166519016460559102500576958511",
   "2690510335456038466316971995177971358377348145714577962663597312067497698492141824891023723779466590008441551091041",
   "1"
  ],
  [
   "985245343147202385849172141206451449614445213641639178015827013743876503597725552865049949196933886461785495392179",
   "3891226372892627339142260412420348169049511851046267091762179037370024522679642863009097740905030840190825862982287",
   "1"
  ],
  [
   "2789282667351060494417950372739544072443363800991936472699045566751112849413070522206591710652236988583242598684060",
   "2000661333655171676052261725000802669690863774293921731828698417668759518688403737456129876784400554671121950185070",
   "1"
  ],
  [
   "2250027483231099826855194693448840241316371819085548890726859952790666304977394826582637400265505746705734853041155",
   "3383327558709373347770376387864712472684498643279970765447734358620789347271391563735115901252389141921502284030058",
   "1"
  ],
  [
   "1680294904025393901009387678934449571002492531446429363792357559844975582366772574080765960967539975723939543408334",
   "1204025375097591028590809890797611766200772279525654560439273319430997481770384036715267209069162869608842133095413",
   "1"
  ],
  [
   "1113416167485340800296926604001430852108456259546035998277020876887384046125516898809575410511662172312489879410003",
   "348235837055511650697993110420083768354379862737289641735917194058294588079912035429555386813927027599782862842245",
   "1"
  ],
  [
   "2050553571621504022018471712779602589690064446446354361952225514747965454636039790791800086537867610180613929744493",
   "2157793109092897120238864968088213857404316576886770384614645524779323495856353369735288844074653937565425295375379",
   "1"
  ],
  [
   "639153704254803466086178372014873448671042466800185016014745950796537221572993046664835534911152639561855013432735",
   "1924235965590466140292515815634314457398219670783350570766325154146025335989702931759025044506089865105694370525347",
   "1"
  ],
  [
   "1269874517538608027261201560210393980929852192813820565548310043517219599804883819134456110153481163216852119633315",
   "1490659244443068751696742006326051906529126168014715024290724600784973002027009399080731612732563915694893566893518",
   "1"
  ],
  [
   "2289233930460917780726950574066867680604419462041064013148729531658659849848239481227602094160617937005643714478238",
   "1386216618100128645275993402191315093130517641697611592604325464768711491740555307041211231617993176129928200902979",
   "1"
  ],
  [
   "494088208605803615683422714795594976329855701372324044485568531718591058923464136398663409304110484519449501851859",
   "3358800109934631251740582732036103773801974876360519034102890830501475893064558924659002118686463593560661390859525",
   "1"
  ],
  [
   "1368879667714847280201779858012114534275958516461764925101909862501407039528104907119084255235121641063575525390197",
   "1569123580548566618882605023946162277736910125394328067272476115810602708352192162465807242010857454819597746876478",
   "1"
  ],
  [
   "1880448495632071864893546340342428108831419824422739395508992959348856682900185255589666194116697899914001812752361",
   "1409261244446880686371972555113183048913064415665798572166896713193543345174749768935627117739851144850835030209156",
   "1"
  ],
  [
   "696394404177770314724163519500026549869581982041276602422398332997064794808905537339206135121509222942740338254504",
   "2089345730337133295832794717624747385745965361349557499922477273726895003943940518824866857202662127941429423607234",
   "1"
  ],
  [
   "1333654216336643015399427295503393271864864184682268852836642902034384334935648799293063660126637753974435814802159",
   "3746464395438687045991374779389305504021381358574938770939314394874699341124729479429163339829319202936132032472288",
   "1"
  ],
  [
   "2359388141284990234433301283946078863244449096764842311150294791191792763171827465182588917143981798838030109506578",
   "1275585384055893222586789302091713911981641738031425335461757848281870431797309026267682742067360175370143837419818",
   "1"
  ],
  [
   "1282046251919840534350500128637689590360640022810548309499433030047988927808312540424625673420678670066652450444378",
   "2170006964826636955839260160917295802681759768985960618550227238012597016557283692802919370204475308715548851667057",
   "1"
  ],
  [
   "669861354151670566686242117996691395663473568938528432478162452729234687731642320687621684446241411145448027192371",
   "3125067275800470468450452155586409756227012505999063533189767691308999527431492480189174018604148106578378835541898",
   "1"
  ],
  [
   "2074397780786300001572978736257314571881238132375804479265213737920244254553517014461562434256537957242850008888781",
   "3491021703659035638721590515491992120530264698651500346971284954529202179896716011916362035405554637104290633503889",
   "1"
  ],
  [
   "3344358857357893743139782529843218272575022393380089979490210843478006684745069699605529431258956482868483516639539",
   "3663035106082628568750549053684103722390978103142043475006166931044721518275694180907502056378155530030098519694980",
   "1"
  ],
  [
   "2184741433849526092866281192119680491836073738146326943710253574933722249412844018304383615025412056938100027007726",
   "2155163018430203921388840236243376618043015213274925339856869966951668058475113646389084621458533070590317851753280",
   "1"
  ],
  [
   "883285234050607439522391190902102289995168074587187617927452489414318861930196632972931616565280790593851970975246",
   "3583686337638191163293916182688145980653962249290768091644856198835673601695038054113039233152027528791904044661611",
   "1"
  ],
  [
   "790207931528519551445310306091012364136799269269006052518011004314676113481450111774895446188923541408842256031863",
   "2467846534556493240390199787511258067514490113192396394184813395009969955827832782365827253649843787331266995388172",
   "1"
  ],
  [
   "757632404604251780065437996970478667493288969802114289832114369143158049270271508017181638905373283126824153930902",
   "991878416477763551354510362802517258774375256056360816751210060255995530216602770092484550433171502379647326331104",
   "1"
  ],
  [
   "2351545453694316746715572493376560209868849349706668591118157945877493016003332438214152763630209085942332679075049",
   "736777780574114546483359286458258814829055071653020527779255617662727842802695450662179754958728354382855190372493",
   "1"
  ],
  [
   "2456076485726783086921203923580644778078486274638364038935993628468996204819007738074602880747662329819993179218944",
   "2547806067903279373661249622417825625791658475780706204845860601497198267742691138466484500315406583018566322550227",
   "1"
  ],
  [
   "3449528323433629123760876576772556745882250946269573383049058713246617125272764570304050462700181083538965843638753",
   "3813890936870388656938188269696214402578736751484297500922381079609105633237747395904723847670176171536239345020482",
   "1"
  ],
  [
   "1216634253575305752687322293291243891057085065644394973075231817344842955709917868346988039954606464236309875585031",
   "3676999842608942182554196370649402546054155598199213478073665712447473640705057103001381021799230067527610961320380",
   "1"
  ],
  [
   "1230417370966145786128378770106023988876246292474690772169126424763286908503839037800234245347209365262593054251432",
   "2892789966274651461593153193474081804942691599129625293831806812357698080452794326797974098126848354895298834316306",
   "1"
  ],
  [
   "2713635769761968093091355094904303459992353489857839675286737268565513145539775321865468982000118409694020671322611",
   "2854089496655751846034651341629765946029848862280517773096741285475182640365292527471903474969186129185523431882824",
   "1"
  ],
  [
   "509987945410473659367537131708258939927770647191630550192544111725260037241817919292264042068627535371543485231189",
   "2560582247500234899773159338018461192186427304443087115811773563976678456018299759010606451091290558846116273006292",
   "1"
  ],
  [
   "3686923790248178589547389543058191403316949871397628074015473893065016739993063597348282168744830196491933789739138",
   "777175055400010650481390935092471441625304388508875609063652227147652891827705558004511502129175717359032074491154",
   "1"
  ],
  [
   "2134571861567396232025039051160715815143220264887495795321071491190601964368642773388849328066123289129849318680947",
   "2932981091482201434294067631920317441847294560270728264740322202111816125096555193119224865865893692267010254225752",
   "1"
  ],
  [
   "3395088048312660730050703094115725829843752580365790180595853057307958905698855570191071295037771788933887864180793",
   "2722118764196970886013354767269188228844097503042556435921046482524472015346512759718488677250587834947464230698281",
   "1"
  ],
  [
   "3522671080940040986517328705771230531211168767462750943068537879409022874678339672099771875434761608585229732250764",
   "3655313405353025254212956499637323409595224784394113559338176154755680761167063095031583764983660625270933071971980",
   "1"
  ],
  [
   "3801922985059054066622341854440580305790566916754545702876246947952936476001602929786098405392381061559871556736009",
   "2348985527295381736812756759049136210765171932474078538083579300396884396782309735934713910460602659918762004600496",
   "1"
  ],
  [
   "3295985044514328499550470940572351227943112186865364824426026385686977025369401736055386127165103967146780369638270",
   "652780622083844624210411577418014512738986543245277270366325429923335173542105373559400665157921653434657137870487",
   "1"
  ],
  [
   "126573562390688445533319482244865670674050682849594214280134933644674408445869433288218590665551089153500227964523",
   "567900898564076138379669413348406050818982197828743126336662990755327233605113347471394425864447646623465865183419",
   "1"
  ],
  [
   "415801634586836398759219291604613732956476512821356047795770655549567979285565788020944877477475097020530914175405",
   "1377075584034640587545237807300214806455420468629522579197922439923681703159123215566488814825547425547394421078945",
   "1"
  ],
  [
   "2747033682118248925131709933596101570744405247387979190175162893913603896770999956897994601772605865425758604637725",
   "404403621967706069223263139581087835087478955177251558967120664149070115950523641878548412644332582280449427000410",
   "1"
  ],
  [
   "1492159699273187143775730162646508836811927393575639405485509882711662438068593742836207282924052116167124183725159",
   "2477971384841682302200208641571471670649166928172670538994808814246255608629424367532048909052795133149138507393017",
   "1"
  ],
  [
   "619987535300552918104348861194286921356961108551287399870546486840784498354806519521941211956806053238052068735120",
   "398671772616376307699365824440379060614908538863707896366411051006185694254433874719475158785452108223425944571278",
   "1"
  ],
  [
   "1889635359574251261660878973720649801997030973575631560777917139997228565834057473687078041677288765935280436405155",
   "1725166793594832767261419685712486923836500658696979952106970574072039336374206935759610582459335867015299929466062",
   "1"
  ],
  [
   "3660155687955778049695236775695380808797525678116694298256261073086461117139727657742455477024252296810627851322643",
   "318099481452727614363111171153843736183108162500351238431976247280836010469034748291787538830724706161098857959868",
   "1"
  ],
  [
   "1024302310906635375090174093483889698957509995628670602740395608235454321315763420399212270464900926099074029640663",
   "3599268732738060775633301092253152912499003887105505141058973717859975175404886586451700386518476811136753267324402",
   "1"
  ],
  [
   "3050544822158439727771366837546132092237003652015593199066736751981001289838394542944620690218336932938339096769337",
   "2642081700694945808875455661466044408117022760295195638314066064345409474197166812798345705114699664578731474249829",
   "1"
  ],
  [
   "2508165385573411916084618544427526275836705119565513619020801390317016159438306452346854295384494586471627789523200",
   "283385401430293788905363111983097393854053103972382549616400752860382227842180699842684492166752492839797543347746",
   "1"
  ],
  [
   "79413162429458957616967367703701402559598673570652522212723174561125023441310530823743900488881018899275908001727",
   "1121086338334640182503622779539929700319159552223628889816139991642334329479331331749082139538222895567942858140868",
   "1"
  ],
  [
   "1226627163523137574475970356954770614407059276986672454775923891661172868805229234932639892803990034881512651292250",
   "3806410389935576135862416927421890814774269625661623943500152173170802701181755749264233556081944543426273141015257",
   "1"
  ],
  [
   "2573009066792785372877060347699086569896399662345628135258535004152026990822240869815415420208596901682403175073827",
   "887310063450933382770879125133418868933398942194506328942027459918563913913633473745798574373448741878564278565334",
   "1"
  ],
  [
   "1930534457250965529061616082372140188876010778639146794290963860332720096648703330587602913959195510381748838028197",
   "3952155025990312531459575048142107817646141585010211913713993300415190579094904090098710500934216259003851619046701",
   "1"
  ],
  [
   "2074391063094514067639571914601559309738141558146791054719001895214978535725835143988097913998562958238311482508261",
   "154150949894832282912174203888326030524595374941231902529127860441448372264296964977140278079164645170535855873924",
   "1"
  ],
  [
   "2338539368999850293621682853742674845397586892249524307683259912651684950100528533693722062819951235966779838413543",
   "3913916610608036412521491637104721896515020985406567997591552644655127621316135648338495879432895590333749473077758",
   "1"
  ],
  [
   "272806409920876973627055371493672835168707002135297124565644732364803213356969207712307540153623015472051878166691",
   "1763693594481739730034855607454642028455734517801647534404582686965783832972972428766153462008515715009953202955448",
   "1"
  ],
  [
   "2482263079495436080747358504720288998026038114440403093842565477317595812265822099334497086960647782788497164783287",
   "1130877790027023843827247405592080864636694317504873901245016864349311674001538412985198679456695012508820053086180",
   "1"
  ],
  [
   "2965266766133518947089766443470135825594002683324749571797338891563859900751962976113999421727758031020877278741771",
   "3289275957111616642353319115206942306328655477461144684627854665220361944312531836323397414824487033942155025171830",
   "1"
  ],
  [
   "610783901156192037182679681508830762555668854119474122917399022513241817828439891097578052557792223942453724059511",
   "614178192054951829325644160210739252367097739107754793991397500327645028515069247575758779865057996106092549366930",
   "1"
  ],
  [
   "2250633924018917416719324372127050190018267658569938793804047923671603984826915117719834402240542103881965207351390",
   "2754617615746667300051892889856782880185375464331922488070273093268502525121669105021399943442813464467887222461599",
   "1"
  ],
  [
   "1058586996031082013789087630608711541528495445917489179702834790984463268147911496432584641175508998322933439969530",
   "1133870648595679096857728619811868590707147699035354570497031116238684639032655460206861327584516237649118527001411",
   "1"
  ],
  [
   "894512415229834305250785850788661641007838679387976167472609987752032613005530824821992848227958441997846313395277",
   "2058874398004383627411933864778666894130542938318184360907718395792547265810351010257906693549217168749049196334081",
   "1"
  ],
  [
   "3274148485184786419313417861103753396324707122790358986674747192537361048849279334890011575817622148579364181433246",
   "39413340362340948636392758179907617161338367452554862980153138773863252896317558693121510329056379738794495038288",
   "1"
  ],
  [
   "2034296943233181662422241529931690450166100850416081111076003696642124073710701355368588187004781831903748168437627",
   "458042661377250245941869618168036243475606422693342935003950663808797420263025881228430931560031505577953784996152",
   "1"
  ],
  [
   "2959664203622479893874243789106763064929007918069972062457979160208239314158439993996943808923306831704485613096732",
   "496168619196536185951179394519955644075679144774669506717721934867843351050632037641761002212097281069974378748713",
   "1"
  ],
  [
   "2102172398392648399379964645789192681808229146669878658633890724010129020700739155814340346339761766728450739179965",
   "387438966001197128263464981732302347235672037726210943575954324104062468680921010715846882734397778855120188993169",
   "1"
  ],
  [
   "2355809413333713576680266562893227419929079687779786900863563932487329615150545828363962111951640194555349228428357",
   "2875485732978214717249151654732217154471229291488626926295028631688423431316466176682631213577076693280717507361773",
   "1"
  ],
  [
   "769912081592237792066979092512845528376045360457643411993164904545008920442178007514953819657721281855101585169601",
   "1966207174809062218784709305942005311511797689593163333562658599323461540357802440160526856907635477082108115568560",
   "1"
  ],
  [
   "1357683147077026776673429041205265928782447003229292673988337232532940324455590777628672852707912013379329818076676",
   "1057814419379197888555375243131892331203086560728437925768240407754580498990255450417037112817920138658773602878789",
   "1"
  ],
  [
   "2487544026082760766051957211147529902813731320252781981900562252491689301859581676310891253045802228933975258413549",
   "426806210195184039097022083132501460958232083894585831891243060522563835147114099991358939197267532210352685934669",
   "1"
  ],
  [
   "3410816295976444062021308666798435880359821890012872065321240073122018798965429334877681219439009117959669111201306",
   "3512706143991685274508123165190108088161871938538609860180452729139665889318732163211413476488110094453492462408802",
   "1"
  ],
  [
   "214299321996955562797654826526739385390476123475563643283846853926439160041294777955084078014446861641440180817957",
   "1245306290044282481243160654348221486643737654285464496668534887297661598679998738719754293694851162271094080578744",
   "1"
  ],
  [
   "1434518035016779118825449246141039910646788297926247205244153556174141782753914932636181090490745302655691329695128",
   "2694902196547868560635265525810777323831740082649613093978222070097378608818390965649961774675534182570466113688625",
   "1"
  ],
  [
   "3863656037937428522858008540730819552742625719250775905845900219431339311099667615774942807410407235411025415937370",
   "682499195212481146235162840296947292442567155477234445045249992423379330815690461475401187527995086351625446217003",
   "1"
  ],
  [
   "2079020728704947370438519660358981977125484240276729102432566810705245690016469178384313232751070224500188109068439",
   "2126066033502430793516769030344006018045530964606195627094795617088241519690898561886325685013833229595046340919291",
   "1"
  ],
  [
   "388284052129611693779511145066963588887592755350231938937601906164391621232514256604339849331212866225084304519114",
   "1377807610014083860863143482880407104404799815629875733237985389316967187463067053640590967304389908105080364864446",
   "1"
  ],
  [
   "3847062333583097476529062756557832779327265638836290558349255871633977480456036912017734713656651871210214605720866",
   "1277118197227195502595520503165659787910279961589176504426273782855232120762515120934293847475228408090836684832004",
   "1"
  ],
  [
   "2187238704535220040692529609163177773732309358434849215718327245828161624631502693911666984984960449298149963654134",
   "2578299700391650010063629538600911019770834916559024653389802001386345966912827842210741846203281433355384630551972",
   "1"
  ],
  [
   "223617040252873299863631932799390572306265983850775540701710669603868598551062870958942476505666319499734204358415",
   "291024842032730249172914956287766961539348645773843978822579776321362088875294404604014788259405139799471404305904",
   "1"
  ],
  [
   "2720329819844291669764032855297269008719371821476758826869824231144641048140152761286215624318580422873410689723699",
   "3570613813894505872933041056805344188691484311002193464739248193634155311995767307995726383306257288448658973965971",
   "1"
  ],
  [
   "1897320805384621685048600136288194521852272275049982237277539218327408272673446697395649235646883296819140870263130",
   "2993637325321132899444769227560334311469343109666695294120467956507737122943008070187283650990102505147888390378744",
   "1"
  ],
  [
   "3808438548224067510394379512933018446731241327306362389428509373722795474825154935674306918652475444183567643597980",
   "1204816750386719118098955871718250272006449544138907848179224625202961459485933609248171072860572695577729708094141",
   "1"
  ],
  [
   "3525180476002198279059552913225729675444994936848540944936143831993759428299200075041749480174254811812700978843226",
   "836757699506047821349298804509425526815113829173321027057767852160101922566019365699185795977344677117116651626726",
   "1"
  ],
  [
   "3810528192675935290463336638707713049662881164701055432766750844016824288145742170284378625717063272780379293359164",
   "3000473240383192345615626908067601277079198928828691321094970218349594112880393501101196827521348644758723769434449",
   "1"
  ],
  [
   "2942365104586592083965817777944234982478084087337697494863263796566124652462114609518145699763166165332549413186827",
   "1738879593260557856114804535481095515532202564574209204147138335217960535776458997965022771204447860127397944691727",
   "1"
  ],
  [
   "817157210503984618183761000877870971399851135707793741702211575567876808093197218755252813993016814918299355918991",
   "3752225444495316057357015914742884970894280342692272577545676744061144243435639594706595908609182989359539273173956",
   "1"
  ],
  [
   "2480434380413442732549379443695062215051957537775720944975864878500242506530534763645257506737709209675828792043223",
   "3786488913406820279770864463674127314489910848553996607385802630912117061396024813912618399910158448964608494636672",
   "1"
  ],
  [
   "3859757353796323543320628048812410886776057956904942807065701714323514302235749973265733327060734140214292708881848",
   "203457906890273905995503345265070920419363925716916114721684702880018894632115381131513162172092531549365700613626",
   "1"
  ],
  [
   "2179554384967894046425115227831100991019431950437220300322058049079471405434608667569987568332669139413693719287513",
   "3273562418176109880332230642821501598816774713602928853945853142071677171712228781666841644006333425648785015767617",
   "1"
  ],
  [
   "1040090005266855844567419697786952921286242514598935032433761204323675769063669632671007299744131828237081682722553",
   "1331267442165054913249678092860623937147361079160733957154936192049978818389382113366774163878213425453100402147070",
   "1"
  ],
  [
   "3112106861357888871544184055851425122066972230363598549345733473719609823188306928990507784974192610999719203333128",
   "1623070459735640748784040619591510562180228175367243666227601365769589304970089595120662213746740854408286529854288",
   "1"
  ],
  [
   "198505347262617248245639875537295226979568482752025981124635657559893138670061816978780800220690524931380745909355",
   "3820452350599056778774036803761620283144219571493310717759144026925780348982514142856252345135492653961535327683849",
   "1"
  ],
  [
   "979178538078676487398984804390737707303165178648144542044152619333274930505438861195978152695209044510409484428826",
   "821713359347191685769447075486915777039280945135052082656868132892525452379970625656775543855076433178756174579467",
   "1"
  ],
  [
   "1965830448774339086560183585488932289304404712737208043561431660074006723785546276349223708902760577056641949816175",
   "649722030376978039727123059246897032669653100844621145894340957809785088119447694312327821726504226712816537041488",
   "1"
  ],
  [
   "3160272075961459965261177690750467586674588319053288161628146411811022958125632768166365199241442848261004639784228",
   "2184567694142050590474165424841908465631619266129500520360130366889556505881557573891906129862314705977532663742118",
   "1"
  ],
  [
   "1672026983852876881478838843466180934417324346853487358878659511911962859170986751777541786528567811127814942030357",
   "991611567939542165009313438666366132280535597526716501511933081333661565421540627676962749691171029148075262543724",
   "1"
  ],
  [
   "1161705359383691533133843548246920129503822059930439541490879945731639981884784192148287446020586024828337288395186",
   "2499798065317478607824654200297751158943992289660130780644481913582064366671453664158249877591493186961530950056624",
   "1"
  ],
  [
   "2767165733697441482084581797569910340002560589784662376582928900982047771579686499587499688742531785843052413993367",
   "3710546217546992392204486702373148443686189399095542758972503287114097118286737441059067735811223003085714081941662",
   "1"
  ],
  [
   "1111278134452823226054812230541814635666879586771138995318495545714346595233918659991849100862971052925246736333529",
   "322657514478526403100727263380226663135839383135596618058344271064209347315840641541855904394774212269090869662741",
   "1"
  ]
 ]
}


================================================
FILE: groth16/verifier/foundry.toml
================================================
[profile.default]
src = "src"
out = "out"
libs = ["lib"]
remappings = [
    "@openzeppelin/=lib/openzeppelin-contracts-upgradeable/contracts/",
]
viaIr = true
optimizer = true
optimizer_runs = 200
gas_limit = 30_000_000

evm_version = "prague"



================================================
FILE: groth16/verifier/scripts/README.md
================================================
# Verifier Generation Scripts

Scripts to generate Solidity Groth16 verifier contracts from verification keys.

## Prerequisites

- Python 3.6 or higher
- Standard library modules: `json`, `sys`, `os`

## Usage

```bash
# Generate 16 leaves verifier (single contract)
python3 generate_verifier_16_leaves.py ../trusted-setup/16_leaves_vk/verification_key.json output.sol

# Generate 32 leaves verifier (single contract)  
python3 generate_verifier_32_leaves.py ../trusted-setup/32_leaves_vk/verification_key.json output.sol

# Generate 64 leaves verifier (main + IC contract)
python3 generate_verifier_64_leaves.py ../trusted-setup/64_leaves_vk/verification_key.json output_dir/

# Generate 128 leaves verifier (main + IC1 + IC2 contracts)
python3 generate_verifier_128_leaves.py ../trusted-setup/128_leaves_vk/verification_key.json output_dir/
```

## Notes

- 16/32 leaves: Single contract with inline IC arrays
- 64/128 leaves: Split into multiple contracts for size optimization
- All scripts use proper BLS12-381 field element formatting
- Generated contracts are ready for deployment


================================================
FILE: groth16/verifier/scripts/generate_verifier_128_leaves.py
================================================
#!/usr/bin/env python3
"""
Generate Groth16Verifier128Leaves.sol and related IC contracts from verification_key.json

Usage: python generate_verifier_128_leaves.py <verification_key.json> <output_dir>
"""

import json
import sys
import os

def split_field_element(value):
    """Split a field element into BLS12-381 48-byte format (PART1 with 32 zeros + 16 bytes, PART2 with 32 bytes)"""
    if isinstance(value, str):
        val = int(value)
    else:
        val = int(value)
    
    # Convert to hex (remove 0x prefix)
    hex_val = hex(val)[2:].zfill(96)  # Pad to 96 hex chars (48 bytes)
    
    # Split into high 16 bytes and low 32 bytes
    high_part = hex_val[:32]  # First 32 hex chars = 16 bytes
    low_part = hex_val[32:]   # Last 64 hex chars = 32 bytes
    
    # Add 16 zero bytes (32 hex chars) prefix to high part
    part1 = "0x" + "0" * 32 + high_part
    part2 = "0x" + low_part
    
    return part1, part2

def generate_ic1_contract(ic_array):
    """Generate the IC1 contract (IC0 through IC128)"""
    ic_entries = []
    for i in range(129):  # IC0 through IC128
        ic_point = ic_array[i]
        x_part1, x_part2 = split_field_element(ic_point[0])
        y_part1, y_part2 = split_field_element(ic_point[1])
        
        ic_entries.append(f"        if (index == {i}) return ({x_part1}, {x_part2}, {y_part1}, {y_part2});")
    
    ic1_contract = f'''// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

contract Groth16Verifier128LeavesIC1 {{
    function getIC1(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {{
{chr(10).join(ic_entries)}
        revert("Invalid IC1 index");
    }}
}}
'''
    
    return ic1_contract

def generate_ic2_contract(ic_array):
    """Generate the IC2 contract (IC129 through IC259)"""
    ic_entries = []
    start_index = 129
    
    for i in range(len(ic_array) - 129):  # Remaining IC points
        global_index = start_index + i
        ic_point = ic_array[global_index]
        x_part1, x_part2 = split_field_element(ic_point[0])
        y_part1, y_part2 = split_field_element(ic_point[1])
        
        ic_entries.append(f"        if (index == {i}) return ({x_part1}, {x_part2}, {y_part1}, {y_part2});")
    
    ic2_contract = f'''// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

contract Groth16Verifier128LeavesIC2 {{
    function getIC2(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {{
{chr(10).join(ic_entries)}
        revert("Invalid IC2 index");
    }}
}}
'''
    
    return ic2_contract

def generate_main_contract(vk_data):
    """Generate the main verifier contract"""
    
    # Extract verification key components
    alpha = vk_data['vk_alpha_1']
    beta = vk_data['vk_beta_2']
    gamma = vk_data['vk_gamma_2'] 
    delta = vk_data['vk_delta_2']
    ic_array = vk_data['IC']
    
    # Calculate counts
    ic_count = len(ic_array)
    pub_signal_count = ic_count - 1  # IC0 is constant term
    ic2_count = ic_count - 129  # IC points handled by IC2 contract
    
    # Split field elements
    alphax_part1, alphax_part2 = split_field_element(alpha[0])
    alphay_part1, alphay_part2 = split_field_element(alpha[1])
    
    betax1_part1, betax1_part2 = split_field_element(beta[0][1])  # x0
    betax2_part1, betax2_part2 = split_field_element(beta[0][0])  # x1  
    betay1_part1, betay1_part2 = split_field_element(beta[1][1])  # y0
    betay2_part1, betay2_part2 = split_field_element(beta[1][0])  # y1
    
    gammax1_part1, gammax1_part2 = split_field_element(gamma[0][1])  # x0
    gammax2_part1, gammax2_part2 = split_field_element(gamma[0][0])  # x1
    gammay1_part1, gammay1_part2 = split_field_element(gamma[1][1])  # y0
    gammay2_part1, gammay2_part2 = split_field_element(gamma[1][0])  # y1
    
    deltax1_part1, deltax1_part2 = split_field_element(delta[0][1])  # x0
    deltax2_part1, deltax2_part2 = split_field_element(delta[0][0])  # x1
    deltay1_part1, deltay1_part2 = split_field_element(delta[1][1])  # y0
    deltay2_part1, deltay2_part2 = split_field_element(delta[1][0])  # y1
    
    main_contract = f'''// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

import "./Groth16Verifier128LeavesIC1.sol";
import "./Groth16Verifier128LeavesIC2.sol";

contract Groth16Verifier128Leaves {{
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key constants for 128 leaves
    uint256 internal constant alphax_PART1 = {alphax_part1};
    uint256 internal constant alphax_PART2 = {alphax_part2};
    uint256 internal constant alphay_PART1 = {alphay_part1};
    uint256 internal constant alphay_PART2 = {alphay_part2};

    uint256 constant betax1_PART1 = {betax1_part1};
    uint256 constant betax1_PART2 = {betax1_part2};
    uint256 constant betax2_PART1 = {betax2_part1};
    uint256 constant betax2_PART2 = {betax2_part2};
    uint256 constant betay1_PART1 = {betay1_part1};
    uint256 constant betay1_PART2 = {betay1_part2};
    uint256 constant betay2_PART1 = {betay2_part1};
    uint256 constant betay2_PART2 = {betay2_part2};

    uint256 constant gammax1_PART1 = {gammax1_part1};
    uint256 constant gammax1_PART2 = {gammax1_part2};
    uint256 constant gammax2_PART1 = {gammax2_part1};
    uint256 constant gammax2_PART2 = {gammax2_part2};
    uint256 constant gammay1_PART1 = {gammay1_part1};
    uint256 constant gammay1_PART2 = {gammay1_part2};
    uint256 constant gammay2_PART1 = {gammay2_part1};
    uint256 constant gammay2_PART2 = {gammay2_part2};

    uint256 constant deltax1_PART1 = {deltax1_part1};
    uint256 constant deltax1_PART2 = {deltax1_part2};
    uint256 constant deltax2_PART1 = {deltax2_part1};
    uint256 constant deltax2_PART2 = {deltax2_part2};
    uint256 constant deltay1_PART1 = {deltay1_part1};
    uint256 constant deltay1_PART2 = {deltay1_part2};
    uint256 constant deltay2_PART1 = {deltay2_part1};
    uint256 constant deltay2_PART2 = {deltay2_part2};

    // References to the IC constants contracts
    Groth16Verifier128LeavesIC1 public icContract1;
    Groth16Verifier128LeavesIC2 public icContract2;

    // Memory layout for pairing check
    uint16 constant pPairing = 1408;
    uint16 constant pVk = 0; 
    uint16 constant pLastMem = 1664;

    constructor(address _icContract1, address _icContract2) {{
        icContract1 = Groth16Verifier128LeavesIC1(_icContract1);
        icContract2 = Groth16Verifier128LeavesIC2(_icContract2);
    }}

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[{pub_signal_count}] calldata _pubSignals
    ) public view returns (bool) {{
        assembly {{
            function checkField(v) {{
                if iszero(lt(v, R_MOD)) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {{
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {{
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Get IC0 (constant term) from IC1 contract
                let icContract1 := sload(icContract1.slot)
                let ic0CallData := mload(0x40)
                mstore(ic0CallData, 0xfa6e2f2a00000000000000000000000000000000000000000000000000000000) // getIC1(uint256) selector
                mstore(add(ic0CallData, 4), 0) // index 0
                
                let ic0Success := staticcall(gas(), icContract1, ic0CallData, 36, ic0CallData, 128)
                if iszero(ic0Success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}

                // Initialize vk_x with IC0
                mstore(_pVk, mload(ic0CallData)) // IC0x_PART1
                mstore(add(_pVk, 32), mload(add(ic0CallData, 32))) // IC0x_PART2
                mstore(add(_pVk, 64), mload(add(ic0CallData, 64))) // IC0y_PART1
                mstore(add(_pVk, 96), mload(add(ic0CallData, 96))) // IC0y_PART2

                // Process first 128 signals (indices 1-128) from IC1
                for {{ let i := 1 }} lt(i, 129) {{ i := add(i, 1) }} {{
                    // Get IC[i] from IC1 contract
                    mstore(ic0CallData, 0xfa6e2f2a00000000000000000000000000000000000000000000000000000000) // getIC1(uint256) selector
                    mstore(add(ic0CallData, 4), i)
                    
                    let icSuccess := staticcall(gas(), icContract1, ic0CallData, 36, ic0CallData, 128)
                    if iszero(icSuccess) {{
                        mstore(0, 0)
                        return(0, 0x20)
                    }}

                    // Get public signal
                    let signalOffset := mul(sub(i, 1), 32)
                    let signal := calldataload(add(pubSignals, signalOffset))

                    // Multiply and accumulate
                    g1_mulAccC(_pVk, mload(ic0CallData), mload(add(ic0CallData, 32)), mload(add(ic0CallData, 64)), mload(add(ic0CallData, 96)), signal)
                }}

                // Process remaining {ic2_count} signals (indices 129-{ic_count-1}) from IC2
                let icContract2 := sload(icContract2.slot)
                for {{ let i := 129 }} lt(i, {ic_count}) {{ i := add(i, 1) }} {{
                    // Get IC[i] from IC2 contract (using index i-129)
                    mstore(ic0CallData, 0xb91c1e9400000000000000000000000000000000000000000000000000000000) // getIC2(uint256) selector
                    mstore(add(ic0CallData, 4), sub(i, 129))
                    
                    let icSuccess := staticcall(gas(), icContract2, ic0CallData, 36, ic0CallData, 128)
                    if iszero(icSuccess) {{
                        mstore(0, 0)
                        return(0, 0x20)
                    }}

                    // Get public signal
                    let signalOffset := mul(sub(i, 1), 32)
                    let signal := calldataload(add(pubSignals, signalOffset))

                    // Multiply and accumulate
                    g1_mulAccC(_pVk, mload(ic0CallData), mload(add(ic0CallData, 32)), mload(add(ic0CallData, 64)), mload(add(ic0CallData, 96)), signal)
                }}

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {{
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }}
                default {{
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }}

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }}

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate that all evaluations âˆˆ F
            for {{ let i := 0 }} lt(i, {pub_signal_count}) {{ i := add(i, 1) }} {{
                let offset := mul(i, 32)
                checkField(calldataload(add(_pubSignals, offset)))
            }}

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }}
    }}
}}
'''
    
    return main_contract

def main():
    if len(sys.argv) != 3:
        print("Usage: python generate_verifier_128_leaves.py <verification_key.json> <output_dir>")
        sys.exit(1)
    
    input_file = sys.argv[1]
    output_dir = sys.argv[2]
    
    if not os.path.exists(input_file):
        print(f"Error: Input file {input_file} does not exist")
        sys.exit(1)
    
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # Load verification key
    with open(input_file, 'r') as f:
        vk_data = json.load(f)
    
    ic_array = vk_data['IC']
    
    # Generate contracts
    ic1_contract = generate_ic1_contract(ic_array)
    ic2_contract = generate_ic2_contract(ic_array)
    main_contract = generate_main_contract(vk_data)
    
    # Write outputs
    ic1_file = os.path.join(output_dir, "Groth16Verifier128LeavesIC1.sol")
    ic2_file = os.path.join(output_dir, "Groth16Verifier128LeavesIC2.sol")
    main_file = os.path.join(output_dir, "Groth16Verifier128Leaves.sol")
    
    with open(ic1_file, 'w') as f:
        f.write(ic1_contract)
    
    with open(ic2_file, 'w') as f:
        f.write(ic2_contract)
    
    with open(main_file, 'w') as f:
        f.write(main_contract)
    
    print(f"Generated {ic1_file}")
    print(f"Generated {ic2_file}")
    print(f"Generated {main_file}")
    print(f"IC count: {len(ic_array)}")
    print(f"Public signals: {len(ic_array) - 1}")
    print(f"IC1 covers: IC0-IC128 (129 points)")
    print(f"IC2 covers: IC129-IC{len(ic_array)-1} ({len(ic_array)-129} points)")

if __name__ == "__main__":
    main()


================================================
FILE: groth16/verifier/scripts/generate_verifier_16_leaves.py
================================================
#!/usr/bin/env python3
"""
Generate Groth16Verifier16Leaves.sol from verification_key.json

Usage: python generate_verifier_16_leaves.py <verification_key.json> <output.sol>
"""

import json
import sys
import os

def split_field_element(value):
    """Split a field element into BLS12-381 48-byte format (PART1 with 32 zeros + 16 bytes, PART2 with 32 bytes)"""
    if isinstance(value, str):
        val = int(value)
    else:
        val = int(value)
    
    # Convert to hex (remove 0x prefix)
    hex_val = hex(val)[2:].zfill(96)  # Pad to 96 hex chars (48 bytes)
    
    # Split into high 16 bytes and low 32 bytes
    high_part = hex_val[:32]  # First 32 hex chars = 16 bytes
    low_part = hex_val[32:]   # Last 64 hex chars = 32 bytes
    
    # Add 16 zero bytes (32 hex chars) prefix to high part
    part1 = "0x" + "0" * 32 + high_part
    part2 = "0x" + low_part
    
    return part1, part2

def generate_ic_constants(ic_array):
    """Generate IC constant declarations"""
    constants = []
    for i, ic_point in enumerate(ic_array):
        x_part1, x_part2 = split_field_element(ic_point[0])
        y_part1, y_part2 = split_field_element(ic_point[1])
        
        constants.extend([
            f"    uint256 constant IC{i}x_PART1 = {x_part1};",
            f"    uint256 constant IC{i}x_PART2 = {x_part2};", 
            f"    uint256 constant IC{i}y_PART1 = {y_part1};",
            f"    uint256 constant IC{i}y_PART2 = {y_part2};",
            ""
        ])
    
    return "\n".join(constants)

def generate_ic_calls(ic_count):
    """Generate g1_mulAccC calls for IC points"""
    calls = []
    for i in range(1, ic_count):  # Start from 1, skip IC0
        offset = i * 32
        calls.append(f"                g1_mulAccC(_pVk, IC{i}x_PART1, IC{i}x_PART2, IC{i}y_PART1, IC{i}y_PART2, calldataload(add(pubSignals, {offset})))")
        calls.append("")
    
    return "\n".join(calls)

def generate_checkfield_calls(pub_signal_count):
    """Generate checkField calls for public signals"""
    calls = []
    for i in range(pub_signal_count):
        offset = i * 32
        calls.append(f"            checkField(calldataload(add(_pubSignals, {offset})))")
        calls.append("")
    
    return "\n".join(calls)

def generate_contract(vk_data):
    """Generate the complete contract from verification key data"""
    
    # Extract verification key components
    alpha = vk_data['vk_alpha_1']
    beta = vk_data['vk_beta_2']
    gamma = vk_data['vk_gamma_2'] 
    delta = vk_data['vk_delta_2']
    ic_array = vk_data['IC']
    
    # Calculate counts
    ic_count = len(ic_array)
    pub_signal_count = ic_count - 1  # IC0 is constant term
    
    # Split field elements
    alphax_part1, alphax_part2 = split_field_element(alpha[0])
    alphay_part1, alphay_part2 = split_field_element(alpha[1])
    
    betax1_part1, betax1_part2 = split_field_element(beta[0][1])  # x0
    betax2_part1, betax2_part2 = split_field_element(beta[0][0])  # x1  
    betay1_part1, betay1_part2 = split_field_element(beta[1][1])  # y0
    betay2_part1, betay2_part2 = split_field_element(beta[1][0])  # y1
    
    gammax1_part1, gammax1_part2 = split_field_element(gamma[0][1])  # x0
    gammax2_part1, gammax2_part2 = split_field_element(gamma[0][0])  # x1
    gammay1_part1, gammay1_part2 = split_field_element(gamma[1][1])  # y0
    gammay2_part1, gammay2_part2 = split_field_element(gamma[1][0])  # y1
    
    deltax1_part1, deltax1_part2 = split_field_element(delta[0][1])  # x0
    deltax2_part1, deltax2_part2 = split_field_element(delta[0][0])  # x1
    deltay1_part1, deltay1_part2 = split_field_element(delta[1][1])  # y0
    deltay2_part1, deltay2_part2 = split_field_element(delta[1][0])  # y1
    
    # Generate IC constants
    ic_constants = generate_ic_constants(ic_array)
    
    # Generate assembly calls
    ic_calls = generate_ic_calls(ic_count)
    checkfield_calls = generate_checkfield_calls(pub_signal_count)
    
    contract_template = f'''// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/

pragma solidity >=0.7.0 <0.9.0;

contract Groth16Verifier16Leaves {{
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 constant alphax_PART1 = {alphax_part1};
    uint256 constant alphax_PART2 = {alphax_part2};
    uint256 constant alphay_PART1 = {alphay_part1};
    uint256 constant alphay_PART2 = {alphay_part2};
    uint256 constant betax1_PART1 = {betax1_part1};
    uint256 constant betax1_PART2 = {betax1_part2};
    uint256 constant betax2_PART1 = {betax2_part1};
    uint256 constant betax2_PART2 = {betax2_part2};
    uint256 constant betay1_PART1 = {betay1_part1};
    uint256 constant betay1_PART2 = {betay1_part2};
    uint256 constant betay2_PART1 = {betay2_part1};
    uint256 constant betay2_PART2 = {betay2_part2};
    uint256 constant gammax1_PART1 = {gammax1_part1};
    uint256 constant gammax1_PART2 = {gammax1_part2};
    uint256 constant gammax2_PART1 = {gammax2_part1};
    uint256 constant gammax2_PART2 = {gammax2_part2};
    uint256 constant gammay1_PART1 = {gammay1_part1};
    uint256 constant gammay1_PART2 = {gammay1_part2};
    uint256 constant gammay2_PART1 = {gammay2_part1};
    uint256 constant gammay2_PART2 = {gammay2_part2};

    uint256 constant deltax2_PART1 = {deltax2_part1};
    uint256 constant deltax2_PART2 = {deltax2_part2};
    uint256 constant deltax1_PART1 = {deltax1_part1};
    uint256 constant deltax1_PART2 = {deltax1_part2};
    uint256 constant deltay2_PART1 = {deltay2_part1};
    uint256 constant deltay2_PART2 = {deltay2_part2};
    uint256 constant deltay1_PART1 = {deltay1_part1};
    uint256 constant deltay1_PART2 = {deltay1_part2};

    // IC Points - split into PART1/PART2 for BLS12-381 format

{ic_constants}

    // Memory data
    uint16 constant pVk = 0;
    uint16 constant pPairing = 128;

    uint16 constant pLastMem = 1664;

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[{pub_signal_count}] calldata _pubSignals
    ) public view returns (bool) {{
        assembly {{
            function checkField(v) {{
                if iszero(lt(v, R_MOD)) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {{
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {{
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Initialize vk_x with IC0 (the constant term)
                mstore(_pVk, IC0x_PART1)
                mstore(add(_pVk, 32), IC0x_PART2)
                mstore(add(_pVk, 64), IC0y_PART1)
                mstore(add(_pVk, 96), IC0y_PART2)

                // Compute the linear combination vk_x = IC0 + IC1*pubSignals[0] + IC2*pubSignals[1] + ...

{ic_calls}

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {{
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }}
                default {{
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }}

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }}

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate that all evaluations âˆˆ F

{checkfield_calls}

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }}
    }}
}}
'''
    
    return contract_template

def main():
    if len(sys.argv) != 3:
        print("Usage: python generate_verifier_16_leaves.py <verification_key.json> <output.sol>")
        sys.exit(1)
    
    input_file = sys.argv[1]
    output_file = sys.argv[2]
    
    if not os.path.exists(input_file):
        print(f"Error: Input file {input_file} does not exist")
        sys.exit(1)
    
    # Load verification key
    with open(input_file, 'r') as f:
        vk_data = json.load(f)
    
    # Generate contract
    contract_code = generate_contract(vk_data)
    
    # Write output
    with open(output_file, 'w') as f:
        f.write(contract_code)
    
    print(f"Generated {output_file}")
    print(f"IC count: {len(vk_data['IC'])}")
    print(f"Public signals: {len(vk_data['IC']) - 1}")

if __name__ == "__main__":
    main()


================================================
FILE: groth16/verifier/scripts/generate_verifier_32_leaves.py
================================================
#!/usr/bin/env python3
"""
Generate Groth16Verifier32Leaves.sol from verification_key.json

Usage: python generate_verifier_32_leaves.py <verification_key.json> <output.sol>
"""

import json
import sys
import os

def split_field_element(value):
    """Split a field element into BLS12-381 48-byte format (PART1 with 32 zeros + 16 bytes, PART2 with 32 bytes)"""
    if isinstance(value, str):
        val = int(value)
    else:
        val = int(value)
    
    # Convert to hex (remove 0x prefix)
    hex_val = hex(val)[2:].zfill(96)  # Pad to 96 hex chars (48 bytes)
    
    # Split into high 16 bytes and low 32 bytes
    high_part = hex_val[:32]  # First 32 hex chars = 16 bytes
    low_part = hex_val[32:]   # Last 64 hex chars = 32 bytes
    
    # Add 16 zero bytes (32 hex chars) prefix to high part
    part1 = "0x" + "0" * 32 + high_part
    part2 = "0x" + low_part
    
    return part1, part2

def generate_ic_constants(ic_array):
    """Generate IC constant declarations"""
    constants = []
    for i, ic_point in enumerate(ic_array):
        x_part1, x_part2 = split_field_element(ic_point[0])
        y_part1, y_part2 = split_field_element(ic_point[1])
        
        constants.extend([
            f"    uint256 constant IC{i}x_PART1 = {x_part1};",
            f"    uint256 constant IC{i}x_PART2 = {x_part2};", 
            f"    uint256 constant IC{i}y_PART1 = {y_part1};",
            f"    uint256 constant IC{i}y_PART2 = {y_part2};",
            ""
        ])
    
    return "\n".join(constants)

def generate_ic_calls(ic_count):
    """Generate g1_mulAccC calls for IC points"""
    calls = []
    for i in range(1, ic_count):  # Start from 1, skip IC0
        offset = i * 32
        calls.append(f"                g1_mulAccC(_pVk, IC{i}x_PART1, IC{i}x_PART2, IC{i}y_PART1, IC{i}y_PART2, calldataload(add(pubSignals, {offset})))")
        calls.append("")
    
    return "\n".join(calls)

def generate_checkfield_calls(pub_signal_count):
    """Generate checkField calls for public signals"""
    calls = []
    for i in range(pub_signal_count):
        offset = i * 32
        calls.append(f"            checkField(calldataload(add(_pubSignals, {offset})))")
        calls.append("")
    
    return "\n".join(calls)

def generate_contract(vk_data):
    """Generate the complete contract from verification key data"""
    
    # Extract verification key components
    alpha = vk_data['vk_alpha_1']
    beta = vk_data['vk_beta_2']
    gamma = vk_data['vk_gamma_2'] 
    delta = vk_data['vk_delta_2']
    ic_array = vk_data['IC']
    
    # Calculate counts
    ic_count = len(ic_array)
    pub_signal_count = ic_count - 1  # IC0 is constant term
    
    # Split field elements
    alphax_part1, alphax_part2 = split_field_element(alpha[0])
    alphay_part1, alphay_part2 = split_field_element(alpha[1])
    
    betax1_part1, betax1_part2 = split_field_element(beta[0][1])  # x0
    betax2_part1, betax2_part2 = split_field_element(beta[0][0])  # x1  
    betay1_part1, betay1_part2 = split_field_element(beta[1][1])  # y0
    betay2_part1, betay2_part2 = split_field_element(beta[1][0])  # y1
    
    gammax1_part1, gammax1_part2 = split_field_element(gamma[0][1])  # x0
    gammax2_part1, gammax2_part2 = split_field_element(gamma[0][0])  # x1
    gammay1_part1, gammay1_part2 = split_field_element(gamma[1][1])  # y0
    gammay2_part1, gammay2_part2 = split_field_element(gamma[1][0])  # y1
    
    deltax1_part1, deltax1_part2 = split_field_element(delta[0][1])  # x0
    deltax2_part1, deltax2_part2 = split_field_element(delta[0][0])  # x1
    deltay1_part1, deltay1_part2 = split_field_element(delta[1][1])  # y0
    deltay2_part1, deltay2_part2 = split_field_element(delta[1][0])  # y1
    
    # Generate IC constants
    ic_constants = generate_ic_constants(ic_array)
    
    # Generate assembly calls
    ic_calls = generate_ic_calls(ic_count)
    checkfield_calls = generate_checkfield_calls(pub_signal_count)
    
    contract_template = f'''// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/

pragma solidity >=0.7.0 <0.9.0;

contract Groth16Verifier32Leaves {{
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 constant alphax_PART1 = {alphax_part1};
    uint256 constant alphax_PART2 = {alphax_part2};
    uint256 constant alphay_PART1 = {alphay_part1};
    uint256 constant alphay_PART2 = {alphay_part2};
    uint256 constant betax1_PART1 = {betax1_part1};
    uint256 constant betax1_PART2 = {betax1_part2};
    uint256 constant betax2_PART1 = {betax2_part1};
    uint256 constant betax2_PART2 = {betax2_part2};
    uint256 constant betay1_PART1 = {betay1_part1};
    uint256 constant betay1_PART2 = {betay1_part2};
    uint256 constant betay2_PART1 = {betay2_part1};
    uint256 constant betay2_PART2 = {betay2_part2};
    uint256 constant gammax1_PART1 = {gammax1_part1};
    uint256 constant gammax1_PART2 = {gammax1_part2};
    uint256 constant gammax2_PART1 = {gammax2_part1};
    uint256 constant gammax2_PART2 = {gammax2_part2};
    uint256 constant gammay1_PART1 = {gammay1_part1};
    uint256 constant gammay1_PART2 = {gammay1_part2};
    uint256 constant gammay2_PART1 = {gammay2_part1};
    uint256 constant gammay2_PART2 = {gammay2_part2};
    uint256 constant deltax1_PART1 = {deltax1_part1};
    uint256 constant deltax1_PART2 = {deltax1_part2};
    uint256 constant deltax2_PART1 = {deltax2_part1};
    uint256 constant deltax2_PART2 = {deltax2_part2};
    uint256 constant deltay1_PART1 = {deltay1_part1};
    uint256 constant deltay1_PART2 = {deltay1_part2};
    uint256 constant deltay2_PART1 = {deltay2_part1};
    uint256 constant deltay2_PART2 = {deltay2_part2};

    // IC Points - split into PART1/PART2 for BLS12-381 format

{ic_constants}

    // Memory data
    uint16 constant pVk = 0;
    uint16 constant pPairing = 128;

    uint16 constant pLastMem = 1664;

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[{pub_signal_count}] calldata _pubSignals
    ) public view returns (bool) {{
        assembly {{
            function checkField(v) {{
                if iszero(lt(v, R_MOD)) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {{
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {{
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Initialize vk_x with IC0 (the constant term)
                mstore(_pVk, IC0x_PART1)
                mstore(add(_pVk, 32), IC0x_PART2)
                mstore(add(_pVk, 64), IC0y_PART1)
                mstore(add(_pVk, 96), IC0y_PART2)

                // Compute the linear combination vk_x = IC0 + IC1*pubSignals[0] + IC2*pubSignals[1] + ...

{ic_calls}

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {{
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }}
                default {{
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }}

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }}

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate that all evaluations âˆˆ F

{checkfield_calls}

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }}
    }}
}}
'''
    
    return contract_template

def main():
    if len(sys.argv) != 3:
        print("Usage: python generate_verifier_32_leaves.py <verification_key.json> <output.sol>")
        sys.exit(1)
    
    input_file = sys.argv[1]
    output_file = sys.argv[2]
    
    if not os.path.exists(input_file):
        print(f"Error: Input file {input_file} does not exist")
        sys.exit(1)
    
    # Load verification key
    with open(input_file, 'r') as f:
        vk_data = json.load(f)
    
    # Generate contract
    contract_code = generate_contract(vk_data)
    
    # Write output
    with open(output_file, 'w') as f:
        f.write(contract_code)
    
    print(f"Generated {output_file}")
    print(f"IC count: {len(vk_data['IC'])}")
    print(f"Public signals: {len(vk_data['IC']) - 1}")

if __name__ == "__main__":
    main()


================================================
FILE: groth16/verifier/scripts/generate_verifier_64_leaves.py
================================================
#!/usr/bin/env python3
"""
Generate Groth16Verifier64Leaves.sol and Groth16Verifier64LeavesIC.sol from verification_key.json

Usage: python generate_verifier_64_leaves.py <verification_key.json> <output_dir>
"""

import json
import sys
import os

def split_field_element(value):
    """Split a field element into BLS12-381 48-byte format (PART1 with 32 zeros + 16 bytes, PART2 with 32 bytes)"""
    if isinstance(value, str):
        val = int(value)
    else:
        val = int(value)
    
    # Convert to hex (remove 0x prefix)
    hex_val = hex(val)[2:].zfill(96)  # Pad to 96 hex chars (48 bytes)
    
    # Split into high 16 bytes and low 32 bytes
    high_part = hex_val[:32]  # First 32 hex chars = 16 bytes
    low_part = hex_val[32:]   # Last 64 hex chars = 32 bytes
    
    # Add 16 zero bytes (32 hex chars) prefix to high part
    part1 = "0x" + "0" * 32 + high_part
    part2 = "0x" + low_part
    
    return part1, part2

def generate_ic_contract(ic_array):
    """Generate the IC contract with getIC function"""
    ic_entries = []
    for i, ic_point in enumerate(ic_array):
        x_part1, x_part2 = split_field_element(ic_point[0])
        y_part1, y_part2 = split_field_element(ic_point[1])
        
        ic_entries.append(f"        if (index == {i}) return ({x_part1}, {x_part2}, {y_part1}, {y_part2});")
    
    ic_contract = f'''// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

// IC Constants contract for 64-leaves verifier - Updated verification key
contract Groth16Verifier64LeavesIC {{
    function getIC(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {{
{chr(10).join(ic_entries)}
        revert("Invalid IC index");
    }}
}}
'''
    
    return ic_contract

def generate_main_contract(vk_data):
    """Generate the main verifier contract"""
    
    # Extract verification key components
    alpha = vk_data['vk_alpha_1']
    beta = vk_data['vk_beta_2']
    gamma = vk_data['vk_gamma_2'] 
    delta = vk_data['vk_delta_2']
    ic_array = vk_data['IC']
    
    # Calculate counts
    ic_count = len(ic_array)
    pub_signal_count = ic_count - 1  # IC0 is constant term
    
    # Split field elements
    alphax_part1, alphax_part2 = split_field_element(alpha[0])
    alphay_part1, alphay_part2 = split_field_element(alpha[1])
    
    betax1_part1, betax1_part2 = split_field_element(beta[0][1])  # x0
    betax2_part1, betax2_part2 = split_field_element(beta[0][0])  # x1  
    betay1_part1, betay1_part2 = split_field_element(beta[1][1])  # y0
    betay2_part1, betay2_part2 = split_field_element(beta[1][0])  # y1
    
    gammax1_part1, gammax1_part2 = split_field_element(gamma[0][1])  # x0
    gammax2_part1, gammax2_part2 = split_field_element(gamma[0][0])  # x1
    gammay1_part1, gammay1_part2 = split_field_element(gamma[1][1])  # y0
    gammay2_part1, gammay2_part2 = split_field_element(gamma[1][0])  # y1
    
    deltax1_part1, deltax1_part2 = split_field_element(delta[0][1])  # x0
    deltax2_part1, deltax2_part2 = split_field_element(delta[0][0])  # x1
    deltay1_part1, deltay1_part2 = split_field_element(delta[1][1])  # y0
    deltay2_part1, deltay2_part2 = split_field_element(delta[1][0])  # y1
    
    main_contract = f'''// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

import "./Groth16Verifier64LeavesIC.sol";

contract Groth16Verifier64Leaves {{
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key constants for 64 leaves
    uint256 internal constant alphax_PART1 = {alphax_part1};
    uint256 internal constant alphax_PART2 = {alphax_part2};
    uint256 internal constant alphay_PART1 = {alphay_part1};
    uint256 internal constant alphay_PART2 = {alphay_part2};

    uint256 constant betax1_PART1 = {betax1_part1};
    uint256 constant betax1_PART2 = {betax1_part2};
    uint256 constant betax2_PART1 = {betax2_part1};
    uint256 constant betax2_PART2 = {betax2_part2};
    uint256 constant betay1_PART1 = {betay1_part1};
    uint256 constant betay1_PART2 = {betay1_part2};
    uint256 constant betay2_PART1 = {betay2_part1};
    uint256 constant betay2_PART2 = {betay2_part2};

    uint256 constant gammax1_PART1 = {gammax1_part1};
    uint256 constant gammax1_PART2 = {gammax1_part2};
    uint256 constant gammax2_PART1 = {gammax2_part1};
    uint256 constant gammax2_PART2 = {gammax2_part2};
    uint256 constant gammay1_PART1 = {gammay1_part1};
    uint256 constant gammay1_PART2 = {gammay1_part2};
    uint256 constant gammay2_PART1 = {gammay2_part1};
    uint256 constant gammay2_PART2 = {gammay2_part2};

    uint256 constant deltax1_PART1 = {deltax1_part1};
    uint256 constant deltax1_PART2 = {deltax1_part2};
    uint256 constant deltax2_PART1 = {deltax2_part1};
    uint256 constant deltax2_PART2 = {deltax2_part2};
    uint256 constant deltay1_PART1 = {deltay1_part1};
    uint256 constant deltay1_PART2 = {deltay1_part2};
    uint256 constant deltay2_PART1 = {deltay2_part1};
    uint256 constant deltay2_PART2 = {deltay2_part2};

    // Reference to the IC constants contract
    Groth16Verifier64LeavesIC public icContract;

    // Memory layout for pairing check
    uint16 constant pPairing = 1408;
    uint16 constant pVk = 0; 
    uint16 constant pLastMem = 1664;

    constructor(address _icContract) {{
        icContract = Groth16Verifier64LeavesIC(_icContract);
    }}

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[{pub_signal_count}] calldata _pubSignals
    ) public view returns (bool) {{
        assembly {{
            function checkField(v) {{
                if iszero(lt(v, R_MOD)) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {{
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}
            }}

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {{
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Get IC0 (constant term) from IC contract
                let icContract := sload(icContract.slot)
                let ic0CallData := mload(0x40)
                mstore(ic0CallData, 0x9bac5bf400000000000000000000000000000000000000000000000000000000) // getIC(uint256) selector
                mstore(add(ic0CallData, 4), 0) // index 0
                
                let ic0Success := staticcall(gas(), icContract, ic0CallData, 36, ic0CallData, 128)
                if iszero(ic0Success) {{
                    mstore(0, 0)
                    return(0, 0x20)
                }}

                // Initialize vk_x with IC0
                mstore(_pVk, mload(ic0CallData)) // IC0x_PART1
                mstore(add(_pVk, 32), mload(add(ic0CallData, 32))) // IC0x_PART2
                mstore(add(_pVk, 64), mload(add(ic0CallData, 64))) // IC0y_PART1
                mstore(add(_pVk, 96), mload(add(ic0CallData, 96))) // IC0y_PART2

                // Compute the linear combination using IC contract
                for {{ let i := 1 }} lt(i, {ic_count}) {{ i := add(i, 1) }} {{
                    // Get IC[i] from contract
                    mstore(ic0CallData, 0x9bac5bf400000000000000000000000000000000000000000000000000000000) // getIC(uint256) selector
                    mstore(add(ic0CallData, 4), i)
                    
                    let icSuccess := staticcall(gas(), icContract, ic0CallData, 36, ic0CallData, 128)
                    if iszero(icSuccess) {{
                        mstore(0, 0)
                        return(0, 0x20)
                    }}

                    // Get public signal
                    let signalOffset := mul(sub(i, 1), 32)
                    let signal := calldataload(add(pubSignals, signalOffset))

                    // Multiply and accumulate
                    g1_mulAccC(_pVk, mload(ic0CallData), mload(add(ic0CallData, 32)), mload(add(ic0CallData, 64)), mload(add(ic0CallData, 96)), signal)
                }}

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {{
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }}
                default {{
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }}

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }}

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate that all evaluations âˆˆ F
            for {{ let i := 0 }} lt(i, {pub_signal_count}) {{ i := add(i, 1) }} {{
                let offset := mul(i, 32)
                checkField(calldataload(add(_pubSignals, offset)))
            }}

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }}
    }}
}}
'''
    
    return main_contract

def main():
    if len(sys.argv) != 3:
        print("Usage: python generate_verifier_64_leaves.py <verification_key.json> <output_dir>")
        sys.exit(1)
    
    input_file = sys.argv[1]
    output_dir = sys.argv[2]
    
    if not os.path.exists(input_file):
        print(f"Error: Input file {input_file} does not exist")
        sys.exit(1)
    
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # Load verification key
    with open(input_file, 'r') as f:
        vk_data = json.load(f)
    
    ic_array = vk_data['IC']
    
    # Generate contracts
    ic_contract = generate_ic_contract(ic_array)
    main_contract = generate_main_contract(vk_data)
    
    # Write outputs
    ic_file = os.path.join(output_dir, "Groth16Verifier64LeavesIC.sol")
    main_file = os.path.join(output_dir, "Groth16Verifier64Leaves.sol")
    
    with open(ic_file, 'w') as f:
        f.write(ic_contract)
    
    with open(main_file, 'w') as f:
        f.write(main_contract)
    
    print(f"Generated {ic_file}")
    print(f"Generated {main_file}")
    print(f"IC count: {len(ic_array)}")
    print(f"Public signals: {len(ic_array) - 1}")

if __name__ == "__main__":
    main()


================================================
FILE: groth16/verifier/src/Groth16Verifier128Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

import "./Groth16Verifier128LeavesIC1.sol";
import "./Groth16Verifier128LeavesIC2.sol";

contract Groth16Verifier128Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key constants for 128 leaves
    uint256 internal constant alphax_PART1 = 0x00000000000000000000000000000000153ce34e3174dd1a7baae7989a950626;
    uint256 internal constant alphax_PART2 = 0x933c51ee499e126b2ddd7d1f5abd2f12ffcd8b2e46a73d87a45b3559dcdde2f4;
    uint256 internal constant alphay_PART1 = 0x00000000000000000000000000000000160a4b2e5f81fed6ba7c401d324521b6;
    uint256 internal constant alphay_PART2 = 0x5e1d36d8d21b5872f1a863ae7f552ee902b09fb6123405189a8c388aa759ab6c;

    uint256 constant betax1_PART1 = 0x000000000000000000000000000000001198aa9397180fdb72fa98b83e26e620;
    uint256 constant betax1_PART2 = 0x6c11a2437379a7fcbd6a98565a64fa809b80b722f439e3e8607d21526ddf6432;
    uint256 constant betax2_PART1 = 0x000000000000000000000000000000000490a2769d030c5ef37b830b87942e3b;
    uint256 constant betax2_PART2 = 0x6a128ca096f0a395cb376978bd79e0630f7c942e9e734d92d7c301820da7dfdd;
    uint256 constant betay1_PART1 = 0x00000000000000000000000000000000066c43799ca11a2858f9851866479aff;
    uint256 constant betay1_PART2 = 0x5067f8cc4bd6ef1531f373aa554364c084825f063980fd12b844bc8dc8d1c960;
    uint256 constant betay2_PART1 = 0x0000000000000000000000000000000012898d39a78666b136ce8524e41d1c42;
    uint256 constant betay2_PART2 = 0x146f103b4be7ccf3b46c1ebff5038237fdffbd8fdfd15c7c50ab10e1f63bd402;

    uint256 constant gammax1_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax1_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammax2_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax2_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay1_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay2_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;

    uint256 constant deltax1_PART1 = 0x0000000000000000000000000000000000e7cf36cd7af398517c38fe5369290a;
    uint256 constant deltax1_PART2 = 0x98db2b905b6bec746f7ad06275e0b5a6da82f16e87dec8bc8ea4b7678292d037;
    uint256 constant deltax2_PART1 = 0x000000000000000000000000000000000fa234f167ec7c99d5c41569688e9059;
    uint256 constant deltax2_PART2 = 0x176b7a19cfd39942976f78a7bbe7d575344ad6a1ee8e6fe484485472c604d5c6;
    uint256 constant deltay1_PART1 = 0x00000000000000000000000000000000058fad8d35d4558bfa929f30f74cacda;
    uint256 constant deltay1_PART2 = 0x47c1b9f1790c2a66bc56d6ca2149bc54caad97fdaa3e6e83d1fe8b17a6611742;
    uint256 constant deltay2_PART1 = 0x000000000000000000000000000000000265513799ca7a0875c58b7ec8f27837;
    uint256 constant deltay2_PART2 = 0x6e91cfa4ff1ac8fcf476dfbe8d1a55c79a6b4bc72a193465936da637b91079ed;

    // References to the IC constants contracts
    Groth16Verifier128LeavesIC1 public icContract1;
    Groth16Verifier128LeavesIC2 public icContract2;

    // Memory layout for pairing check
    uint16 constant pPairing = 1408;
    uint16 constant pVk = 0; 
    uint16 constant pLastMem = 1664;

    constructor(address _icContract1, address _icContract2) {
        icContract1 = Groth16Verifier128LeavesIC1(_icContract1);
        icContract2 = Groth16Verifier128LeavesIC2(_icContract2);
    }

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB, 
        uint256[4] calldata _pC,
        uint256[259] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function getICValues1(index, ic_contract_addr) -> x0, x1, y0, y1 {
                let mIn := mload(0x40)
                
                // Prepare call data for getIC1(index)
                mstore(mIn, 0xf231279100000000000000000000000000000000000000000000000000000000) // getIC1 function selector
                mstore(add(mIn, 4), index)
                
                let success := staticcall(gas(), ic_contract_addr, mIn, 36, mIn, 128)
                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
                
                x0 := mload(mIn)
                x1 := mload(add(mIn, 32))
                y0 := mload(add(mIn, 64))
                y1 := mload(add(mIn, 96))
            }

            function getICValues2(index, ic_contract_addr) -> x0, x1, y0, y1 {
                let mIn := mload(0x40)
                
                // Prepare call data for getIC2(index)
                mstore(mIn, 0x49d837fe00000000000000000000000000000000000000000000000000000000) // getIC2 function selector
                mstore(add(mIn, 4), index)
                
                let success := staticcall(gas(), ic_contract_addr, mIn, 36, mIn, 128)
                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
                
                x0 := mload(mIn)
                x1 := mload(add(mIn, 32))
                y0 := mload(add(mIn, 64))
                y1 := mload(add(mIn, 96))
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem, ic_contract_addr1, ic_contract_addr2) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Get IC0 values and store (always from contract 1)
                let ic0_x0, ic0_x1, ic0_y0, ic0_y1 := getICValues1(0, ic_contract_addr1)
                mstore(_pVk, ic0_x0)
                mstore(add(_pVk, 32), ic0_x1)
                mstore(add(_pVk, 64), ic0_y0)
                mstore(add(_pVk, 96), ic0_y1)

                // Compute the linear combination vk_x using external IC values
                // Process first 128 signals (indices 1-128) from IC1
                for { let i := 1 } lt(i, 129) { i := add(i, 1) } {
                    let ic_x0, ic_x1, ic_y0, ic_y1 := getICValues1(i, ic_contract_addr1)
                    let pubSignalOffset := mul(sub(i, 1), 32)
                    g1_mulAccC(_pVk, ic_x0, ic_x1, ic_y0, ic_y1, calldataload(add(pubSignals, pubSignalOffset)))
                }

                // Process remaining 131 signals (indices 129-259) from IC2
                for { let i := 129 } lt(i, 260) { i := add(i, 1) } {
                    let ic_x0, ic_x1, ic_y0, ic_y1 := getICValues2(sub(i, 129), ic_contract_addr2)
                    let pubSignalOffset := mul(sub(i, 1), 32)
                    g1_mulAccC(_pVk, ic_x0, ic_x1, ic_y0, ic_y1, calldataload(add(pubSignals, pubSignalOffset)))
                }

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)
                
                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default {
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                }
                
                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 544), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 576), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 608), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 640), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 672), betay1_PART2) // y0_PART2
                mstore(add(_pPairing, 704), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 736), betay2_PART2) // y1_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax1_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax1_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax2_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax2_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay1_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay1_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay2_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay2_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1312), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1344), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1376), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1408), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1440), deltay1_PART2) // y0_PART2
                mstore(add(_pPairing, 1472), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1504), deltay2_PART2) // y1_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Check the pairing
            let ic1_addr := sload(icContract1.slot)
            let ic2_addr := sload(icContract2.slot)
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem, ic1_addr, ic2_addr)
            
            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}



================================================
FILE: groth16/verifier/src/Groth16Verifier128LeavesIC1.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

contract Groth16Verifier128LeavesIC1 {
    function getIC1(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {
        if (index == 0) return (0x00000000000000000000000000000000014525c5deb864057aa7930f8ebe640b, 0x38f123620ab00d1921384e8848d7f706439720193f2c6cc3a475832a58c569e9, 0x000000000000000000000000000000000af94700073efeedfbd511333148ff2a, 0x3bb3027e0be1fec5306ac136175484d8450f251cf2ce10ee6780bc4421753c66);
        if (index == 1) return (0x00000000000000000000000000000000083006fe886bd2fbac1345cf91f0461e, 0xfccb41aa7c1ba7c62818bba25def205bd509f55b93529ca39d618f48ea3db65f, 0x0000000000000000000000000000000003c9e6b7a21134f69c396f2942f21d6f, 0x79fb40e887986d69505a95e1baed26a1217448d1b37bc714d8f15c345676e7c8);
        if (index == 2) return (0x0000000000000000000000000000000001148696105dd279f9da57b1d1206eca, 0x295f879a355ddf9d90a6e6531eff188bb2946ffe86839ea2e49e3e164834da03, 0x0000000000000000000000000000000005de28bb05710dc0726efe459a47f36d, 0xcbea6c305c358282946b03f1a73b0b56d629b4dd825f52251c1a4d51c9ea0423);
        if (index == 3) return (0x0000000000000000000000000000000017560f497ce3422c33ad4078c9f721e1, 0xf802f54da10756e916161ddbcaabeb1da069e8a76745b6defef7026501927aa0, 0x000000000000000000000000000000000d0725aa27c1e222e9519bb6e92c929f, 0x6c2f3274abfbcf13c291588c51ea80716569c43bc49863f0a4194475785fdc79);
        if (index == 4) return (0x000000000000000000000000000000000b6698898aac2866adf7bd4fed2b555c, 0x77fc6271dd976e4431b668454d3bfaf9f47c32d4621ad7c3bb7bae05b9755ba7, 0x000000000000000000000000000000000203b931f2b509b98286d8c3ecba4cb4, 0x604aaa0e3c58c99d45236f2f3ba1386039efec63b9e29dfece5f1b6dd578ee95);
        if (index == 5) return (0x000000000000000000000000000000000e75a19c38b63578426ac85fd9ba07e2, 0x253d4a2075ea5e86145783733274dcf8abe098a7dd45a6035722c6b5f6591093, 0x000000000000000000000000000000000ae075cf48517f7ba53f46270b5c00e6, 0x9e0ff6f68b38254c92f4265fc814b9540311d271fd62a16acc2e1d676b804ceb);
        if (index == 6) return (0x000000000000000000000000000000000bfae60aa92a94a90a2e69ddd72f25f0, 0x0aca8b6ab77d46c78a4fb8dd85a51df7a4520849a9b2734e5d408518fa3ca43e, 0x000000000000000000000000000000000c182e8195e0de5a19a1d6399d215a17, 0x1d4ea0dae602bc8f0d9155d7468efcd59e804656de01d97383c0189210f64fd3);
        if (index == 7) return (0x0000000000000000000000000000000014184b5bdd5b1011d73cf5d17738cbf1, 0x675ad040528313e1beb55f930029cd50cfeabd9f4e2958cc96969ed0dd3bf309, 0x000000000000000000000000000000000b781417f17acec573ca5a831e913ca1, 0xda3c61c176feb5562176f871304088348366cecd3da02d7d0f4f83003ab05362);
        if (index == 8) return (0x000000000000000000000000000000000ed0285e786dd13864a9f57a657aee55, 0x2f8b95b0a328937fab4091972a455f677bf395890c0ef56fcaf931cb61062b99, 0x000000000000000000000000000000000e7aa8fce1b04cca162abde7fc366000, 0xcd073b17572e5df05abea0d2f4e6a1e6547852832367f8c5ee3e7ed3e6b3ac9a);
        if (index == 9) return (0x000000000000000000000000000000000f5cee7106183925f8e97d08505d6dfe, 0xa19756ce9f57691c29a8317e0b69c5c6dc0a9d907eae514cdff65786f972ae81, 0x0000000000000000000000000000000014ef79d9fa2a0fc259a15c93d8520fbf, 0x5bc8849ac448ff8f202ee32d4aa20a77f7b52ee2f169313ea9b0556354ced76a);
        if (index == 10) return (0x0000000000000000000000000000000014f392d81ee74e2431edce67648c9c47, 0xdb19457a6843d14123443d0b96443af893475a65b485f0f53dc55b34841ce79c, 0x0000000000000000000000000000000001b99b0e2f59f65ff0c355b3ea85e7e7, 0x0c17dbe42ffd060870b9780cc85307e8a4582764f36fefaeaa9a1e8deffe0cb7);
        if (index == 11) return (0x000000000000000000000000000000001266d7e77a7f70aa38e7213be9d965a2, 0x1a21491993e5b67faac1a3135f0a27af60a51d686452e0c23ec132b14ed3a51f, 0x0000000000000000000000000000000017a7dabaa57665e529c141cd06ef1a56, 0xfc90c806f04b917c1b4aac58ddc72965e9231e8cabbd9c05afc7ba36d397099c);
        if (index == 12) return (0x00000000000000000000000000000000114637a9981249595edbfdc593be8f7c, 0xe3e159177bbe5a91283b0d63389c1b41f3b3ce5454143ec81deb98621770ef8b, 0x000000000000000000000000000000000ea4ddb965a5865c0e5d04c067f7cb45, 0xbec08f288d7acc2479c38d3e11f5876e3dd307b682a6d9641157ea50ecb4c542);
        if (index == 13) return (0x0000000000000000000000000000000005552a0528c2bfbb0856819e1f294225, 0x38931f40215d2cb289e0561fdbf5683affdf73b6031201ee018a61a72da5b356, 0x00000000000000000000000000000000053975ce76046503055927cfba9897ac, 0x89505be338dfd4b3bf985442fe7df3fb48df6b4e299a58429b85c2edd633ba4e);
        if (index == 14) return (0x00000000000000000000000000000000113a0fe8753b43c7ddc2699675072c80, 0xb3e3c923d58f686692a40bf4b4b0df3f0b03d34362652f705534ed17fe763120, 0x0000000000000000000000000000000013ae033d8e2b5b83da210abe0a7c6152, 0x670affe02f30eeac15bc6ecd0d4253cbaca3bca9a067de4eb76adf4ad2a8408c);
        if (index == 15) return (0x00000000000000000000000000000000094116d9f7d8368fd35030a237c819ec, 0xb435f86942236b15de12d16e49d0401dfac4aac0d10136ad6ce203193f2a20a9, 0x00000000000000000000000000000000073b407752d6e6707bc9d8a3807a79d3, 0x3d56e93bde0c937349f52b35be872f11c5c10da099b44ffe10ee97b7e6ceb642);
        if (index == 16) return (0x00000000000000000000000000000000151ba015a8188cb1155d0f022bb849e1, 0x2daae09c5162f1baa4bead0ac3231d9e94368a3b326c48b66f675688c694c707, 0x0000000000000000000000000000000006372a87a5c1e3ed9792f745081dc958, 0xfcfbc1cfe0cdf4a3f6fd70ef80a9c2aafbd42a8dbe2c7deac0610e6eb3d47c50);
        if (index == 17) return (0x00000000000000000000000000000000132de26cac3859fb4a33b25c1b589101, 0xea2b9a7b0d8f34bbba109402a9ef50b0a54a46527d427c37c8584bb01c237e5e, 0x0000000000000000000000000000000015ca1ed6e53615725520eab762240827, 0x4d39ede5390fe9687c2ba417465f5ec70c1d848cade4b302abb9967abe004ec7);
        if (index == 18) return (0x0000000000000000000000000000000016f4e6ec563e9dacaac33cf927d18a0e, 0xc5b8ece146afa623c18ed3965b62020b3f006721d34da71b9c73422c7d2a7e88, 0x000000000000000000000000000000000dc02a402650ffe8b6177658b3443f43, 0x55ffe66646c0d9feda25d462b928055e5f3b3db6866a5e9b681337cb4e99f041);
        if (index == 19) return (0x0000000000000000000000000000000009edb2b5432e4d63d35dba3cde89b1c2, 0x29a3f9db1e87f93900ab60af808b59efb068a7086df8262c1cc3fbc3f6fd405f, 0x000000000000000000000000000000000617e984b7a33bd25c44ab1a436f8e45, 0xce20745a39fa1155a8f0aab7b18fd1abc8bdf25c21c6a225a76582ac6ff0431d);
        if (index == 20) return (0x000000000000000000000000000000000dbe4ac9a9ee69b805ccb486a60b558e, 0x6427b6f9fcbc24dc1d9595062ec2d3c1ac37dbddc398df1d5408b41c8efbec60, 0x000000000000000000000000000000000fcc3ff857849633f7dcc8a4ddb334a8, 0x8713c42405044c9ad601d1b581c2344084e0ee8d47baa2181f46d96a16bf3f83);
        if (index == 21) return (0x000000000000000000000000000000000a3569b2c992e9e9043d47e2b9dbdacc, 0xe2ddedc8443804fea460086d6185f8de28ae99bc9e9b1ee8c57fdec039e32596, 0x000000000000000000000000000000000206395b993cf53e564f85d9c6222e96, 0x6651c2b1cbcc8537901a085ac1260ac17ea87a454c52939d7c3f18cab6f9e3ab);
        if (index == 22) return (0x0000000000000000000000000000000009c4b7424436e52e558a283c4a653c27, 0x611dce53c5e48a387cb249675a02673e3baa4dd4631ff01010e530a6ff908a1e, 0x00000000000000000000000000000000062839631e87f8e069752da3bd239986, 0x0b3f50f2980015dd1128e9d0f9c2613e7c07709b01bb4376ae30dc4fb64241c8);
        if (index == 23) return (0x0000000000000000000000000000000008d85e2a24c12eb402f93b9e80c88a91, 0xfbdcf6b76c6b6d3884876a5c562362f694317d7999b45f070cbeeee9aacb5560, 0x0000000000000000000000000000000019b0192d348d5946849a64dca63b2928, 0xdf0e0c76da6ea125cbf0551dbf04b8d2df0e1b2b873afa21dcff6d3c928c0ca8);
        if (index == 24) return (0x00000000000000000000000000000000108c57617ad366304662b0a7dc210b67, 0x412f35e3004aa49c3f4c6995de2e909e9c2cb0130d923c50ea47dc48037a997d, 0x0000000000000000000000000000000019b5b3fd4347c2bf314bb5929bb0357d, 0x95360c439c8d1968483ef8b7394377d1b73f3bb0179ffba7234bfb2b2cb05a06);
        if (index == 25) return (0x000000000000000000000000000000000050052b83880b89f3e42ef6269ea270, 0x9a539cedf8b0d24b6c0b33948b7e6c3c6f6093a803302dac6f2f743489864287, 0x000000000000000000000000000000000f1bfe1fd1a394309fd868f6d88716f3, 0xd9405d01381a77a2d1bb2c6e4ce510bdc5018bf8d623476bbe5ec3c5c573e9ee);
        if (index == 26) return (0x0000000000000000000000000000000012a36d0d584b80769e8f8a8604db940b, 0xc108056ee45ec186836c8c16f7a57b56cb3538109f23c7fbd6c08d3e9edea3d2, 0x00000000000000000000000000000000077950c73c6af3a0dcf9e8bd022acc9a, 0xeecccb3fbef7f74f59edae6a3817560ee9c1519017546127db95f94cc4e62e82);
        if (index == 27) return (0x00000000000000000000000000000000080ad7cd7e6163ff9c96a20eb0c2a981, 0xe2ae055fac637ca76d799633a9bc1df466c332a9c19078bb97c425a9439d057c, 0x00000000000000000000000000000000027b57d21dda433bad61d72b24cbf8cd, 0x94a8c79c569a1d9f923704cf49d1d8ba2249e01bfb127e514f93dd6289be1bdc);
        if (index == 28) return (0x000000000000000000000000000000000b78ac49bf4656f4fb5798da27259c46, 0xf6712aaea47f90153834e8b4a5109e0e37b70ed0367f8629ef9c46a226f34d49, 0x0000000000000000000000000000000017895efe1fc6edcfa151a74cc1f0f6f9, 0x31ff817f8303cd81cad921a9115ccef2aaf304cb6e71cbd3166274255c1d6299);
        if (index == 29) return (0x000000000000000000000000000000001698946cbc7d1e7dd81df83b5f447ddf, 0xba2490692f4969d903af612fafb247e5a19ce7254c82ddba2c2b89e8d273763f, 0x0000000000000000000000000000000010ec58d312fc951f1c16a43976982bc5, 0xefaecf5a018e965e8d708b55ccc58a1d58fb027d3120c4bd67d85a37ac51aad4);
        if (index == 30) return (0x0000000000000000000000000000000012133f484b46798c5b8318973c4a9ea9, 0x1a7f7c5df67037a95154198032843af52046f28194e00a1cd41d9ebac60a18be, 0x00000000000000000000000000000000120ba685c61629a558a670534c924379, 0x28b427215186dcaf7f26e666164121e3181937b7671a8a6e9d2e66b9ce68b4a5);
        if (index == 31) return (0x0000000000000000000000000000000001af624ca34c588094a5cac32aaa94ba, 0xd57e498ea5676a7d01ee6c6917bce080980407bf2c89adfca71e7d2d4c2aa95d, 0x00000000000000000000000000000000106ca44b837224725ddf0465fa282ed9, 0xf2d170d4dceab7cee95df96630ebdd74648c5a289b8fb58dec1e23978a1d86c2);
        if (index == 32) return (0x0000000000000000000000000000000006da8986a3486d16879aaf0abbbaf6bb, 0x6db3236b05726531a9ead462c1cb442ce43e92737d7f67b0239b6831175f46de, 0x0000000000000000000000000000000004e7239da25be2916b196c47a5757d9b, 0xdcfb9580e54311cf96502db2f6a296da886d1e7757f955f7bd2b64a345a30bd4);
        if (index == 33) return (0x0000000000000000000000000000000010cb30137a6f1439f099fda3259bc531, 0xd614bea9128c996847a7fc7ca419bd8a3159b74adff77a06f541f8066656409c, 0x0000000000000000000000000000000003ea3128f08820a08a64250ebed36b74, 0x6bdc9a9fe0b6e7742e94749c2ca3d02b2baae5142cfe3e74cb52b68ebda7ebbc);
        if (index == 34) return (0x0000000000000000000000000000000003ccf9719813c3b9936ac31c69450a01, 0x20ca9a5288425707d879af65ec714d2c7beda9d43111838cfeaacec7bffa5227, 0x0000000000000000000000000000000003721ccf290a111a764eb9f158a8ff9d, 0x0d0229ed7d92a52adb1184a444d8406402a6064d9cd398270654c895ff475d42);
        if (index == 35) return (0x00000000000000000000000000000000095d5db881de798d2020290dc1218205, 0xe3fbd753fa94a55c953ef8f0220bf0191e29b2a0c9b95aa1850e721fbce883ec, 0x0000000000000000000000000000000012b26832c2ba2e56fee0bd652e685ec2, 0xc2e7d9f033860c62b28b97d489d65bf54ab312e86a2ca2f0d011556a2bd9bdf2);
        if (index == 36) return (0x000000000000000000000000000000000ec771cc2c11c813b1869cefd1dd0cee, 0x3471dab17cfe52e47f2bf14fa8068c2318e25b0bf457569bd7db0977061a3a2b, 0x000000000000000000000000000000001789f09c3c40d5f325305af5d5e28e5a, 0x6e180ce2baf60cbba76ef9db8ae88f6cec2d0fb2d960b4d66602adaf2090587c);
        if (index == 37) return (0x0000000000000000000000000000000001f012b9e20c74771f52ecc91f3cd790, 0x05f622336533f353fe7152eca29f4fecab90327f0bd8ee7e8f57a23553e9b751, 0x00000000000000000000000000000000102bcdf9134f9e3bf3deccac3a304ada, 0xe1b19cd1fdf295c4e9f363ae6000716bcd3d11e2d44322d3cb6c44375107aba2);
        if (index == 38) return (0x0000000000000000000000000000000011498b5bffc06a9baade8ba2f9aa5e81, 0x58d10685de098ad83f840e20a53b2ed79cd3a4a7dfb4a8b12d772737d0e5bc6a, 0x000000000000000000000000000000000fa6d0ac7ff0cf72c2a361ddc8b68c8f, 0xc685fb839b56480f8f0744f9c2b711df4a6f3637c9d747b86002d7b24bb5fd9a);
        if (index == 39) return (0x0000000000000000000000000000000014081779d33d38d4836d79449590084a, 0xa7d6c67ff2cfd03fe2c38594a6193e91f07268b265b4477d6c834538dee4d127, 0x000000000000000000000000000000000b8ddf17f913a2e9f91d9c96b1c02d3c, 0xfe82c90002ccf615db6a2fc54b5f784481d1f4497e522959986a6d3af585e4d4);
        if (index == 40) return (0x0000000000000000000000000000000006c866c73bc8d886b273c53a59ddd1b9, 0xf35910701af407921fd328131840faaa830a33f52d401b029b4c5b85f5ac42f4, 0x0000000000000000000000000000000001f3e2a90baa236cd0bb8e08a52721e8, 0xb39ab5812318f34c3c1645503699996ff9962363b7b356f00200c0ee5ee82970);
        if (index == 41) return (0x000000000000000000000000000000000c863ce98b28a353a205126d411640f0, 0x65bac4a80aef2c8343d3df81b56cba82fa7355d911c9be07bd9be91f5620db73, 0x0000000000000000000000000000000006b95f910cba3fda8977f3afcd701446, 0x5748b40507113358fa7a6ddea910067c6fdfacd14111a1545b3d330119110d4c);
        if (index == 42) return (0x00000000000000000000000000000000180b47402a2be26b6488a844f21873a6, 0x467bff785cf146b7289dc66954e2056b6e4aff22d539df608aac66f9f57678c6, 0x000000000000000000000000000000000f477de570bca546efbb29355a14871c, 0x937004bd322c69285e0a668a2818d6c6e2cf2b02da4b979d63852cc90de6b24e);
        if (index == 43) return (0x00000000000000000000000000000000079548229c0a9c56bfdc3e693e76c33f, 0x58a0c7234b2f14085e65ee53b8014d9572f6a0c4660c4828e41ba4d7145bac95, 0x000000000000000000000000000000000f6c1fe00bc516bcfce440e45829b1a8, 0x6233725be3da8cd30bd388d96ad660212a58b2f34488af5c00038ff5cb42f883);
        if (index == 44) return (0x0000000000000000000000000000000004545246755883d8445822f1ccf55927, 0x211fb8dc139291adecad95e8d458c1de6834008ef10719bccd72821c45d81b49, 0x00000000000000000000000000000000020100608d2188e9892ddc7a4d30de8f, 0xbf79151a8dc1449d6eeba63fb934f33b4b643826ecaa2df07e715a571210fa0b);
        if (index == 45) return (0x000000000000000000000000000000000bf6d7f3893a10395aebd1e648cdb262, 0x6a9a1191addc045ca4fe788c08fb59ccc69fe4b1a042861891661d92757c53ff, 0x0000000000000000000000000000000007e531666c2e7e7d99a044d8ccbdc53f, 0xc762dc70465c5ac698a31e83b25fb59cb839e0549a78e7f276ba12fc050e2959);
        if (index == 46) return (0x00000000000000000000000000000000197fc0ac0aa3d9fbd71eafca01d6e610, 0xcab7b42db0bb28b1fdb7fc3c1a2b933ee99aad98dea7d00d5650c0305c6f8974, 0x00000000000000000000000000000000032b63a2259bc017fe748f179686e6cb, 0x33681110722a9ac21d3dc6b344384ee5be3d989eca732361c1628f307b4cf6c9);
        if (index == 47) return (0x000000000000000000000000000000000464a72babc51bad96c384a1db193293, 0xc3dae4e07389af4bf0ed0a6cd093593cef83af6cb39d4aa84df29428e1a27761, 0x000000000000000000000000000000000b023720923436b459fb9f77548a538a, 0x5a1b10c735243b42c6c4fd7926130650b802cc8dd6b221aabaec099d74e4cd68);
        if (index == 48) return (0x000000000000000000000000000000000476893abee39fa48b9b8125bda95bc8, 0x348d31b2546c51ac1c2009d7eda8970b684c0bedf36a5cae2cbee58db3549388, 0x0000000000000000000000000000000000f6505b20c00923f3830e63a36f5869, 0xac3e24565303a31ac0b3f93bb8a9bbd9bcd361300ad907bede6ff037c6f31358);
        if (index == 49) return (0x0000000000000000000000000000000008bc92080b37e7e57b17eb8d5ebe3466, 0x86f3cd2f0b0d66aef0aa9878bee11e8c3b0c6b648a1d5b7f133497ab6ca2192b, 0x000000000000000000000000000000000744c6dd50968e2c0976cd29442fc1ab, 0x0f4c09aa8868ded705237740f11566012dae9e8c15edc9033ddf6a8dbbc18bff);
        if (index == 50) return (0x000000000000000000000000000000000bc44054b22fef48f95f47363a5f4ae9, 0xc5be1c08ecb1fc59e193879bcd8dc681ac6dad1552cf2670cdc4d952a3f7315e, 0x00000000000000000000000000000000096e2a3b87bcf6fb08a4cb028896d2b3, 0x63a3f394a0114fcae2487290438972ea69efbaa784847c1cdf32128757b17e57);
        if (index == 51) return (0x00000000000000000000000000000000159a0d2181010feaf877d114cf6235c3, 0xcc4b6da1cb5a7d4ff9972a772292d21e80aafd776ee0daf3dbef23fc178746e6, 0x000000000000000000000000000000001064ed26bf3dd7181a01e15c66a60970, 0xe30ac54c3b9e3444953391cf5b4ca0072c4c0e1016a71b7a170f535e6e9ec2d9);
        if (index == 52) return (0x00000000000000000000000000000000100da6f93cd22203c5a4b8fe0dcc7749, 0x07579eb47469158f266fff5c99b5978d5e580b1b1c005859d867680b67a1a8f5, 0x0000000000000000000000000000000015adea7fcc4051b1785ea9dd3c07d368, 0xc98240c8218ec2a9ee9a8cdc35fb3b1f66307c5bf2c79f6aa831da7103714e9b);
        if (index == 53) return (0x00000000000000000000000000000000132ccbba844d05420d4c6d6d8cc18d06, 0x8c40a578c6a255a17f1f3e2a7509bfdab9b130c9200e0d4c8efac4e3ae5dab3a, 0x000000000000000000000000000000000017c8f0ae31855915334d165ad3d36f, 0x39e6fd08237c5ed34e064b599d5714e31aec909cf26e6f9f057cba6d9c594c5d);
        if (index == 54) return (0x00000000000000000000000000000000113bb70957c81a487909d7076e84fb0e, 0x2f0318f7a2f3bc7dc8e67b2032d9f6f1cd9513ddd6d2283b6e3e9cb01d75f416, 0x000000000000000000000000000000000fdacb584eb800b35a82a73381f7c1cd, 0x3e1bbfeb47579ad3395df7588ca28e31e9a08543982b417e8c73496b39225854);
        if (index == 55) return (0x000000000000000000000000000000000bcffaedd76ed3405bd48db333914e0c, 0xdba63796ea0e6ab579669e5ad8aec7e67c13ecc6b5e01361f7bab9f14af4b65e, 0x0000000000000000000000000000000005fd357226d3b8faf0da41bf09163a2f, 0x06450fc8e2de6c8e504a257cd1b579332c4b3f1e5d8b854d493f137365ab3008);
        if (index == 56) return (0x0000000000000000000000000000000014cdc47541daf5a22f1a7f3fe94014db, 0x54356a03ed872c8648783dc404ddbabc323e33b858a395f85475bd03394db878, 0x000000000000000000000000000000000873d02ca4b11d05e003b860621e4047, 0x1a2016bed4a6d8a01513dc57685bade352612720898f3b6e16e28d3e2ddcbb08);
        if (index == 57) return (0x0000000000000000000000000000000014d64109ed20ce65601ad171a9cdccd2, 0x44d6ebd2f5423b4bd38b318132e07da80f8396b8ea53c832e00118fce69c5d6a, 0x000000000000000000000000000000000572312078218c80022cac86b5442340, 0x0f03d0f882d6bdb3baab425b89134502839ce2c99d2c60b5c2bac91597d6a931);
        if (index == 58) return (0x0000000000000000000000000000000011fcada509dd0a081a6c0933e48be712, 0x98e32fd354e837d7afb0a72e151e06f2995d2c7ef396b688219da25b966e139a, 0x0000000000000000000000000000000011809c52e6322979ab4a70d2a1d27eb1, 0xc2438db1682fd6f1c8c6e0854c57f0181fe6b537a97ec34122d958bb2bbcba4c);
        if (index == 59) return (0x0000000000000000000000000000000013b880fa17a423e01c0c046da795ad17, 0x9055d6db34df972669f132c89c38e7dc6572ae7aba5217d623e07f0a890f27cb, 0x00000000000000000000000000000000073a5143a46d8d5b3deb5fd66acf9a04, 0xee28849476a82c51f325d575704cf56be0325d1701caa94283bb1fa92bb4ad56);
        if (index == 60) return (0x0000000000000000000000000000000019b860b32cff359f3bf285b9feedb4a8, 0xda842c56827dd3bf9a2fa0e8352e048f2cb3f7dca48351752397d7dacdb747eb, 0x00000000000000000000000000000000126da9b24a9ade8ca1c8b63def12dc52, 0xa0201f70e651a887707f7f3a17590b47fd240df94d1fd3f3500974a8d2aa2b51);
        if (index == 61) return (0x000000000000000000000000000000001901aa2fc24add66ef218c35958402da, 0x14f8463a969184f927976aead17fa416c4fd7d61c45bce629f5498cc3c585de0, 0x0000000000000000000000000000000012f75f0c9e1f3e0991f64e59184d34e9, 0x295361b7706a49dbf19a9a6a9f84be11c4975513e9fe0fe72b961f6453765355);
        if (index == 62) return (0x00000000000000000000000000000000063a0bcf865ded678ce5f51f20e48f42, 0x66267e5875cf3687a61498e59b70ada7abc979c5f00fdd834847b2bf4f5d8142, 0x000000000000000000000000000000000bf94d555f75d894d8398066201a0489, 0xf6fdd74802044b3a5264434479b91f57b040d4c41da9de10743842248aecb849);
        if (index == 63) return (0x0000000000000000000000000000000013ed10bf2401b2015500355c81454c05, 0xecd8e13edc6db332ee584c9dd64afdf08230eabc8c84df56359675321f23499d, 0x000000000000000000000000000000000955a6f1ee1727b79fbf05b589ea2d6f, 0xe2d8199f35ee3f590c889b2844bd6ab1c9e7a1dd7da1f4d76d8f046d32f403a7);
        if (index == 64) return (0x00000000000000000000000000000000144a3c32c7b40871a76d02d2cac99326, 0x349fe841e87d97789db9fdd4c1ad62c083cef586eadcd6cd2d1037347bdd8671, 0x000000000000000000000000000000001840f98afdd9fa73c9f164d6db80e480, 0x6f73cfb211a8db0ed69540fe14522526237afce8601a3b881c8898910481040b);
        if (index == 65) return (0x000000000000000000000000000000000a10e32db02db82321ed6036340a5fa4, 0x314e96bb78bcc362aa853acd7ddddf29c9f5fbfa0189f99e4feb3fe2545d628c, 0x0000000000000000000000000000000004354e96dbbab6ac2102ce7732f9a731, 0x755f1daba2068fc7cd0296962f729b6e6795dba4099f18d2ec2474058ea41d62);
        if (index == 66) return (0x000000000000000000000000000000000df65cc456c14fd27320324427fe26d1, 0xfceb8c4cd16755d4c112979552bb6db9bdda62b3f42c6a59db59b385e0622da4, 0x000000000000000000000000000000000fc4b168d45a9d09ee4531a0113f08b1, 0x44085862aab51d74e539ddad2fbf3bf952e0cdd502fa933791dd43e4f4c34782);
        if (index == 67) return (0x000000000000000000000000000000000fec65b2020c58ec22255d76af16b8d5, 0xa0be24a7cdb836b1d5c9cf55b7ad166b4cb464444e53e58d1c868313cb94e9b6, 0x0000000000000000000000000000000015b1b7a58986546976192433dfe24441, 0x1381d4951afc4de52f252ddaf030073c35c28a3b42964ce40f31046c4be2ca29);
        if (index == 68) return (0x0000000000000000000000000000000016f1ecc908baeae6be3d6adf0eaa983a, 0xfdb2a560c9a53f6e1b134d24858d7adaa7f61fca70e28a4a360991cb471d4d71, 0x00000000000000000000000000000000093c7eecd0b6b6bf6bae4f70b14b5220, 0xbe5f30bf6a899b7ee0779435c4aee5185ef158e8d40cc9b9efb07c7f3cd025d1);
        if (index == 69) return (0x000000000000000000000000000000000554c0b53494c1317b4eca9f2e2e622d, 0x551e23b00b5baf857d7fd177115edf0c10be21499c06e090217bf9ecf2240894, 0x0000000000000000000000000000000015cfe49d0811ff4b174fec47635eaea0, 0x268fe756350c1cfcae018436c39efd8d1499fa71cf57e0cdec0f5007cd208139);
        if (index == 70) return (0x000000000000000000000000000000000ebbce643e062a6500c35d3daab2b494, 0x4424ff98b208dd52886fcd87a0123e287016ad39dc0171c4477f113af35a338e, 0x00000000000000000000000000000000012eff6a5997c69d40ecb3918bef8275, 0xae5055e982ab4385e649cb4b9af43722209df2a7ef8b1a40130e011e0dbf5b8d);
        if (index == 71) return (0x000000000000000000000000000000000022f5679828d37a0ac11a3d6cd036d0, 0x9c65982be81ccfbbaa8d164607adddf996501147c4e2f8a8ae5b4a5743dc468d, 0x0000000000000000000000000000000016ce6fdc6955d1dd993eaa732775e57b, 0x62d5a21ea31bb0a83dde30e91a1b743ada6f54a7d88c76cb50fd0c0aee49cb76);
        if (index == 72) return (0x0000000000000000000000000000000003632e5a13b7866f41e46de7f7978011, 0x78c2eb3a879abd2aabe8ad8a508c3968c6d1a4febebb482a359f29711b587adf, 0x0000000000000000000000000000000005a7079551a031d381a6ab0ef6f46565, 0x3ba704482ab78af3f47150451b1a927796948c752f680167fb92b0c9e2f2b0b6);
        if (index == 73) return (0x0000000000000000000000000000000000a78feaa56f24691e808e7e4fea695e, 0xcd3aa5c20f5ef650f095eec70a15d871e46cdfcbf27c1a1cab97c4fcb7605a7c, 0x000000000000000000000000000000000f6f1caad6d939fdc2dc5860ca5d250b, 0xcf5fcf707d6183f6a780b53179917bae6bfecf76eea41d01d65bdd9e998ccebb);
        if (index == 74) return (0x0000000000000000000000000000000010c343025edc963a81e46b80c0e4f89a, 0xa3e51b961f949b1a2f9aea6c233d2a7bb1c2cd4338275e335a817bab18409f6a, 0x000000000000000000000000000000000a6545b78fbe21131cc15c495d0e851d, 0xa2b76c4dc38fd543ca912f078032f56559f358b66d8391091807b1badde33ce8);
        if (index == 75) return (0x000000000000000000000000000000001267c135ba601965013af90f114d25fa, 0xd1d2fd6940ca47bd7c18e872c075b9f1c29c136e9ef5d87a66d2717faf21dc1b, 0x0000000000000000000000000000000005049a62fe038f7fb6a8de3521ce2a9f, 0x66f869e3b61989bfc3d432c1c86e1a31fdde1dce9fb80594970ea28d08f9e6ad);
        if (index == 76) return (0x0000000000000000000000000000000018d4325c84e1aef94819af14515e8329, 0xcbb1398460d12fe2a94208b186e8b31e04d6d76b491ed11991ba0050d5861ab5, 0x0000000000000000000000000000000005409a82970641d8a9f569c93a84604a, 0x359e556d8955eff13298226c73dfc68e43241c6903fcca49a5fb13c4ab0469fd);
        if (index == 77) return (0x00000000000000000000000000000000131e010b420eec74b88e7e0008f15c6b, 0x17d5a7c7991af496759bd23bdd1bd17202adba99b79614e3d58e59ce6bcb72e9, 0x000000000000000000000000000000000d41aba30d0045ecfaeb79654976e7aa, 0x7c9659863400d951145f6868193daa8837af7437bf64ae8d0567d7a5bbfffb0d);
        if (index == 78) return (0x0000000000000000000000000000000016421c0b3c6d708752358925e5bbb784, 0x6fa8138179ade6f0aaaf746b778576d55bc79b08f71cab0da6f1f5154a997af9, 0x000000000000000000000000000000000f9de942d1137529c8cad676341afbce, 0x636dd25dc5d8d61c9e6f5666cd3bc8755dae867a8c70106b9f050d4bd2504c3f);
        if (index == 79) return (0x000000000000000000000000000000001104b2989fc470c80fbf160e3bec079e, 0xdf3ec28c398e17d3467d94035210f1bf03f24625822d90bd05211dc68dd9864c, 0x0000000000000000000000000000000001d4ba8750d70cfb0fc545e8bc5a19da, 0xf455b58e6632a3742264b9865cbf4f5106bf61d431df96d24f6982a91a265f87);
        if (index == 80) return (0x000000000000000000000000000000000f8f51d02230c5e8fb3e5524304a11a4, 0xe820d07bf15aba902876012af0d726d1aae9dacbfd11def35e0d00ef150226d0, 0x0000000000000000000000000000000013c2c027051996f538fa9e235767c2fd, 0xe391988adc9c538ae49b90ec5e4905ac4721eda24cdb1f086a050f08ca9b8a6d);
        if (index == 81) return (0x00000000000000000000000000000000102897f76c98dad4b786564550cc7216, 0xb71b825b671013a5a458f8fb1b70f2c1f25be90f7127c7385ecacc60ea6912a4, 0x00000000000000000000000000000000002890cb3e7378d5c2f53ab7e2cf4571, 0x913419303c11fb2102e5e69ffe7f59c6ddad41e1291466c59cab09331e496c87);
        if (index == 82) return (0x00000000000000000000000000000000076dae24613d14adf4198bbf253b1aed, 0xd5b1702d7c7bafee6034c9abd4379e363366a96b8f5528f31c6d2dd37d45577a, 0x000000000000000000000000000000000b9abb3c559c73d9e9e8048752884572, 0xa3d16922ea337c1975074f439c02fa8486c71f3d76da92fb2625c75b79d0a009);
        if (index == 83) return (0x000000000000000000000000000000000a13ff3d7c446be17134286a14f53ba8, 0x689714de79673574c83c285f9890e7b96acccb3665d5b4706a4decfa1d5e5d86, 0x00000000000000000000000000000000098af71c44f5089f5a7d01b15c625f65, 0xb3fe5e342e82358c971363ca2fb9350c32b1604222ea3925f1f6b43ffd3c8225);
        if (index == 84) return (0x000000000000000000000000000000001837e0e218ec6e014fc0c6cde08ac453, 0x2524efb7218097d48c2e1c04e5c8b3be8c53f786c6e772c0d32debfbd3fadc04, 0x00000000000000000000000000000000083fae8180b0ef63972df4e55e7c6a51, 0x0a3a23c82260ff258c6e94d8e859339f9b29c02c0a395eb76dc30aeabd0879e1);
        if (index == 85) return (0x0000000000000000000000000000000007c21e480b6f7a7ff76728b224490548, 0x0333d027e43b07da77eadf0febd2c3de19ac5bb074faaaf5ca4627be673ce296, 0x0000000000000000000000000000000005efcb70c4456d6ca1e6c432f8745c66, 0x881132ba9ab78fbe115f4d1ed25a1e8cb1c7f5a05d82d43b0cfced322714ae9f);
        if (index == 86) return (0x0000000000000000000000000000000002c0b13df9f71cda3607182d95eff956, 0xc0ab161a133603a175718ed03b251772bd76d7df27bb9356c4414510726ff0c7, 0x00000000000000000000000000000000103df3d5d4c139b9cf62160fde22a06a, 0x3f944ca101194f15e8c190429d858196ec8cd354fd07f04d7c609dcd6fccc6a5);
        if (index == 87) return (0x000000000000000000000000000000000f7368ed512bca1f42bf14cd78b83c3b, 0x319bd0104f00d07c3b321d5cbf0c981f1995cd57539a688eb35bb210e182a055, 0x0000000000000000000000000000000001a08a9e0275b82eade7b4f9ec142a2a, 0x141591a50c97af3c4427f42a527be8a9549379f657d40449de119b5908adc51d);
        if (index == 88) return (0x0000000000000000000000000000000012ec5ad135e67ecb994f5156115b38cb, 0x9951d2f13fc52500221911ff8c9303e168b26982d10e133fb8995398a604ccb3, 0x00000000000000000000000000000000134dbfde017ced62b4a54c2ba6f55c84, 0xf2a342c008aa2035473a0a16a7b16476d4d7b1ff3869ea370487b223cf5208ef);
        if (index == 89) return (0x000000000000000000000000000000000ae07ab5bb31556a809a8e2974b44993, 0x4cb6f8344aa1bf5a8048738c7525f2f3f4a7f9e191852c934e6fa364c75250d4, 0x00000000000000000000000000000000031d8985ea25ca9dfd9df54b4f6212f8, 0xa5e97df30e68d920e1b18c303da7ffee69edd9cfe731fe181cb1c02ca8f87c3b);
        if (index == 90) return (0x0000000000000000000000000000000010dc48341d8e5a157d4d334fae051221, 0x06847ed8d00f8985be41319e8c6c68a13071c57f01824934bb0227a16a281b3b, 0x00000000000000000000000000000000059c77ca1e94d9804bd8a6d9c76cd1e6, 0x41c65c6f9e9629e79f75d4867e6204ea49c789cc13b35f7408f2abf2cb2963f2);
        if (index == 91) return (0x0000000000000000000000000000000013f65c1df6afdad996badaf63739c71d, 0x1c13ece1cdfdd6b1be0deb582285cd8ea7e957d5528dac2a6112b636c35f7621, 0x000000000000000000000000000000000b9aab7a062613033aa356772c088974, 0x266b0ca7cfee8681e842dc376d73e4843c38d4353336bb93dc171dc4f2b6bdf1);
        if (index == 92) return (0x000000000000000000000000000000000f6460fb43eaab6b4f0f42b7fc11ff66, 0xb83e6e987c833281d9d39e564655102a4705c6a3bba5e012c12ec0ab9853a3bd, 0x000000000000000000000000000000000f6747cb3cb6281267176db11e87a56f, 0x6917a0b81ce51e38cd287baefbad221a685811cafdebffb97a80e5b94ee9db1f);
        if (index == 93) return (0x000000000000000000000000000000000311204f1d751d69ecfb1a85409be211, 0x807c581ca482f084a0e116a0e2fbedd14594474fb334b8cc8afbb0937fc72f9c, 0x000000000000000000000000000000001363e4e5923066f5465e73a3ab41a039, 0x2844058ab6e23dcda2b55ca028ae532a832ffedeb33a1eea81b0504efc6be63c);
        if (index == 94) return (0x000000000000000000000000000000000d9eac19b40dffec1e557cf0dc278553, 0x9d24a8f298a1284497b56efbf73432ac33f175f9c7b161ce3f8846c146691ff8, 0x0000000000000000000000000000000012e122ff1b5150da8515a6ec50980a3b, 0x4be6ec4caa0d9c290f0301f700c356b3b877ab1a034babaf7cc6113726f6f880);
        if (index == 95) return (0x00000000000000000000000000000000004e922d0b59a818c5ae008e0091ac61, 0x0fd198beaf2893968b55003fe77382405b4f490716241e7411ca84e0b5e4dfcf, 0x00000000000000000000000000000000146e784bf4982f7c680c989fccd00028, 0x2a40aac55b13293ff4283150c9f7b9f6ccb09e3ed51c0408e9d18852deeccd4e);
        if (index == 96) return (0x0000000000000000000000000000000011e2853f3f2dd88312e54154c3e4c4e1, 0xf3be6846bb3150e9ff49e84a9487f2bc04a033b274ed0e032b3594714a1c8cf4, 0x000000000000000000000000000000001912eaae2e671afa59e95bc3cfdd3038, 0xe89857ff20851756ccccc2dc8f977d725c4fa27b092aa1e4efb02f6be4a955fa);
        if (index == 97) return (0x00000000000000000000000000000000139aa4a896645efeccd762d26010df53, 0x0d1e3ec03142ab3293e0df36d8a910aa47b70121bda07865b00bfb75e35361ee, 0x0000000000000000000000000000000012685c611748cdabfadc1b6808cd449e, 0xf1c9f944d9df7614a8c9cad9000bd0d17d41293d6d934b6d44528b9a219ce7be);
        if (index == 98) return (0x00000000000000000000000000000000135ce6b855fead6964ff9f3de4db84b5, 0x6949d5857763c2bd36d396492f6195c4c4daed80956ba4dab1854776b9ffefb4, 0x00000000000000000000000000000000164f86d99daf226dac34a319bd7a1d1b, 0x860417f9c5c317995a49f13bcf9ccae84d049c54becdc4c2dd48a4f5a548bd9f);
        if (index == 99) return (0x000000000000000000000000000000000b02d592d2f1a3d2ccec1bf4e6953823, 0xc19b592ffb955c7e8bcc50fadbb54f48aef42946b2f5487c644754477487a8b0, 0x0000000000000000000000000000000002217cd7d3b6890602f0f5adf7dc85ed, 0x8f03ee0f406473d84276f11f701d700781db5072c8fb089be9c7dc22cbc0e484);
        if (index == 100) return (0x00000000000000000000000000000000083f96aaa8ae5490f0a5ae2078e8be7c, 0x50865ae11988650d99580c8f7117f697df147837a737879f67b2250b385c2953, 0x000000000000000000000000000000000af8a7d94e6c817337e2abc233a2d7e3, 0xe7d01af35d8e12172f499ef988594572624a9c0258d2b7e5a9195b38016673e0);
        if (index == 101) return (0x000000000000000000000000000000000d1d88ffccdd0e0f4a8440f9cfd3c3d1, 0x33bb84287a48db972d620a833aaba76440b3f567f3ac33638f6b66ca2f87849b, 0x0000000000000000000000000000000003209e4268c7391f51be0543e7192e9c, 0x8119042cbde79dbc3caaca3e69d8a74fcf50211d02edd069f0c37b4065a08a15);
        if (index == 102) return (0x000000000000000000000000000000001959f7730daa4d7e3bf5e7ce6caee02a, 0xe5be93c46762572d4b987820f472dfe1f85e492a436a23b8eeac40f40eab654b, 0x000000000000000000000000000000000baea60d100c68e2cc70e56e4d48320a, 0x5eb2a0751e829998d52253344cf6203146954bd1c83234c5b388fb51abc87e98);
        if (index == 103) return (0x000000000000000000000000000000001709929d211158a47b7c526ef57938d4, 0x6d522498ebddb51a44794ff7b46c50ad0aa63e14a1fbdfc36dd0b2521ad5fda3, 0x00000000000000000000000000000000194e4662feec2a28de7014951481235f, 0xf443ef92089d704fdd471b448ac8e1bc96684d831d7e60ac1f2d6cc9979ec817);
        if (index == 104) return (0x00000000000000000000000000000000179d7dc660fef7d40f26ff0fa8c411ae, 0xe9093e48bc9956f39ef4731300ce66c9d8166787b914bb51c766e3674aba8048, 0x0000000000000000000000000000000008c234484d89c027cff70c91dbe32b02, 0x301d3f1f0280fd2041f944d7954be59c8a624adca7f455cd0dbe935b644f81cd);
        if (index == 105) return (0x000000000000000000000000000000000a4534146aea3aa6de8f662801d9f327, 0x5af3415f571b855ed0ce2911705aa3696b9d6c91e29e9b33ad1787dae42bd481, 0x0000000000000000000000000000000005784bc0ae355fd17137e04e46155ccf, 0x33e15331dc5997e7cb86ce741ba890f1f26a7c164352bf5cbaa8bcab6200eaa2);
        if (index == 106) return (0x000000000000000000000000000000000bc24973cb1c5bd7bcd80b899801a0f7, 0xc7bbcea4cdac672fa6465c58769087a1ee86b8a704756059c630835450e7c6dd, 0x000000000000000000000000000000001637028e90ad3e0570e1d4cd2863af16, 0x9f83245be7d8580b38bfadfda067853bdc4cacd60ea9ffba6942a332aa88cd30);
        if (index == 107) return (0x0000000000000000000000000000000001153a9eafa6c0f08b006f2e006c90d2, 0xa226b36a6970bf9a9700cb84f00b2b006a2f2af312cd085dd444c20d4918667f, 0x00000000000000000000000000000000076e5177bae08adc979ecb62663e8ed9, 0x2820655f6c19f6a7e499506223bc3b5927ac01a3cb5753882cf4c04696fdd9f3);
        if (index == 108) return (0x000000000000000000000000000000000fdb756b4e25201c4a93440fe64785d0, 0x87a17eaed45a1f689d864ea11707ad2c85383fdc31b756d7f81dfd6e2d8b511e, 0x0000000000000000000000000000000006e6a22224d9d8134f66ed6e2b4d3265, 0xc28c52ceb965ef033340ea28f3826cdcd3c4fd8e89c32ab16ffa1e70f80df016);
        if (index == 109) return (0x0000000000000000000000000000000002799e90e17a54b6d200024feac7be32, 0xcef80e98809bc62296db53145528c02aac067f54a05460941deee39f4a09a79e, 0x000000000000000000000000000000000661b72b60ab76a889cb53e2de9b2035, 0xdc5c846ddd17930c8735cb59d210e2594eb04487defc4f1f263cdaa8710a4d8e);
        if (index == 110) return (0x00000000000000000000000000000000078bedd4e3280c7f3aa93236729fae53, 0x5624d266414383e402017f5e1319b4df287a7edec6138a582afb4ddf45ad910d, 0x000000000000000000000000000000000402e67a154ae6d165077664681c0a3a, 0x105221be304211d63ccae82ee165f340d879eb6da610c5d609c4a4e8caad11f8);
        if (index == 111) return (0x000000000000000000000000000000000945c5338173d326b500facea4d831ee, 0x60c3e420aec0cbe7e050bc471d1eae9ce2655b245c9394cb14511b09e65763ff, 0x000000000000000000000000000000001839cdb0970f90d2ea9333425117a530, 0x466af388827357476b9fac2167a43412d3048adf5a3c020a64207f8268ab591d);
        if (index == 112) return (0x0000000000000000000000000000000015a4758da619a6fe1de242c9ca2f37bc, 0xcfbcbe4aef8b4b42ba576b7c14d51132206a1bf91510f68961d9732c5f648efc, 0x000000000000000000000000000000000e5006c8e215edb52d58e37c5afdf596, 0xf9c5ed30b91a4a771cef5d0c33220030e8250aad03666703c671358980df6741);
        if (index == 113) return (0x000000000000000000000000000000000475e13dfb990378278cf18a20483629, 0x767bed605eaf6c8bee6bd4e9013e6a561fd3649e97d7661de257360ba472a0f2, 0x000000000000000000000000000000000f609ba897dfe96d9c124eecb967b40e, 0x0ec864ee14e77b0cb38a6e62969ee63a28ca3c7ee44fe2d6f175e659bccf0222);
        if (index == 114) return (0x0000000000000000000000000000000011a21541ac18febc2ab3f696299b6453, 0x65d7a49c703e1a9198ae82fd355c007b122f8879b4c27f706c0653e8034a73f5, 0x0000000000000000000000000000000009dafcfc1847c82061be640a366a0b17, 0x778e9e2f3ee894a527c1c0e399ca76f27b5de95a6a4e0653da83aeb8a4b49e37);
        if (index == 115) return (0x0000000000000000000000000000000006cd47bd485a8d1770fb92e82247798e, 0xf37350fb74a3be34fbc76979519d88d349ec2d9dd93e8a75d26bca6daccd2a22, 0x00000000000000000000000000000000139e47090170a9815be265cda8fd535c, 0x005aa351a17a73f7dc4d183652bc9beedbd9a75749d199dd471d6ecb228ab9af);
        if (index == 116) return (0x000000000000000000000000000000000a0a6381999ffd9cbd895738bf902677, 0xdf5821e591c3eaea212b5cd0959b4dd841534aae4cbb5f2689ce75bbe6acd631, 0x0000000000000000000000000000000019d7e8b2c22ec9e1140eaca0dabc34c2, 0xf4d7703cbedaf285cb5d9b8eb051c17eb1fc72fdca839c338523e0537a0b5a89);
        if (index == 117) return (0x00000000000000000000000000000000031e7dbded7c9d5e66bd8c8221742b0d, 0xb6b193ebe784fee2ea7ff76a5c510dbd885eced4106fe1872972bd8032bccdc8, 0x000000000000000000000000000000000b4d193b382d87cc4d376d08cef93f79, 0xb8c7bca6307ce2ad97e8df4d8d4f242589f8fc6b2e2f27599e5126ece7129b82);
        if (index == 118) return (0x0000000000000000000000000000000019759da9990078ca41d1ccc3abda82ed, 0x5349b38c57ac703e1de4229df5b47ad5456ee33a492414c56973cd04102df5c5, 0x0000000000000000000000000000000000068a4cbe516f8d933c91f6a6bd65f5, 0x278c74c2968669e6165be2af55a4ea28f24823d3bfc456177580a35bf34c8823);
        if (index == 119) return (0x000000000000000000000000000000001253e781345187584f490bc3b24f5b77, 0x36bb51fa36a6a1a039ae07e6e5e9368932950ab1360b9ca8d947352f06ee4087, 0x000000000000000000000000000000000e6e6851677d22b6d8234939a7afa4fc, 0x5a9dc1633eb92088cbb0785c85c656193d67f09aed1dd4ff434e9cfba3a480c6);
        if (index == 120) return (0x000000000000000000000000000000000ceae226fcf48fb86cf4364f11657339, 0xc786c3e9b17aa234fec4f1f2194262d3c50a27ea3b231cd80fbb55d82e83d082, 0x000000000000000000000000000000000f984dc6ea6e439fb02009c754d55f8d, 0xe4c8c9b642ca6f7c1ed0fcefade25870859708816c879886260cdcf0d7347c9b);
        if (index == 121) return (0x0000000000000000000000000000000007108d76396de126e2e970ba84ce83ea, 0x2b3ba1c0b72df21c8997d166c42b41e19ec541824b62014182f07303dba3323b, 0x0000000000000000000000000000000001c6b7cc0760af6365079067542692cb, 0xd3e53c1002e3c1f985ea1957d548273a8a843368fe16e222ca389133d6e9b7a9);
        if (index == 122) return (0x000000000000000000000000000000000a29c661953b4b855b65aeb5f2d332f9, 0xcd270c2af89a6c733e187325948ccf9ed29bfb5417b0d8216ec5d5e0314fe6df, 0x0000000000000000000000000000000019d932d52be2c2f62690790475ca272b, 0x0bc42d0a1ea20ca1481c82c88393904aad9b57bbb5509e3d46763d4418e28a5f);
        if (index == 123) return (0x000000000000000000000000000000001909054a23446c21235f7808c4d13db3, 0x983e49891aa4163267892371ee8a9edf047f89d8a9d39a46fb26a3adf0343bd0, 0x000000000000000000000000000000001590da87361555a2d37753cb37ebf5a6, 0xcc4f7a9719ea9ce3563bc79a2a3b856061ab01d2c0d3c6b023c732ce7a6fb05a);
        if (index == 124) return (0x00000000000000000000000000000000126c01cc712cc18fce3d4d508edf7a54, 0x22596c1cd1365705595929cdadc253a4cabbc66c597b783e80a7dd9c26f374b7, 0x0000000000000000000000000000000010d59582e16ec99a1fd00a8c5576c6df, 0x29fe68a5e00307fbf38d6a4d27638786188f0a8117553453a089a717a8e6d3fc);
        if (index == 125) return (0x000000000000000000000000000000000e29b0db0c1fa59b8ebf2be5b5a5b759, 0xe7e99b88d0571928513b99537cc7f97bcfdd89bddcdd6def20d272de99f8a7b9, 0x0000000000000000000000000000000007debca5a20f6ec1da8beb46d3d407e5, 0xe1ea79820574d6de4b00667abb50b969f9780435fabaddb4ef8107d77df9f095);
        if (index == 126) return (0x0000000000000000000000000000000015d150cfa4a2eb6e4b31fdabe9f0a22f, 0x88c3f90b7935ea595c34fdc6960cab0c5d471cbb4507835fff3ed3e3f53e67a5, 0x0000000000000000000000000000000005caf90228fad782d3901edb77b3d0bf, 0x3a9789cccc3a42e124b06d6fe25c0f095c3f250764be1c4a1127f1d61fa2c4a1);
        if (index == 127) return (0x0000000000000000000000000000000003c0b2c9919771957775f2133acbd01b, 0x450e4efbd5299e75eb3bd191eeae61a2ef0d064ce18863809c2834d2aa5dd2cc, 0x000000000000000000000000000000000428c8ab9900b01f5ca8493e2f27baf1, 0x1d155a967326cd449010707fda682cbf5f6470fc04f5177d3192265907e72d6f);
        if (index == 128) return (0x0000000000000000000000000000000019925812e9cb32711a1902f628500477, 0xdf47ac77da7b0a0622f0be9288efaf6ecf7d8679d45afedfdd1b20cd5949a95e, 0x000000000000000000000000000000000852155982dfada4e3c948831ebfa254, 0x65441a66b5a27a55eeb894a8a1fd2abb6b7b1cb15fdad1f59c993409a500971b);
        revert("Invalid IC index for IC1");
    }
}



================================================
FILE: groth16/verifier/src/Groth16Verifier128LeavesIC2.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

contract Groth16Verifier128LeavesIC2 {
    function getIC2(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {
        if (index == 0) return (0x000000000000000000000000000000000981c9c7b22bc9b8858b5408144badfd, 0xeaedd4796635c6b09102a5fa85ad1ef0d466f7d813247aabee94062d11f26f00, 0x00000000000000000000000000000000091ded8251647368df883b50a4715874, 0x70fc544135bc9be7dcd9ad9e527f86ec0a8b3f4f073ec85c84ea54a4261649f1);
        if (index == 1) return (0x00000000000000000000000000000000197b0c48656cbcb9edd89ece9da1582d, 0xb5081e7e5446634f438ca880b48d5a6554cad416cbef3e8981a50b88979b96fb, 0x0000000000000000000000000000000000e38b1922e9ec850670ccee19746c84, 0x3b4a109ccab4fb67e16ac4eef7c3cc05d0b505d12e18bc35594feba8c8c90684);
        if (index == 2) return (0x00000000000000000000000000000000180b6a4f9fee46589a0bc3c439bbeef1, 0x4c4e154d953be6aea45f0d55a25553d84496732429ce89e7d95f66bba33deabb, 0x0000000000000000000000000000000017f90d2c1218a1a08c5048399ce7848f, 0xc8d427b363eafffe987d86bf42ae5d6da35fb63276ec8e0a18d7485ac12937f4);
        if (index == 3) return (0x000000000000000000000000000000000dc8b79619fe1790be7cd94d4d0b5b71, 0x2193592c76f60783d0dd8721917d6c845b450d7b30ebc6bbb852d45996b3016d, 0x00000000000000000000000000000000055793e8911af99e383ccbed7dbaef4b, 0x78e84b7e0d8ea431bb56a16b0697b0765cfa1fe926bae71dcb1ead5fd75afe02);
        if (index == 4) return (0x00000000000000000000000000000000050808093debc567ee5b6bc383f5a32a, 0xa8f57aa6cdc5d2025c615133281e786976e6d117048f7c63d460469c1b4689ad, 0x0000000000000000000000000000000008de350a647d093cb22ca248cf8e2076, 0xb66761389ef204cb0182a812371115feb4cb2ff71f89f25f13ffb601883b8ad1);
        if (index == 5) return (0x000000000000000000000000000000001267336e3f38a164193e57e2fe864b23, 0x73664fba3c95426b1b7fb5d94aedaf39b47d1de24f954663a4ec28f24f64fa99, 0x0000000000000000000000000000000006d30cae253055423180f3acc104d436, 0x5d0f0f6f0ea2c18fd13720ffd6c95fd907fb2114bdbd0cbe798486700e2b70e9);
        if (index == 6) return (0x000000000000000000000000000000000134b9738fddbffff8baf08567881faa, 0x26d1fce9fc893f738eaa3aea6c9f08de43da71dbfb88ccf865da8cccd0bd8faf, 0x000000000000000000000000000000001439def26bf82ed2fda9c869d6e4dcfc, 0xffd4369daa1ac4170b36d8e68c45f626f7d079f0c6e446ff4b55eec485fe4658);
        if (index == 7) return (0x0000000000000000000000000000000004763c1a3fd1c258ffbd169097b71ca3, 0x26e186b6807a6c957e64b1f21e1685273e080ed65e44f3614d8543fe97458ddd, 0x000000000000000000000000000000000d13c110b92aa63b03c971102b15ed84, 0xffdec19e9c981a9c697391d02c9e7d2fc077b03a4fd890e9fe1d3678ef336048);
        if (index == 8) return (0x0000000000000000000000000000000019e830c92c5a0e6e85056afa551d3196, 0x4f72f444a2acf79469c041c3e1d4f0a2a3798358e94b17f2b182bdf28a999010, 0x00000000000000000000000000000000095f650ceb936ae6d5159b14e02b6706, 0xef3d6be80da58f6df8c571b250c2ee42953c0c26619ce7f04a42b6e14406794d);
        if (index == 9) return (0x0000000000000000000000000000000019903797175813d0257081d90e47e191, 0xd8ea08a2316de4330a16cfa1023e1dc830ec695aa210e778f5ef674cd8ca9357, 0x0000000000000000000000000000000014ebc941df96cde825a70101e92769d8, 0x505590b0af5511ae6024f8dfbcfde70385f14aa1ac47e0f42d53e95d6e8a7fca);
        if (index == 10) return (0x0000000000000000000000000000000015b80d5d9819165f5ee7964539caee75, 0xfc99f9b84b50831c2f886c6cde1e1e391b899528dd426e850ed3e76a6c99edf4, 0x0000000000000000000000000000000009e70e371611bfe3e9c794040a688a91, 0xe87a04b46b18da9ccdda21ef6e293e61b0c664b49607d37f59c0707a27ee93e2);
        if (index == 11) return (0x000000000000000000000000000000001811de262e5356151b772e4f6c3286ea, 0xea0b619cb24892d49776217350cf2fed5231811e0ea5d163e3a66f2ffa15821b, 0x000000000000000000000000000000000a77c8bfc62ad9844bd001c89ccb38ef, 0xc450e6b8787a1e9576124c7de70231faca48bd2988b9891e2aa9b08faac0a54f);
        if (index == 12) return (0x00000000000000000000000000000000057a0621ed86bf8ba4f75bfe371001c3, 0x276f697327f6d76167e413ba610b82d07562e8513b45ebe1da5c1d352a9ed6cc, 0x000000000000000000000000000000000a258f1019f9de11bb73a5140f621c19, 0xeb99467ae76ae9ad5e005851f5e0002cb235a9a9e6403658ae3a1c310f91df88);
        if (index == 13) return (0x0000000000000000000000000000000016fa80dd6121abd1b058326ce9ef5e10, 0x5fbf344826add46b08aecdc196d23555684f3ee197bc504df2d442440e74e1bc, 0x00000000000000000000000000000000184101657702472e5f0cc7dff2dbadf0, 0x4473ede8e24f3db799df4509a571d8aa5cca0fbaed1f5ea133bc2682207d4366);
        if (index == 14) return (0x000000000000000000000000000000000d82168cdc2f6b4bd089cb4b5f51e853, 0xf98d3b9033079f9cbfb5397638026926fe010ad05ddcc76a022a6727839441a7, 0x000000000000000000000000000000001828e26c6a91ed1a01ec977757011604, 0xcdfce9f1c7741138469b8d90e9270f84fdd7fc06aa73a62b84031a8a150be425);
        if (index == 15) return (0x000000000000000000000000000000001114d3a73bf45b330c72622536f8f3bb, 0x82051556ceddeac7cc1bd62d2e7698629dcfefca338f0def133560ccff1ba670, 0x0000000000000000000000000000000003d2c49b4eb8a28077a4626e5bfbaf56, 0x8a3197ab2da56102749ac6cf1cd43ddb3f19d4d22ddfc03d141182f9ff17e5e4);
        if (index == 16) return (0x000000000000000000000000000000000d4511ccf1631f9373fa29d0b2b0877b, 0xf5c35d3a4eb514ea35bf0dd6e3fb348423f648c0b8af3d1e4734c6f1161a6502, 0x0000000000000000000000000000000014744bfba950a355f5d6ff940235a3c0, 0xb78dfcfc616bc8f013a64809231801fcd6e20e229b143c956c841bb94eeed6e3);
        if (index == 17) return (0x000000000000000000000000000000000032d982edcfa5f6e26d34ca989e11e5, 0x6f17a42e4e0cbab30bea0acb3334014dd57dab020d675819ba28a99d239d7bd7, 0x000000000000000000000000000000000e4e9a3764d6c6358f523421d0d26a44, 0x2a4687c3b0c887c7f875ec338c9b4b86cefe933b17d4d57c120dd2cc5ae1c9df);
        if (index == 18) return (0x000000000000000000000000000000001320f10e59eaec3b3629054a8eece71f, 0xa042d7a48d746d412ecf2dc996cc46804c255860ee8329fd37f9dc750959f501, 0x00000000000000000000000000000000191750354a8b7fc72f3cb5bf5a76a1c5, 0x6ed7affd78e0aa765f17795bd27834e1df4b2c79a42285dc01cb31e369573b63);
        if (index == 19) return (0x0000000000000000000000000000000008c7ec82f3bf135591864b3e8d68591f, 0x9aea7598772bcab692e8ba5b27474e773c2f15a2a98e55e819f67422ac47ad6f, 0x0000000000000000000000000000000014087a7bb6b307f4bcb28b523232e29a, 0x79cfd07bb6d3134003cc3605f6f265ad8d45ef78d9d74f8bfce8cbec973d03c6);
        if (index == 20) return (0x000000000000000000000000000000000fcfd10910ae59172574369fa794b10c, 0x7f9aa444e6825faede882910a7f210f02de1da1bf2fea4f85ba6260153ab02c2, 0x00000000000000000000000000000000135f1cb59a37d6208df1a6413181b102, 0x8aa4119e6a284ede48463bc00d28ee70ad200bbd65050db639fecde487ad0829);
        if (index == 21) return (0x0000000000000000000000000000000010e5447497df5e2659f1c7aa85a0f64a, 0xec109c6eb85c33bbeb698bf2f3fd91b503f6a893d86ef1e7b7e48cb98ad83724, 0x0000000000000000000000000000000007eca3e433a48ee5270642d2bc0f2675, 0xcc209c13dc200b20df77beaf17f05e72e1511ad74389897ab19575d2d87cfdaf);
        if (index == 22) return (0x0000000000000000000000000000000010819bf5a2e9d0383b118aa51cdb0277, 0x1657e49581fcbd7bc385fe6109dc75a11e6467afeac55088ba2218d14fa16642, 0x000000000000000000000000000000001673e87fd7cf5350a02f0a36bf9693a8, 0x36e37f5d7647da166f7cfd49c94edb1c6b50003213c1500078228fc71bfd011b);
        if (index == 23) return (0x000000000000000000000000000000000b950ee4f621dbe0fac2cd9227acf64d, 0xa1763662f836e8f8f918d5cfa6f9dfa0ebbefd1ffbacda3242c89d8e67276631, 0x000000000000000000000000000000000d5cb6ff2e10f2df151d8dc162ce9f18, 0x3649c520e9c064502ce7c4a8587a8da4be7bad50df1a504a21622a96ffa3b33f);
        if (index == 24) return (0x0000000000000000000000000000000016a8f3b204da5d27b21535286d0ed854, 0x9c671dbff7f3ac5d2ee3a739750c7a7fcd0ce14911ff1cd71d879ddd1e4a840d, 0x000000000000000000000000000000000a0c1cb6ef697a2a0790e904d72a058c, 0x940b2464a168bb7504e7438685afce1869868486edff16ebfb390476b9531f8f);
        if (index == 25) return (0x000000000000000000000000000000001442d3f4aebde050ccc6ba1c7798398c, 0x3ba17e49b2223c4d27735c09bec18dae3bda8f4788d6fe259546a72a864faf91, 0x000000000000000000000000000000000cbf25d40fe1ce7ecf8056d7bf995dd1, 0xd867c1fd14d0c2c5d5071bef4ef0bb7254c101a4d90d0ab0f729ca60aaa8a9ee);
        if (index == 26) return (0x000000000000000000000000000000000916769e5e28d438265f9a2ff9b61935, 0x83875f059ab9ed954433b310fc790fc2c3df75b7fa3e39911e5c958f5cb513b0, 0x0000000000000000000000000000000006910d87d52a01c8ee1dffc0aee3f1d4, 0x15e1d1f387802f3b68cf6f67fdc3f0454302db7c8c35232c5543ba8215a23898);
        if (index == 27) return (0x0000000000000000000000000000000014a48e81d1b355eb2e1a6d77d1869c9d, 0x4b567341dcc444e30fb6b1f93af9a821e79f6050905285cb5fa591bbc0d59b76, 0x0000000000000000000000000000000006175d29f2b3c7c5ce2fae9dd7e29e00, 0x1d5542f380c94770074ad04290b265f886d23be36c93c5377cd7e26e1583ad47);
        if (index == 28) return (0x0000000000000000000000000000000013fe9ebbcccd993261313589a5c80a26, 0x42978b00ea66438bf767e4e38f36e4fabdcfdddf07798a06a621bcddd57ccbec, 0x00000000000000000000000000000000043f7f57159f16f1466dec85eabffd27, 0x4c7aaea3f90ee48e51346e52dc092baacf6e261c63e648d254347c90db9246d1);
        if (index == 29) return (0x00000000000000000000000000000000001fab77e224474623450c6fbf2df728, 0x21430f06eedbd823c9e245b79ca06bbfe40d6c1d73cfbca3a14af0610f1efd4d, 0x00000000000000000000000000000000182368ab4b5d128f5a7b1033ef0f3b7d, 0x3a717fd1fb5d08c0528297a2b7ef5bb5ff9b011a1094dcae492fbf6f77482ec3);
        if (index == 30) return (0x0000000000000000000000000000000001bb7294e340c9b553c4d50770fbc9fc, 0x7abd7ec7cfce5c969fce5a34c1b71c2b557c3228971335392dcbf93aeb54eb4a, 0x000000000000000000000000000000000b5312773376c7fe523d7d922b7161e7, 0x55f2031ce1be733d2abf030bd8931f8028d0366eef4063dcf84b6ad90ff1851f);
        if (index == 31) return (0x0000000000000000000000000000000008dcf3379782a5bff06ee28a1bcbc16f, 0x9a2c839ae2727ed2aa264b4a43f99bbffc4623232883a5eaad3d0b910211051c, 0x00000000000000000000000000000000079ccc4bb45162109d1a6857b1d09926, 0x8e302c065a93db12ce8a03d7c9ac053ae65101e314dc0b3cce1d94d6c7304bc4);
        if (index == 32) return (0x0000000000000000000000000000000018eac0a38e40e2d3fa84ccd99d911369, 0xa4b627b706167d52fb554c2c9af1b2364517e83dfc45aca5607bf1e7a7183541, 0x00000000000000000000000000000000192360e32b4a6b0eee9754730ae8dbff, 0xe81654a57fe56addf5eafee895494f37ac426bac73adc5759eb10cc89e589be0);
        if (index == 33) return (0x000000000000000000000000000000000b9ea7062159586adfe9d57d98fc9650, 0x17f0ff9bbe8f220ec5adf64e6cbdd89e8ffc0637a7a5c1bbed69910bf02b64c9, 0x0000000000000000000000000000000019fd2570c3325323b58e80e16ae52c7e, 0xc9e28718a40d37a11b9877ceb725ea23ffcd368abf46ecebfcb572493cd60f67);
        if (index == 34) return (0x0000000000000000000000000000000005d0c0813fdad9a299e0f95ac49df09c, 0xc2e75236943ed9b62afe12dbbe668a5ce188afab9a6643cb8594ea90423bc42e, 0x000000000000000000000000000000001894d48c30211df49837035ecaa965b6, 0x38d5ab67884737f47ec12d9b3eb8eb7a0cee882058f5e1c1e6affc0b72b2dc99);
        if (index == 35) return (0x0000000000000000000000000000000000dea4c0dd980f87123e1937e83f8e29, 0x3d2655642cdf2ca76e393bf3419a2a3a63c5b4a790ba6f9496882f5372f56df3, 0x00000000000000000000000000000000177997f8972c43862d4500ba7c089aa2, 0xd853dc3abc98093ee698062721f0e087e1a7996f178c3b9b021e5e8ffdac65d0);
        if (index == 36) return (0x000000000000000000000000000000000e7648384a8ecf004b5b7c160d697495, 0xb0733679ac4ac267372386e5e07b224626ad4d1b7d1fb8a2269263f63a406ecb, 0x0000000000000000000000000000000002f8d3c1912b49b997ac0fd6dd7fb3dd, 0x82d28ea42b9749f5454809d85b2704c8dc35427dedb91bc42b308cba3e1804c3);
        if (index == 37) return (0x0000000000000000000000000000000012a0379c4f5b73add643d445c28d35ee, 0x1d5389e602265d6839c1bc0b3c18e2e27509547a38357952cf9daf313c6b13d9, 0x000000000000000000000000000000000104e08298677e10a3cff1959db60752, 0x8c9c3b4551b19dfdad988b95bd65f4df51a78344147d23703e77452904f9671c);
        if (index == 38) return (0x000000000000000000000000000000000fab7ce92a5695d8c8cb97ad4fdd9a0c, 0x041e659a4ff1d028a8f64d2eff4e9938e64165265b9362569b4b8a412580eaf7, 0x000000000000000000000000000000000309a77edca892dd92a62834ccb5d16b, 0x9296509674786e437e802ffa65594bd4af558d3d3005874d733778cfcc471856);
        if (index == 39) return (0x00000000000000000000000000000000110b8a6e95f4a0bd74c6c23f25bf368a, 0x51fc1ced3649a7f5395274f3b26e5c7351784bbb7239dbb48560a36164e80e1a, 0x0000000000000000000000000000000000b57a14f0485f6458ee546b9a1d93a6, 0xac50ab175f43a12da0d3407ad09592cd8f1c68df61ac1526e64c8df65bfd86d6);
        if (index == 40) return (0x000000000000000000000000000000000ca8bed3ced99900dee33424f4a1972e, 0xce5b11fb23505040b099b897ec341e516b438b00a48b6f9eeef3322061b6ce8a, 0x000000000000000000000000000000000c1dd8fbb756494964fa773f44d27a31, 0x5b0f7ab6db5851e060b5b39c2cacf94ecc4fa61cf18d5aabbde737550ade8476);
        if (index == 41) return (0x00000000000000000000000000000000156e04f6bc440b73cb39f726a07979d2, 0x22d849b5b663ed1c1df6775944d2f87b5f1df967abc0dd8925801bd70203d342, 0x00000000000000000000000000000000179cbeed1c64fddcfbce8320c882c14e, 0x811c0928c6816e86e4251d983aad024f3df7cd6f34456f8df78b13618e8fd1b5);
        if (index == 42) return (0x0000000000000000000000000000000011750b38f695b65656854d28cda3480b, 0x53c8a3c548f1aac30650009024978a65d066b61914ac3aef318af102b74aa819, 0x0000000000000000000000000000000010ae5e763463a2ab81ddfdd861fbba6c, 0xcdc0421f30e33c04b11c838a3432a91413d9718c186daaa53af2b1c35e940b9b);
        if (index == 43) return (0x000000000000000000000000000000000435badcbfbd86d2fd9e0a2376ccd17a, 0xda629166c1c19102e2fc5944d6fa7e6b9fa5b8c7edff1e528fe901d322172666, 0x00000000000000000000000000000000089a09f618ff66f3977c9afc16f1e2f8, 0x9e82914424a0f8dc8824a642dfbeceb30425abd93406e4dbd88db899aa25f25f);
        if (index == 44) return (0x000000000000000000000000000000000490fb0c04fc582d41f7f2f7bf84b181, 0x8180894e1ee240dfa1711bd8f6f93cb619f89b19086a2f60b0ac825e080d97dc, 0x0000000000000000000000000000000012d18903432fba16c47a5ea61baefdec, 0xed96bfe1890bc426b38d731a48e2ef87609a7ca3d2b651aea36d976121206e94);
        if (index == 45) return (0x00000000000000000000000000000000196757f7f8dda71c3db0e892cb67030d, 0xf5c31b7f5e0efa9b624a6d65482e1ccb3427bb7e6d29a0d8ab92660328d109f3, 0x000000000000000000000000000000000438697f68ee43aa55f3133b071d4d14, 0xa9c168cb4ddb7105f7e10e6055f868ed071da3ab1a5cebacc09e10d5c49c9685);
        if (index == 46) return (0x00000000000000000000000000000000167c2c09f5d10a695c6e4ad2166eddd1, 0xa8afd291600305f8ecd4c6c17362624657ccf3794f7600b78a47c5e74654aae6, 0x000000000000000000000000000000000b91b8cab450d346c54bb44eb6a7b098, 0x03c1db163c3b5c879007a89df8316eca3d264ebf24d58a85726561501210b56d);
        if (index == 47) return (0x000000000000000000000000000000001058cd965a7cb4659a3745193fe1c800, 0xc0dad9a49ba94fe1a1ff56048bdc09a01ac63ea7ae93a8e3970951783dc77797, 0x0000000000000000000000000000000012b9a1f338eb5c58c7d7c2c5357aefb9, 0x175d47b7d21fce9b02569d9863b8639323d00f6ea85923a8a517f5bec5069383);
        if (index == 48) return (0x0000000000000000000000000000000014d05b13b863fd88f65b5d71045a5e41, 0xe1a045daec6d8f7185c45c7a82ce15622cf62dbab09cab16843b6ecf698bd389, 0x0000000000000000000000000000000018e21d38c77f679f0bac1843c9f0560b, 0x7ba41600a478e911f6af7b18737d7cb9d1fdaf4d3551b687bd420e41e7724e3f);
        if (index == 49) return (0x000000000000000000000000000000000aeddacf3849a1cf9d46870cbdd4a9aa, 0x9604917ed738f273bcb1728c090146d264a093545ce269354503fecb08044923, 0x000000000000000000000000000000000dd2ff5cbcd4b90efe25a33ef63ab927, 0x1fbb80eda5c1d0835cabb31b9a009c291326219146bacd64066d0e1d523336fa);
        if (index == 50) return (0x0000000000000000000000000000000004bef9ab08c50dd814f7b914bf9cd462, 0xe1ef6ac9b5dbf1962e0dd443707074b47e6f578bebf15ba332b9355c016025b2, 0x00000000000000000000000000000000063c00a98986743cf60e4062ca3bd3ea, 0x34a6acc1f1fdb97409980ea3f9ec899357a5112da3264656921cddfce52ec66c);
        if (index == 51) return (0x000000000000000000000000000000000667ee9306292d250f332d8ba0491e52, 0x8cdf800adcc956c147154d7967fd8556eb5bd35bdd177a1b208dfa732db7a435, 0x0000000000000000000000000000000018bb384bdd8dfff97b58a6dc6c7d585d, 0x91833bfeb6459f20819e0bb38270a9641b24bf11a74aac7a77346a9b4f7456dd);
        if (index == 52) return (0x0000000000000000000000000000000006430520dd6ae7afe86de230446680de, 0x8c70a8d1655149c7720a583cd2a7e35ef75f99aaf084072df63cfe0d16debc66, 0x00000000000000000000000000000000028edd7887da94987729b7559aba273c, 0xe7f450bd90d560c71fa328922fdf3f091c4aa0a24cb4e2ec79c8c3ab61c35482);
        if (index == 53) return (0x000000000000000000000000000000000bbb745a237e0f0136489e2a455d4116, 0x9788eab82ddef56a41970c20e84655d525599bca9d7c63d492d90c7a0f188bd0, 0x00000000000000000000000000000000076bc59e3a1e7bb1ee0bc1b06b0c33b9, 0x963a69b36f6631531f2343a9aeec034c4bb913cd271cd752e7ec447fc60a1eb4);
        if (index == 54) return (0x00000000000000000000000000000000034770b142a4c9d1f556c5baa2dfa1b9, 0xa5551e422476c8066ddf6cbc8344ce57ba2aee6bd58befd41bfc697dbbba313a, 0x000000000000000000000000000000000fc013ff42ad386ac54055d8e7884f65, 0x289244d207e4aa4d39935c9a2249687cfbdf774cdcd03997bc8dff987305edee);
        if (index == 55) return (0x000000000000000000000000000000000323e749cd917a4850575a33911750dd, 0x64947fcdaadd3c81474c39d733cdee18e75e9b4348241a04d02fb2d4683cee15, 0x00000000000000000000000000000000032dc18bd4a3b28d9cddc121d8d7c1c7, 0x681d44efc0351acf208a1b3a05ce1ccbe66bcba0b273b71b30daa5e09672f1b7);
        if (index == 56) return (0x000000000000000000000000000000000ab781b4019c8f19549f504f8ed3c48f, 0xf2a453f0e17257e719ef97722b18ab91ed31591a4cc959fefa298f3497735d91, 0x0000000000000000000000000000000016acf7dda0d0dec5152a36d81c236fc5, 0x4572a3f401d733ac73034053e578fe8c2d2e55f798db7f87a8be806e1fc84965);
        if (index == 57) return (0x000000000000000000000000000000000c96faac6a90e97cab777dea473b5b5c, 0xf2ee201423984e5414d1b9ea6304276ddd4524fa55cb8a6bbdd5a291278a3bf9, 0x00000000000000000000000000000000092409d98e18cb92ea8043aabc307d77, 0xe0a402bab6a1854f6e6d365d3426bbbb9596724907558170b3d2d242ba582f30);
        if (index == 58) return (0x0000000000000000000000000000000004b7d272a9a96ffe40665d544bcf7332, 0x2f65a88e549f84357d417754d8f02cf256c53e3d8376dbeef6c77aff7969b9cf, 0x0000000000000000000000000000000013360650d306b4b265aef97acfbce06d, 0x037390593b4750d9dacb5dd7a0a2bd84bcd52677edb561709dafd8445dcc69d6);
        if (index == 59) return (0x0000000000000000000000000000000014285b3707d60984230f7a5dcbce35dc, 0x88eff14900ea6d8bd2cf5a33b0959237e5d179f991213050479e557af24424a9, 0x000000000000000000000000000000000ff0fbc7afb8a75eee4864ca1b6a61c9, 0x9ae5948ab96adb2bd4889109cfde5bf48c5b5e263fc121c641116023ddd5b470);
        if (index == 60) return (0x00000000000000000000000000000000149619581bf8c1bade800091d2931151, 0xd97c30e0d1e7cd890dba35799d02c63d08acfec48f0fc63fc03f94b49846fed1, 0x000000000000000000000000000000000d52b75a6c1fd4b04813e76ada192c8c, 0x96e3dcd08f04ce34bddcb974af2ee7061af319bd6bc71db9b0e049200fe4cee8);
        if (index == 61) return (0x00000000000000000000000000000000052e7d7c53ea9e03fe6dc84558688877, 0xbb6e1bf48f691f88b93b232800c217ff373bfac8a0de2475ccefdfc9397ae5ab, 0x000000000000000000000000000000000cd9f4a80909dfcebc073381db01afb4, 0x3d292cb8bf3fcde9a7dabd8137e331605b9bf699f62d5bb534b8c4f71827b596);
        if (index == 62) return (0x000000000000000000000000000000001233eee1ea2d631404cb0e606a62a269, 0x5f1c99e661e1855a942887e7ce7526a5fba296cb446ed6196499849796f5fe34, 0x000000000000000000000000000000000610ff2de0d0d9f8fa6e78baff5eb6c6, 0x19421d3bd6d0d51f62420109a8f7f1628ee1d06c3f5e3ba81016d35326f5f031);
        if (index == 63) return (0x000000000000000000000000000000000649203b9720377f22ddc7d4a64247ef, 0x6a561c8165fdb4df1e0791cbd253ff00428de65963e85add2547867eb83ca512, 0x0000000000000000000000000000000001996d6acdbecfff5dd5be5306b6969a, 0xcb95c3f471b8c0d9bc3e17e2d02052898bbcafb3b78dd774e7f182900da87d02);
        if (index == 64) return (0x00000000000000000000000000000000185123885088b9803c39a5ab6eea212b, 0xb207080a045d91386e0653b01c629a1ec817bc43265656aab23aab65971d6369, 0x000000000000000000000000000000001033903f9eb616107b2f97fe97b3ce82, 0x242cc5655ee071dd23823abe4cf2cc19c9b8c3e496d3dbd547510f0a6bebef84);
        if (index == 65) return (0x00000000000000000000000000000000143c600e80ad37cc3da11b9f9bf20922, 0x01cd60ec5dbc74e2b453504e26564f21814c42898d2e86314489296deabc38c8, 0x00000000000000000000000000000000152b880569a8347bb8e56ed6f5ac6156, 0xd6945a8d308730b8b5c6cd1c1a90fc135decd0832f6fb80b73c19d2686872afd);
        if (index == 66) return (0x000000000000000000000000000000000b07afa4d74a0fe9b45c78ba2b425ad1, 0xa26ac59097445bb57cb10e23539432e62d9a57be03ad438a8688a8f02d49f403, 0x0000000000000000000000000000000005c010292ed30c6056d7304365526d1c, 0xf15ce61ab45a5b54fd317b95133a23bba902b4e587a1f99ee537e8ce84e0b2ca);
        if (index == 67) return (0x00000000000000000000000000000000115aafda4e5bf6ff9b1433d3779fad46, 0x316cdad4497c4f51a9ab746fd549ca0176ebc239d3a800e673249fc40a24935b, 0x00000000000000000000000000000000115b0463b68041cbff39f26c5f43b066, 0x0bf566bfdbed4029d04f991cf92f2873924764cdfb8f375ffb982c9e636f3b4e);
        if (index == 68) return (0x0000000000000000000000000000000000f54838dd6d75e0fd4e012ef0a8448e, 0x10c92673373b55cf02c198627af251eeda297daaf9b43b307eb35f72cff6750a, 0x0000000000000000000000000000000007f8da5d2cdb013867c9f59885fbaf29, 0x9ef078c4d4f99c96ab1ee2589e30151ce2307193feb902829c23bbdf45f9f31b);
        if (index == 69) return (0x000000000000000000000000000000000dbdcd090c9fab279a75dee239daca02, 0x2dec6377db5abe892607e7d1413661f03929c2274b89b82441a99ed23cd49e22, 0x000000000000000000000000000000000d636096d29474abcfcf8819a48b0a4d, 0xe56384d9d2ac195b681de7a0228fb65c5f927738a84395a8c2557989b66eb95b);
        if (index == 70) return (0x000000000000000000000000000000000204d94ca30c0d44dabc7765f89666db, 0x0ce6c6bbba58c029946f64f35feb3d6a65270b7292dcfb73d64fe98191828d5d, 0x000000000000000000000000000000000a4bf99bcdca792caeb1b892513b74ff, 0x907c9b1a2bddc17a37e2efb7c610d7efcc7ecc08af905a3b9c2ddd4e23bf611a);
        if (index == 71) return (0x000000000000000000000000000000000680dd4c303a8fbefad14dec361cde9a, 0xe7d9e8d80e9601ba33bfea648a638561290e9c2f458e3d3692386398a864878b, 0x000000000000000000000000000000001158dbcfe47cc4d90a801020fa3b3fea, 0x511eddccc18643cfb243a4bab47166f4fb854445f2f815bce39383dba9899438);
        if (index == 72) return (0x0000000000000000000000000000000018dbac37b521aef81db3ce6b495c9cb9, 0xcbb13406729e7056d70d423620ac49a4b35b3d507bb90abd0fad8e36adac001e, 0x0000000000000000000000000000000011c926e6ed9e430dabafe20d3d41047b, 0x1e39e77694a2b755413eba4fe32513367f0d43290515ae9823ce4893cd8a3477);
        if (index == 73) return (0x00000000000000000000000000000000019cac2e63bb5f5adcd1d716b75def93, 0x6e32b3e9bbd0c8b706545fb543dbfecd446fffd54556dd7b31091ca15e57f529, 0x0000000000000000000000000000000013495f571989f687ec9538c747304059, 0xa1627517dafae9c1e4ec807cf0a86771b0e9d80dccd9836ef82fe0090249d69e);
        if (index == 74) return (0x0000000000000000000000000000000018e3aad65fb0c9c1e0e6a84a135bfd51, 0x0ec253a0243435ee73a7ac98c19583b89758a57e700f01c8a57fe4f0a69ed1d0, 0x0000000000000000000000000000000012582bb2e67be2da7a29e59137d90ea6, 0x57131aab89554f3092b56887f08384b865ac6ceaa0c977e36f0ab97282f18287);
        if (index == 75) return (0x0000000000000000000000000000000008f809bd98063b86852274db5fb95879, 0xd6909b6d98d418c356ee08419c660a2d2fe5e0e22b7cdf5ed8993ddd75550393, 0x0000000000000000000000000000000001d9bda7eb1fb51e551b72a474763236, 0x65869f63b8872f6cb305ef272b97976c4b58c70b80d2313a113079eb93f9173b);
        if (index == 76) return (0x0000000000000000000000000000000004bd5c3d95d6cddca81ac43cec7f0a9b, 0x84e0f7603ea281e88d96022f6cb617ec487c033130588a40b0e6e3fdc4fad24b, 0x000000000000000000000000000000000dcaa2b662a8d135d34199ce5b790a6f, 0xfd8b0df85642a293782ff0405163566eec22e071157b76dbdb49b8074def6083);
        if (index == 77) return (0x0000000000000000000000000000000002c36c59defd9b2ffa8225b74d051cfc, 0xfd449f3d3d432cbdeca8f6fa5115efe87b83a76c02e5cdac7c8e7e45366905dd, 0x00000000000000000000000000000000012659fa20fe987c5fe353f86212ef31, 0xdce59d06be88d36a4ec24bcdbbee366f6a1b6b2246036a0b3c434636864e8dca);
        if (index == 78) return (0x0000000000000000000000000000000008aa291a34e3da86fd6f5823def2804c, 0x640f65f0a8824b4bff735014e0bc45d93dde61e24bc8d32e13c806d413316069, 0x00000000000000000000000000000000162a937974185fa4b1746f225daade2e, 0x817496c2fdee0075d23f81588ada579c3c1e346ce1a53ea5b863fac30c498673);
        if (index == 79) return (0x00000000000000000000000000000000125f77feabca5c5565e9bf26a9e56c4c, 0xb84803b1460b04ca24d031f85109cd711082bc3875869d4f1a578be89abfa449, 0x0000000000000000000000000000000000dfacddff1f5f03e8affc234f8f8dba, 0x52b96f456195bf5dbe0034734ffa4a22c47ac3dda115cd8327eddd3eabd73ff8);
        if (index == 80) return (0x000000000000000000000000000000000eacb93cdec54e9e9c5e61cec0440547, 0x315216963bc5292c9bf17f4f3796e31586944818961e8076d714848d8ceb922a, 0x00000000000000000000000000000000136a0161d1a1905ecbbec6930545040c, 0x0435ea23f504fede85283edc2c31730d30d27dc30c2a6de2d4843d8945a62dd9);
        if (index == 81) return (0x000000000000000000000000000000000005242c65da2cad7609fad29cf4682b, 0xaddfb164b8b077df3594ec561fa1c7feaad8175174631c65b4bb2f5831037d39, 0x000000000000000000000000000000000ba7f09e06bdffff3f92ccd3d7387b9d, 0x607d3add08137949212c2e3a52e3eba1200980510d9c0666e1ad86e55a3aec4f);
        if (index == 82) return (0x000000000000000000000000000000000fb7eab46f9ec493434a382bf278857d, 0xfc0f7092b7dc80b0683d64f293cab8bce9fa19c767fe0074679784e690083638, 0x000000000000000000000000000000000d38ee0c25fe239f368f99c995e29d00, 0xebd9ce1fc7d9443781c8c99af28b8812130584b280df6a9880ed8493e2075211);
        if (index == 83) return (0x0000000000000000000000000000000007c8f5841e500a18519a04fe0fe506af, 0x5026edb3de174e9344b105552ad6f7f6f1273baa168a3869453e6d9da51e0900, 0x00000000000000000000000000000000193e64b30f795a1d278243a2b406bc01, 0xc3bf49973cd1dc0294a3f8a7d634c528a0b6adbfa19a92ab321ace5d9ce35224);
        if (index == 84) return (0x0000000000000000000000000000000013e4047183c9ccc544887cb522a1bf19, 0x3a24a8f25b429a69c45e295293dde51127a66a50ac2481487af7381b87ed12dd, 0x00000000000000000000000000000000039deecdb145a02aeab75f1c144d9279, 0x8875ee3bdc0cb2f26208bd3f926fc45b853b8bbed87d1418d0a91ad7c96b96db);
        if (index == 85) return (0x000000000000000000000000000000000890a95dcd7bc8d7951c17530f9acf9f, 0x9c7b7eecc4d1a9d197ee6676b3bc256f659ebcea0c5f56bf494411e41642cfdf, 0x0000000000000000000000000000000017fa14186ce66ab918d7f898fa638321, 0x3c2c60853ef840340afa6484eb66276cc8b7b1ffcfecf6966db9083950f889e5);
        if (index == 86) return (0x00000000000000000000000000000000171faf6ae53699239792cc51fdcfda2c, 0xb81ff063910cf99e0f71c4204866c95219e821c0a6880cf60b8d2bfbed45397c, 0x0000000000000000000000000000000007d2c14f7bd7ee5c64ec1bef15174413, 0x512758717c5544ffce1e44c2a8537112a7bda23b8d755ae45ec475038b5ff776);
        if (index == 87) return (0x0000000000000000000000000000000011f3c9920d32c3e3759e6b82d280447c, 0xcd23e40a294290cce35532f1a7ff298ea6fc29447c1f093ccb2d47b3e8459246, 0x000000000000000000000000000000000bf26748436a1c6d6b89ef48ee9c018b, 0x937679a3eb5b71eb02ce792a2ad2d253030a11210a79c96624c63914b7f7534b);
        if (index == 88) return (0x0000000000000000000000000000000013ff9e5d9b4005879ecdcc5a0fc357b0, 0x8d4526b831f22213a49aa4093d68255e067909fb775d264771eb06aa82f7ccfc, 0x000000000000000000000000000000000d6bf45af45ddf42de07c8722c3ea202, 0x185b65865956fde6f0eba5b98273609c33617ef4f952267be35e6f1bb9eb6ac6);
        if (index == 89) return (0x0000000000000000000000000000000014beb7bef8078df2db4480404adeb8e5, 0xde0a374e31d12fe92077fbc36fb35358e2193e141ff37ad247d6e54bc0874a2f, 0x0000000000000000000000000000000006b79379121fb43fd2bd78b5922e69af, 0x304ac7c5035891a3e6eb4bf520ac7749c34ecfe247f51da41c15aca94a6697e7);
        if (index == 90) return (0x0000000000000000000000000000000015245ee64d385df828daa3cc99d7ac9c, 0x0ece4ebf83a38bc70ca7ed270c000066b0bb068d891f75fcf2d90e2689c9b304, 0x00000000000000000000000000000000138395ae157b052edbc38efc57d248f9, 0x2972cf2cd33de4652d8a8a8fa85a6806a6e6822e5d9183b60f2b385c1562851e);
        if (index == 91) return (0x0000000000000000000000000000000017728731358ee708c58d45090c4e01ba, 0xa4659f54320adeeda0523a6753d86c789e5ff9d8149edc6900c8a2ca6475e14e, 0x0000000000000000000000000000000001ab74c9d91bedc6539a28959b171fa6, 0x638bba0703ac41f7947f56f93fa8cff1379d218bcdfd9f2fee95e808ec469f39);
        if (index == 92) return (0x00000000000000000000000000000000147a6c10abb0b4409d0bcb3756a13efc, 0x4dd372d494924d025e46b600d0f3709df6afa32e7885697ffc4a14162f2f49d1, 0x00000000000000000000000000000000195b3fa8480fa6560963252814b2e15d, 0x9517319132acdd83950bba789bcb3c488406cd138f9e9a8ff24ab260009e0f0c);
        if (index == 93) return (0x00000000000000000000000000000000055f400cccdfc6a2fc47eaac4fca4fff, 0x08e625d117554d79a9d32243499410cd40545af2420116efa63765f877ad16fc, 0x000000000000000000000000000000000496f092261b87e5d6e7268c9d06f8a4, 0xc37867864aca6f7c594a27e847bd604fc95ef6356524004f6921ad93df174f90);
        if (index == 94) return (0x0000000000000000000000000000000000d39d4341bf0c7e52f32a188b811920, 0x5415de81c5ea957d422e0a8eb1973757454ce6dda73f0b7ec59c345943d799da, 0x00000000000000000000000000000000004f91e9c7375fef56c4f394cc064611, 0x2258fea9848e9ed744e3aab9e02765760258ca41695a20a0c887b3b15ab8564e);
        if (index == 95) return (0x0000000000000000000000000000000003ae5f53f3599a02021853f446f625db, 0xf8e34f9fc09ff77fc9de68e994612730eea15ddfff671f82b8ab9d5d9d6ad7d9, 0x0000000000000000000000000000000008bf12c5db1f7a6937df586939636ffb, 0x2abcf933487c5b7c5e5c07df1bb3a76c97e83ce2f408d8e3994427e2b902268b);
        if (index == 96) return (0x00000000000000000000000000000000159ab581423065ea1dbc5f6503cebddb, 0xec9ae13ba8a3592243376dc9496526655d3b4a718c6718d90b7c0ddf5e92daee, 0x000000000000000000000000000000000b7ac54ab71ddfc96be020f60e96778e, 0xde5c272795738d92becadbfc4ab1edb3d832f4ba746c521f51b1f7b61dd506fc);
        if (index == 97) return (0x0000000000000000000000000000000008e2ff81d2aa84d569a6c124baeff74c, 0xb6b2f3120771913e4e88661af3f60ff7dc27a9d67446b39e67d8aca1fecf96f5, 0x000000000000000000000000000000000f4c5e76cfc930eac2ee20e8277eb285, 0xeaa362e2faf2384367493934db573ef6795a4595d8325431cb71e8fd3d8df299);
        if (index == 98) return (0x000000000000000000000000000000001997c98aef11cbcc45f981e1418d948b, 0xaaa1816df191552c0843cc36d706b75ae47b340b76985ec09674db579efcee27, 0x000000000000000000000000000000000eaca8608fcd3257b362ae6b5d26172b, 0xda99e0bea0125a03edd192c1087030b310ce777eb486dba8a84b50231993f2ce);
        if (index == 99) return (0x000000000000000000000000000000000af6e3374c68c22e80ef093e679a266e, 0x54b91cfb019cbfa8e00c24068e7ecfa7ed621ff2244acbff806f7ebb6dbc73bb, 0x000000000000000000000000000000000fe22b7c4095da1313a269755299b280, 0x65f6ca255031e876567cf22db90370042523a758b8848d98a83238acb7525f2b);
        if (index == 100) return (0x0000000000000000000000000000000002579cc44377573cb3f53b24ab366a1c, 0x20d398727df19b37859a80b8e79b62cc9f87e9b559ac40ae0d15fc858ad29edf, 0x000000000000000000000000000000000b971c41a2f5ec55682af1742d2e8d13, 0xda4cad820bc1a66f8de915fd3cc1553a164f2128417601b060726c457cbd0374);
        if (index == 101) return (0x000000000000000000000000000000000412567dd415c1ec3e6ed57572a1caa5, 0xef93bb1474bb470e869c695863d633812d84c1c4fd6c9e6dff0a68c4e0c45793, 0x0000000000000000000000000000000004170e40231a44ebaa40831b45dd8a43, 0x27e8421cbf1e678a2d3120e796122daeead8535b119706b3c30b546d79cacc91);
        if (index == 102) return (0x00000000000000000000000000000000057ae7197df93439e313ac0092824a1d, 0xa47d4c01031fc826113cf7b51545429768cc1827dc571eda55828233f9c6a09b, 0x000000000000000000000000000000000220344cc775126edf7b0fec84c95d8e, 0x7ee932b8c074689b01636c73c4aa9a61da6ecfe83d189fbfb11424d81441f7ac);
        if (index == 103) return (0x000000000000000000000000000000000dd0a3ddd20987f1d84cc8c308aa4326, 0x382e3bc4f618e015c88f16ebfd52b349365ec9824d23ae8102eb8448685d6d23, 0x000000000000000000000000000000000053e11296d543bc825ef012f4ab327d, 0x06568e0498d1a065b0afb8dc7474431576372f42fbe6b0a3942c3ed4dc11df4c);
        if (index == 104) return (0x000000000000000000000000000000001146ad20d7eb8d3dc947699d8f1e1a9b, 0x550274ca6ca219a755b56c314252934f128344fb58d087403dc61447f28f6c15, 0x000000000000000000000000000000000b53e179a9c270537616459bfa03e743, 0xb262b00a44e182e3ceb607f5614ce441c3ca14b171d0a24a807537b64e06efbb);
        if (index == 105) return (0x0000000000000000000000000000000011c053c9805f5d7a3a217cd6cb35cf64, 0xad35095cb24ebb6317ab9d67b4a2f853d5df6153c3c61fca34658f75a855923b, 0x000000000000000000000000000000000dd3870b42c3ba97ede53fa07d200e30, 0x74966f63fd7b260fb50ff0c5fc1055865ad028b7c902b1cac098f2e94cc43658);
        if (index == 106) return (0x000000000000000000000000000000000ce5828928ce6d70c3d813974763666f, 0x74b2c5d4312dbd3eaff0167d2be28439bfca1bbb38832ab0fa0c4a4c504a15c1, 0x000000000000000000000000000000001186fefd6e0a06dc7e42a40f5f053ca0, 0x20e3e4d1b9240a244c077dcb4b541308b3936434fc3653e3ecfb2bef21375f61);
        if (index == 107) return (0x000000000000000000000000000000000dadc9ec594e4cf55b5ec745104e7ce2, 0x5b9e3fe1692798bbde74cc4f18236c70f27ccf4c51b3f7d33cc5955ec61e2351, 0x0000000000000000000000000000000015dae3bd625b212cbe24d88f5f28861c, 0xba1db55d985115ae5888f36d7c3ba7424ade9629acf4a719b1e4020c1c8c6088);
        if (index == 108) return (0x00000000000000000000000000000000033e5a2c88e856298e76b26dc67bdf77, 0x54ec68f254f5d9f503630d38126e5fec04898696d932903e467b0533f6d1098c, 0x00000000000000000000000000000000191949d2839ea455fe7523eefb9fe9e4, 0xa27e6dd2062cc593be36335ca240d2562c8a4428843d2152a90fc8efc1bc0c36);
        if (index == 109) return (0x0000000000000000000000000000000009e944f0886e70ae0aa15a30f760bdab, 0x05fdc2d35698205b40429e7dc9c2d2ffc7d4edfa1fc6c4ecc483309bc35ba145, 0x00000000000000000000000000000000188507520c262e70a0746a6278a676d0, 0x9a5bc13a2abff33fb4dc418daf63b7a938929be1143a5d2f133b8a9bbb179bf0);
        if (index == 110) return (0x0000000000000000000000000000000006e35c4ecd527cfca871b064b7a865a0, 0x617039fb63bbc6ca3d8a2590868b2eb191ba11ac49e9708ca5a4600e3c10da7a, 0x000000000000000000000000000000000f5cda8006e298c13c5e66b79af504c1, 0x4c98bf3c32a582f142eeb6f41aba0db7ae1013130f83cecfc6acfe896b671162);
        if (index == 111) return (0x000000000000000000000000000000000e3d24ed422aa226d784404becaa2c4b, 0x6d5af1a04e8102ca6cf58b5e09d42b4602c5f6bdabede5f200ab459cdf352152, 0x000000000000000000000000000000000304fccf3a76db8dbad022763d8dc5a3, 0x5fa2671b15da8d040d5a0f6a60ebe24536020d1ca7a25eae58d28b9c51306e2c);
        if (index == 112) return (0x000000000000000000000000000000000d440f83868d16e0a9554e4fdfb39365, 0x62832e26a3ccd68911f22d9c187f623acb03678412f16fa72f7f19493635a59f, 0x000000000000000000000000000000001121f57d191808b62a2f3213c43c54ea, 0x68c1f9e726f19e40efde15a9e4a85d90edcf941a5b8bd3719dfec031064bbab0);
        if (index == 113) return (0x0000000000000000000000000000000008fa771ca8c74ac8113f792a51c3a9ae, 0x2ca115a4eaa4744c71a026c3502c3c5368167b8f2489c2bc09c86d2701f5053d, 0x0000000000000000000000000000000003054e458715b97318888645ea17a146, 0x5868a3ebbd4dcc71f03e4dbfa03248802076b386c9ab7792c89066491bbf8d46);
        if (index == 114) return (0x000000000000000000000000000000000ca9f377e85f030326d2e1ad0b32765b, 0x81102ce296af9ebaae2990dc4afd3eb344047bbd5b24feea2cb6fc894964d421, 0x0000000000000000000000000000000004982530cd929d871b1e621d7f1ae829, 0x6174f5e3cf37beae070ec76a1459380432346b3038c866f4ed0b421da8982eeb);
        if (index == 115) return (0x0000000000000000000000000000000015d1683e9c5d2e34bb03184c9ed4459a, 0xa16169d75be612df851a096cc97fc100099713c5efa607b7c07ffd0867330981, 0x000000000000000000000000000000000aa41e94fb1170083d0891198835838d, 0xb4e21bd586b064a86350d8f87a162ddf82ccaec107a31c446706afc9692152f9);
        if (index == 116) return (0x0000000000000000000000000000000016d5e03b23ffb34140213d869864140f, 0x06c4ce77491858e5bab394e587756d853a0442ec1861082d838b240308289659, 0x00000000000000000000000000000000163b11ddb353b4ea6205ffe013fa76dd, 0x5752ad4fe5a26218113e0845ea8fd3cd6be035dbcc7c629560f0ae7cfe191da9);
        if (index == 117) return (0x0000000000000000000000000000000018994aab24a0c2a63b676e666895baed, 0x7210fecb6a3b224ae45cd4cf68964d4bb2202e91cd2ac9fff832186c7ff17df6, 0x000000000000000000000000000000000f93a20f62b5b16e6643db3bc3e9ce17, 0x1adac75d4b67ed4f328786397abab731085d95cc17fd2125a0617f72395c2dd3);
        if (index == 118) return (0x000000000000000000000000000000001177b37236bbe2c8d6e1001aa8fa5980, 0xd7fcf0ab23c66b6a81451bf5d7a0c1805f24a832052e5df02a2d19c621b7ca0f, 0x000000000000000000000000000000000bd4370ccb5f63de107bb4d20f6723aa, 0x104b66ff8c0e1189f2ae43f56532ddd92a306b08ace02a8a8c2949b28df40447);
        if (index == 119) return (0x00000000000000000000000000000000046b978483c037b9628f91565967c3a0, 0xbb61ec9e8e0b0df1a6b3381bfbc3fa38c857e3b275a234add9a238d07a85aa5b, 0x0000000000000000000000000000000006bd3ba3bd69af118975157d27f70415, 0xc0348765d34277cc956e3dba5579e5ada5dcff46da37665c3e5a6d8d87bcafed);
        if (index == 120) return (0x000000000000000000000000000000000ffe4b06e71c80f5cd281e3d57645512, 0xaef1ae78b71ce05b5fcab6e8473bf2bb6a850e44f8869698bc9017b0ac0eff61, 0x00000000000000000000000000000000187a5f339c988973ba19985d527b4329, 0x0670b7e5a25c451d6732f952912daef1a38451b3286159b32873231c6e114a9c);
        if (index == 121) return (0x00000000000000000000000000000000139464383efc1221e031b91d493e065f, 0xd42cda54c6c659ce5da78708d2f762e18d36127db60db9cb5c571efe3d81b24f, 0x0000000000000000000000000000000019591df8dcf357838a9eadf118d56349, 0xc10406e9ed921dc3c9a15c6864e0f7145b4ac2aa0941a4c9e35296c24a8b528b);
        if (index == 122) return (0x00000000000000000000000000000000022fa5f14e81f9f5bd42b0f5c0c5d0a9, 0x1b3453b42b7516b28b05188e6a516f8f8e0440cf0d2d8cced95dd23711139d08, 0x000000000000000000000000000000001362e12f8822f0f2e99577ae459def2a, 0x95e996c5779d880daf84d0325e8a7c002a8837b0682459fe69bb469fc42950df);
        if (index == 123) return (0x0000000000000000000000000000000012f6c61543da35ac9c84a3fe63e013b0, 0x41d2453f3c2abad18912e2e379ef809b571709e07ebccffadbd7808b287179b8, 0x000000000000000000000000000000000a0399b298cd7af4cc3d2a9e46c30c2e, 0x74f9f3d8d1b72bb77863613a836a4f51944f11340f705d2387ebd823eb69e5eb);
        if (index == 124) return (0x000000000000000000000000000000000ee3261b3a13143e1bcb919aaf2f9111, 0x1250377b36160a76589f0e067a6e41345d7344ea6422187dc330e53a4c26592c, 0x000000000000000000000000000000000496a6340635602b1e193b628528bfc9, 0xa79fb8200259e3021b7f844810e421010b047a01bc5c60a9126bc3653b7d1bd2);
        if (index == 125) return (0x000000000000000000000000000000001372f71dd5fda55ce3ed4305aa2f4c4f, 0x1b7f4b5802c23fe57b09d808c581c7165341ca05944baaa6c4d036e8c4b06461, 0x0000000000000000000000000000000019ef4373f16bb4eec7fb75660677bf24, 0xf87711c0aa7295bb7e45aeda9540b07727ddb062f60dcb815649bf7855750899);
        if (index == 126) return (0x00000000000000000000000000000000180eae01bbf4725f396c52cd21565e76, 0xc2766ed949b9a1ddb8217bda298ca5ea31afceea4956336acea45431219da030, 0x0000000000000000000000000000000001943e3807b1305e82f1fa1ca53a203c, 0xc4c3f71304cb840a352ec774ebf147c238e9d6dde680839f277d396f879148b4);
        if (index == 127) return (0x0000000000000000000000000000000005ad4f0435427c8fb679309638258b40, 0x674b926605026c9eb0449bd38d9524b982159d50d83f10ca845478e8ccec89b8, 0x0000000000000000000000000000000018710da950e8d7e1a4f1d83a8a266ded, 0x4aed9e6232612f9719a72b98771e032d6683a15e2edd922397adce1f3c53e74a);
        if (index == 128) return (0x00000000000000000000000000000000043cb244c273b4d39c7dda9efd7e7dc0, 0x72f73aa168b3176a0f03646044d2b982215c6fdb5a2eafe7231ca0e41a36f43b, 0x0000000000000000000000000000000015f94975fb78a1385abc50a30281e5a2, 0x18d9c42e2ff88ee4abb38211336915020194118f0c4b983bf0f7746c87007643);
        if (index == 129) return (0x0000000000000000000000000000000014ccd616e29665a3073de21b343f3ac4, 0xce6cea2ca78ae38f4e57f4f3c71ea3bdc799870a4685044496c8b01278ba229a, 0x000000000000000000000000000000000dcbcd13a509754a378560219ac98eec, 0x24a05500156a0e32c5ad6505fc2576c17ab34cedbf15c441dadb8ee7b03f2e3f);
        if (index == 130) return (0x00000000000000000000000000000000010bc6854534944cb95a30f688bce471, 0x85fe7772dedb0a149b02085ecee2472a7e37b8457027a72104a437ce94682896, 0x0000000000000000000000000000000010153ce243f040827640859073a8f321, 0xc28c8717890e7a136095d04ebfbcfc58956b8a55dc5c6ea5219a63e05bf8d269);
        revert("Invalid IC index for IC2");
    }
}



================================================
FILE: groth16/verifier/src/Groth16Verifier16Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/

pragma solidity >=0.7.0 <0.9.0;

contract Groth16Verifier16Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 constant alphax_PART1 = 0x0000000000000000000000000000000019df117428d6209b35175c2f17efafe4;
    uint256 constant alphax_PART2 = 0xe450152a225c773f71256fd0b6cb00b6361afac3ca588df0ca43d1c523062d63;
    uint256 constant alphay_PART1 = 0x00000000000000000000000000000000014abb7d34799248932222e650bfa336;
    uint256 constant alphay_PART2 = 0xee7524a6cbf0e52efbd93a779c4374d80a6339c6f97c4d2c0bda733daa549838;
    uint256 constant betax1_PART1 = 0x0000000000000000000000000000000012646561fabc56a886f1d90cef4038d1;
    uint256 constant betax1_PART2 = 0x30051a9549614a0b507f7669679658ce59ef2ebbf1bcb348f63205ad7f3aaf0e;
    uint256 constant betax2_PART1 = 0x00000000000000000000000000000000061eef3f522852aa16a76287334ac1b7;
    uint256 constant betax2_PART2 = 0xb692587a5f5e0077e861626084a351f7ec76e25f330cbf53d8c6cfef10dacd0c;
    uint256 constant betay1_PART1 = 0x0000000000000000000000000000000018724e57498c87b761e361e5df060703;
    uint256 constant betay1_PART2 = 0xe4147c3cba9fd694a29c8ffe02712eb9db274fd1d847c867cd5e071a8e36c6a3;
    uint256 constant betay2_PART1 = 0x000000000000000000000000000000000a767683c4e1592eaa00783291289fa4;
    uint256 constant betay2_PART2 = 0x3371ea0d895d18364a737c5559a7a82734a1913c12f9d92295dd246976996818;
    uint256 constant gammax1_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax1_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammax2_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax2_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay1_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay2_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;

    uint256 constant deltax2_PART1 = 0x000000000000000000000000000000000d570fb7ea4577cfd8b7e4c570a05571;
    uint256 constant deltax2_PART2 = 0x19a1a67a0550d09759c0b3916c9eeed17b3bbfad5de8a9980481575f67b12754;
    uint256 constant deltax1_PART1 = 0x000000000000000000000000000000000284bcbcfe2cc1c07cbca6b2ea428056;
    uint256 constant deltax1_PART2 = 0x425f8aa1f197f305a5efde3840ab85c42e1154709a78a8580e557a8647d5104e;
    uint256 constant deltay2_PART1 = 0x0000000000000000000000000000000018e05348bf04fefbe97f4ddc87f560fc;
    uint256 constant deltay2_PART2 = 0x702cf9197803951e5ff52c114c773607ea1720660e830e656d8dc95c8d90b45d;
    uint256 constant deltay1_PART1 = 0x000000000000000000000000000000000372bb20e14213b5e2c0058063b7a42a;
    uint256 constant deltay1_PART2 = 0xd2e7645aef948fe3bb1132de6ec3c9e3ee0d77d7e7defd8ad71b3a809a50170d;

    // IC Points - split into PART1/PART2 for BLS12-381 format

    uint256 constant IC0x_PART1 = 0x000000000000000000000000000000000c5b9587dbdb202411ce7024a82af7c4;
    uint256 constant IC0x_PART2 = 0x6d92127f4d7e7f6046a77da8ee5eaaeadf6df45d92f9b98446a41cf7e7a55a1d;
    uint256 constant IC0y_PART1 = 0x0000000000000000000000000000000000bd748077228d54d9efa03a16dcbf3f;
    uint256 constant IC0y_PART2 = 0x54b7a89deb3f2755db122df64251be468e5746616382a0e8b3c68065e2099f94;
    //
    uint256 constant IC1x_PART1 = 0x0000000000000000000000000000000010a05855e58fabeb9776e5541183e563;
    uint256 constant IC1x_PART2 = 0x471b896aa44bfd06c9d7a66f9234a2027ab5d535583064f5b00cd18de8e48f8e;
    uint256 constant IC1y_PART1 = 0x000000000000000000000000000000000026341f29b7b91d5e55050c36c1b70f;
    uint256 constant IC1y_PART2 = 0x4ca6649719ef621f7e689254db2ffb13e95136d4ada43f5c5bfc242c77f3867c;

    uint256 constant IC2x_PART1 = 0x000000000000000000000000000000001663fd13d308a0acb443939c06f51fdb;
    uint256 constant IC2x_PART2 = 0xbfde651a8fc153611a24a92b420496af268a835d027a3d38e896d92e57116e0a;
    uint256 constant IC2y_PART1 = 0x0000000000000000000000000000000012fa2282bb1e5e0fb531e53243ed8ac8;
    uint256 constant IC2y_PART2 = 0xdfd9763102a0722fb3aad2ae16d04190920bcf4f50a96cbb57bebc64069c880b;

    uint256 constant IC3x_PART1 = 0x000000000000000000000000000000000085712075ff3413f4085a97d65abde8;
    uint256 constant IC3x_PART2 = 0xa70399a19c36b2c97a34af6b3b78aaab0060f4bda838a5972d132d5f23dec951;
    uint256 constant IC3y_PART1 = 0x0000000000000000000000000000000013e0ac0add23e0426da5290d8dceb8aa;
    uint256 constant IC3y_PART2 = 0x3330f206bf4fa00b35206ef41564937ab901606f5c8cdbb5d9b94fbc91d1d450;

    uint256 constant IC4x_PART1 = 0x000000000000000000000000000000000d3704d1fa439474d84c1d8bc1e0f79b;
    uint256 constant IC4x_PART2 = 0x1619987380009dd7d940f0b5a78f9d85e21ac178f2f422f6cf00c59e5aa78022;
    uint256 constant IC4y_PART1 = 0x000000000000000000000000000000000610bef9a78c800b8ffcc7751e78d913;
    uint256 constant IC4y_PART2 = 0x56f993157355c81617599a1923f934b9d376d80452ec71504ca6fd631239c9c3;

    uint256 constant IC5x_PART1 = 0x0000000000000000000000000000000010b4bfc5bdc3ac7d7d774814c5b8469b;
    uint256 constant IC5x_PART2 = 0x4d3aaf6eb15350bfe056adfca088e37040352555fe96877cf27f62a608ccdd12;
    uint256 constant IC5y_PART1 = 0x0000000000000000000000000000000002b2393b2147ae2240e8e6642a757e39;
    uint256 constant IC5y_PART2 = 0x2165512d5f45cf1645f547c7fec34346c014160fb5c01c36014ad58ab3778ad3;

    uint256 constant IC6x_PART1 = 0x000000000000000000000000000000000f22f37781890ab295e7673b4e1a9d09;
    uint256 constant IC6x_PART2 = 0xd8bdaa0692363f2b89fd4e84fd2db0cf45f8f72b83160e92067f3eee50d3bfa2;
    uint256 constant IC6y_PART1 = 0x000000000000000000000000000000000b98908daeacdf0a62601b044e6f8e70;
    uint256 constant IC6y_PART2 = 0x654fb02840e93344784620c4c0577da1e4de0fe493871177d70a49227c76b13b;

    uint256 constant IC7x_PART1 = 0x000000000000000000000000000000001196218f50c4cb8f11dcb4fb98139f8c;
    uint256 constant IC7x_PART2 = 0xa47d27573247cebec3c28cd70001d1e59b2b9bb173ff5288966be642ec94631b;
    uint256 constant IC7y_PART1 = 0x00000000000000000000000000000000114fdd622d665e29975099b0043ce2e4;
    uint256 constant IC7y_PART2 = 0x3c12d90ee3cd8da750711f680b899d7a79b0602a677242986ec5b2f13d6a53d4;

    uint256 constant IC8x_PART1 = 0x000000000000000000000000000000000ea54065c55f7bf279694e95512be477;
    uint256 constant IC8x_PART2 = 0xd42ac0c90e444aabea2ce4be63dcd3d7b6d74af1c3f3d475fb9ff4b6e2b0be1b;
    uint256 constant IC8y_PART1 = 0x0000000000000000000000000000000010bc256c25861d88330e1e42b159e35a;
    uint256 constant IC8y_PART2 = 0x3f9ac38fb4d0e181d1ab392679d5749dc7e572affebdfbddb8ed2ea7427c7472;

    uint256 constant IC9x_PART1 = 0x000000000000000000000000000000000f38207d2f851d124bd28789dd5f464d;
    uint256 constant IC9x_PART2 = 0xeb1cfd18dbb2a07a17688fa3e24818270acca6d3da35f17948678521712e9c9e;
    uint256 constant IC9y_PART1 = 0x000000000000000000000000000000000d304d17c4fefd7a78667936a7bdd8e8;
    uint256 constant IC9y_PART2 = 0x2a9d0b23c683a5122e7683ec358db5944df9803f8ea1c5f480174db92130ed19;

    uint256 constant IC10x_PART1 = 0x00000000000000000000000000000000035b25e53d6cbf45f1a2664ed0c71ac3;
    uint256 constant IC10x_PART2 = 0x74e30da61fe0a5ab3a0134bb231a2731dfdc0386bafc18c1b3674632286abeca;
    uint256 constant IC10y_PART1 = 0x000000000000000000000000000000001424477479442e64529947ffeb2fe8df;
    uint256 constant IC10y_PART2 = 0x40543006d0c9bd1a92a6f7e12bdceb14268ab38721fd95d369492fbab0c29454;

    uint256 constant IC11x_PART1 = 0x0000000000000000000000000000000013c71df95f24911eb7f51b5fa34f8c90;
    uint256 constant IC11x_PART2 = 0x8cd0087f98ae589f3694e7372c409b105692b2a3c6936ea130445b2f50087d26;
    uint256 constant IC11y_PART1 = 0x000000000000000000000000000000000c4c1fa9967cce79e206aa02288dc36d;
    uint256 constant IC11y_PART2 = 0x52aa078b49b3b20f9b698bf86c0cc82cf10c4cd41c8312659c743338c912d239;

    uint256 constant IC12x_PART1 = 0x00000000000000000000000000000000178d40f5ebd7ba5b91aa83631972f29a;
    uint256 constant IC12x_PART2 = 0x8f582ac5cb6a088842722d3e570f90997b6a5797a80c2513f5a43799bfeac762;
    uint256 constant IC12y_PART1 = 0x0000000000000000000000000000000017693f44442a213006b943c4435cbb74;
    uint256 constant IC12y_PART2 = 0x47700d698774e0b10720abc52dc49b89a458c801e5a24456ff5ce39ba1c05c32;

    uint256 constant IC13x_PART1 = 0x000000000000000000000000000000000309dd8b492f5e639141651605b7d682;
    uint256 constant IC13x_PART2 = 0x911c42fba8cc073e2b494642da20a74deaef70c3e8c9bcf10b01fc2949d2c095;
    uint256 constant IC13y_PART1 = 0x00000000000000000000000000000000189bbf018b62a9e37146e52b56371ac9;
    uint256 constant IC13y_PART2 = 0xd5bdd79236dd91be31bf6be48039fbaaa12404a8617c9e538ddd7fdb6f24d6ec;

    uint256 constant IC14x_PART1 = 0x00000000000000000000000000000000016a083c0f9cd61629c56ee069f54756;
    uint256 constant IC14x_PART2 = 0x14a0bcd14255027e6cb47a6beee85d6a8db235566869871de9a9a8bead71e7e8;
    uint256 constant IC14y_PART1 = 0x00000000000000000000000000000000188f43d08f552b4b098cd3ffec057566;
    uint256 constant IC14y_PART2 = 0x2bd11ce786b4ef6ae7aa60492ce5310e62bc8bcfa645e63db6b6d553a004c836;

    uint256 constant IC15x_PART1 = 0x0000000000000000000000000000000003c29acb4a567dfbb46d9795cbe3fffe;
    uint256 constant IC15x_PART2 = 0xa51362c3168156ceb47ff8e9afe61f143dc115bc27f60a202bf82a16d0247893;
    uint256 constant IC15y_PART1 = 0x0000000000000000000000000000000016ae85892b291d50453327749795d6df;
    uint256 constant IC15y_PART2 = 0xb1d690d9d205c0c7ad70a648d114c9c492e63b8fc7bc07b7435f426d1395aaf5;

    uint256 constant IC16x_PART1 = 0x000000000000000000000000000000001570b666f18e238a570df52ea73d695f;
    uint256 constant IC16x_PART2 = 0xc505014ac52f11251cbf2e9f06e4d05cb6d427e521e2436cc8a236d9751e7c23;
    uint256 constant IC16y_PART1 = 0x00000000000000000000000000000000104104348625ac6743ddc9e7835cf104;
    uint256 constant IC16y_PART2 = 0x207fe65336e94a734682e47f8cb7da2ea3cfbcd34a8c4df7090174174ced9960;

    uint256 constant IC17x_PART1 = 0x0000000000000000000000000000000005106c27aad2d795846882895772c82b;
    uint256 constant IC17x_PART2 = 0x3e31a05c25aa46e8edbb09d46112102e89f86d6e5e5cea769d9b16796a1bfe10;
    uint256 constant IC17y_PART1 = 0x0000000000000000000000000000000011382243f5e9b76da06a6259ebe55328;
    uint256 constant IC17y_PART2 = 0x15f61f111ab9cdb5c5e4d4b38f9e00645a33f2e45359d1e1ae29e0e9064aa041;

    uint256 constant IC18x_PART1 = 0x000000000000000000000000000000000799f4421039525f8b9c8eafec14e76a;
    uint256 constant IC18x_PART2 = 0xb3ce22411742878b04922bda532f68b0dd0f7be214a0bd7199be48735f27a4b8;
    uint256 constant IC18y_PART1 = 0x000000000000000000000000000000000c2654dc6ff9083578e151f3e44f32e0;
    uint256 constant IC18y_PART2 = 0xc80f49f809f53a6a0b8b92965a9bf4c47948d1610198cfd20bd0d99d5b9949d1;

    uint256 constant IC19x_PART1 = 0x000000000000000000000000000000000b785757f4600e6b43d906717d01f1ee;
    uint256 constant IC19x_PART2 = 0x3c17df668d103399856ebabfedc7274a01011ef567f159f3bb7e5ba1ac2c6fa5;
    uint256 constant IC19y_PART1 = 0x00000000000000000000000000000000001aea0f4d7d8d4f65f720e3bde41b1b;
    uint256 constant IC19y_PART2 = 0xc402e1a562f7aeb443f58c8426aed7536f033b3420efeb11d649fafd5e75fe29;

    uint256 constant IC20x_PART1 = 0x000000000000000000000000000000000ea5f4f26a548598383fda3fc379b834;
    uint256 constant IC20x_PART2 = 0x43e203748b2f9e7915b1d9a99ff190a3d184878a913a3b550bb016de0de70914;
    uint256 constant IC20y_PART1 = 0x0000000000000000000000000000000008504d56ea5c797d1ab0ac4e88ed984d;
    uint256 constant IC20y_PART2 = 0xf5acf3c857249d8af97dce6a1280cf935896e0a4f1030d1529dabc96b1a82cc6;

    uint256 constant IC21x_PART1 = 0x0000000000000000000000000000000001178be2273a47d5a87b657cdad786f2;
    uint256 constant IC21x_PART2 = 0x1351a4449617e9869173b4aea9d9cd8d873b0a691e9625435be1debf872ce385;
    uint256 constant IC21y_PART1 = 0x0000000000000000000000000000000006b4d869343e157b032b02190e2432ed;
    uint256 constant IC21y_PART2 = 0xb526acc1f42be4d707bfb7ae57b7d9278bb9d0f84984850cb339144bb82deaa0;

    uint256 constant IC22x_PART1 = 0x000000000000000000000000000000000f13706c09c5e8f6857fb70d217bb183;
    uint256 constant IC22x_PART2 = 0x6c3ca62e09da71b2104260a53e1b90d398a92bcef33c304281bb54dfcc72eb94;
    uint256 constant IC22y_PART1 = 0x000000000000000000000000000000000692b983b7569367382e076caf8cccbf;
    uint256 constant IC22y_PART2 = 0xad911eda16f9127b644d8b45e8e4ffb4fb3738480bbc2fb39b4cee462f49c962;

    uint256 constant IC23x_PART1 = 0x0000000000000000000000000000000009f4f09805256f443e43b40c610391ad;
    uint256 constant IC23x_PART2 = 0x1d0927172d223f54a911e6d1b63edfcd65cd54a0389e323a7ff012335d6c53d8;
    uint256 constant IC23y_PART1 = 0x00000000000000000000000000000000030677026ccdcb221981d134dcf1195e;
    uint256 constant IC23y_PART2 = 0xa26c2ebd86f07dba7ee125c69daf3108999e1c60e545faa355140e9a7837c36f;

    uint256 constant IC24x_PART1 = 0x000000000000000000000000000000000549eec6506512d8ab31f2707fdc7c7f;
    uint256 constant IC24x_PART2 = 0x976a0fe903db19679cf1e6ee70314936b1116e575b30f992002ef697b381ff7d;
    uint256 constant IC24y_PART1 = 0x00000000000000000000000000000000076d2f331795dfdabbc11352d8d3ce60;
    uint256 constant IC24y_PART2 = 0x4906b3fa1d63d9d463426d5be2979be5ce3a6f7323329eebc78ba3c8113451d2;

    uint256 constant IC25x_PART1 = 0x00000000000000000000000000000000146fc7d0fbf4125b471d0637d97f4391;
    uint256 constant IC25x_PART2 = 0xe31708eeba2821e2c6a7dda56971c836d79c223c2e3a6a18de47fdc4180d44fa;
    uint256 constant IC25y_PART1 = 0x000000000000000000000000000000001517e54261488981875e720eee03bf6d;
    uint256 constant IC25y_PART2 = 0x8384e43214ff2f095d41e165e7a07ab6eb44e2590a490e4c2dbd451d2bbe000d;

    uint256 constant IC26x_PART1 = 0x000000000000000000000000000000001572757993ce8014e79d3cad3027786c;
    uint256 constant IC26x_PART2 = 0x19088afd16f9e561c2c55420620078b0c0ab693c650d5987c6db0863ab2d6cbd;
    uint256 constant IC26y_PART1 = 0x000000000000000000000000000000000605b61c14f6d294b196ccf6fb86dc75;
    uint256 constant IC26y_PART2 = 0xa80fb8c50f2ae06677d511f9347c53de5462dcc7d223a6afe723648ff14de54f;

    uint256 constant IC27x_PART1 = 0x00000000000000000000000000000000023c56c0a07fa876d51d06f00e3ab108;
    uint256 constant IC27x_PART2 = 0x5f94510e426d843d4318bab5533c377d9ec5ae3a17fe76c2a51667a8c9fc4821;
    uint256 constant IC27y_PART1 = 0x00000000000000000000000000000000020af97fe1fe874fef61a85dd737ea5b;
    uint256 constant IC27y_PART2 = 0x11a0dc903e4e06da3460c04195f48bd015de722cedcf78a7ea639d25d2c190a3;

    uint256 constant IC28x_PART1 = 0x000000000000000000000000000000001804abe8e64449fe61f8443d7d5ef0b9;
    uint256 constant IC28x_PART2 = 0xbe5f9a3a51adf73746458722ca55fe064d046c9f94c5945e812db1d0aa47b7ad;
    uint256 constant IC28y_PART1 = 0x0000000000000000000000000000000005eec3835aacb0b2335c69503a731fcc;
    uint256 constant IC28y_PART2 = 0xbadce42685aca3e8ff851eb9beb165f0bb267af3088e3c6429505cd7cbd41fc7;

    uint256 constant IC29x_PART1 = 0x000000000000000000000000000000000e57320a8d8e7a85560b7addfec48967;
    uint256 constant IC29x_PART2 = 0x874670297df5f7414dc76772149bcd666a13095901445f657139a57ff2c15976;
    uint256 constant IC29y_PART1 = 0x000000000000000000000000000000000f633c495e0ac018804d9e37a693f406;
    uint256 constant IC29y_PART2 = 0xfa53d59e0712f34c373fbb6d3d87504d1cdf8f1018b3668149c021dc5552dc77;

    uint256 constant IC30x_PART1 = 0x0000000000000000000000000000000001f8897fbeb26ecd34e7bd22aadf02b0;
    uint256 constant IC30x_PART2 = 0x3b40cd1cda9280456da7c0aee64b3927ab9b0a41133e781f179f3fbae000efde;
    uint256 constant IC30y_PART1 = 0x000000000000000000000000000000001425f9e72dceed9c2182f3311f4f95cb;
    uint256 constant IC30y_PART2 = 0xaabe04b78076f6f43ad90cda81eb7075625c21b2bb9625eddb29536badcfaa56;

    uint256 constant IC31x_PART1 = 0x00000000000000000000000000000000015e6b504766ade9e76aa07946f4d617;
    uint256 constant IC31x_PART2 = 0xce417457efa53aad3217362b926b4276a8e2019078b58f5df5bff0f9e25fad9e;
    uint256 constant IC31y_PART1 = 0x000000000000000000000000000000000104a4f63eb3d2c2c8c3273a2e7f79d4;
    uint256 constant IC31y_PART2 = 0x0e7cf24dfd7391ff99846951de562b63625844351051f28c553b9c37d713675b;

    uint256 constant IC32x_PART1 = 0x000000000000000000000000000000001760f5fb8e6648c17d421bdc0e253ba8;
    uint256 constant IC32x_PART2 = 0x73e10644849de70e8ebe892839356689e8e99527672e592abab142709426d46d;
    uint256 constant IC32y_PART1 = 0x00000000000000000000000000000000030aa2f95f6590f64f4bc558ed674372;
    uint256 constant IC32y_PART2 = 0x2b769a63e184bdf0a3f786c30ee08b3c48a031616f758705145173eff748084a;

    uint256 constant IC33x_PART1 = 0x000000000000000000000000000000000aebf4293fe911e2e9473f6be0d523fd;
    uint256 constant IC33x_PART2 = 0x734be905d8bed8d5f4d2465b7d235fd9037fe0f08f046002820e2d9a2e46725c;
    uint256 constant IC33y_PART1 = 0x000000000000000000000000000000000e41363f04b540b2ba99a4de0b05805a;
    uint256 constant IC33y_PART2 = 0xd4e17fd00c265ca9840e7b147af9cc5e5a5ffbb0c0d2274608a09898e7735836;

    uint256 constant IC34x_PART1 = 0x0000000000000000000000000000000010a4f4d7e92a409610cc2263ae78363d;
    uint256 constant IC34x_PART2 = 0x3c63debbb557d1c23827a378d33fe9bcefc78816c78d5a94e0c509a47522a4ca;
    uint256 constant IC34y_PART1 = 0x00000000000000000000000000000000168a19d2f9aa689e3f98c46dfdd5b2e4;
    uint256 constant IC34y_PART2 = 0x24c84aed3b025fd603e0dc3de3a6b421fe7fcaad71e04eb8f94c64dcec0bc706;

    uint256 constant IC35x_PART1 = 0x000000000000000000000000000000001495f19c35fe990ceebef98df375a756;
    uint256 constant IC35x_PART2 = 0x1eed35a0b2c0808955c5c9e107cc8b9a30dd6a73ba5d2ca0e1f1a87417a5c4c2;
    uint256 constant IC35y_PART1 = 0x0000000000000000000000000000000008ea5279e086b6ed8bf16caa5670ea7d;
    uint256 constant IC35y_PART2 = 0x28b12ecc662fa022bcf892778f4c8e459b3f4611f63c6eea0abfb7f8279d86cc;

    // Memory data
    uint16 constant pVk = 0;
    uint16 constant pPairing = 128;

    uint16 constant pLastMem = 1664;

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[35] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            function checkField(v) {
                if iszero(lt(v, R_MOD)) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Initialize vk_x with IC0 (the constant term)
                mstore(_pVk, IC0x_PART1)
                mstore(add(_pVk, 32), IC0x_PART2)
                mstore(add(_pVk, 64), IC0y_PART1)
                mstore(add(_pVk, 96), IC0y_PART2)

                // Compute the linear combination vk_x = IC0 + IC1*pubSignals[0] + IC2*pubSignals[1] + ...

                g1_mulAccC(_pVk, IC1x_PART1, IC1x_PART2, IC1y_PART1, IC1y_PART2, calldataload(add(pubSignals, 0)))

                g1_mulAccC(_pVk, IC2x_PART1, IC2x_PART2, IC2y_PART1, IC2y_PART2, calldataload(add(pubSignals, 32)))

                g1_mulAccC(_pVk, IC3x_PART1, IC3x_PART2, IC3y_PART1, IC3y_PART2, calldataload(add(pubSignals, 64)))

                g1_mulAccC(_pVk, IC4x_PART1, IC4x_PART2, IC4y_PART1, IC4y_PART2, calldataload(add(pubSignals, 96)))

                g1_mulAccC(_pVk, IC5x_PART1, IC5x_PART2, IC5y_PART1, IC5y_PART2, calldataload(add(pubSignals, 128)))

                g1_mulAccC(_pVk, IC6x_PART1, IC6x_PART2, IC6y_PART1, IC6y_PART2, calldataload(add(pubSignals, 160)))

                g1_mulAccC(_pVk, IC7x_PART1, IC7x_PART2, IC7y_PART1, IC7y_PART2, calldataload(add(pubSignals, 192)))

                g1_mulAccC(_pVk, IC8x_PART1, IC8x_PART2, IC8y_PART1, IC8y_PART2, calldataload(add(pubSignals, 224)))

                g1_mulAccC(_pVk, IC9x_PART1, IC9x_PART2, IC9y_PART1, IC9y_PART2, calldataload(add(pubSignals, 256)))

                g1_mulAccC(_pVk, IC10x_PART1, IC10x_PART2, IC10y_PART1, IC10y_PART2, calldataload(add(pubSignals, 288)))

                g1_mulAccC(_pVk, IC11x_PART1, IC11x_PART2, IC11y_PART1, IC11y_PART2, calldataload(add(pubSignals, 320)))

                g1_mulAccC(_pVk, IC12x_PART1, IC12x_PART2, IC12y_PART1, IC12y_PART2, calldataload(add(pubSignals, 352)))

                g1_mulAccC(_pVk, IC13x_PART1, IC13x_PART2, IC13y_PART1, IC13y_PART2, calldataload(add(pubSignals, 384)))

                g1_mulAccC(_pVk, IC14x_PART1, IC14x_PART2, IC14y_PART1, IC14y_PART2, calldataload(add(pubSignals, 416)))

                g1_mulAccC(_pVk, IC15x_PART1, IC15x_PART2, IC15y_PART1, IC15y_PART2, calldataload(add(pubSignals, 448)))

                g1_mulAccC(_pVk, IC16x_PART1, IC16x_PART2, IC16y_PART1, IC16y_PART2, calldataload(add(pubSignals, 480)))

                g1_mulAccC(_pVk, IC17x_PART1, IC17x_PART2, IC17y_PART1, IC17y_PART2, calldataload(add(pubSignals, 512)))

                g1_mulAccC(_pVk, IC18x_PART1, IC18x_PART2, IC18y_PART1, IC18y_PART2, calldataload(add(pubSignals, 544)))

                g1_mulAccC(_pVk, IC19x_PART1, IC19x_PART2, IC19y_PART1, IC19y_PART2, calldataload(add(pubSignals, 576)))

                g1_mulAccC(_pVk, IC20x_PART1, IC20x_PART2, IC20y_PART1, IC20y_PART2, calldataload(add(pubSignals, 608)))

                g1_mulAccC(_pVk, IC21x_PART1, IC21x_PART2, IC21y_PART1, IC21y_PART2, calldataload(add(pubSignals, 640)))

                g1_mulAccC(_pVk, IC22x_PART1, IC22x_PART2, IC22y_PART1, IC22y_PART2, calldataload(add(pubSignals, 672)))

                g1_mulAccC(_pVk, IC23x_PART1, IC23x_PART2, IC23y_PART1, IC23y_PART2, calldataload(add(pubSignals, 704)))

                g1_mulAccC(_pVk, IC24x_PART1, IC24x_PART2, IC24y_PART1, IC24y_PART2, calldataload(add(pubSignals, 736)))

                g1_mulAccC(_pVk, IC25x_PART1, IC25x_PART2, IC25y_PART1, IC25y_PART2, calldataload(add(pubSignals, 768)))

                g1_mulAccC(_pVk, IC26x_PART1, IC26x_PART2, IC26y_PART1, IC26y_PART2, calldataload(add(pubSignals, 800)))

                g1_mulAccC(_pVk, IC27x_PART1, IC27x_PART2, IC27y_PART1, IC27y_PART2, calldataload(add(pubSignals, 832)))

                g1_mulAccC(_pVk, IC28x_PART1, IC28x_PART2, IC28y_PART1, IC28y_PART2, calldataload(add(pubSignals, 864)))

                g1_mulAccC(_pVk, IC29x_PART1, IC29x_PART2, IC29y_PART1, IC29y_PART2, calldataload(add(pubSignals, 896)))

                g1_mulAccC(_pVk, IC30x_PART1, IC30x_PART2, IC30y_PART1, IC30y_PART2, calldataload(add(pubSignals, 928)))

                g1_mulAccC(_pVk, IC31x_PART1, IC31x_PART2, IC31y_PART1, IC31y_PART2, calldataload(add(pubSignals, 960)))

                g1_mulAccC(_pVk, IC32x_PART1, IC32x_PART2, IC32y_PART1, IC32y_PART2, calldataload(add(pubSignals, 992)))

                g1_mulAccC(
                    _pVk, IC33x_PART1, IC33x_PART2, IC33y_PART1, IC33y_PART2, calldataload(add(pubSignals, 1024))
                )

                g1_mulAccC(_pVk, IC34x_PART1, IC34x_PART2, IC34y_PART1, IC34y_PART2, calldataload(add(pubSignals, 1056)))

                g1_mulAccC(_pVk, IC35x_PART1, IC35x_PART2, IC35y_PART1, IC35y_PART2, calldataload(add(pubSignals, 1088)))

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default {
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 544), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 576), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 608), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 640), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 672), betay1_PART2) // y0_PART2
                mstore(add(_pPairing, 704), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 736), betay2_PART2) // y1_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1312), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1344), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1376), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1408), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1440), deltay1_PART2) // y0_PART2
                mstore(add(_pPairing, 1472), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1504), deltay2_PART2) // y1_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate that all evaluations âˆˆ F

            checkField(calldataload(add(_pubSignals, 0)))

            checkField(calldataload(add(_pubSignals, 32)))

            checkField(calldataload(add(_pubSignals, 64)))

            checkField(calldataload(add(_pubSignals, 96)))

            checkField(calldataload(add(_pubSignals, 128)))

            checkField(calldataload(add(_pubSignals, 160)))

            checkField(calldataload(add(_pubSignals, 192)))

            checkField(calldataload(add(_pubSignals, 224)))

            checkField(calldataload(add(_pubSignals, 256)))

            checkField(calldataload(add(_pubSignals, 288)))

            checkField(calldataload(add(_pubSignals, 320)))

            checkField(calldataload(add(_pubSignals, 352)))

            checkField(calldataload(add(_pubSignals, 384)))

            checkField(calldataload(add(_pubSignals, 416)))

            checkField(calldataload(add(_pubSignals, 448)))

            checkField(calldataload(add(_pubSignals, 480)))

            checkField(calldataload(add(_pubSignals, 512)))

            checkField(calldataload(add(_pubSignals, 544)))

            checkField(calldataload(add(_pubSignals, 576)))

            checkField(calldataload(add(_pubSignals, 608)))

            checkField(calldataload(add(_pubSignals, 640)))

            checkField(calldataload(add(_pubSignals, 672)))

            checkField(calldataload(add(_pubSignals, 704)))

            checkField(calldataload(add(_pubSignals, 736)))

            checkField(calldataload(add(_pubSignals, 768)))

            checkField(calldataload(add(_pubSignals, 800)))

            checkField(calldataload(add(_pubSignals, 832)))

            checkField(calldataload(add(_pubSignals, 864)))

            checkField(calldataload(add(_pubSignals, 896)))

            checkField(calldataload(add(_pubSignals, 928)))

            checkField(calldataload(add(_pubSignals, 960)))

            checkField(calldataload(add(_pubSignals, 992)))

            checkField(calldataload(add(_pubSignals, 1024)))

            checkField(calldataload(add(_pubSignals, 1056)))

            checkField(calldataload(add(_pubSignals, 1088)))

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}



================================================
FILE: groth16/verifier/src/Groth16Verifier32Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/

pragma solidity >=0.7.0 <0.9.0;

contract Groth16Verifier32Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 constant alphax_PART1 = 0x000000000000000000000000000000000041aec82900960a8f89d297b8361c46;
    uint256 constant alphax_PART2 = 0x965d3d9b8a5d0f58c2cf30e3e76777f7ecc18a58789ae4e61a959f9ce352f11b;
    uint256 constant alphay_PART1 = 0x0000000000000000000000000000000011b89c42e2c64df0886f20ef133a73b7;
    uint256 constant alphay_PART2 = 0xe7f1324a8309139ca841b5895b838f73ed2275d7661b68a75f58377551a8b913;
    uint256 constant betax1_PART1 = 0x00000000000000000000000000000000170d37a68234c1a86d9567dc33b985fe;
    uint256 constant betax1_PART2 = 0xd262eb743f24162f9d4c72058789589b6983bdf056ae1a083c16169432941283;
    uint256 constant betax2_PART1 = 0x00000000000000000000000000000000159077a549d9092da3d9085f0e86a6f7;
    uint256 constant betax2_PART2 = 0xdbeee4986e8428ca1d1455518651c51ee171af97852f6c4c43f22fb748fac3c2;
    uint256 constant betay1_PART1 = 0x000000000000000000000000000000001009966cbaef70dda75304685c942598;
    uint256 constant betay1_PART2 = 0x80f492b2b0b0dc28a137b6bf184456054053bb9bac889103d80858f764eccfde;
    uint256 constant betay2_PART1 = 0x000000000000000000000000000000000de4adbd44f0bfd56fb04dfd0cdcccb7;
    uint256 constant betay2_PART2 = 0x54fd77c317e4a78c742f2ef2773633b9072e8d00615d014f2b99fd8e7376a201;
    uint256 constant gammax1_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax1_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammax2_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax2_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay1_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay2_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;
    uint256 constant deltax1_PART1 = 0x000000000000000000000000000000001911079b0192d1512bee7038ffdbb2fe;
    uint256 constant deltax1_PART2 = 0x732440ccf97e107311adb0aa9b95cfe5153287fe0c4c9a234f67d6958e82de76;
    uint256 constant deltax2_PART1 = 0x000000000000000000000000000000000cd5f74aff7e2096aac04bf9faa546ff;
    uint256 constant deltax2_PART2 = 0x546bfa46533b8ba43cee10193901da194fd6a13b4dbf5c61ce139bb9ee33dfc3;
    uint256 constant deltay1_PART1 = 0x00000000000000000000000000000000145666bec14bce2cbe06ba1048690f93;
    uint256 constant deltay1_PART2 = 0xe9583a4bae1da429949e5ac6480ed0fdc7371daf0e1ea2f2b749384bcbf64e22;
    uint256 constant deltay2_PART1 = 0x0000000000000000000000000000000008d7ee8ad4f4c21187c89881512d93cd;
    uint256 constant deltay2_PART2 = 0xf16c7136f419c1a5742be2698d141acec91d449f9d0cb6330aedbf88164a0e7c;

    // IC Points - split into PART1/PART2 for BLS12-381 format

    uint256 constant IC0x_PART1 = 0x000000000000000000000000000000000ad5d8160a07a5ddc320e05d7866d1aa;
    uint256 constant IC0x_PART2 = 0xb8c394bffd2290985d7d03bb33ec66c22c36c993f0680e90cbe3f74fa8494b4d;
    uint256 constant IC0y_PART1 = 0x0000000000000000000000000000000011becab5b5844b97448cf35c42b5b20e;
    uint256 constant IC0y_PART2 = 0x8b4bd0169af64b9e3743495087070664d6e2965cbffd5729fc0945051fcecbe7;

    uint256 constant IC1x_PART1 = 0x000000000000000000000000000000000b1e70c8455275809e7cebb2a19a0c74;
    uint256 constant IC1x_PART2 = 0x04d12468c432c13c3920d77bc7f8002751ec7a12960b67537c95984113f1c75f;
    uint256 constant IC1y_PART1 = 0x000000000000000000000000000000000b2585a051bedebfcc32ed80d8929767;
    uint256 constant IC1y_PART2 = 0xf4817cc3ec2ddc7bc163941bc45cdcb2e5411083c450c02b796c0f389a2089a2;
    uint256 constant IC2x_PART1 = 0x000000000000000000000000000000000d8a4fb8c668e6f0e8992f29ed7b38ec;
    uint256 constant IC2x_PART2 = 0x82723de3ea054ce3a20b4d6514f0b59394c642e56c87b4e370897e67463e1f99;
    uint256 constant IC2y_PART1 = 0x000000000000000000000000000000000c21a14b8568de36012883568b68b170;
    uint256 constant IC2y_PART2 = 0xb37932866c4bef79da16b3267d1987eac72a8049440f977a778cb954a2bde0d2;
    uint256 constant IC3x_PART1 = 0x0000000000000000000000000000000017444890a388432643b1f0ed8babbe39;
    uint256 constant IC3x_PART2 = 0x3a3cbb82946cb229d0a26c6e2efea41b30a330f8546416066c715dd888048384;
    uint256 constant IC3y_PART1 = 0x000000000000000000000000000000001533fd8c6ae98fcc2d7aeba88eab3406;
    uint256 constant IC3y_PART2 = 0x126d89d2dbae992fc0685ed3dfcb5ab8b2b8ca94df47470e57de7de0a56723e2;
    uint256 constant IC4x_PART1 = 0x0000000000000000000000000000000011fcc80d90a9094680dfc500e1a887f2;
    uint256 constant IC4x_PART2 = 0xbde2376425c512dd3691b413fd0fe668e0230f5099ab3d75a90eb444e378db19;
    uint256 constant IC4y_PART1 = 0x000000000000000000000000000000000d5480a80396553ddb1f648b3de0e6f2;
    uint256 constant IC4y_PART2 = 0xd76709ea6fd8d0a233c0adcd55261fa0532ac96a30940ce3ba13856da2c05113;
    uint256 constant IC5x_PART1 = 0x0000000000000000000000000000000009f8f2da8c5f17725ab7efcf4395bbee;
    uint256 constant IC5x_PART2 = 0x0fdea5e6a06e2e4b8b51c27d599b8615cc5a70cc3814b6f5c49ad2b14d9ffaa3;
    uint256 constant IC5y_PART1 = 0x000000000000000000000000000000000a82e5317d260d528e869cca2f6d24fb;
    uint256 constant IC5y_PART2 = 0x31421ee017f51a1dd62ac5cf8e8d189947e94fe130dd97a25f6caba001d115d7;
    uint256 constant IC6x_PART1 = 0x00000000000000000000000000000000022a5c854213dcf4ad4b8e5d60591a37;
    uint256 constant IC6x_PART2 = 0x3b8ebe28a93099bffcae2bfb71ff0e32478ab8ffbe78e7eeb913dc80d552066f;
    uint256 constant IC6y_PART1 = 0x00000000000000000000000000000000033876a920d16650a06d01910e3c273a;
    uint256 constant IC6y_PART2 = 0x7c3ec87fdc036429d83e290fdb93677eeb81b5398f2b6cd0680dae951a374cc9;
    uint256 constant IC7x_PART1 = 0x0000000000000000000000000000000010916fa8846e5105b3b8c6c76a2adc24;
    uint256 constant IC7x_PART2 = 0x4b2d32b9b59ee75935d8dba9c3418516c00e3f16e988a0d93252aab39a5ef0eb;
    uint256 constant IC7y_PART1 = 0x000000000000000000000000000000000c36c585a8144f4b30b2b303342d2d2a;
    uint256 constant IC7y_PART2 = 0x51a61a7ef8cfc42366c509ac7148c9f47a835d62a790c561c26b75dc83103c8d;
    uint256 constant IC8x_PART1 = 0x000000000000000000000000000000001847907e62098ebd57efdc0617c30910;
    uint256 constant IC8x_PART2 = 0xd91b2dc6f21f378c5f6f9e40b79a423c04ab27f028b2623f1eeaeecd3c4c4dda;
    uint256 constant IC8y_PART1 = 0x00000000000000000000000000000000198c618d35a1089340fb7a54f3faf173;
    uint256 constant IC8y_PART2 = 0x2e57c920638bdee89879d11321749ea272d35df3aedcbeaef2ef444848210641;
    uint256 constant IC9x_PART1 = 0x00000000000000000000000000000000191ce9be2afb052af4e7b13d4ffdb88b;
    uint256 constant IC9x_PART2 = 0x00e23d083c7d13490a629f0c445c1f25c61c8eae665687a90aa3e64ba7c74d83;
    uint256 constant IC9y_PART1 = 0x00000000000000000000000000000000108bbc0aeb266076dc1c7c1075b27b27;
    uint256 constant IC9y_PART2 = 0x476d007daac34ceea86827934d53cf17918d1895d0ac8cbc54ba04cd5f56fefa;
    uint256 constant IC10x_PART1 = 0x00000000000000000000000000000000046bcf5edc446843f5bd79ac92b8ac3b;
    uint256 constant IC10x_PART2 = 0xd9347dfbe8e8c74b63bc3844d09619adb6f1da7ae4fa85c7df7df2c4cbdb8bd3;
    uint256 constant IC10y_PART1 = 0x0000000000000000000000000000000008768fba2208b04ff47cdacbd94912d1;
    uint256 constant IC10y_PART2 = 0xe1889a3bbb1e9b42c40baca9610825a65f7cf39df010ca51386c047522cc2e89;
    uint256 constant IC11x_PART1 = 0x0000000000000000000000000000000006dcacf6f0dd4e5637726cc50c1a6161;
    uint256 constant IC11x_PART2 = 0xb672c87468ba1f9b9adb423734a575fcf3ffae40ec57a49a179ff672b81cbe35;
    uint256 constant IC11y_PART1 = 0x0000000000000000000000000000000017b1d0f81cf4deb9b9b50a6241fb7342;
    uint256 constant IC11y_PART2 = 0x2ede309c178de67bd1d43e8d39b6c78074b4f08d6d8d012bff2f99bf38489d11;
    uint256 constant IC12x_PART1 = 0x0000000000000000000000000000000013683dd4a096019c16b7bf774db7daa0;
    uint256 constant IC12x_PART2 = 0xf085320adb43a66d41d66472896b2cc23c059c151d73312dc8ed9d3d2826e60b;
    uint256 constant IC12y_PART1 = 0x000000000000000000000000000000001015df7c6ccf2f05acae882c680bb7e9;
    uint256 constant IC12y_PART2 = 0xd49e6dc436f94757a25b16e94e56cc8748f19857b3d05de1ea93acb0dbcba992;
    uint256 constant IC13x_PART1 = 0x00000000000000000000000000000000110660c35a837140ce91566b8e5c3885;
    uint256 constant IC13x_PART2 = 0xb321565846201e067d89f795be8e2e3230c4d852b71707b2418ac99cb95e5b7b;
    uint256 constant IC13y_PART1 = 0x000000000000000000000000000000001927b6261a6c80dc021902833d2812ff;
    uint256 constant IC13y_PART2 = 0x175c5a672282f7387893bc317721b6eed3dbb56db84ee371ad5a064992fbdf49;
    uint256 constant IC14x_PART1 = 0x000000000000000000000000000000000b301aa03699e068dbcc5f64c84bc610;
    uint256 constant IC14x_PART2 = 0x3e16fe0f5787c0c20f3c636df74c926195ac883f8c79d8bf394ea342f050a7f1;
    uint256 constant IC14y_PART1 = 0x000000000000000000000000000000000645173a6bc186a4d50a2a902cc4e5eb;
    uint256 constant IC14y_PART2 = 0xf8c8f04ae87a73231e8026d1c26b6b2a62c7bc050bf78e139e1dd80bb02a9d7f;
    uint256 constant IC15x_PART1 = 0x000000000000000000000000000000000d2d88c0a02f8da26d1b5feb889c8547;
    uint256 constant IC15x_PART2 = 0xfa1d8096af92b1094fecd8dc7cb6f58e0eb6d1541db9263f84f68342ced4730d;
    uint256 constant IC15y_PART1 = 0x0000000000000000000000000000000011ae6089b4922fc85a3ed69c7deb7407;
    uint256 constant IC15y_PART2 = 0x7f385801551594a9395da1c7cc413d39fbd6ff6977522681fb751a09f5199363;
    uint256 constant IC16x_PART1 = 0x000000000000000000000000000000000e297e4e7fca74177440a438605173b1;
    uint256 constant IC16x_PART2 = 0x3708d7185186bd1fa54ae82549302a417845dca69dda7ee52aa9b6dd9416db09;
    uint256 constant IC16y_PART1 = 0x0000000000000000000000000000000010491a188791c2d55c606b4c1d76d849;
    uint256 constant IC16y_PART2 = 0xe33a7a8be676bcfc0645eaa34305d654513cb15b4e35a898dbe8036d51ae4ae8;
    uint256 constant IC17x_PART1 = 0x00000000000000000000000000000000193814c43d64f769cc987a9461eea4f1;
    uint256 constant IC17x_PART2 = 0x146662d1fbf72e7f3a83e11a6011f74375f5c294c428eaa4e9304b13d07810c1;
    uint256 constant IC17y_PART1 = 0x0000000000000000000000000000000006beda62a43d4d6f1450c106ccb5b760;
    uint256 constant IC17y_PART2 = 0xc5a2f29dcafef58e0ec0da3f2c5e37f248a8b7d5e4bc309f34aab6edb45ec041;
    uint256 constant IC18x_PART1 = 0x000000000000000000000000000000000dadde7bc5a295671276fd5975963016;
    uint256 constant IC18x_PART2 = 0xef02b7318a9830afcc086675812ed38ba7571ac380da54724f5e9750b4d15ac1;
    uint256 constant IC18y_PART1 = 0x0000000000000000000000000000000006e41bbc2561dfd9c878220984287657;
    uint256 constant IC18y_PART2 = 0xdcb0219420e90fef9f1acb424b6a01ac18066ca061e513b7e6f0ac1ac18f2063;
    uint256 constant IC19x_PART1 = 0x0000000000000000000000000000000018449b1894f043b8bc083b8fa0529ae5;
    uint256 constant IC19x_PART2 = 0x390bb0d781156bd4503acaaa87eecf67761a79c3275a3dd386b6718903187374;
    uint256 constant IC19y_PART1 = 0x000000000000000000000000000000000454a0b6f84ca25e984035c21e923292;
    uint256 constant IC19y_PART2 = 0x93272713fab1b02396c0036185aad9439d00c1a24f89cd37777a9891edb25d66;
    uint256 constant IC20x_PART1 = 0x00000000000000000000000000000000128dfc40af63058790843aade597e19d;
    uint256 constant IC20x_PART2 = 0x4407975dcfc101365e1362c3773123515f5453c209f7060f5fa7405ef87ff79b;
    uint256 constant IC20y_PART1 = 0x000000000000000000000000000000000d919c298da7a38665b5de1dbe39ff78;
    uint256 constant IC20y_PART2 = 0x38338631d8fd61226986b0d451026f25eef5d2798bf85065c1d6e8f102106451;
    uint256 constant IC21x_PART1 = 0x00000000000000000000000000000000089555c1bb5888da3f04aad99a1f93e5;
    uint256 constant IC21x_PART2 = 0x0cf65cafb418ab39506be77ce39b91eb88bf81d34ab834f9edd51158c16c3d5a;
    uint256 constant IC21y_PART1 = 0x00000000000000000000000000000000007a501093c07d7378c7597374dff17b;
    uint256 constant IC21y_PART2 = 0x95b4cbdb6dd460aa8a6e0f9490cae36cb6ac16cd71232004feb86fc4cb3ca69c;
    uint256 constant IC22x_PART1 = 0x0000000000000000000000000000000004dd7437f83edab5d3ffe938b0702a39;
    uint256 constant IC22x_PART2 = 0xbf59151b2f8a02d56a3f487567433a9e6abcf214b47abb2a167b91ed639cc622;
    uint256 constant IC22y_PART1 = 0x0000000000000000000000000000000018abc5cfb4df43a839b5b25c0eca69e9;
    uint256 constant IC22y_PART2 = 0x3b4b10c182e63de1ab9343893e8fd815652970a16d91bd7cc1cefca27624890c;
    uint256 constant IC23x_PART1 = 0x000000000000000000000000000000001001fa69af72e0e230e1cda5d9e04c1e;
    uint256 constant IC23x_PART2 = 0x0c4467bddebe58c66cd9771950ff58eefbd0967297eb0b8f6cd782ce6f4a44d1;
    uint256 constant IC23y_PART1 = 0x0000000000000000000000000000000016e8a036532c893b33f5f20ce98d67bd;
    uint256 constant IC23y_PART2 = 0x03c4955644ce0bd17bdfd838f0f8a838bae3f8a6314b4bef3787b17e4c05155f;
    uint256 constant IC24x_PART1 = 0x000000000000000000000000000000000c42fbddad49c35f2a06ff6e70156e4c;
    uint256 constant IC24x_PART2 = 0x723e02b1e12300ee46513bef18ff5ba80354d7296267a1a8c3528a12c952e767;
    uint256 constant IC24y_PART1 = 0x000000000000000000000000000000000d7dddd4c17fc9eaf1a9aae7710ee2a5;
    uint256 constant IC24y_PART2 = 0x11af9e4cd06dcef5d61a04166c1d00f5f9c38e3bcf53b00aafee02d8b1626b6c;
    uint256 constant IC25x_PART1 = 0x0000000000000000000000000000000008103d86aa6b4fd1d62f2f11d5fb92e2;
    uint256 constant IC25x_PART2 = 0xcfb0ad4183e28dc4ce706013fabc19e2f0814ebd8241151032b390d8bb9892eb;
    uint256 constant IC25y_PART1 = 0x0000000000000000000000000000000003b3d976ace695c83bd6f94d41905274;
    uint256 constant IC25y_PART2 = 0x072604d6078ef796b54fbb6ac1021e661e491fe9d5053c917a43e5c3f6d962d4;
    uint256 constant IC26x_PART1 = 0x0000000000000000000000000000000019c36613943ff98ed51609d3de7063b1;
    uint256 constant IC26x_PART2 = 0x6d2a44d0d03a04d9f982cd0e441284c36e1477851944722ae2e8468cf4aebf0a;
    uint256 constant IC26y_PART1 = 0x00000000000000000000000000000000049eac00f3a96cae9225f1db05d6e23a;
    uint256 constant IC26y_PART2 = 0xbddc41cedb8d2150dbee8e002de69c9c689bbecd2a19b73612fa6fba82a39ce8;
    uint256 constant IC27x_PART1 = 0x000000000000000000000000000000001890e4b53aff600cab2c17861c0d9273;
    uint256 constant IC27x_PART2 = 0xee43c1783fe8784a9875aaeb1865c4d4a450d9909d5671c9ff1d82b562e8958e;
    uint256 constant IC27y_PART1 = 0x0000000000000000000000000000000018a5bc64efb75a6821322c00903b32f5;
    uint256 constant IC27y_PART2 = 0x215b98481eb73eb7239cb3d18b0e7ecbea9f8e1d35f1aa2fcb09f980bb46e1d8;
    uint256 constant IC28x_PART1 = 0x00000000000000000000000000000000016ad0e353bdb3f46b4990b968399c54;
    uint256 constant IC28x_PART2 = 0xad543c7fd142337f8062f29faf7c0e8c63fb7a7908fac2affeafebe8627a1224;
    uint256 constant IC28y_PART1 = 0x0000000000000000000000000000000002e94e26689ffe98173689d42b24b138;
    uint256 constant IC28y_PART2 = 0x930c71a49fac0c9ca1f3132f07ed5f5c32da88106edbd21a50f68b9b99020364;
    uint256 constant IC29x_PART1 = 0x00000000000000000000000000000000108dc0c0b61b319305053049c7b380be;
    uint256 constant IC29x_PART2 = 0x5835301fc8e49488c25625bc32f0144c8119a98647543c7af00f560b7104cde6;
    uint256 constant IC29y_PART1 = 0x000000000000000000000000000000000ebf1bb84e3f3278a38f4919f8e91281;
    uint256 constant IC29y_PART2 = 0xcba8a9261103bb64e62605c3ca661b902ad016140d6931064613546aeef9431b;
    uint256 constant IC30x_PART1 = 0x0000000000000000000000000000000006b6f1551f2b8ccced8c149fcf99a349;
    uint256 constant IC30x_PART2 = 0x0f7f84859c4e3e2c1c5098027be375f7fe61d146559f0c47515bf8d58ad859ce;
    uint256 constant IC30y_PART1 = 0x00000000000000000000000000000000056240cb2d6eee293f3ff32f4690442d;
    uint256 constant IC30y_PART2 = 0x6c1054299b1d652d8b856ab001891c00874c0e625b753447c76188a4700ac48e;
    uint256 constant IC31x_PART1 = 0x0000000000000000000000000000000008c5960762bce449109661fcc9d06250;
    uint256 constant IC31x_PART2 = 0xa2df8d9b0b3184cdbdf656b421124092c057266f19a9f098e3123a667b280658;
    uint256 constant IC31y_PART1 = 0x0000000000000000000000000000000008f9b1208709fc8dc47357a1b10cae41;
    uint256 constant IC31y_PART2 = 0xc0390ac8a1e25b1e27956fa51d480753cfbdae01254a272ee16851a0254ac6ac;
    uint256 constant IC32x_PART1 = 0x00000000000000000000000000000000089d393465500f08056026e572071d3d;
    uint256 constant IC32x_PART2 = 0xbdec4222d45ea90cd36e1d4187ed11765d7c7bf24d01511b45b54b0af480e5fa;
    uint256 constant IC32y_PART1 = 0x0000000000000000000000000000000007909b079b6212f4b500a8c1a3513be9;
    uint256 constant IC32y_PART2 = 0x867e8c73b6b2951cd180ba3822cab81e552b961e285be7e776271ad21db09fb7;
    uint256 constant IC33x_PART1 = 0x000000000000000000000000000000000527935a0c71919c4d9851d66aa919b7;
    uint256 constant IC33x_PART2 = 0x22c4400fe7aed6194fbc870c769d3438be9b425f47bdb447be7984194495fc71;
    uint256 constant IC33y_PART1 = 0x0000000000000000000000000000000002d3e8e7621aeeaf49833d6794e66c1f;
    uint256 constant IC33y_PART2 = 0xcaf739b77094a6c5616602675fae952da00030ff5d384cb2dbdfeec648c9e25a;
    uint256 constant IC34x_PART1 = 0x000000000000000000000000000000000933cb07630c5cb4516b5477de95f428;
    uint256 constant IC34x_PART2 = 0x37e8cde7cb733d796700bb0af31507709d8a6c75be28bbf51a18adb3686c91f3;
    uint256 constant IC34y_PART1 = 0x0000000000000000000000000000000015ef0c94f135ffff37c37e9fc75f058e;
    uint256 constant IC34y_PART2 = 0x8feabe57be6eec276d1b78df9a08ee40cfba31c9a8247826cf11b1caf6174024;
    uint256 constant IC35x_PART1 = 0x000000000000000000000000000000000ea9275f850269077e8f50a1903f76f1;
    uint256 constant IC35x_PART2 = 0xa4f522bc59f687fb34dcb9003abfd8f71c8b96cadb6ea05c234e5536cfc2ccb8;
    uint256 constant IC35y_PART1 = 0x000000000000000000000000000000000fdee2f8f402227df59bb9398e5cbda2;
    uint256 constant IC35y_PART2 = 0x791859a4b9d3b2127ae9a64d244c0f5e97e1bfb760323d8125a1c83c18918dc6;
    uint256 constant IC36x_PART1 = 0x0000000000000000000000000000000016352064893e1f8444e45f4dc4e552dc;
    uint256 constant IC36x_PART2 = 0xb60a50ee987bd1ac0dfee89fe97b819166f9f36bacd3c83d140fc4c2fa32e8b8;
    uint256 constant IC36y_PART1 = 0x0000000000000000000000000000000003828423519ca759bcc6b9189607108c;
    uint256 constant IC36y_PART2 = 0x2aa4640649b181c9c65f9b1c0be4d45551ee256c86feef1b5a8b9f36814a5f0d;
    uint256 constant IC37x_PART1 = 0x000000000000000000000000000000000b289478c6d9bdd67da60697c6f5cd0e;
    uint256 constant IC37x_PART2 = 0x2708ed81223910e86f20edb55055786ed536dd31ecf3aa60ffc045e311922179;
    uint256 constant IC37y_PART1 = 0x000000000000000000000000000000001483ced5105448f81d5b93c2e1ff9e8c;
    uint256 constant IC37y_PART2 = 0x97854b16e5adde18071acd6b037562666ed32afc3eafa0a8931a38db533ca5eb;
    uint256 constant IC38x_PART1 = 0x0000000000000000000000000000000019de020dd33293101decd1f4878ece07;
    uint256 constant IC38x_PART2 = 0x6025a05c43af4a6313da96ddf9c19c08653b4da881fa8c03d5fdeaac3d301c23;
    uint256 constant IC38y_PART1 = 0x0000000000000000000000000000000018dd66e39b6de1faba339252dd47d4a5;
    uint256 constant IC38y_PART2 = 0xc8db961a0cdb326b5db1d45ffa7f7ec9f53c4129eff787fac579b89aab02a29b;
    uint256 constant IC39x_PART1 = 0x0000000000000000000000000000000007c747e6e82ea2d1af580fca4cc74133;
    uint256 constant IC39x_PART2 = 0xf8eab416142563427fec35a0ea07777ba462a450960c4db913c99777aa10830e;
    uint256 constant IC39y_PART1 = 0x0000000000000000000000000000000019a82aa00aed94ec4ae8b1ea98ae4903;
    uint256 constant IC39y_PART2 = 0x5d8d2d7dfdce8efcd3ac0a7885127ebae139b4077430b391756d17d3e41b116a;
    uint256 constant IC40x_PART1 = 0x00000000000000000000000000000000121d669cc97a4dc6217256b7c95deeb4;
    uint256 constant IC40x_PART2 = 0x7c4ee75637acacfdcf6cc31ea2eadfbcc0cc90bc8e1bacf57a2c356535efc139;
    uint256 constant IC40y_PART1 = 0x000000000000000000000000000000001094d12e4a6c97a4476f64ba89c20298;
    uint256 constant IC40y_PART2 = 0xbe5975b100a33ad9ebdf11c4f771c841f5e5205e018dee43945392c45aeace00;
    uint256 constant IC41x_PART1 = 0x00000000000000000000000000000000009786e92ac21d2b6005ce6736e874d8;
    uint256 constant IC41x_PART2 = 0x344b2197df5e3d830bde033950f1e994f763cc42fbd2aa44226ac3096f7a9e6d;
    uint256 constant IC41y_PART1 = 0x00000000000000000000000000000000107f30e692402b8a5d0322bbab4ca12b;
    uint256 constant IC41y_PART2 = 0x4b4c61d8714c47a5908de6a0f85c99e72b21126d988f3613a7c3ed8a06717a57;
    uint256 constant IC42x_PART1 = 0x000000000000000000000000000000001433c3056f8da6117dbcc9563cce1c36;
    uint256 constant IC42x_PART2 = 0xcaa1d59276a5f964d04fd64bcd6ce6ad2ab22c114762c8e76ae0fdfd8b8fa372;
    uint256 constant IC42y_PART1 = 0x0000000000000000000000000000000012196c08262860fb384f6c894d54da5b;
    uint256 constant IC42y_PART2 = 0x5db6fe7063cd3a591449872d9a06990d197a49def55e16f09d2c7c6e501de878;
    uint256 constant IC43x_PART1 = 0x00000000000000000000000000000000053963ed89842788933e6ef8c97f8458;
    uint256 constant IC43x_PART2 = 0xd1177184823769809b03450c48ceb837c92ae03a3039dae4a5da335038bf4979;
    uint256 constant IC43y_PART1 = 0x0000000000000000000000000000000007a87db22c66c121433bc9481c5e9c2c;
    uint256 constant IC43y_PART2 = 0xef5ceadf4aa4a1ebc8fc701042927a21759057bf2ea62d1242fa03e6b696204d;
    uint256 constant IC44x_PART1 = 0x00000000000000000000000000000000141e6842857602cf2ab118e17fdbc45c;
    uint256 constant IC44x_PART2 = 0xb52f3fe38af17c9cfe017d413a598e5ce95519856983c075cd791c9182014bce;
    uint256 constant IC44y_PART1 = 0x000000000000000000000000000000000e8a9cded8ecc5196f0f8ebc09ea8d9c;
    uint256 constant IC44y_PART2 = 0xbc30a7ab995e79e5885333e69ed0beb6240ea8e20103a7ed890f47dd19c30477;
    uint256 constant IC45x_PART1 = 0x00000000000000000000000000000000053cfc2fb9fedbcdde175a06f44ee423;
    uint256 constant IC45x_PART2 = 0x5d46e61110ed6c99326a9edb9e1c51a192ac19844ce885efcd50987283720ad7;
    uint256 constant IC45y_PART1 = 0x00000000000000000000000000000000115252df5adb85bb7b0ad09a28df9871;
    uint256 constant IC45y_PART2 = 0x7081c06afe874b409c091df7a9fe8c0e30dee711c3f20e3cfab5fd21c26c146b;
    uint256 constant IC46x_PART1 = 0x000000000000000000000000000000001853096ea54054dbdbb8df2432593085;
    uint256 constant IC46x_PART2 = 0x60d825e1ed7d002372d54dea790b59dc6d46c90c2972b0c347d4be040701b646;
    uint256 constant IC46y_PART1 = 0x0000000000000000000000000000000007509932974dc222f95b8f7fa2634afa;
    uint256 constant IC46y_PART2 = 0xef6f788cdf84176fd10123685c31043fe8695e86a143c0f4fd490fb53e141044;
    uint256 constant IC47x_PART1 = 0x0000000000000000000000000000000001fcf1004904b9a67d1991c41fc8b731;
    uint256 constant IC47x_PART2 = 0x7049ff95c3ee119ea67528b07105fa06c62f12e90cb795ee47a384917f90ca3d;
    uint256 constant IC47y_PART1 = 0x000000000000000000000000000000001295565f4b2803657fb1afdae63006f0;
    uint256 constant IC47y_PART2 = 0x668c0bc13fa8ee8cad2737d862d496aff2dc9df02c91378e56c289d6daab232c;
    uint256 constant IC48x_PART1 = 0x000000000000000000000000000000000b434d0f6c20c9e47713c3bad2b0d340;
    uint256 constant IC48x_PART2 = 0x5ac3c710e20b6f1d54a22341115378dc48400fa899550c15c02b6b351310dc18;
    uint256 constant IC48y_PART1 = 0x00000000000000000000000000000000058eb6f69a22d0485ad8a36837b9646c;
    uint256 constant IC48y_PART2 = 0x70a28da9a59c587c77eb17522488742e2d107b50dab5d470cdf737088696265e;
    uint256 constant IC49x_PART1 = 0x0000000000000000000000000000000008901cb06dfcd01cc461c512c184031a;
    uint256 constant IC49x_PART2 = 0x7df0d5ba77d2917e9636d70b639ac7f14dd853d6ea12b5a75a5adcce25354306;
    uint256 constant IC49y_PART1 = 0x000000000000000000000000000000000d51a037303fd710d8cb692ef676971a;
    uint256 constant IC49y_PART2 = 0x33df8c7a07749c2be86576dc4e66565a1ece28694a104141178a464f9bf7dd15;
    uint256 constant IC50x_PART1 = 0x00000000000000000000000000000000024ea7fce8e965aaa5a9722ccf37deaf;
    uint256 constant IC50x_PART2 = 0x1838e0de8a4ae9ea5ea555ab72682620fb5409f190df5fcf33529e47818e0e04;
    uint256 constant IC50y_PART1 = 0x000000000000000000000000000000001608629a6d3667d1d98d2e0f469d5d7c;
    uint256 constant IC50y_PART2 = 0x94631bc711273a94f4086d4ec9d85946daca3db31cf4f02358e335bc9376ff91;
    uint256 constant IC51x_PART1 = 0x00000000000000000000000000000000131b2fb0f9d44bb8b3ecc66385ac05b4;
    uint256 constant IC51x_PART2 = 0x431116f3a67bd312ff49df447a50fddfd55c35d57f338dadeadf747a81e48378;
    uint256 constant IC51y_PART1 = 0x000000000000000000000000000000000fae9d06db71cea1e6b404cb930bc3fe;
    uint256 constant IC51y_PART2 = 0xa02cf23c29acf33c5332c3b39c60f57053b422053e69bba96c7d19da5997b7e0;
    uint256 constant IC52x_PART1 = 0x000000000000000000000000000000000680e4e20b1117c8a9e6e5797fad719d;
    uint256 constant IC52x_PART2 = 0xa0f10ae12e18f86109e8e6f7781a70aa549d4a422000d1ee80f85bb309981f1b;
    uint256 constant IC52y_PART1 = 0x0000000000000000000000000000000011cdfa8175e30c3217bbd5ec060ff566;
    uint256 constant IC52y_PART2 = 0xe4d00afefd502f41e9b014c648f93c16d5260acff0b51e060411a05e4552a6e1;
    uint256 constant IC53x_PART1 = 0x0000000000000000000000000000000006ffd5d489285940debdf423d8879b1e;
    uint256 constant IC53x_PART2 = 0x192332ebaedfab0d3df9a74f8f15ca5640d60a92b0833e19d00e228392cf54b5;
    uint256 constant IC53y_PART1 = 0x000000000000000000000000000000000d7de9130805ea9d27e917aea19e1cac;
    uint256 constant IC53y_PART2 = 0x2568775286b754629a2cf877de5a2ceecc7afa3bed0bdacd4868b7c966d852ec;
    uint256 constant IC54x_PART1 = 0x000000000000000000000000000000000b8676113235df4dadc29910aca51ca9;
    uint256 constant IC54x_PART2 = 0xf51576ef8a439e4e8e309c507fbb9823ec9fda7bdec196d66a1d5fe6cceccdcd;
    uint256 constant IC54y_PART1 = 0x00000000000000000000000000000000095f2a218b56aae636871e83b2eb19d4;
    uint256 constant IC54y_PART2 = 0x0896824810eec62d82eedf42d735de9cb7c8cfef811f138fb3d4856ac85f4edd;
    uint256 constant IC55x_PART1 = 0x00000000000000000000000000000000020e7d343b2a32dacc709fb3fe1a2ccc;
    uint256 constant IC55x_PART2 = 0xa1607f6f8cd135069fab87d5c988c2b580cb2b739ba5bd74340467122a90bc10;
    uint256 constant IC55y_PART1 = 0x0000000000000000000000000000000003d8d4702d1d5655380eafba3252af3f;
    uint256 constant IC55y_PART2 = 0x8ef3b96ceb96dced14ebf60e035cd708c98b370ca40a98941452226ac0e1bb4f;
    uint256 constant IC56x_PART1 = 0x00000000000000000000000000000000041c19793049c027019e5d6c6929224e;
    uint256 constant IC56x_PART2 = 0x3e43ef6f4bf8fc3ee23ffdc0917681224bf643f3edd942c96398756ff9dae636;
    uint256 constant IC56y_PART1 = 0x00000000000000000000000000000000175a245cb1ae0bda31c62c8385d377cd;
    uint256 constant IC56y_PART2 = 0x7fd1abddfd01b3b33966971fe49a6b58c3f0196c5ae426d02c4e0c3cca616dca;
    uint256 constant IC57x_PART1 = 0x0000000000000000000000000000000010c900e02fbd4b42a9a8725a9de84e99;
    uint256 constant IC57x_PART2 = 0x3f9d107a991f48db3dedd8ead2fa11461036e3d339c86c8f6992528521cdc653;
    uint256 constant IC57y_PART1 = 0x00000000000000000000000000000000065a06c13e1d6268a1d73c3116e9fea8;
    uint256 constant IC57y_PART2 = 0x496a21634c7d21c35fc4396e50d77e8ba61071ec6b5689901b4a1b5e99e54b1a;
    uint256 constant IC58x_PART1 = 0x0000000000000000000000000000000006b7304e16374e980f08b0d04eceddb7;
    uint256 constant IC58x_PART2 = 0xf740926bf2d70ac8c6e1f3ba053aaf72c47568385b48cf46d46d556267960497;
    uint256 constant IC58y_PART1 = 0x0000000000000000000000000000000014f449cbeaa604f5b39526d30cf1417a;
    uint256 constant IC58y_PART2 = 0x315e2bfb72f49ce89d0d3d7f70832cdda6b19df88ea37b891c22e3b93da3bfd8;
    uint256 constant IC59x_PART1 = 0x00000000000000000000000000000000086c51d63cff03cfa1fcbdc9f492134a;
    uint256 constant IC59x_PART2 = 0x0a9a8117d4af108674f162c49d5b1516c2fbe2233e8fc6fd9746463435dd82cf;
    uint256 constant IC59y_PART1 = 0x00000000000000000000000000000000166f14b251d65695df26cc03bedde788;
    uint256 constant IC59y_PART2 = 0x1233819ddc0d292430089ed733e558e8527aff66d1c225a54305e083150eda29;
    uint256 constant IC60x_PART1 = 0x000000000000000000000000000000000cf9d33ba4d81d0c453370ca5c955e1b;
    uint256 constant IC60x_PART2 = 0x341e370f97c3bad644fea96e212904b92ecb917cfd5c569770786cc6fc280bdd;
    uint256 constant IC60y_PART1 = 0x000000000000000000000000000000000098195198f4fffa8aefd0bf26163041;
    uint256 constant IC60y_PART2 = 0xe8564ef37b83d782766f301bec41dc484b6ab76db2a28a959e722a6eaa7be701;
    uint256 constant IC61x_PART1 = 0x0000000000000000000000000000000005cdb71d24021c4af6544753303b293f;
    uint256 constant IC61x_PART2 = 0x4d8ee48a9a01fc753bfc0841c389aa8939ca9a9e464290d41ac5bdcea45deaba;
    uint256 constant IC61y_PART1 = 0x0000000000000000000000000000000014b9c85f2af65d76ece7641199f2001d;
    uint256 constant IC61y_PART2 = 0x455d0b40e1afb4576c588ed7c3a16e9243eec4e8ff0e84f9c7b05e45123566fa;
    uint256 constant IC62x_PART1 = 0x0000000000000000000000000000000007837ebb14d7a4dc886d3ff6ad3137f7;
    uint256 constant IC62x_PART2 = 0x270fd854f87ba5d7de443067b9fde249927f8dd6cdeb4f72e03f643c9dd82a7e;
    uint256 constant IC62y_PART1 = 0x000000000000000000000000000000000e64770cecf33db89cd7f69e834ba992;
    uint256 constant IC62y_PART2 = 0xae80e8c8b58698feec0fb3b77490f1e2857761da45f7938d20e7649160465313;
    uint256 constant IC63x_PART1 = 0x00000000000000000000000000000000176bab516050d6f77aba68271518c4bc;
    uint256 constant IC63x_PART2 = 0xf4e5b376d496b5dced8a8e85ffc5eb6ee491907144d389916e9538fdf899f53c;
    uint256 constant IC63y_PART1 = 0x00000000000000000000000000000000140a0905e427c6073b57285b0e227927;
    uint256 constant IC63y_PART2 = 0xa47b716c2778284201f0f77465c1f78b3ef06dfd7bc2459c59b38cdf592768d5;
    uint256 constant IC64x_PART1 = 0x00000000000000000000000000000000075f0ff5ecb921dd5ec8aeadddbdca26;
    uint256 constant IC64x_PART2 = 0xe5eaef1e70fce41bd84b113330e5cf4d73c427c3c5fe747199f0509ccfefc6bf;
    uint256 constant IC64y_PART1 = 0x000000000000000000000000000000000ca08555fc523e9ed848544e8c8ecef5;
    uint256 constant IC64y_PART2 = 0x1cc39fc325317606c22d8e9c9ad874bd607883df019eb8c3a0a9f30f3b668324;
    uint256 constant IC65x_PART1 = 0x0000000000000000000000000000000001e45f628ca55735b91e9ac635585b5f;
    uint256 constant IC65x_PART2 = 0x592f2b25078f6c225baa9b51a00ee04ab71f13747f26897831c5894be633193f;
    uint256 constant IC65y_PART1 = 0x00000000000000000000000000000000174cfbdfe8070e4d77fe66aaf1e09335;
    uint256 constant IC65y_PART2 = 0xddec45ec0e456229c066935db2edb865f51ef91a09a57aeac5f5ea8b0bd88af9;
    uint256 constant IC66x_PART1 = 0x000000000000000000000000000000001382a9891904f9fcf590b4d27821bd32;
    uint256 constant IC66x_PART2 = 0x792f6ae658bdb783f1d7181d9d47c626ad55559599e0156158b2f34557e2a902;
    uint256 constant IC66y_PART1 = 0x00000000000000000000000000000000010c79f9dfea5d21c1b7164e78008bbd;
    uint256 constant IC66y_PART2 = 0x2b9d9c6dbd7e3677f9d9bfb693c35623c9b547d0538ce3b9dfc762832c922db4;
    uint256 constant IC67x_PART1 = 0x0000000000000000000000000000000003a5088f5280a02ae1dff7bddc087fdb;
    uint256 constant IC67x_PART2 = 0xfd30f671001296c2cd440f9716e91ddf2a68d9548e01fe8e8e4aa6078a485c7e;
    uint256 constant IC67y_PART1 = 0x0000000000000000000000000000000000be37db9c6f75ccc093bb940b3d43c3;
    uint256 constant IC67y_PART2 = 0xf91a9dce997cdc67e7a8fedcf6013a5afd15e0186114c7d9bd74b7f5abdf8bed;
    
 
    // Memory data
    uint16 constant pVk = 0;
    uint16 constant pPairing = 512;

    uint16 constant pLastMem = 1664;

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[67] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            function checkField(v) {
                if iszero(lt(v, R_MOD)) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }


            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Initialize vk_x with IC0 (the constant term)
                mstore(_pVk, IC0x_PART1)
                mstore(add(_pVk, 32), IC0x_PART2)
                mstore(add(_pVk, 64), IC0y_PART1)
                mstore(add(_pVk, 96), IC0y_PART2)

                // Compute the linear combination vk_x = IC0 + IC1*pubSignals[0] + IC2*pubSignals[1] + ...

                g1_mulAccC(_pVk, IC1x_PART1, IC1x_PART2, IC1y_PART1, IC1y_PART2, calldataload(add(pubSignals, 0)))

                g1_mulAccC(_pVk, IC2x_PART1, IC2x_PART2, IC2y_PART1, IC2y_PART2, calldataload(add(pubSignals, 32)))

                g1_mulAccC(_pVk, IC3x_PART1, IC3x_PART2, IC3y_PART1, IC3y_PART2, calldataload(add(pubSignals, 64)))

                g1_mulAccC(_pVk, IC4x_PART1, IC4x_PART2, IC4y_PART1, IC4y_PART2, calldataload(add(pubSignals, 96)))

                g1_mulAccC(_pVk, IC5x_PART1, IC5x_PART2, IC5y_PART1, IC5y_PART2, calldataload(add(pubSignals, 128)))

                g1_mulAccC(_pVk, IC6x_PART1, IC6x_PART2, IC6y_PART1, IC6y_PART2, calldataload(add(pubSignals, 160)))

                g1_mulAccC(_pVk, IC7x_PART1, IC7x_PART2, IC7y_PART1, IC7y_PART2, calldataload(add(pubSignals, 192)))

                g1_mulAccC(_pVk, IC8x_PART1, IC8x_PART2, IC8y_PART1, IC8y_PART2, calldataload(add(pubSignals, 224)))

                g1_mulAccC(_pVk, IC9x_PART1, IC9x_PART2, IC9y_PART1, IC9y_PART2, calldataload(add(pubSignals, 256)))

                g1_mulAccC(_pVk, IC10x_PART1, IC10x_PART2, IC10y_PART1, IC10y_PART2, calldataload(add(pubSignals, 288)))

                g1_mulAccC(_pVk, IC11x_PART1, IC11x_PART2, IC11y_PART1, IC11y_PART2, calldataload(add(pubSignals, 320)))

                g1_mulAccC(_pVk, IC12x_PART1, IC12x_PART2, IC12y_PART1, IC12y_PART2, calldataload(add(pubSignals, 352)))

                g1_mulAccC(_pVk, IC13x_PART1, IC13x_PART2, IC13y_PART1, IC13y_PART2, calldataload(add(pubSignals, 384)))

                g1_mulAccC(_pVk, IC14x_PART1, IC14x_PART2, IC14y_PART1, IC14y_PART2, calldataload(add(pubSignals, 416)))

                g1_mulAccC(_pVk, IC15x_PART1, IC15x_PART2, IC15y_PART1, IC15y_PART2, calldataload(add(pubSignals, 448)))

                g1_mulAccC(_pVk, IC16x_PART1, IC16x_PART2, IC16y_PART1, IC16y_PART2, calldataload(add(pubSignals, 480)))

                g1_mulAccC(_pVk, IC17x_PART1, IC17x_PART2, IC17y_PART1, IC17y_PART2, calldataload(add(pubSignals, 512)))

                g1_mulAccC(_pVk, IC18x_PART1, IC18x_PART2, IC18y_PART1, IC18y_PART2, calldataload(add(pubSignals, 544)))

                g1_mulAccC(_pVk, IC19x_PART1, IC19x_PART2, IC19y_PART1, IC19y_PART2, calldataload(add(pubSignals, 576)))

                g1_mulAccC(_pVk, IC20x_PART1, IC20x_PART2, IC20y_PART1, IC20y_PART2, calldataload(add(pubSignals, 608)))

                g1_mulAccC(_pVk, IC21x_PART1, IC21x_PART2, IC21y_PART1, IC21y_PART2, calldataload(add(pubSignals, 640)))

                g1_mulAccC(_pVk, IC22x_PART1, IC22x_PART2, IC22y_PART1, IC22y_PART2, calldataload(add(pubSignals, 672)))

                g1_mulAccC(_pVk, IC23x_PART1, IC23x_PART2, IC23y_PART1, IC23y_PART2, calldataload(add(pubSignals, 704)))

                g1_mulAccC(_pVk, IC24x_PART1, IC24x_PART2, IC24y_PART1, IC24y_PART2, calldataload(add(pubSignals, 736)))

                g1_mulAccC(_pVk, IC25x_PART1, IC25x_PART2, IC25y_PART1, IC25y_PART2, calldataload(add(pubSignals, 768)))

                g1_mulAccC(_pVk, IC26x_PART1, IC26x_PART2, IC26y_PART1, IC26y_PART2, calldataload(add(pubSignals, 800)))

                g1_mulAccC(_pVk, IC27x_PART1, IC27x_PART2, IC27y_PART1, IC27y_PART2, calldataload(add(pubSignals, 832)))

                g1_mulAccC(_pVk, IC28x_PART1, IC28x_PART2, IC28y_PART1, IC28y_PART2, calldataload(add(pubSignals, 864)))

                g1_mulAccC(_pVk, IC29x_PART1, IC29x_PART2, IC29y_PART1, IC29y_PART2, calldataload(add(pubSignals, 896)))

                g1_mulAccC(_pVk, IC30x_PART1, IC30x_PART2, IC30y_PART1, IC30y_PART2, calldataload(add(pubSignals, 928)))

                g1_mulAccC(_pVk, IC31x_PART1, IC31x_PART2, IC31y_PART1, IC31y_PART2, calldataload(add(pubSignals, 960)))

                g1_mulAccC(_pVk, IC32x_PART1, IC32x_PART2, IC32y_PART1, IC32y_PART2, calldataload(add(pubSignals, 992)))

                g1_mulAccC(
                    _pVk, IC33x_PART1, IC33x_PART2, IC33y_PART1, IC33y_PART2, calldataload(add(pubSignals, 1024))
                )

                g1_mulAccC(
                    _pVk, IC34x_PART1, IC34x_PART2, IC34y_PART1, IC34y_PART2, calldataload(add(pubSignals, 1056))
                )

                g1_mulAccC(
                    _pVk, IC35x_PART1, IC35x_PART2, IC35y_PART1, IC35y_PART2, calldataload(add(pubSignals, 1088))
                )

                g1_mulAccC(
                    _pVk, IC36x_PART1, IC36x_PART2, IC36y_PART1, IC36y_PART2, calldataload(add(pubSignals, 1120))
                )

                g1_mulAccC(
                    _pVk, IC37x_PART1, IC37x_PART2, IC37y_PART1, IC37y_PART2, calldataload(add(pubSignals, 1152))
                )

                g1_mulAccC(
                    _pVk, IC38x_PART1, IC38x_PART2, IC38y_PART1, IC38y_PART2, calldataload(add(pubSignals, 1184))
                )

                g1_mulAccC(
                    _pVk, IC39x_PART1, IC39x_PART2, IC39y_PART1, IC39y_PART2, calldataload(add(pubSignals, 1216))
                )

                g1_mulAccC(
                    _pVk, IC40x_PART1, IC40x_PART2, IC40y_PART1, IC40y_PART2, calldataload(add(pubSignals, 1248))
                )

                g1_mulAccC(
                    _pVk, IC41x_PART1, IC41x_PART2, IC41y_PART1, IC41y_PART2, calldataload(add(pubSignals, 1280))
                )

                g1_mulAccC(
                    _pVk, IC42x_PART1, IC42x_PART2, IC42y_PART1, IC42y_PART2, calldataload(add(pubSignals, 1312))
                )

                g1_mulAccC(
                    _pVk, IC43x_PART1, IC43x_PART2, IC43y_PART1, IC43y_PART2, calldataload(add(pubSignals, 1344))
                )

                g1_mulAccC(
                    _pVk, IC44x_PART1, IC44x_PART2, IC44y_PART1, IC44y_PART2, calldataload(add(pubSignals, 1376))
                )

                g1_mulAccC(
                    _pVk, IC45x_PART1, IC45x_PART2, IC45y_PART1, IC45y_PART2, calldataload(add(pubSignals, 1408))
                )

                g1_mulAccC(
                    _pVk, IC46x_PART1, IC46x_PART2, IC46y_PART1, IC46y_PART2, calldataload(add(pubSignals, 1440))
                )

                g1_mulAccC(
                    _pVk, IC47x_PART1, IC47x_PART2, IC47y_PART1, IC47y_PART2, calldataload(add(pubSignals, 1472))
                )

                g1_mulAccC(
                    _pVk, IC48x_PART1, IC48x_PART2, IC48y_PART1, IC48y_PART2, calldataload(add(pubSignals, 1504))
                )

                g1_mulAccC(
                    _pVk, IC49x_PART1, IC49x_PART2, IC49y_PART1, IC49y_PART2, calldataload(add(pubSignals, 1536))
                )

                g1_mulAccC(
                    _pVk, IC50x_PART1, IC50x_PART2, IC50y_PART1, IC50y_PART2, calldataload(add(pubSignals, 1568))
                )

                g1_mulAccC(
                    _pVk, IC51x_PART1, IC51x_PART2, IC51y_PART1, IC51y_PART2, calldataload(add(pubSignals, 1600))
                )

                g1_mulAccC(
                    _pVk, IC52x_PART1, IC52x_PART2, IC52y_PART1, IC52y_PART2, calldataload(add(pubSignals, 1632))
                )

                g1_mulAccC(
                    _pVk, IC53x_PART1, IC53x_PART2, IC53y_PART1, IC53y_PART2, calldataload(add(pubSignals, 1664))
                )

                g1_mulAccC(
                    _pVk, IC54x_PART1, IC54x_PART2, IC54y_PART1, IC54y_PART2, calldataload(add(pubSignals, 1696))
                )

                g1_mulAccC(
                    _pVk, IC55x_PART1, IC55x_PART2, IC55y_PART1, IC55y_PART2, calldataload(add(pubSignals, 1728))
                )

                g1_mulAccC(
                    _pVk, IC56x_PART1, IC56x_PART2, IC56y_PART1, IC56y_PART2, calldataload(add(pubSignals, 1760))
                )

                g1_mulAccC(
                    _pVk, IC57x_PART1, IC57x_PART2, IC57y_PART1, IC57y_PART2, calldataload(add(pubSignals, 1792))
                )

                g1_mulAccC(
                    _pVk, IC58x_PART1, IC58x_PART2, IC58y_PART1, IC58y_PART2, calldataload(add(pubSignals, 1824))
                )

                g1_mulAccC(
                    _pVk, IC59x_PART1, IC59x_PART2, IC59y_PART1, IC59y_PART2, calldataload(add(pubSignals, 1856))
                )

                g1_mulAccC(
                    _pVk, IC60x_PART1, IC60x_PART2, IC60y_PART1, IC60y_PART2, calldataload(add(pubSignals, 1888))
                )

                g1_mulAccC(
                    _pVk, IC61x_PART1, IC61x_PART2, IC61y_PART1, IC61y_PART2, calldataload(add(pubSignals, 1920))
                )

                g1_mulAccC(
                    _pVk, IC62x_PART1, IC62x_PART2, IC62y_PART1, IC62y_PART2, calldataload(add(pubSignals, 1952))
                )

                g1_mulAccC(
                    _pVk, IC63x_PART1, IC63x_PART2, IC63y_PART1, IC63y_PART2, calldataload(add(pubSignals, 1984))
                )

                g1_mulAccC(
                    _pVk, IC64x_PART1, IC64x_PART2, IC64y_PART1, IC64y_PART2, calldataload(add(pubSignals, 2016))
                )

                g1_mulAccC(
                    _pVk, IC65x_PART1, IC65x_PART2, IC65y_PART1, IC65y_PART2, calldataload(add(pubSignals, 2048))
                )

                g1_mulAccC(
                    _pVk, IC66x_PART1, IC66x_PART2, IC66y_PART1, IC66y_PART2, calldataload(add(pubSignals, 2080))
                )

                g1_mulAccC(
                    _pVk, IC67x_PART1, IC67x_PART2, IC67y_PART1, IC67y_PART2, calldataload(add(pubSignals, 2112))
                )

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default { 
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2
                

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax1_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax1_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax2_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax2_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay1_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay1_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay2_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay2_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate new public signal fields
            checkField(calldataload(add(_pubSignals, 2080)))
            checkField(calldataload(add(_pubSignals, 2112)))

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
             return(0, 0x20)
         }
     }
 }



================================================
FILE: groth16/verifier/src/Groth16Verifier64Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

import "./Groth16Verifier64LeavesIC.sol";

contract Groth16Verifier64Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 internal constant alphax_PART1 = 0x000000000000000000000000000000000b64c080c737ba7a22eb10bdd910a8dd;
    uint256 internal constant alphax_PART2 = 0xeaf6fee44136b7f01137411d704ce9834d1206f96c1e5b0d85331112474e00fd;
    uint256 internal constant alphay_PART1 = 0x0000000000000000000000000000000009b199d1d14d750ab035b0f175586479;
    uint256 internal constant alphay_PART2 = 0x6f17a9a71f42a94e5bc1cb31785503a35a264c9170aa22170403ace2330d9b46;
    
    uint256 constant betax1_PART1 = 0x000000000000000000000000000000000048ff455eaf220d0cfa22014ef3aaf2;
    uint256 constant betax1_PART2 = 0xc5209615cf3a98e2545004b3d43a3591c1acbeefe16e3cf81155bc3aad5e3fe9;
    uint256 constant betax2_PART1 = 0x0000000000000000000000000000000007708cfcadb0c0530028dcd0e1f21c08;
    uint256 constant betax2_PART2 = 0x7b7e3f36d98ff6be8ca8eb662fe3d824790d3570616010f104e99848f87d0c83;
    uint256 constant betay1_PART1 = 0x000000000000000000000000000000000adb0437246524e1737815ce833f795f;
    uint256 constant betay1_PART2 = 0x910b4c67537881a1a9901e5c9b2b3f43fbe23043e117d11be4b69f03e24f2a20;
    uint256 constant betay2_PART1 = 0x000000000000000000000000000000000349bdb043c0d6f663b59fb2ac8f80e1;
    uint256 constant betay2_PART2 = 0xb90ec6fcb9b51c11e201999fd2948b90db942941ee71a7ce24fac1a6b233da26;
    uint256 constant gammax1_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax1_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammax2_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax2_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay1_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay2_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;
    uint256 constant deltax1_PART1 = 0x000000000000000000000000000000000f81a86ebef33d3eb94374fb130b412e;
    uint256 constant deltax1_PART2 = 0xec9e28a14641e3dc1cdb2df67dbade8c774ca46bd5b850332803e58ac8be29a4;
    uint256 constant deltax2_PART1 = 0x00000000000000000000000000000000046c1db7caba4882cd429f49cb987ae1;
    uint256 constant deltax2_PART2 = 0x585b8ac907fdcbaeceaa0557d2a1b9c0ee0f993f3627689fa928adbaea798afd;
    uint256 constant deltay1_PART1 = 0x000000000000000000000000000000000aacf89f73ce5418374edabb64cea90f;
    uint256 constant deltay1_PART2 = 0xa1b3645445940ebe33e5e5ce2fe939293279a1247d1147056b151193ad0e0c70;
    uint256 constant deltay2_PART1 = 0x000000000000000000000000000000001886749265167fe3a323cb971b0b0f52;
    uint256 constant deltay2_PART2 = 0x24014bcce824d9e276b3ec1e0a333071c77b435af9a1d8db41ba0523e399d271;

    // Reference to the IC constants contract
    Groth16Verifier64LeavesIC public icContract;

    // Memory layout for pairing check
    uint16 constant pPairing = 1408;
    uint16 constant pVk = 0; 
    uint16 constant pLastMem = 1664;

    constructor(address _icContract) {
        icContract = Groth16Verifier64LeavesIC(_icContract);
    }

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB, 
        uint256[4] calldata _pC,
        uint256[131] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function getICValues(index, ic_contract_addr) -> x0, x1, y0, y1 {
                let mIn := mload(0x40)
                
                // Prepare call data for getIC(index)
                mstore(mIn, 0x3fd741b500000000000000000000000000000000000000000000000000000000) // getIC function selector
                mstore(add(mIn, 4), index)
                
                let success := staticcall(gas(), ic_contract_addr, mIn, 36, mIn, 128)
                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
                
                x0 := mload(mIn)
                x1 := mload(add(mIn, 32))
                y0 := mload(add(mIn, 64))
                y1 := mload(add(mIn, 96))
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem, ic_contract_addr) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Get IC0 values and store
                let ic0_x0, ic0_x1, ic0_y0, ic0_y1 := getICValues(0, ic_contract_addr)
                mstore(_pVk, ic0_x0)
                mstore(add(_pVk, 32), ic0_x1)
                mstore(add(_pVk, 64), ic0_y0)
                mstore(add(_pVk, 96), ic0_y1)

                // Compute the linear combination vk_x using external IC values
                for { let i := 1 } lt(i, 132) { i := add(i, 1) } {
                    let ic_x0, ic_x1, ic_y0, ic_y1 := getICValues(i, ic_contract_addr)
                    let pubSignalOffset := mul(sub(i, 1), 32)
                    g1_mulAccC(_pVk, ic_x0, ic_x1, ic_y0, ic_y1, calldataload(add(pubSignals, pubSignalOffset)))
                }

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)
                
                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default { 
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x0_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x0_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x1_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x1_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y0_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y0_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y1_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y1_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1312), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1344), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1376), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1408), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1440), deltay1_PART2) // y0_PART2
                mstore(add(_pPairing, 1472), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1504), deltay2_PART2) // y1_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            let ic_contract_addr := sload(icContract.slot)
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem, ic_contract_addr)
            
            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}


================================================
FILE: groth16/verifier/src/Groth16Verifier64LeavesIC.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

// IC Constants contract for 64-leaves verifier - Updated verification key
contract Groth16Verifier64LeavesIC {
    function getIC(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {
        if (index == 0) return (0x00000000000000000000000000000000178d31f66a202ff0da7f9d75cc355523, 0xe52ee3797b1f94b232dc2aca71b56373355e48c226cb7fac72d33318330efa8b, 0x00000000000000000000000000000000081839b652279de9801721714f18e2f5, 0x6fec0a8f68b83184ce9783086124ffa9912332ad05201ec1c256bdbbf675966b);
        if (index == 1) return (0x0000000000000000000000000000000012754b2a3750130c0603db148a277993, 0xd16373a7bc196fcd9d04957de1b2c5d41712067b5a142522abf2f95303e31dcb, 0x00000000000000000000000000000000133701f27c8ae8e0afa4a676996efa7c, 0x34bc3e83597b5906806ee149d54041a75010d2d95fff675130225bf92c98bf50);
        if (index == 2) return (0x00000000000000000000000000000000125e501b8da37f7817afe352d94c3158, 0xa96663b48d256dd7a5519d0d37abd178df303bb52b5b91f86f0a8537595455b5, 0x00000000000000000000000000000000127a8ce66a0e5f591af34f009530e537, 0x41cd3238304d498e083d63b1e22ef4992c2afa3a12befb16a4a222b518fa0b9e);
        if (index == 3) return (0x000000000000000000000000000000000b8b50ce9e4698760b070b6b0b54db86, 0x9257978d3c1ea61d173f61dff22f33c894f8e6159c713df6ee98b4fdefadaf96, 0x000000000000000000000000000000001116a384bacfa804427076c68d45bf83, 0x69730d1a358910cb8701606f00be2b594d657fa470081b2bd017f8ba4d075baf);
        if (index == 4) return (0x0000000000000000000000000000000017413962f780ccf411c231b78b498ecb, 0x7b0ee85ea4152d1b97be49b5ef3d8daeffa54f0e909eca98847659f444031a95, 0x0000000000000000000000000000000011ddc1e76854be65cb11ea4194b95a5a, 0xeb69152127076d7aaf190c873ac10cbbb7d394a007a6d8f5c08d1df9c77b5e83);
        if (index == 5) return (0x000000000000000000000000000000001011d402352e5de872ae0f428cd30504, 0x166f05b2a3716a68fa1a19f175c96cbdde43db6f1d2f3fc6c1b9cc54cb6f425f, 0x0000000000000000000000000000000008df5decf370c3a0e7e4620afe28fa61, 0xc96caa0e6f742708877a6ec720341990d677103ba94a42e6c8216d90af1b80b1);
        if (index == 6) return (0x000000000000000000000000000000001161602e129e8ef770495aab76761b7e, 0xc4801fa3501e8d96cb3cafe1756991b016cd33a389cd63328c7fd863a1723091, 0x00000000000000000000000000000000053c3c6a0998ea69120268474d8f3ed0, 0x8fc7c03f577426610d31b5316cd77f7672991b3c7a5f56c496f53765062cc823);
        if (index == 7) return (0x000000000000000000000000000000000f786af01024edd8239b78bbf497dd50, 0xaaf6505869f88ee498109d78351e2483ab05919c6369ae98d96bcc444b5d0361, 0x0000000000000000000000000000000001a0c3c88030fd6f045e34be8264d3b9, 0xd720f6631fe2d5313de3463bc1ebbdbd7ac765a8e924eb7a1c5a7cbe3a10dfcf);
        if (index == 8) return (0x00000000000000000000000000000000185266fedaa9926534601248eb19a6c3, 0x2311c47bd1f58fc6076c0cf68005e01677f88c6127ea627fe869da2349ca7451, 0x00000000000000000000000000000000195c220896785ff2a703c58a4be6b2b9, 0x22c819242d8d2dd1b3180c9b126528467f435ffbc03cd2a3066707b706824e37);
        if (index == 9) return (0x00000000000000000000000000000000151e3adba6215292fd29fdad8f1f9ee7, 0x6cecc96d6010a9bc635d31eb0fb71c7fd5b4dcef9e543d5625ac1d4510880d08, 0x000000000000000000000000000000000a23ba6ea244eaadc472a3b79fc6d909, 0xf584480e6ae8fd7f5d59891a4183240ed2afcd68404e322cd06b5501c4c0d28d);
        if (index == 10) return (0x0000000000000000000000000000000018223a9d11583aaa9f5ae4bd48a3746b, 0x82459a96ae853b47f35a9a21f7fd5cf4b900d858213221767671c0215216224b, 0x000000000000000000000000000000000b4de78c9e72e285f190acaa7c5f55f5, 0x36cbb8807c22880949c8a0c736428471b515ac11a1787dc609a693a4dc09decc);
        if (index == 11) return (0x000000000000000000000000000000001345d02fd696ad13356c78dec496e22b, 0xdce31f4883a94f7f8ec5c2f8a647f31d0c5f169d2ff944a1ec92decc38397317, 0x000000000000000000000000000000000577f65b026ed1a48f0d4e0da9aa4686, 0x556c4c73124649cc4192e7d02dfc3eaf4c3ae15764f7bdb32b1ca6649f8e305f);
        if (index == 12) return (0x00000000000000000000000000000000139ac047b6359387e8d86909db14d7f8, 0x9618e497378df352067ea17ccdb9db877c332478789cb5522b0ff7a72e0851b7, 0x0000000000000000000000000000000002da5b50ae565bca4925fe471593b4bb, 0x9343d6acba73827976d0aba2b80cb91eae8a32e82a26aac3c38e726592c9aa4a);
        if (index == 13) return (0x0000000000000000000000000000000017c6c86910913584dcecdf9ed83c6e93, 0x232cbcb746b95696dec82f1ae4dab5204534f0b275fa65f1dfcb9090d20c817a, 0x0000000000000000000000000000000018e5652027cee7f43e3b609939636f0a, 0xddf538eac9a42008c9e73ca877023ae1297d4fc5d2b647a3a0319e3265519bab);
        if (index == 14) return (0x00000000000000000000000000000000086699b1f11b7c79baa726cf5c376c2c, 0x72dd2e3c2e9c1ffc27e1fe12903d98be7854909668f4f3087b7564bc1d22dd81, 0x00000000000000000000000000000000118b8d166162cd97ab6894a10acaf96b, 0xe7448ceeec901c5ad3aca4a09adcf4d16cdcb783e59d2ba5f717a520ebb7f1e2);
        if (index == 15) return (0x00000000000000000000000000000000091e581b43926e0f496c4318b61ec47a, 0x40253a3dc96794bb420c9be690a5db042aeca2a524799a46e2cd3db66b1fbf69, 0x0000000000000000000000000000000000c9a96b4b30b863eff8c2b1c431cc89, 0xf4b4b49bc0e64c6d3a469efd0b091cd67debccf66c09aa6ac3fb6ba821d42bf9);
        if (index == 16) return (0x0000000000000000000000000000000006310347f4f2dbec13b150af5f490775, 0x293e89671e5b0e27a4ac176bec8cfd20d5e8fedd60b662798fa53141ec7df141, 0x0000000000000000000000000000000003c177a5b0e70147a5016a2189675038, 0x0a91736f9b647cbddaa5272aa0bcdf649ebe4827b2d8dda152f358e1a7779864);
        if (index == 17) return (0x00000000000000000000000000000000150a84413c904da803a6b97a9f7b5220, 0x0ddc59ae559392be197eb5f66ffaa46c70cbf8b15215e8f41f41981460e056be, 0x00000000000000000000000000000000166a7e91c7971ab69b853543d434ed6a, 0x664afe7f35cc38521be36141ae6a814388320044b7837f194d9b7bc9ddc52676);
        if (index == 18) return (0x00000000000000000000000000000000164fbe58a5457bca216d75ed30caf065, 0xc33ad26eb61a4cbc8ec66afc343e2c651ccde4b35055ae2e5c4f50e9ca099195, 0x0000000000000000000000000000000002b6f31c4e1b498590c45bc1a2e058a6, 0xd7b0f1ef4bc13274259d399343891855e7aa29debea09c9c2bf6c34a72e1b6fd);
        if (index == 19) return (0x00000000000000000000000000000000174870eaf927cb0b41feac0a288ce58a, 0xdde7fc3356ab53e30f34fc96edf056ca8822102c39ee482eebfda44378d404b2, 0x0000000000000000000000000000000012f08157e8cb7ffc22cbb94af1aa260d, 0x49ed96f2929fab317397fefe5adcb7423b6cba899a9792fb93e2006640aab3f6);
        if (index == 20) return (0x0000000000000000000000000000000012bd70ba8f73e239c3e9d705b7969468, 0xb563216b86e06ce11cf8e0e136b8ecce81910b6f00fb19a1ff3cef585165e2bf, 0x00000000000000000000000000000000069b31f72abe0330f82c20f0fce10d13, 0xd1652dfe599637c5e91a0ae507be560f4973871d430cb7ec8620809b73025bb9);
        if (index == 21) return (0x0000000000000000000000000000000004a7b03bd560b5a8b018f583edd52ff3, 0xa9339d0b0fdc997294c9e81f7e27ccf3ded70da87ee114d07d0298c306e7e2e8, 0x000000000000000000000000000000000cb6625ef07f87b2107e41115cd3007e, 0xba38307a1d4debc17a8d6e52b69a8d8c52dd6e0ae2b434049d67d4b19b62cb1a);
        if (index == 22) return (0x000000000000000000000000000000001380ec6e721af931f6ca47fe59c82ae5, 0x9a28025378c219f431f6ee0685d366e73f5a4a06b1a1ec72c461493fc65ae10d, 0x0000000000000000000000000000000019ab13ee90e7d11d0d5a9f450a14b302, 0x937af98ecc0c875028f10853d5a561d47d0787ea4a33a683c18574bb55b0a25d);
        if (index == 23) return (0x000000000000000000000000000000000328f1dc25991f4ec92792c9f4e76e37, 0xba40174728fd7913faa6795eabc4b74e06c98854a0ef5a4addf09828fd953403, 0x00000000000000000000000000000000099685d890c37cb2098857a31d2dd518, 0xeca3375fd0d976e68fcd2311091195c6bf5cd31980ddc362a5c23a2c590db416);
        if (index == 24) return (0x0000000000000000000000000000000002bb558b2416a5961ab4e8d5a4909313, 0x4c496dc1e07d51b18e60022079317672f0766513a5a6a2505dc4d47155370db8, 0x0000000000000000000000000000000007308e1aaf87471a49e40e9a2e2088c4, 0x7b9d348e146c75dd8e2aaab23a2b7480663dd359441ac012732464a6e43311bc);
        if (index == 25) return (0x00000000000000000000000000000000110609796ddd2f98d72aa35399613c1d, 0x5118ad4203dabce323fe8941fdad89b4ea68ce2540c37683e0050bbf785786fc, 0x00000000000000000000000000000000182f14519ff14168f143f6deef068d99, 0xb57b494655f7d8dd3b3bfd1bae21540490cb8a42cb69f6a2db232a05e82a5a75);
        if (index == 26) return (0x00000000000000000000000000000000073e73d7684ee74535e0c946f7ab89b9, 0x4fa55dd4fb29cb821cb7bf5f11602abc63c2304f22f5496d98d9b5a1f969aec9, 0x000000000000000000000000000000001439d69d7739b06bb8687b371eb6e10d, 0xcf7006059849555156dc4f965bf3884858793a15d116e00c04f1e2d87b8883c7);
        if (index == 27) return (0x00000000000000000000000000000000023bb7f7e50018c5c9658b58acb5c0fe, 0x8954bf0bfff48e8d7efebfb9dc219e2857874d4f4620af1c0a356c2dbb08cab2, 0x0000000000000000000000000000000005029c4483806cff78e42821381509d8, 0xa7dfa2e8718bf3fb8281153ebf2a5e0cd3cb85e472665d01129b4a45c0731825);
        if (index == 28) return (0x00000000000000000000000000000000130f5ef2c7234dde4f852e19950ec4a6, 0x541725e16d0fbb68fdfcefd4096039cd523a4f774b002698ae9871005ad56cc3, 0x0000000000000000000000000000000016dfcceb99184fef54c98278adb69083, 0x80cf6cec6879766792774d1d6fd4eb00f8a5ceada914810de8d0125ba0852cf3);
        if (index == 29) return (0x0000000000000000000000000000000014a91e9c9bfd008e67054622759ae63c, 0x9aafd44e123cd90f64a2f21adbe04b94e8dfcaa528321bef55c8999ace514a2a, 0x00000000000000000000000000000000047b58b81462a07d962790f5d084a07b, 0x6eb6647eabe4a693b00d04d4e41f50d3f613741ebc7f66fd8b5c4eeff0424047);
        if (index == 30) return (0x00000000000000000000000000000000130680c1b368a67208282a425fbce705, 0xee6fcdde894cde773d08882ab6e58369bdff62c90e29ea06be9e70834a35e39c, 0x000000000000000000000000000000000d101182d8a302140ddcbd33e792ed22, 0x4d823108210ae8259c4cb606bd0cc02560360b716cc7863a7c063146df1b33b4);
        if (index == 31) return (0x00000000000000000000000000000000194be4d660f45783ce3757c32b0c8491, 0x0f93cc499a0e0f433cd7fddcfc322a9022016791e2c8799bb40a33c51c5c23ee, 0x000000000000000000000000000000000ec11dcc28071f177017975af594f693, 0xec20d559b7d0761070df19afbc8d5553484d8770dce845c8d3e369e183cf6029);
        if (index == 32) return (0x000000000000000000000000000000000eb5c299e9ff2b2c66a1e546827aae1a, 0x4edfbed76196c758552c1f315589bc538e5722fc87b14397400c49cba9896009, 0x000000000000000000000000000000000c289abdcc97606f1acb43fa8c44cff5, 0xfdef9345502760e119db68bbac5938b91cac14b3a35ae7292bac75241e4b2fb9);
        if (index == 33) return (0x0000000000000000000000000000000013b0a18209e4f3f9b9ac15bf2045d6fb, 0x6d381dd672406218aa9c10dcfd409c313565ada427c33e95ce987e147a2cbe7b, 0x0000000000000000000000000000000013d886fdeb0b514fe37182f5ac2bd095, 0x2545b3a311120794b3b47237ccb8baef3a4f350ff17900fc05ea38a36cbb6cdb);
        if (index == 34) return (0x00000000000000000000000000000000021b8ed92a1f77eb63c3dee84738cfb6, 0xba17c2c24ce49ab1e1730a0674e426d9bb53bfe6594364372f10dc67dee4d400, 0x000000000000000000000000000000000ea68c3a451d02b6b6608bfe82f0c2a7, 0x29f404467f8f5602300050bcc226d451c319692609711ecb1fead37c9422c7dd);
        if (index == 35) return (0x000000000000000000000000000000000623fddfd9b2eb8fdc4c73df76e2b71a, 0xafce0540ddf864cd09ecebeca6fc213e328ec34c75c32139b5be28e4dc9c182f, 0x00000000000000000000000000000000117b087ee9769988c4522876f9855b60, 0x5108d5caa283fa20b12deef5c843aca281784e76d0194add8fc9fe93a50a7561);
        if (index == 36) return (0x000000000000000000000000000000000666b982a773311cf1d81b457c61c4f1, 0xb1a0942f9d33d7e6cc326a94fbd555665b11c95a18180fe3128057fc165d4fb3, 0x000000000000000000000000000000001948248ffa7a54f60cbad6c482d6d3bc, 0x8762b73d1588dcc114e1adaf53d7734e958a355f3c481e3f2bde2433f472ea8f);
        if (index == 37) return (0x00000000000000000000000000000000121f515ba5f6d6c4fc0a01be3f1d1bb0, 0x0e5d8d8ab3de5d926738fcd8ef514d62bced509b32c855ff8892d4359baf959c, 0x000000000000000000000000000000000cffa18fabdb82e56503ff1800201645, 0x246b27f9f6f9a837442fd5d9a890b8534c83186cc18836583b0c90318142166e);
        if (index == 38) return (0x000000000000000000000000000000000e9e64aa8f715c03acc45cba9d699ee4, 0x63fe1722e8f19450cc9778a82d48a8990975be634386796a7418f7ebdd8d9c03, 0x0000000000000000000000000000000015fb5f497c9d9783ad6582dfdc5fe57f, 0x799f42c087ab320cc488a9b52a65d7aaaf98202a6b1a2d523b99b7ced715206a);
        if (index == 39) return (0x000000000000000000000000000000000aeac6d2733f88f05bcf757fba4ebc8d, 0x9c3c6fea0b962199cc868893cdff6378b419bde28d54159a026bc46b45405ece, 0x0000000000000000000000000000000007d29d2b5aa0dd172424e447156cbb9a, 0x652e7f281d4472596ad5fdf32cca281b211a418804cf3ab97bb28dd68849c3f5);
        if (index == 40) return (0x00000000000000000000000000000000073be821f47cdd2f7e8bac4d5bd6e2a8, 0x94de745f1933dc52cd910db54cfebd8c589d53a82e4dbe71dc6dc04f5d981553, 0x000000000000000000000000000000000243356bc0533dd66e54fe79c67a99e6, 0x87d06c19756550c02db443d49c71f12dcb0624c849660f52f17f708d54a6e985);
        if (index == 41) return (0x000000000000000000000000000000000d529d79cc635730fb61f036118969c7, 0xe35688821ca3836fbb318ec1a81d9d6bba18417e4d0fc8c8ee8651c9d168b86d, 0x000000000000000000000000000000000e04fba3e149ffc9c3924da7d7035c32, 0x388b9c0fb7a86dedcf6d526d92bc5a893b8334681e411c3eae52a83950bf3c13);
        if (index == 42) return (0x0000000000000000000000000000000004271514971f40d24c1f671b93a5ce9c, 0x13136db5a7012ef253cb4645d6946578a915a771f2cb7871763ff4b588b72d9f, 0x000000000000000000000000000000000c8083f248791a2553f78a6ba7e31f7a, 0xd0277b53558c226e428fe727b71beb263baa7fb56fdd4f7a0ac802a6f42370a3);
        if (index == 43) return (0x000000000000000000000000000000000840237841ba11d2010f742aeb5024f8, 0x19c73e98217d35996157bcbbb76f01ef4dd3f6cf484b86c0bc58ee103a76bda3, 0x0000000000000000000000000000000009af5cb844a6f056f0128a55b99a2602, 0x1e44aec95898c9481ddabde3630092a24f076eb6f37863b522b1d562841d9dce);
        if (index == 44) return (0x000000000000000000000000000000000edf9a9d30fb754b3ae7b1e0aee8ae13, 0xe17e177be457ecc2dc3b169b8734040af3439b531e423b7f496ebb402427409e, 0x000000000000000000000000000000000901a5780c9905e6b505f2bfb6132ed6, 0xe7ff459e3f99749bca2a1528e7b01ea13107b9c6835ca1c883ebafd0263ed943);
        if (index == 45) return (0x000000000000000000000000000000000335ccc664347ff09e229428243c590d, 0x4c6411c40b0d25152185134783ac750944db62a1458b7f5167ec316c264b60d3, 0x0000000000000000000000000000000015d293990e1e04276edf4393dad458e7, 0x4892f0dce31176bd82e90b52c74a39bb7bde0e14ee7df7230d4de069eb751d05);
        if (index == 46) return (0x0000000000000000000000000000000008e4cf77105ba122404d0da6ab962aab, 0xb1ea3a261cbc8e1895cd76adad9ad6dee1db87fdc36e514c4facdefba3c5f775, 0x000000000000000000000000000000000a31de84dd16ee2493c984131f4dd641, 0xf6bbf4dc0bd634ed934a1315e62c67f8217372be36d3fa94c1ed089d8a9ab03e);
        if (index == 47) return (0x000000000000000000000000000000000c37af6ae53ee073b0211c7b6aaf8090, 0x336ba2cb29e0f8ba8fb2d664c9421536ba0f59bca114241d2c15c1d2b83707e9, 0x000000000000000000000000000000000927f9c73e3db4237017f4a8df9120b8, 0x60985028935a2f7434a9821b8644ad9681fda86e9a9ea6b98ce2359ecdb0f284);
        if (index == 48) return (0x00000000000000000000000000000000048649f0c9d20641a665194fc29ed1d8, 0x385c6845f0a7fd37365d96b6482612b62aa29d7a213f0b148aa336071d9122a8, 0x000000000000000000000000000000000d9323056b2fff4ddd154b91864aa1c1, 0x77c8117f2871499135acaa32a666097b1088af452030773439caaec4acb18dc2);
        if (index == 49) return (0x0000000000000000000000000000000008aa389bff242a3ca61357561d279ded, 0x04abcd4fd7cf4d07dc4b36aea850a45fdee6fea484fd4dff57fb271db30b82ef, 0x0000000000000000000000000000000018575d7e685af09abac40c7ff0821c97, 0xc19cc5c6e33806ca42997abac1571cccd00210dd8b9dae62dff2da3cea9f24e0);
        if (index == 50) return (0x000000000000000000000000000000000f5449fec93f6a9804823c4149bc031f, 0xae957ba23a2c8f80c0a71989d2b86516a10dce35d5b87780403883e69c53fc12, 0x000000000000000000000000000000000849a3223f7b06c65a25a88016086d1f, 0x3de137bbeff5b33537c2c4c457b7932412db8cd9488ecf6ab90c55cb9623792a);
        if (index == 51) return (0x00000000000000000000000000000000085462253704baf8674a79a681739c3e, 0xb64169f4bc6571aa3356266a14692caac8198d75d40409b77b8d6879357cd45a, 0x000000000000000000000000000000000e194c4039794859a57f5d4f8aae7087, 0xfb40b178482a0cd41c3f240daa812a2e79184aeca0f2fafc453da458f9fd8071);
        if (index == 52) return (0x00000000000000000000000000000000045a2846416170190ad3817f1ccc252d, 0x2e6dc1574a1c1b7cf0070d2dae59b81e947514283803e6187e0950e07091fc33, 0x00000000000000000000000000000000144dd1188443e8c77a53727876c710bc, 0x357c6913a2f6d0c90f693d9cb2dd881f48aeab42b6761e17c0233e3ad48abf8a);
        if (index == 53) return (0x000000000000000000000000000000000d7a463e8911b5b3d2b32597702ad57d, 0x1105a9ae200e07a929d387103a7ac0507431e3f89ae9c369df5afbc72953f5cd, 0x0000000000000000000000000000000016ae7f057f900705288af8271c9449bb, 0xc7bceeec6b4e68739580a2910634f66ddddf203c81b72e4e57bd98c3949e5491);
        if (index == 54) return (0x0000000000000000000000000000000015ba8e920da26e55e5bc58482c64afec, 0x5fb6ae2385d3fc1e963d0fedce8c5f45fa5b15651f10adafa18a4947feeda933, 0x0000000000000000000000000000000017cc99a32e37d80b52a20fe968fc88c3, 0xdf8ed1bc19a9e715e3c98b7b30aba11fc0e3b1d1a8758e17963094c4f8541e84);
        if (index == 55) return (0x000000000000000000000000000000000e31ce20eccd4ad2e2bbdccd7ac3c50f, 0x06611eb41a71584ddebfce593753a1231d74bed30a7bebda2ca603f77bdba2ee, 0x000000000000000000000000000000000e009bc213cd53ad6d4e35bd96ae32c0, 0xc462af0adbc9c92875cd1b3c81660af3ab5fe13cef500fe697995fbbde96bb40);
        if (index == 56) return (0x0000000000000000000000000000000005bd234e2dc65bf90935b48f9e67f60c, 0x6023af6b4b8bcacecc19e06cb73beca8ad6e13fb1496ee7d4c3343c4f8d6760e, 0x0000000000000000000000000000000017489f401fc7c9f272ed2207fd8d20e5, 0xf0715697e76b41a629718b707dd1cae85f45ab2e15c56d7e9284b3cf583b3b6b);
        if (index == 57) return (0x000000000000000000000000000000000522535d200f2836e4ccf00e046531c3, 0x6f1c4f0261710724d658bba939919a7a8e185ac631f6543f33743aa651f92077, 0x000000000000000000000000000000001008af24bf54ce385bfb1716ad82a507, 0x3836582e3fb27a2536e7e9a0d5521d9b143c799b045d28398104007a18bd7f0c);
        if (index == 58) return (0x0000000000000000000000000000000004ec24d5d1979148f751a68bdd076e06, 0xa473f75dbbdc23b96672532ae6c097b5902c50049a75e297faca3b3922685c96, 0x000000000000000000000000000000000671c1d8aa9c748894ab39472146f88f, 0x27b6193c60f87ec6898a2391004c94a9941a84b1952b2a8cc2ebc2e087b1a0e0);
        if (index == 59) return (0x000000000000000000000000000000000f473e9c41c28160a800fedbf44d871e, 0xd6c0a5ea4c5d8d86834260f004bbb41c93b055401042ab5859955f4c43e534e9, 0x0000000000000000000000000000000004c975052346329065506319b7b13944, 0xd7af89fa48a2a9af1431dcc4c034aac743a9848289f73723328d79ef4f3c608d);
        if (index == 60) return (0x000000000000000000000000000000000ff51b81078a3593bb36a1f6321994e6, 0xe226cf6a68eecf8e7a3bedf3fea4c3feedaf1de3385088078a5ec40a46bce400, 0x00000000000000000000000000000000108dad977b5d001215a82ee8dc9e0a2c, 0x8333a3b46e50f4223f354bad72f0e6834280ef941dff6f214a8955f20a94f5d3);
        if (index == 61) return (0x0000000000000000000000000000000016697b4e8b6f4589351b8b3b85d37a01, 0xb79abc70a8eacd800de649dd523f562a2e423f95ff47354fa51fcb3f253779e1, 0x0000000000000000000000000000000018c78371c009bb927181d373af63c4dd, 0xd3518f074f42671b1ecb5510997d0474f3ced347fded71b9abf13cb7a6c42e42);
        if (index == 62) return (0x0000000000000000000000000000000007e795faaae5da7d93802521946786fa, 0x90581004b1f9f8ed04c3a9cf706e037947d104071362e861ae86ddb21bf0f007, 0x0000000000000000000000000000000017e3d3c422b3d0d680991e033a5b1a57, 0x4527bc95e912b3ef07c23fec3afcb8ae267501dc787078c7ee6be41f161959bc);
        if (index == 63) return (0x0000000000000000000000000000000007fe82c673a73042bb65e6bda912fed7, 0x0ef796484cd1e164a2fdf41259b77bb2caa98a3f6ff7ad7b9fb00ec6354099a8, 0x0000000000000000000000000000000012cb7a59a68cc68f47b2f523b7761cc7, 0x30fd50a29915e23f6eb01a9e0304012fc17db02323ca1f044c3f1f3a7b79bc12);
        if (index == 64) return (0x0000000000000000000000000000000011a17f367a6da02506dae8dc60bf6f4d, 0xe06ed6769a3e7b8e30cb700c05ae30efbb3551c3b345c9af6decbd35a6cf39f3, 0x00000000000000000000000000000000128b1bd87cd75e8b14bf7ae9977269c5, 0xdaa970eb07b0f7f4a79f3a5b72559d9ff6c08d64159874d0d132e3300e8fc048);
        if (index == 65) return (0x0000000000000000000000000000000003503ed1ace84747c4b36c29a4752681, 0xc253542a228db29b90a559f0fd0a1f6b1fc103ed7c7d01be53e13a99d6b63055, 0x0000000000000000000000000000000010a2eda33f9c7ce8cc3dda04054cb3e3, 0xdd22d5ce9a29b4c40b0c771b6746365a60fc89eea77949a0b846b1bb09b726d4);
        if (index == 66) return (0x0000000000000000000000000000000017f45557dc44052d6be0ba4d6073ebce, 0x409da98a4684a50b0fc0ff5750bebe2cbd08a290e87eb66f808cc52159fc5882, 0x00000000000000000000000000000000050ca60477ed3922b23a59ccda03de70, 0x66957e560e831c6a3fda2adf2d14c6ead2159392b40c46ab4c6689539533d512);
        if (index == 67) return (0x000000000000000000000000000000000dde5c204fba2c32dbef6e8f5d321839, 0x13e9c1ec39e65ad3f133a756d0f813b757a54c0b93c5932a43898c346ce62973, 0x00000000000000000000000000000000130e5391e531417b30b868340d6bb801, 0xd551851fa17244833c72f1a82aed72917821e2f9a01bc70554b361c77760c158);
        if (index == 68) return (0x00000000000000000000000000000000160eeedb3685bd88a110995958deda2c, 0x686a9ed2e4c1ce23e174a6e7c82452871eb6d70419c92b14c856000dd7b59039, 0x0000000000000000000000000000000011af9b3cde62a9950984ea35d3bda206, 0x4471cc0f0578c0cf0ef66b1cb6c4928b6be8820a4a13f0b68689f0a243217d29);
        if (index == 69) return (0x0000000000000000000000000000000016e3233300164eb4c5878b21cfcf0336, 0xc8d9d7f7ca86039e4d4c113835024ac8df3b5b3c15b158f165ff5b358841848c, 0x0000000000000000000000000000000017bfc1c4aced6545f16434b3ae7eaebd, 0x4c6defc2e7d6bdb80c0548e46b8879d735f44edfb06dbe380e0240f3c851c68c);
        if (index == 70) return (0x0000000000000000000000000000000018b39b89dc59ccb0c131754212dcc83b, 0x2409621a8fdce509d7acd6347d5de05f5bb814ee3370e3523d2c2aa08e62d409, 0x000000000000000000000000000000000f42fc9a9fa3cc02508f83fb144f3eb5, 0x451c0ef388446090d8cc262cfdf72f59438a3de278638da2ec2ad0a1bc8e56b0);
        if (index == 71) return (0x00000000000000000000000000000000156a1931fdeea88077bcdc8dfb61160f, 0x3fab376971bc4a4ef8ca74baa2db62d26e9aa06655294967ab581c0ca6f4537e, 0x00000000000000000000000000000000043dbf5e087a36b3b7dc8e8449f67de0, 0x9b2a3dcaee27dc5f25d249b9335637a7cb5c917062e31cb19bbd07200685c697);
        if (index == 72) return (0x0000000000000000000000000000000000d28683b953fb9d569d1f1182bdb93c, 0x39d12571833f84d149cb4a972c345b0f4f5892572fd879ecc45d71180b6e0e6b, 0x0000000000000000000000000000000003b091ec02e2d53249d527b7b805bbc6, 0xd7951bce7a13f24152d01ef4f8f6be641fd2dbc9a6dad154243eff757eef80bb);
        if (index == 73) return (0x0000000000000000000000000000000002b396aa88adb63c5cdb667a46c661a6, 0x1c6322275cc45a09105c2ad8ba7dba64ca49fe44231eac2485d7db3d1cbb29ad, 0x0000000000000000000000000000000008f27140db622e891f9eaca6d033fe95, 0xdb45173c4ffd6f4e25699bba3e993004993b81e7266ca87bba5aa8d289dbbba1);
        if (index == 74) return (0x0000000000000000000000000000000011d90be8e6177f52686606d7945cc1d1, 0x8c8a753ed12173aabfa2c3d271e140a744c1c5163aab6058c1c6d15863ee361d, 0x0000000000000000000000000000000002a0a1702a8c52aca7150f18b0be27b7, 0xdd06f87baf7d1d49dfe907aa39dd5a0be5cb956a6206cc763da722ae2ff04c5a);
        if (index == 75) return (0x0000000000000000000000000000000009b1db9b811506987de60340681905d7, 0x52fde26b990c8307776baba41bec2761de6252feb241da3ae6608d17c75cb467, 0x00000000000000000000000000000000101986439e52012b83087014aac0a60d, 0x8a87829be7936939c51e38f24f995e4a5bd2a7cff5328432989b32dcd7ede7f9);
        if (index == 76) return (0x0000000000000000000000000000000004073433e1a06a2975f2b9aa102a2d85, 0xd38e94066fae96cda5816a8e84a644f5f7806a4945526e9d9e8b48650b6f3890, 0x00000000000000000000000000000000029718d6f78833a0b37d01a9208dd70f, 0x949e1db9ab73954255aaa1da063565021757d7aa7ce286c36161f35eb6fd4d8e);
        if (index == 77) return (0x000000000000000000000000000000000c46f725b797bb5f61637bf164556ef7, 0x95a57c79e9b6ca8ed28017b45f9b7eff9c23eb7f3c978f89b18ab9bf9df9e3a3, 0x000000000000000000000000000000000b356917aa6d07bf2a94d9897cae1f54, 0x93bef3a8634cc7f5724c4318f63c031d377fdc983970c0def3aa3ef721dbe4ce);
        if (index == 78) return (0x0000000000000000000000000000000017c7cf97be6b3869b9f14fa521968a53, 0x453f2d3def013eabf27c0c6de0527f9f481cca488a07eef4153a9dac01138513, 0x000000000000000000000000000000000211157b51b1dc14fd5f238dff14b001, 0x8425c41c545911e1af9973816784cb8b2431c514f76d2bdd8be03f24af30d1bc);
        if (index == 79) return (0x0000000000000000000000000000000006a7afcf7582617c564c65f2da12746a, 0x5540e0b933ded32047c0465b71638f3203bdc3a9eacbb331eec41a3129eadbd7, 0x0000000000000000000000000000000017628a2bf71fd96c7d00ff8c83064d7e, 0xa67e79b48c737f485035a024b0b39082e3518de776911d3f6f4e7dc9f27335f2);
        if (index == 80) return (0x0000000000000000000000000000000013d1ddbbfa664a65c90c249ab63aabe2, 0xba60fbfeb27fcdc42111a3b685980a683b08732778bcb070aa6d315b14b4b339, 0x00000000000000000000000000000000112a7bc70e09b4196a55ff6b1d0ceed2, 0x9a57cb2f3a9f8e050c867430209ad9732e5b59612c4419ea24c45ac589196865);
        if (index == 81) return (0x00000000000000000000000000000000104bbebf964a98be46a36e787654fc38, 0xe30f1c9ae5d7cfd2ffdceeed3f5535d3eedb29be79305a749e02c1b67f355900, 0x0000000000000000000000000000000001d7585da892d2d7290130e97329d2ce, 0x388a9c7dd63f1a9e2304807f967ba9fce71e04b8eb02150e4aff21ab253f2622);
        if (index == 82) return (0x00000000000000000000000000000000008415ce3e6004954ec3465314ecdc2f, 0xa6ea6ab44f1d221ae9a7b5dd2d73b53138ef894c7f642ede35f05d151f262fbf, 0x000000000000000000000000000000000748aa0f823dad44f3a8f794c7279ed1, 0x5bfe93ae9f4d2ab887d96f6b82456578495a7de6f99c90b621c2bff192416cc4);
        if (index == 83) return (0x0000000000000000000000000000000007f834eb8b4f8c127ea9471d23f724aa, 0xd68d63b9fa533a30100423055b1a83ae3bd2e00f708958977df3e8c0c366fe5a, 0x0000000000000000000000000000000018bb1241eb18d2004d3478aad15e81d3, 0x3ae2b9da127aac4693c37bba4b85ad5ebf6a61d0ecccc919aeefaf72798f42d9);
        if (index == 84) return (0x0000000000000000000000000000000010b798ed6c948a86fa88301a47a69e43, 0x51a00e96bb42bda26135c01da0c0264e6987d7915264d95072d25ab0e0488823, 0x0000000000000000000000000000000005c3d50fc3c45393e4c92572f309150f, 0xb9700fbfdb3820fe728e71ff72e4e4d4d4be8b4aa3e9057a59fe3a3a5e6cf9d6);
        if (index == 85) return (0x000000000000000000000000000000000c8afdd1a1a365ec4a4f365be3d14225, 0x13525121694b37b8e50ccf35bb0d0691c7a5b11182676ce39ea5ef3e12e153a5, 0x0000000000000000000000000000000019ad7bbcfbadbe66ecef35b02fd29a2a, 0x88cb4e8515e7a638a7895de58c729c72b89387775d72a2d15e2b2fdb5756152d);
        if (index == 86) return (0x000000000000000000000000000000000d7a4362481c65f42209b69de1e32f52, 0x9bcb98650ccae8c66efa14bb43899f9141363b8c06145776bda0e7564c5dc3e5, 0x00000000000000000000000000000000010064dafb2cde738905d4d4a8e2a3cb, 0xe3a0460e1f0f7d60e090354512132d8d6fb92a1c77e6444a265aacd806acdf84);
        if (index == 87) return (0x000000000000000000000000000000000f319cabf7ac3a1ed6ffa252d52a90ed, 0x0cd546f42a464b5f61d6f6b6b78952bc3c82af39bc2c56cc14ae4f37d76bbae7, 0x00000000000000000000000000000000196de1f9798d4520894c79ce32a42ea7, 0x77468f88b72a0edb26f64481485a814f1df59d5b957ee2ee7ed18b21a7e069fe);
        if (index == 88) return (0x0000000000000000000000000000000001c5bfdfae5769c7e54fcfa55ae07fe7, 0xe384c4378b9f536b8f37a98033a3060b74e2ff82a1dfb6e8b748c2a80a2100a3, 0x000000000000000000000000000000000b757da6482423a175d17722a4f35da4, 0x01f1cd5cf7cbf7477c5194342c80e308abe8ed4e61ea4ad61f6582ff08b3e4b8);
        if (index == 89) return (0x000000000000000000000000000000001020a9a68607f7c2225323af4f235db3, 0x81fbdf7bafad484374f86cb3916b4a227ddc8cca3a18b75b3a022e7c8780ceb7, 0x000000000000000000000000000000000758f338acf6d3b282ef3143bfc935a0, 0xb304d361af5e71425287fbfe2e62436f2b4bf79750c617588ffde8ce544ecfe4);
        if (index == 90) return (0x00000000000000000000000000000000134406ae35f39dc3a62233c091e0bc05, 0x57dd3be843cbad937e4e93c8e327e29d7a036eff4624a5bf7c9f20cd0a4a050b, 0x00000000000000000000000000000000155ef07e28b3b7dcd418be4cd8402f45, 0xe9d8e61f8a2568e4dd10e0952cf2cd42cc011d2a10f7e857c783f702b56bc576);
        if (index == 91) return (0x0000000000000000000000000000000003f7e5550b5d4aef945bf284a1b02240, 0x5719a32aed89b2625c7bd2e7646c67eba7b89887a28efa499f84e795a7da1777, 0x0000000000000000000000000000000003fd8a9b8e27f58882056e4fbf446ad9, 0x48058e41d088e434b68f0f94ecf226a22836d842a6b4315116de2ed7c7e5e492);
        if (index == 92) return (0x000000000000000000000000000000000e9f66e2e4c513af93f6014da487be0b, 0x381313af169289474d978ae0d48ba5932a9de58fbe5e7238f7fa0d345078f05e, 0x0000000000000000000000000000000011e5a91e45298575da6a50b319cf3379, 0xbe6578b4b6f705f8dedf7389017d921b23a6bd44e8dfa7afe9c5dc25034c949f);
        if (index == 93) return (0x0000000000000000000000000000000006e0b61774c52a42144b32a41fa01e01, 0xe4b0e4fa172349b8742172f40b7c250aca31c13f168f3d39b656663be5a0b8fa, 0x00000000000000000000000000000000075ded918c63fa360ccc7a4d7d130629, 0xc50462f3a8a0285c61df70a8189c22ad42c6882c2bf011b1071778e6ec8c9343);
        if (index == 94) return (0x0000000000000000000000000000000005cfcfcb467338b9f7a000c4620a38d2, 0x885bc8bf51da8d92332ca5dc0bb0cbdd0165b48516134b528a7bd0ab6d17644d, 0x000000000000000000000000000000000d607473426d97a717995b4402ff51e4, 0x0d05ad4cfaa5ba351f8a692aaee13db06646447b2c717a835f66b54d336c4c01);
        if (index == 95) return (0x000000000000000000000000000000001545c746a8db12386a1ade76470f21af, 0xa9024d4a95d103fd47c165c8c7ddd6d2b850db1bc55503b07a30a5da4794db9e, 0x0000000000000000000000000000000000418e0ac34973f5f5558a8913d04b3c, 0x7084fbdf56e288dcfb6e8dc0e62b868f26b01627fbc0e206e84044ef50cfd350);
        if (index == 96) return (0x000000000000000000000000000000000d379377fc5180dfd1bce3dbfe154279, 0x05059fa38acd114791d86351c7280fcebe49cc7ee3d78a160df7141dc6794f7b, 0x0000000000000000000000000000000002f9d8b9c87d55ef64d09c00c964de12, 0x91e5b3a1e51dc92023fc3486f91a74d680796cb2424b801c6983dfa9dbbba138);
        if (index == 97) return (0x00000000000000000000000000000000133ab521c3c4705344a8cc2749e7ad72, 0x475ded7dfe27b7ff8e066aafae78e225d10ce28a9fbdcf115b57dcf437794f1c, 0x000000000000000000000000000000000339429afe305bd6dde6f4bd0a99bd64, 0xfba9ba8e3c71fa4e2fa5ed023451dc4146ace1cc06ea847e7f4770faff439b29);
        if (index == 98) return (0x000000000000000000000000000000000da878909e229a57a32acf5d8ae4f851, 0x40140b45f9c930e9632fcfa38bfa5f99c6855ae9a808e42f100539ae51a291bd, 0x00000000000000000000000000000000028469f4ad42908985c12ea0a11ee0ed, 0x4deb18723e81a37a4fd39dab9c4a6beedb9278f727485822fbaf12b9f92fee91);
        if (index == 99) return (0x000000000000000000000000000000000f4e562ff0d94cb9cbc91392c4bbd8e2, 0xad1d62ea826550c6cb78a7b15e3ab07958d83608293c33145164b9b90d499c45, 0x0000000000000000000000000000000012aeb246f38c8ff94d026a27c3de507f, 0x58a58c10485efc462d3fb384519a1ddb349e424a99b89a0bafa67d5975f77bed);
        if (index == 100) return (0x0000000000000000000000000000000005009178ed9cdcab999c05c28accda54, 0x9fc3adbdfbcf019fff5d97cd0550a11216102476fea9fed0cd866133bc619cc1, 0x000000000000000000000000000000000cc6531e6638e3452f339790b8da4c7d, 0x32d575fdde2a045d27e1db2619cf3c4f8563bbf67d1e8d37d968af414cd847b0);
        if (index == 101) return (0x0000000000000000000000000000000008d230081509402804e54cfee27d25f5, 0x0c4fa87797f880400b143f3012713f1d08d724eba063ce25a9de5103f543a604, 0x0000000000000000000000000000000006df6d21afdec60c965307be03b7d95e, 0xdad9c70b89d3a9b9150038d22927c6252a1ed5ed92eb3422dde88662c5974545);
        if (index == 102) return (0x00000000000000000000000000000000102972419eece365e78fda3fd075f049, 0x993b0d9d3cf700ebf36d8a7518f5a6b09f7788e42c66bc37256e8e8c6eb3b9ed, 0x0000000000000000000000000000000002c5e45ec88dec5a8607dba413a879d1, 0x67a766f5c92a1f0bf6e6549157ded73a6b3c2416fca2a9550cdc51389b0d684d);
        if (index == 103) return (0x00000000000000000000000000000000162917e188a56c540c4799b6e05ec19c, 0x25e6ab7d3c143771b5a2251e4acc4a11a32735916639e4cb8447587a79161e1a, 0x0000000000000000000000000000000016d2902b4943392fe4c1a565160fa8bd, 0x41b0653b6d2641e6c60a7785e6d98406a14cc049a771ce36515bf7a023fc5462);
        if (index == 104) return (0x0000000000000000000000000000000001646fca6a07e0c70db53e50e08b8259, 0x31e8d57f1a3bc717afd282cbd182141549aef7a209484741f640bd9cd8b3d025, 0x000000000000000000000000000000000817466aca7604079c1af4a4eddc412c, 0x7c04d07a33f1d486327b478d946ea97b1e768ec91468f3222d51134c9428a4b8);
        if (index == 105) return (0x000000000000000000000000000000000951fc04ae7305b1cbc3db0eaaa47cb7, 0x9f66549f4693582363a15db76cfd76797be81e7dd6b059437fc2b3e74d38ed98, 0x0000000000000000000000000000000011825688562f018a2c2a3f84cc29eeab, 0x647cc0478fee43040d50b547a27d48873cd7806142e0d191f278b05e3ba71431);
        if (index == 106) return (0x00000000000000000000000000000000191a493979c4330551cd30e7e5f94a0e, 0xa773e0c3462922f02934ed82e7992abe4a09ac25602828629e5cc641f55c9d5a, 0x00000000000000000000000000000000046f2d6a9989098aebcefc3d03aa0839, 0x5fa46927db94f877b5e41b4b3aab3f4857d2986c4fc098d522cf7534308bd52b);
        if (index == 107) return (0x000000000000000000000000000000000d81f6ad4bbe836dc0ba1819e69c7c72, 0x517613921d4e838e0953232c543269923ebc33631727acd4ed3d78c8b8f7d897, 0x000000000000000000000000000000000dd03660f81c7b8bef28d652f2a62324, 0x09fcc5d51444bed78fc18add154f11abfa758f66e3c838f8b71207083adafffb);
        if (index == 108) return (0x000000000000000000000000000000000285d1ca409bd92e21a8ec372eb5df5a, 0x7c0bfb783aa2d6749dd32b24528ad9b82696e45a4c96e3d8371c74468e30efca, 0x0000000000000000000000000000000008f3a8f27329e6161df605f75d86adfd, 0x39b59149073256a9237960393b3bd99ca82e52307c74d10460a27a13edd413be);
        if (index == 109) return (0x0000000000000000000000000000000018feafb11c7549262bdec877adbd663d, 0x0f5511d8a0d755cf372a645d4da68dedbfb2590ee88f20582f5b31dd04900d22, 0x00000000000000000000000000000000084c2fccaa4ef69efe66bf1321786029, 0x92275b6e285d7d9dae5f5b1d05fa02efe09162589f8a0a31d46ace0c0ba0fd04);
        if (index == 110) return (0x000000000000000000000000000000000e35f574d966160fb4e9e622e8e49e88, 0xf5d42ecef67e37236d59d89cbf818de747b850dc3f008007caed31ef08d2e3f6, 0x0000000000000000000000000000000010c065a87132c529115018d1e6873726, 0x4099ab1dab74a2a199d96941201bae1306f92a0a01f66bd898fae8d97e0c25a4);
        if (index == 111) return (0x000000000000000000000000000000000173ef3cd9809834f8bb6bca8be51892, 0x1c725396c1ec957379feb00d9cec8b13e99b3381e7f9bf0146fe9df2f2dd1f0f, 0x0000000000000000000000000000000001e40d357fd84a6d0afce7a3f12ac501, 0x138770da3197f4b09793405c83423e06636d7feda79728ff890c476839eb4df0);
        if (index == 112) return (0x0000000000000000000000000000000011aca1832fc00cd2483d381173687f91, 0xc42f8992b88a719810db064cd409324a4d67a5bd97b3c447d8e1e63ef66e6d33, 0x000000000000000000000000000000001732e105ba4f593a78e2b29f68e913e3, 0xe37c1bafc60b8d1c227d8368e9fbabae93f652f54056a9ed32b0ae88a3b8be93);
        if (index == 113) return (0x000000000000000000000000000000000c53bf944c9bf5e691bced9ecf0fa8b3, 0x12ef22a4279bcc3e3756829348578842b93d7bc1320509c0889825ff76c7d15a, 0x00000000000000000000000000000000137336c02c58ce2a0d540936d04147d6, 0xd248c45d41bb37513e99c0da8df70e104f57f1e00e8eea12275b1ba3a12414f8);
        if (index == 114) return (0x0000000000000000000000000000000018be71d6d2624272ed4d08dbb43dd8aa, 0x93a1f58986db798cc55f5230625e64f648fe8fbea61dac022d402533b0825c9c, 0x0000000000000000000000000000000007d3ee223edaa652ffc2b71e3772f2cc, 0x8cb99e51a9d91ab058d09d26a2af3087c47dd1e769868edd71e28970a9dc72bd);
        if (index == 115) return (0x0000000000000000000000000000000016e74fb086fe019059b26781dd3bcfed, 0xdf48191d443ad9aa094a36887128b4f420d9b9c5aa92396c6ccf9849fff68e5a, 0x00000000000000000000000000000000056fc0116a82189080f315bc53e711d7, 0x4078220f553509c97fdb41d2edf21bb02c70fb58f90bf86c20751f030b5b60e6);
        if (index == 116) return (0x0000000000000000000000000000000018c1eb99f2f1eefb7984b0d0d04492b1, 0xc22d6d7475883652225542c9158e5503d3c45e3f7147219a3e685b2da2361c3c, 0x00000000000000000000000000000000137e9574b30c9f061dfe47d747860c3b, 0xd7916219a45d659b7c00e24ce09085e8f8becfa0ee0f757723e16a6442ac8151);
        if (index == 117) return (0x00000000000000000000000000000000131def3eb8216b52d281d6508857514f, 0xb788bd24fa7593bef733e39a431c4a82997aec4825acf9b79a8b108e7a4d2d0b, 0x000000000000000000000000000000000b4c37f28d7aed7623e441afdf06ccd3, 0x078246f72c89f0ca7381743d6e9211d5e70cc6f50f8b97c67b6d202b722f0c0f);
        if (index == 118) return (0x00000000000000000000000000000000054f26422f04105662f08e0a57970c2f, 0xd839612786dcf8aca0725f8333e6a70f98faba554d9dc9178429d26a97f3328f, 0x000000000000000000000000000000001860f2867c24b9928711952efef96bd8, 0x59638124b0a78fb2f1423cd2c64db59eb439b7b1f37135e52877e6c0b53d8bc4);
        if (index == 119) return (0x00000000000000000000000000000000101d9eff6d0aab2b585c83fa638d3059, 0xc20a9eddc18bd4cd38d2ba37393a7bf57623970458a92d735d6e8a7911b6a6d7, 0x000000000000000000000000000000001899efc5d5b63c09c74daff3de3627a5, 0x93b8ac1768915a97988c19e2ec609c1530163505d8a0aee455af595971838e80);
        if (index == 120) return (0x000000000000000000000000000000001913cd2e32e4fac4d7a0db1849385d01, 0x41a31b2547c8b90152481e50abb2982599f34bd5f2b4cd3052c4f55d529075b8, 0x000000000000000000000000000000000152678f4657a9e01b9bb27bdb525612, 0x9641438e2d8073f0baf3e8dde3b89c08826d23a48cffde835e0b3834389b55fa);
        if (index == 121) return (0x000000000000000000000000000000000e292d810827da6a8df909b6d5f292e1, 0xf3f890c707694de8468a3aa7a44af3ae32b2d8d7c20234750be3b5e322ca96d9, 0x000000000000000000000000000000001544cdbb25228c226a77fde821991b83, 0xc560f209393adec20527a39a9924542ce87f3092e482a34ee17c18b036c50241);
        if (index == 122) return (0x0000000000000000000000000000000006c1f225b1a711eeeae2c020746b4e99, 0x397dbf9f218b82a1f27b8b2a0bc43639b8b649348a93d3241d31f16d9fad3ef9, 0x0000000000000000000000000000000008a640549bf864cce4c48568d526b895, 0x56d1d5d55761e09d0f8648b3bc6b2c6a518c7c55fc8d194aa8ed9d977802fefe);
        if (index == 123) return (0x000000000000000000000000000000001438429a74fc833e76894697009202dc, 0x39d33ff60e6472bd4c4a9886d56f83a3b4463722eb6536f340d3ca347cba6408, 0x000000000000000000000000000000000a8b98e22d6f84682bada464130f8c43, 0x45c88cd44f5bff0c33a620e6d90fb9513eaf5d22324a5cfdd088248ccc131b50);
        if (index == 124) return (0x00000000000000000000000000000000014a2ac79843818edb69d2b50b8bb18a, 0x96c5b484c25ce151cc7ee4da1431ba894edd4d2fbef93b0aa4663f563dd8b46b, 0x0000000000000000000000000000000018d26d449879121a31fff29dd7efecc7, 0x9e93c2164dafe3b9ea2338aa3beffabc00d0f109c1da98d20727274fa589c509);
        if (index == 125) return (0x00000000000000000000000000000000065ca24a04aa5d1cdf24f423b0f281f7, 0x9f45671baa3d5bdf2eb6ace27dfedbb85f2f44207338bf89feba5e8cff24661a, 0x000000000000000000000000000000000556ba3f97c9c1f06e6ff4b47bc80ed5, 0xc57e90178997cb4887a55beed0da348b084d0ddbd5b640b4be3ad531af18070b);
        if (index == 126) return (0x000000000000000000000000000000000cc5b2b5d72e092d29fe881275de13bc, 0x133f221e574d58333317ea4db9ed525ad48a5b3ae41cea336307ea7d5352d56f, 0x000000000000000000000000000000000438a9080017083db60a96e33bfb96bc, 0x905d7335711afefdd54e31a64a604bd616057379230d70190ea3abdd9357fa50);
        if (index == 127) return (0x0000000000000000000000000000000014885f2885f9cde5e6e17f2f95d48b5d, 0xac7419747c5688b1f4aee09f5ef5261ea9cf311f83d0c837b6f515cdb8a6cd24, 0x000000000000000000000000000000000e318426a43d7b82fe6cccea446ef08e, 0x6803d875732adcd0428dc9e9a46e5a918329bfa68540a922e79652bc363c3ea6);
        if (index == 128) return (0x000000000000000000000000000000000add065ff730506b351fa6dc80c657b1, 0xbf92f1ee1c58db7ce1ea9dabcfd2eb2fdfd80a069d2704c7748f85b6ff8afa15, 0x00000000000000000000000000000000067150392b5465e4671229ac3fa121b5, 0x83036e8d8c3725d644a9aee5f04db8d5b2ee0855048cfa4561726f8cb695076c);
        if (index == 129) return (0x00000000000000000000000000000000078c397a039fc54d08179618fb8f12aa, 0x69fef408af2ba08d6d057033b457feaa2dac927d049afbac6acf8423e5d839b2, 0x00000000000000000000000000000000103dd3fa1e52a4aa04f5802af8cac74c, 0x6c744acb1b97e76a523340b78609b4c98d069669da954673c9e822ed9ae4fab0);
        if (index == 130) return (0x0000000000000000000000000000000011fa880e750461bae157cb704d6cfca6, 0x59bc653e5a95a186042af2328ce1e9fad2fa9a8f39a2faa7ef252096d4844197, 0x00000000000000000000000000000000181b9fad899aaf651a2aa4dd36595fb7, 0xfde19936f6389fe48d90f84de212e6a977f749874b9d32ae954f7e4097b7889e);
        if (index == 131) return (0x00000000000000000000000000000000073859c44a3f690929e138882a8091fe, 0x7e680146a9518a41750190398adb9987fbba9535cc707670915f1c26d66a7ad9, 0x000000000000000000000000000000000218aa461c847605648c3acab35a08d7, 0x9fa64ca19ab7b83f1b1f77c79c84ec6dabba2f47358a349b81e7adf068acd415);
        revert("Invalid IC index");
    }
}


================================================
FILE: groth16/verifier/test/128_leaves/Groth16Verifier128LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "../../forge-std/src/Test.sol";
import "../../forge-std/src/console.sol";
import "../../src/Groth16Verifier128Leaves.sol";
import "../../src/Groth16Verifier128LeavesIC1.sol";
import "../../src/Groth16Verifier128LeavesIC2.sol";

contract Groth16Verifier128LeavesTest is Test {
    Groth16Verifier128Leaves verifier;
    Groth16Verifier128LeavesIC1 icContract1;
    Groth16Verifier128LeavesIC2 icContract2;

    // Updated proof constants from prover/128_leaves_groth/proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x00000000000000000000000000000000073f88faa50fc02143d43ad6e04d7511;
    uint256 constant pA_x_PART2 = 0xd4bbcd62fc013946fe1f92bb03acb0d023a60661ab4ef1abc4fadf36d7a8b33e;
    uint256 constant pA_y_PART1 = 0x000000000000000000000000000000000a7d33bb58fcb3d1aa843bbcd2f9bef3;
    uint256 constant pA_y_PART2 = 0x368c2c7a3a74e764973e54a37de199d1cc3900e2c45f4b6dd327277b51f525c6;

    uint256 constant pB_x0_PART1 = 0x0000000000000000000000000000000015c67822da0ba883550bb78ed176248b;
    uint256 constant pB_x0_PART2 = 0x6d087a4ee190bfe865e0a7d9a64341592c34c10befeaa0f6bf826049255ffddd;
    uint256 constant pB_x1_PART1 = 0x0000000000000000000000000000000001afa6f3d933e12e35bfe39b80c5cd8b;
    uint256 constant pB_x1_PART2 = 0x01d338bff32408267b9fdd17592b30af57bce25e174249f15ddfce14db1e0187;

    uint256 constant pB_y0_PART1 = 0x00000000000000000000000000000000035afb5f40528ea07322e84597613b91;
    uint256 constant pB_y0_PART2 = 0x4c6a1ba2f3ca608a41e131a0df811171fc56786b753370be0069b4b6a37127c5;
    uint256 constant pB_y1_PART1 = 0x000000000000000000000000000000000b6a97d0c65b8882687ecda087822957;
    uint256 constant pB_y1_PART2 = 0x0ab2c6a416dda575d1e313e09017e2d525d8d6a19ef8657ecc948bb314a69f2c;

    uint256 constant pC_x_PART1 = 0x0000000000000000000000000000000018ae7f4b5985bac687f7ce707d31205f;
    uint256 constant pC_x_PART2 = 0x75247dbb2966068524857b83e9e6c95adf846d7b4c4fc3f0c2da6986f04a1ada;
    uint256 constant pC_y_PART1 = 0x000000000000000000000000000000001202c46378dfdb385d0de62c2a34737a;
    uint256 constant pC_y_PART2 = 0xbbf4b0d0a7a57e9ef5badc28cbb78843c9353a561b9dc0d08c2d30300108df72;

    function setUp() public {
        // Deploy IC constants contracts first
        icContract1 = new Groth16Verifier128LeavesIC1();
        icContract2 = new Groth16Verifier128LeavesIC2();
        // Deploy main verifier with IC contract addresses
        verifier = new Groth16Verifier128Leaves(address(icContract1), address(icContract2));
    }

    function testProof128() public view {
        // Test data from prover/128_leaves_groth/proof.json and prover/128_leaves_groth/public.json
        uint256[4] memory proof_a = [
            pA_x_PART1,
            pA_x_PART2, 
            pA_y_PART1,
            pA_y_PART2
        ];
        
        uint256[8] memory proof_b = [
            pB_x0_PART1,
            pB_x0_PART2,
            pB_x1_PART1,
            pB_x1_PART2,
            pB_y0_PART1,
            pB_y0_PART2,
            pB_y1_PART1,
            pB_y1_PART2
        ];
        
        uint256[4] memory proof_c = [
            pC_x_PART1,
            pC_x_PART2,
            pC_y_PART1,
            pC_y_PART2
        ];
        
        // Public signals from prover/128_leaves_groth/public.json (259 values for 128-leaf Merkle tree proof)
        uint256[259] memory pub_signals = [
            206695481878273484056705585188047556010030907458735423358908191339675099390,
            12345678901234567890123456789012345678901234567890123456789012345678,
            930919869281768667460268632116214329467302314052,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000
        ];

        // Verify with the proof data
        bool result = verifier.verifyProof(proof_a, proof_b, proof_c, pub_signals);
        
        console.log("128-leaf proof verification result:", result);
        assertTrue(result, "Proof should be valid");
    }

}



================================================
FILE: groth16/verifier/test/16_leaves/Groth16Verifier16LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "../../forge-std/src/Test.sol";
import "../../forge-std/src/console.sol";
import "../../src/Groth16Verifier16Leaves.sol";

contract Groth16Verifier16LeavesTest is Test {
    Groth16Verifier16Leaves public verifier;

    // Updated proof constants from prover/16_leaves_groth/proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x00000000000000000000000000000000136569c52d8ae28174779a4137be90a1;
    uint256 constant pA_x_PART2 = 0x779ae14f3a3dedd3762b71595898a38b899c64d7fa4ad8ceedb85821862c423a;
    uint256 constant pA_y_PART1 = 0x00000000000000000000000000000000120fbfa077720f1c5a34b1c62fb44343;
    uint256 constant pA_y_PART2 = 0x4dee5b1180fb47e19a75613c2ac3927fc6e9a0f191bbf91ee454b670cc2731aa;

    uint256 constant pB_x0_PART1 = 0x0000000000000000000000000000000019909e281a9c874573b50d0b028f14e6;
    uint256 constant pB_x0_PART2 = 0x13e5ec6a16bc6815117fe4ae1577a50e3eeb79e9fc45e5c855a47357cc1adf21;
    uint256 constant pB_x1_PART1 = 0x0000000000000000000000000000000010c65fe20741bf7df6af765035202b29;
    uint256 constant pB_x1_PART2 = 0x9337750e7c1261bcd2898006359a8f816e9ebecf0c861896ace44447ebbd420c;

    uint256 constant pB_y0_PART1 = 0x00000000000000000000000000000000151ab2ec8d92fb50dd33a57bd1f78f37;
    uint256 constant pB_y0_PART2 = 0xb82a58d01b6dc19277fb5b7a4745e8ec1968eec86264975d410678e937924a72;
    uint256 constant pB_y1_PART1 = 0x000000000000000000000000000000001121527ee8658367cedfb1480514189c;
    uint256 constant pB_y1_PART2 = 0xb02c24ba02a8d4742c4302807c4ff40eb5df407fb09ab7b03ac4bac2ec835e6b;

    uint256 constant pC_x_PART1 = 0x0000000000000000000000000000000017cec1b0782f4aaf18dd83c70fa65fd3;
    uint256 constant pC_x_PART2 = 0x4b72d6e0f2c9a4c25446edaf5d36dc414c7337c651519932cbab0c04d5d44aa0;
    uint256 constant pC_y_PART1 = 0x000000000000000000000000000000001365f5b649597193fdd485f117303c76;
    uint256 constant pC_y_PART2 = 0xcf3bfe461b099a88026a417abf8dd2459730e8e99041bb17d0ad812809ce5e15;

    function setUp() public {
        verifier = new Groth16Verifier16Leaves();
    }

    function testValidProof16() public view {
        // Test data from prover/16_leaves_groth/proof.json and prover/16_leaves_groth/public.json
        // This proof is generated for BLS12-381 curve with 16-leaf Merkle tree

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from prover/16_leaves_groth/public.json (35 values for 16-leaf Merkle tree proof)
        uint256[35] memory _pubSignals = [
            uint256(28610243300859813175896801336277197512176412480259486447172509003484661197946),
            uint256(12345678901234567890123456789012345678901234567890123456789012345678),
            uint256(930919869281768667460268632116214329467302314052),
            uint256(123456789012345678901234567890),
            uint256(987654321098765432109876543210),
            uint256(111111111111111111111111111111),
            uint256(222222222222222222222222222222),
            uint256(333333333333333333333333333333),
            uint256(444444444444444444444444444444),
            uint256(555555555555555555555555555555),
            uint256(666666666666666666666666666666),
            uint256(777777777777777777777777777777),
            uint256(888888888888888888888888888888),
            uint256(999999999999999999999999999999),
            uint256(101010101010101010101010101010),
            uint256(121212121212121212121212121212),
            uint256(131313131313131313131313131313),
            uint256(141414141414141414141414141414),
            uint256(151515151515151515151515151515),
            uint256(1000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(3000000000000000000000000000000),
            uint256(4000000000000000000000000000000),
            uint256(5000000000000000000000000000000),
            uint256(6000000000000000000000000000000),
            uint256(7000000000000000000000000000000),
            uint256(8000000000000000000000000000000),
            uint256(9000000000000000000000000000000),
            uint256(1100000000000000000000000000000),
            uint256(1200000000000000000000000000000),
            uint256(1300000000000000000000000000000),
            uint256(1400000000000000000000000000000),
            uint256(1500000000000000000000000000000),
            uint256(1600000000000000000000000000000),
            uint256(1700000000000000000000000000000)
        ];

        // Verify the proof
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        assertTrue(result, "Valid proof should pass verification");
    }

    function testGasConsumption16() public view {
        // Test data from prover/16_leaves_groth/proof.json and prover/16_leaves_groth/public.json
        // This test measures gas consumption for BLS12-381 Groth16 verification

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from prover/16_leaves_groth/public.json (35 values for 16-leaf Merkle tree proof)
        uint256[35] memory _pubSignals = [
            uint256(28610243300859813175896801336277197512176412480259486447172509003484661197946),
            uint256(12345678901234567890123456789012345678901234567890123456789012345678),
            uint256(930919869281768667460268632116214329467302314052),
            uint256(123456789012345678901234567890),
            uint256(987654321098765432109876543210),
            uint256(111111111111111111111111111111),
            uint256(222222222222222222222222222222),
            uint256(333333333333333333333333333333),
            uint256(444444444444444444444444444444),
            uint256(555555555555555555555555555555),
            uint256(666666666666666666666666666666),
            uint256(777777777777777777777777777777),
            uint256(888888888888888888888888888888),
            uint256(999999999999999999999999999999),
            uint256(101010101010101010101010101010),
            uint256(121212121212121212121212121212),
            uint256(131313131313131313131313131313),
            uint256(141414141414141414141414141414),
            uint256(151515151515151515151515151515),
            uint256(1000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(3000000000000000000000000000000),
            uint256(4000000000000000000000000000000),
            uint256(5000000000000000000000000000000),
            uint256(6000000000000000000000000000000),
            uint256(7000000000000000000000000000000),
            uint256(8000000000000000000000000000000),
            uint256(9000000000000000000000000000000),
            uint256(1100000000000000000000000000000),
            uint256(1200000000000000000000000000000),
            uint256(1300000000000000000000000000000),
            uint256(1400000000000000000000000000000),
            uint256(1500000000000000000000000000000),
            uint256(1600000000000000000000000000000),
            uint256(1700000000000000000000000000000)
        ];

        // Measure gas consumption
        uint256 gasStart = gasleft();
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        uint256 gasEnd = gasleft();

        uint256 gasUsed = gasStart - gasEnd;

        // Log the gas consumption
        console.log("=== BLS12-381 Groth16 Verification Gas Report ===");
        console.log("Gas used for proof verification:", gasUsed);
        console.log("Proof verification result:", result ? "PASSED" : "FAILED");
        console.log("Circuit: 16-leaf Merkle tree");
        console.log("Public signals: 33");
        console.log("Curve: BLS12-381");
        console.log("Protocol: Groth16");

        // Assert the proof is valid
        assertTrue(result, "Valid proof should pass verification");
    }
}



================================================
FILE: groth16/verifier/test/32_leaves/Groth16Verifier32LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "../../forge-std/src/Test.sol";
import "../../forge-std/src/console.sol";
import "../../src/Groth16Verifier32Leaves.sol";

contract Groth16Verifier32LeavesTest is Test {
    Groth16Verifier32Leaves public verifier;

    // Updated proof constants from prover/32_leaves_groth/proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x000000000000000000000000000000000f336c3b8a47dbd956fbe3d8b325cf2a;
    uint256 constant pA_x_PART2 = 0x53080a61314c571e54a7449d7a009566db3805c1e4bce0b9ffd3c231e0128c8e;
    uint256 constant pA_y_PART1 = 0x000000000000000000000000000000000443790d151bc1e8aab041ad1688f259;
    uint256 constant pA_y_PART2 = 0xc74682f85fa12dba095dce46658ac86c062685d606a1e5257fdf4c89cd690c1c;

    uint256 constant pB_x0_PART1 = 0x0000000000000000000000000000000004458e36b770de559c007be7eed48153;
    uint256 constant pB_x0_PART2 = 0x4b3f8c82cc92c7ee5a5bfa61ab832a73da97ac6285b472b551d3195ab21ab09b;
    uint256 constant pB_x1_PART1 = 0x0000000000000000000000000000000003addf48dc22f350ad77ccb424e00963;
    uint256 constant pB_x1_PART2 = 0xa3bf18000152fc7effd92a518ceec5ef5d95dc8d7c67d1c8043f083639baa008;

    uint256 constant pB_y0_PART1 = 0x0000000000000000000000000000000009fb58cd00c423874c6818b163986e0a;
    uint256 constant pB_y0_PART2 = 0x9eea5ad3e27db0e0134f3d14411c8b8e4572b6bf2cc72ce40be91cb867a62f7f;
    uint256 constant pB_y1_PART1 = 0x00000000000000000000000000000000032b234cfa09d28e7e183ea116bb3eec;
    uint256 constant pB_y1_PART2 = 0xfc412c59fa3697cb5b3ea22a164dfc8e304a3d18296088337d08b3d6892ab081;

    uint256 constant pC_x_PART1 = 0x000000000000000000000000000000000e2d9f54aabfd0ba65e82f6048185281;
    uint256 constant pC_x_PART2 = 0x20b392ed1edf89410e976706694b13e7b8b6407d8589cd795f0d64dd59a9003e;
    uint256 constant pC_y_PART1 = 0x00000000000000000000000000000000068b0f0187a6650f1df271dfa7572bee;
    uint256 constant pC_y_PART2 = 0x9d66571205e1f745cb4cc4de3b8c5fc1d43ededc4c349f587979d1ca57feb021;

    function setUp() public {
        verifier = new Groth16Verifier32Leaves();
    }

    function testValidProof32() public view {
        // Test data from prover/32_leaves_groth/proof.json and prover/32_leaves_groth/public.json
        // This proof is generated for BLS12-381 curve with 32-leaf Merkle tree

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from prover/32_leaves_groth/public.json (67 values for 32-leaf Merkle tree proof)
        uint256[67] memory _pubSignals = [
            uint256(37313680328208527071742884240564653402860122418310991085745147043134005207746),
            uint256(12345678901234567890123456789012345678901234567890123456789012345678),
            uint256(930919869281768667460268632116214329467302314052),
            uint256(6218676549690402052910318315276979534381485872621884367715834658603456243904),
            uint256(0),
            uint256(0),
            uint256(5708510646087729135889959965248975632956651064800454628727069218571497917126),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(2000000000000000000000000000),
            uint256(0),
            uint256(0),
            uint256(1000000),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0)
        ];

        // Verify the proof
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        assertTrue(result, "Valid proof should pass verification");
    }

    function testGasConsumption32() public view {
        // Test data from prover/32_leaves_groth/proof.json and prover/32_leaves_groth/public.json
        // This test measures gas consumption for BLS12-381 Groth16 verification

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from prover/32_leaves_groth/public.json (67 values for 32-leaf Merkle tree proof)
        uint256[67] memory _pubSignals = [
            uint256(37313680328208527071742884240564653402860122418310991085745147043134005207746),
            uint256(12345678901234567890123456789012345678901234567890123456789012345678),
            uint256(930919869281768667460268632116214329467302314052),
            uint256(6218676549690402052910318315276979534381485872621884367715834658603456243904),
            uint256(0),
            uint256(0),
            uint256(5708510646087729135889959965248975632956651064800454628727069218571497917126),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(2000000000000000000000000000),
            uint256(0),
            uint256(0),
            uint256(1000000),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0)
        ];

        // Measure gas consumption
        uint256 gasStart = gasleft();
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        uint256 gasEnd = gasleft();

        uint256 gasUsed = gasStart - gasEnd;

        // Log the gas consumption
        console.log("=== BLS12-381 Groth16 Verification Gas Report ===");
        console.log("Gas used for proof verification:", gasUsed);
        console.log("Proof verification result:", result ? "PASSED" : "FAILED");
        console.log("Circuit: 32-leaf Merkle tree");
        console.log("Public signals: 67");
        console.log("Curve: BLS12-381");
        console.log("Protocol: Groth16");

        // Assert the proof is valid
        assertTrue(result, "Valid proof should pass verification");
    }
}



================================================
FILE: groth16/verifier/test/64_leaves/Groth16Verifier64LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "../../forge-std/src/Test.sol";
import "../../forge-std/src/console.sol";
import "../../src/Groth16Verifier64Leaves.sol";
import "../../src/Groth16Verifier64LeavesIC.sol";

contract Groth16Verifier64LeavesNewProofTest is Test {
    Groth16Verifier64Leaves verifier;
    Groth16Verifier64LeavesIC icContract;

    // Updated proof constants from prover/64_leaves_groth/proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x0000000000000000000000000000000008dbc3e743691d18169b8312cc5dd76d;
    uint256 constant pA_x_PART2 = 0x93a1ef2d3796e33b5a9ec677cec6180aa02a58168426632854af8d86db5fe99e;
    uint256 constant pA_y_PART1 = 0x000000000000000000000000000000000a1972f51c110449a231aa3998f64178;
    uint256 constant pA_y_PART2 = 0x51fd46f7a063405846c7f9a259b5bc486d20a1df0a254618a27de484311aac69;

    uint256 constant pB_x0_PART1 = 0x00000000000000000000000000000000040937164598e7d133b83de647512244;
    uint256 constant pB_x0_PART2 = 0x086ff466140bfae2380450289c98752f1746f45da0584e551cddc0e43dfc94ff;
    uint256 constant pB_x1_PART1 = 0x000000000000000000000000000000000dfb3e735c20593988c435b31b3ec69a;
    uint256 constant pB_x1_PART2 = 0xbeb7272dd03cfecb69adfe7dd26679a1b367c8be088335417e73f12d6180b3ac;

    uint256 constant pB_y0_PART1 = 0x0000000000000000000000000000000014b6d96b44c5e020c890e8bde8336096;
    uint256 constant pB_y0_PART2 = 0x695fc216ff5f0f22e4f84e1ed1dbf648a72d09498fa0dce0b0ed83d79631344e;
    uint256 constant pB_y1_PART1 = 0x000000000000000000000000000000000de7a0cbf268f9f005e9a1a0d1804cec;
    uint256 constant pB_y1_PART2 = 0x151ebb66dc8a256364ef2a8cd34c019cd9e84364b961f8d65877d15a439ada50;

    uint256 constant pC_x_PART1 = 0x00000000000000000000000000000000117d551e021355f484d37fd898247aed;
    uint256 constant pC_x_PART2 = 0x0a90ba2fdaa344f73168bd43d218f3e51b5cc08ab1d4beaa6f38d740c44b473e;
    uint256 constant pC_y_PART1 = 0x0000000000000000000000000000000014809cb2835b80f11c1660fe8bfb91f0;
    uint256 constant pC_y_PART2 = 0x31cccbed7e4dfa39f6308ce4aba4ec35dc99de13600a77b660f56eafb89c0f6d;

    function setUp() public {
        // Deploy IC constants contract first
        icContract = new Groth16Verifier64LeavesIC();
        // Deploy main verifier with IC contract address
        verifier = new Groth16Verifier64Leaves(address(icContract));
    }

    function testVerifyProof64() public view {
        // Test data from prover/64_leaves_groth/proof.json and prover/64_leaves_groth/public.json
        uint256[4] memory proof_a = [
            pA_x_PART1,
            pA_x_PART2, 
            pA_y_PART1,
            pA_y_PART2
        ];
        
        uint256[8] memory proof_b = [
            pB_x0_PART1,
            pB_x0_PART2,
            pB_x1_PART1,
            pB_x1_PART2,
            pB_y0_PART1,
            pB_y0_PART2,
            pB_y1_PART1,
            pB_y1_PART2
        ];
        
        uint256[4] memory proof_c = [
            pC_x_PART1,
            pC_x_PART2,
            pC_y_PART1,
            pC_y_PART2
        ];
        
        // Public signals from prover/64_leaves_groth/public.json (131 values for 64-leaf Merkle tree proof)
        uint256[131] memory pub_signals = [
            39698489385903076125264884489111143859292314516175838395384137790940219449324,
            12345678901234567890123456789012345678901234567890123456789012345678,
            930919869281768667460268632116214329467302314052,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000
        ];

        // Verify the proof
        bool result = verifier.verifyProof(proof_a, proof_b, proof_c, pub_signals);
        
        console.log("64-leaf proof verification result:", result);
        assertTrue(result, "Valid proof should pass verification");
    }

    function testGasConsumption64() public view {
        // Test data from prover/64_leaves_groth/proof.json and prover/64_leaves_groth/public.json
        // This test measures gas consumption for BLS12-381 Groth16 verification

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from prover/64_leaves_groth/public.json (131 values for 64-leaf Merkle tree proof)
        uint256[131] memory _pubSignals = [
            39698489385903076125264884489111143859292314516175838395384137790940219449324,
            12345678901234567890123456789012345678901234567890123456789012345678,
            930919869281768667460268632116214329467302314052,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000
        ];

        // Measure gas consumption
        uint256 gasStart = gasleft();
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        uint256 gasEnd = gasleft();

        uint256 gasUsed = gasStart - gasEnd;

        // Log the gas consumption
        console.log("=== BLS12-381 Groth16 Verification Gas Report ===");
        console.log("Gas used for proof verification:", gasUsed);
        console.log("Proof verification result:", result ? "PASSED" : "FAILED");
        console.log("Circuit: 64-leaf Merkle tree");
        console.log("Public signals: 131");
        console.log("Curve: BLS12-381");
        console.log("Protocol: Groth16");

        // Assert the proof is valid
        assertTrue(result, "Valid proof should pass verification");
    }
}


================================================
FILE: script/README.md
================================================
# UUPS Upgradeable Contract Deployment Guide

This directory contains deployment and upgrade scripts for the UUPS (Universal Upgradeable Proxy Standard) versions of the Tokamak channel manager contracts.

## ðŸ“ Files Overview

### Deployment Scripts
- **`DeployV2.s.sol`** - Foundry script for deploying UUPS upgradeable contracts
- **`deploy-v2.sh`** - Shell script wrapper for easy deployment
- **`env-v2.template`** - Environment configuration template

### Upgrade Scripts  
- **`UpgradeContracts.s.sol`** - Foundry script for upgrading existing contracts
- **`upgrade-contracts.sh`** - Shell script wrapper for easy upgrades

## ðŸš€ Quick Start

### 1. Setup Environment

```bash
# Copy the environment template
cp script/env-upgradeable.template .env

# Edit .env with your configuration
nano .env
```

### 2. Deploy Contracts

```bash
# Deploy to testnet (e.g., Sepolia)
./script/deploy-v2.sh sepolia

# Deploy to mainnet
./script/deploy-v2.sh mainnet
```

### 3. Upgrade Contracts (Later)

```bash
# Upgrade contracts
./script/upgrade-contracts.sh sepolia

## ðŸ”§ Detailed Configuration

### Required Environment Variables

```bash
# Deployment account
PRIVATE_KEY=your_private_key_here
DEPLOYER_ADDRESS=0x1234567890123456789012345678901234567890

# Contract dependencies
ZK_VERIFIER_ADDRESS=0x1234567890123456789012345678901234567890

# Network configuration
RPC_URL=https://your-rpc-endpoint-here
CHAIN_ID=11155111

# Optional configuration
TREE_DEPTH=3                    # Merkle tree depth (default: 3)
VERIFY_CONTRACTS=true            # Verify on block explorer
ETHERSCAN_API_KEY=your_api_key   # Required for verification
```

### Additional Variables for Upgrades

```bash
# Existing proxy addresses (required for upgrades)
MERKLE_TREE_PROXY_ADDRESS=0x1234567890123456789012345678901234567890
ROLLUP_BRIDGE_PROXY_ADDRESS=0x1234567890123456789012345678901234567890

# Upgrade flags
UPGRADE_MERKLE_TREE=true         # Upgrade MerkleTreeManager4
UPGRADE_ROLLUP_BRIDGE=true       # Upgrade RollupBridge
```

## ðŸ“‹ Step-by-Step Deployment

### Initial Deployment Process

1. **Deploy Implementations**: Both contract implementations are deployed
2. **Deploy Proxies**: ERC1967 proxies are deployed pointing to implementations
3. **Initialize Contracts**: Proxies are initialized with constructor data
4. **Configure Bridge**: MerkleTreeManager4 is configured with bridge address
5. **Verification**: All deployments are verified for correctness
6. **Block Explorer Verification**: Contracts are verified on block explorer (optional)

### What Gets Deployed

| Contract Type | Description | Usage |
|---------------|-------------|-------|
| `RollupBridgeUpgradeable` (Implementation) | Contract logic | For upgrades only |  
| `RollupBridge` (Proxy) | User-facing contract | Main interactions |

**âš ï¸ Important**: Always interact with the **proxy addresses**, not the implementation addresses!

## ðŸ”„ Upgrade Process

### How Upgrades Work

1. **Deploy New Implementation**: New contract logic is deployed
2. **Verify Ownership**: Script confirms deployer owns the contracts
3. **Execute Upgrade**: `upgradeTo()` is called on existing proxies
4. **Verify Upgrade**: Script confirms implementations were updated
5. **State Preservation**: All existing state remains intact

### Upgrade Safety

- âœ… State is preserved across upgrades
- âœ… Proxy addresses never change
- âœ… Only owner can perform upgrades
- âœ… Implementation addresses are updated
- âœ… All functionality continues to work

## ðŸŒ Network Examples

### Ethereum Sepolia Testnet
```bash
CHAIN_ID=11155111
RPC_URL=https://sepolia.infura.io/v3/YOUR_PROJECT_ID
```

### Ethereum Mainnet
```bash
CHAIN_ID=1
RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID
```

### Arbitrum One
```bash
CHAIN_ID=42161
RPC_URL=https://arb1.arbitrum.io/rpc
```

### Arbitrum Sepolia
```bash
CHAIN_ID=421614
RPC_URL=https://sepolia-rollup.arbitrum.io/rpc
```

## ðŸ” Manual Deployment Commands

If you prefer to run commands manually:

### Deploy
```bash
forge script script/DeployUpgradeable.s.sol:DeployUpgradeableScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --verify \
    --etherscan-api-key $ETHERSCAN_API_KEY
```

### Upgrade
```bash
forge script script/UpgradeContracts.s.sol:UpgradeContractsScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --verify \
    --etherscan-api-key $ETHERSCAN_API_KEY
```

## ðŸ“ Output Files

### Deployment Outputs
- **`broadcast/`** - Foundry broadcast files with transaction details
- **`deployments-{network}-{timestamp}.json`** - Deployment summary
- **Console logs** - Addresses and configuration details

### Important Addresses to Save
After deployment, save these addresses:
- **MerkleTreeManager4 Proxy** - Use for all interactions
- **RollupBridge Proxy** - Use for all interactions  
- Implementation addresses - Keep for upgrade reference

## ðŸ›¡ï¸ Security Best Practices

### Pre-Deployment
1. **Test on testnet first** - Always deploy and test on testnet
2. **Verify verifier contract** - Ensure ZK_VERIFIER_ADDRESS is correct
3. **Check deployer balance** - Ensure sufficient funds for deployment
4. **Backup private keys** - Secure your deployment keys

### Post-Deployment
1. **Verify contract code** - Confirm contracts are verified on block explorer  
2. **Test functionality** - Run comprehensive tests on deployed contracts
3. **Secure owner keys** - Transfer ownership to multisig for production
4. **Monitor contracts** - Set up monitoring for contract activity

### Upgrade Safety
1. **Test upgrades on testnet** - Never upgrade mainnet without testing
2. **Backup state** - Consider snapshotting state before upgrades
3. **Gradual rollout** - Consider phased upgrades for complex changes
4. **Emergency procedures** - Have rollback plans ready

## â— Common Issues & Solutions

### Deployment Failures
- **"Insufficient funds"** - Add more ETH to deployer account
- **"Invalid verifier address"** - Check ZK_VERIFIER_ADDRESS is deployed
- **"Initialization failed"** - Verify constructor parameters

### Upgrade Failures  
- **"Ownable: caller is not the owner"** - Deployer must own contracts
- **"Same implementation"** - Cannot upgrade to same implementation
- **"Proxy not found"** - Check proxy addresses are correct

### Verification Failures
- **"Contract not verified"** - Check ETHERSCAN_API_KEY is valid
- **"Constructor mismatch"** - Verify constructor arguments are correct

## ðŸ“ž Support

For issues or questions:
1. Check the error messages carefully
2. Verify your environment configuration  
3. Test on a testnet first
4. Review the broadcast files for transaction details

## ðŸ”— References

- [OpenZeppelin UUPS Documentation](https://docs.openzeppelin.com/contracts/4.x/upgradeable)
- [EIP-1967: Standard Proxy Storage Slots](https://eips.ethereum.org/EIPS/eip-1967)
- [Foundry Deployment Documentation](https://book.getfoundry.sh/forge/deploying)
- [UUPS_UPGRADE_IMPLEMENTATION.md](../UUPS_UPGRADE_IMPLEMENTATION.md) - Technical implementation details


================================================
FILE: script/generate-contracts-json.sh
================================================
#!/bin/bash

# Generate contracts JSON from .env addresses
# Usage: ./generate-contracts-json.sh [network]
# Examples: 
#   ./generate-contracts-json.sh sepolia
#   ./generate-contracts-json.sh mainnet
#   ./generate-contracts-json.sh     # defaults to "unknown"

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

print_status() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

print_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

print_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"

# Default network
NETWORK=${1:-"unknown"}

print_status "Generating contracts JSON from .env addresses for network: $NETWORK"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    print_error ".env file not found in project root"
    echo "Please create a .env file with contract addresses"
    exit 1
fi

print_success "Found .env file"

# Source the environment variables
source "$ENV_FILE"

# Check if jq is available
if ! command -v jq &> /dev/null; then
    print_error "jq not installed - cannot generate contracts JSON"
    echo "Please install jq: brew install jq (macOS) or apt-get install jq (Linux)"
    exit 1
fi

# Create output directory
OUTPUT_DIR="$SCRIPT_DIR/output"
mkdir -p "$OUTPUT_DIR"

# Output file
OUTPUT_FILE="$OUTPUT_DIR/contracts-$NETWORK.json"

print_status "Generating JSON file: $OUTPUT_FILE"

# Function to add contract entry
add_contract() {
    local contract_name="$1"
    local address="$2"
    local abi_source="$3"
    local first_contract="$4"
    
    if [ -z "$address" ] || [ "$address" = "null" ]; then
        return 0
    fi
    
    # Add comma for all but first contract
    if [ "$first_contract" = "false" ]; then
        printf ',\n' >> "$OUTPUT_FILE"
    fi
    
    # Get ABI from forge artifacts
    local abi_file="$PROJECT_ROOT/out/${abi_source}.sol/${contract_name}.json"
    local abi="[]"
    
    if [ -f "$abi_file" ]; then
        abi=$(jq -c '.abi' "$abi_file" 2>/dev/null || echo "[]")
    else
        print_warning "ABI file not found for $contract_name: $abi_file"
    fi
    
    # Add contract entry (convert to lowercase for consistency)
    printf '    "%s": {\n      "address": "%s",\n      "abi": %s\n    }' \
        "$contract_name" "$(echo "$address" | tr '[:upper:]' '[:lower:]')" "$abi" >> "$OUTPUT_FILE"
    
    echo "false"  # Return false for next iteration
}

# Start building the JSON
printf '{\n  "network": "%s",\n  "generatedDate": "%s",\n  "source": "env_addresses",\n  "contracts": {\n' \
    "$NETWORK" "$(date -u +"%Y-%m-%dT%H:%M:%SZ")" > "$OUTPUT_FILE"

first_contract="true"

# Direct deployment contracts (from .env)
if [ -n "$ZK_VERIFIER_ADDRESS" ]; then
    first_contract=$(add_contract "TokamakVerifier" "$ZK_VERIFIER_ADDRESS" "TokamakVerifier" "$first_contract")
fi

if [ -n "$Groth16_Verifier16" ]; then
    first_contract=$(add_contract "Groth16Verifier16Leaves" "$Groth16_Verifier16" "Groth16Verifier16Leaves" "$first_contract")
fi

if [ -n "$Groth16_Verifier32" ]; then
    first_contract=$(add_contract "Groth16Verifier32Leaves" "$Groth16_Verifier32" "Groth16Verifier32Leaves" "$first_contract")
fi

if [ -n "$Groth16_Verifier64" ]; then
    first_contract=$(add_contract "Groth16Verifier64Leaves" "$Groth16_Verifier64" "Groth16Verifier64Leaves" "$first_contract")
fi

if [ -n "$Groth16_Verifier128" ]; then
    first_contract=$(add_contract "Groth16Verifier128Leaves" "$Groth16_Verifier128" "Groth16Verifier128Leaves" "$first_contract")
fi

if [ -n "$ZEC_FROST_ADDRESS" ]; then
    first_contract=$(add_contract "ZecFrost" "$ZEC_FROST_ADDRESS" "ZecFrost" "$first_contract")
fi

# Proxy contracts (use proxy addresses with implementation ABIs)
if [ -n "$ROLLUP_BRIDGE_CORE_PROXY_ADDRESS" ]; then
    first_contract=$(add_contract "BridgeCore" "$ROLLUP_BRIDGE_CORE_PROXY_ADDRESS" "BridgeCore" "$first_contract")
fi

if [ -n "$ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS" ]; then
    first_contract=$(add_contract "BridgeDepositManager" "$ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS" "BridgeDepositManager" "$first_contract")
fi

if [ -n "$ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS" ]; then
    first_contract=$(add_contract "BridgeProofManager" "$ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS" "BridgeProofManager" "$first_contract")
fi

if [ -n "$ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS" ]; then
    first_contract=$(add_contract "BridgeWithdrawManager" "$ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS" "BridgeWithdrawManager" "$first_contract")
fi

if [ -n "$ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS" ]; then
    first_contract=$(add_contract "BridgeAdminManager" "$ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS" "BridgeAdminManager" "$first_contract")
fi

# Close the JSON
printf '\n  }\n}\n' >> "$OUTPUT_FILE"

# Count contracts
contract_count=$(jq '.contracts | length' "$OUTPUT_FILE" 2>/dev/null || echo "unknown")

print_success "Generated contracts JSON with $contract_count contracts"
print_status "File saved to: $OUTPUT_FILE"

# Show summary
echo ""
echo "=== CONTRACT SUMMARY ==="
if command -v jq &> /dev/null && [ -f "$OUTPUT_FILE" ]; then
    jq -r '.contracts | to_entries[] | "\(.key): \(.value.address)"' "$OUTPUT_FILE"
else
    echo "Use 'jq' to view the generated JSON file"
fi
echo "========================="

print_success "JSON generation complete!"


================================================
FILE: script/deploy/README.md
================================================
# Deploy Scripts

This folder contains all deployment scripts for the Tokamak zk-EVM bridge system.

## Available Deployment Scripts

### Solidity Scripts (.sol)

1. **DeployV2.s.sol** - Main deployment script for V2 contracts
2. **DeployTokamakVerifier.s.sol** - Deploys TokamakVerifier contract
3. **RegisterFunction.s.sol** - Registers functions in deployed contracts
4. **SetChannelPublicKey.s.sol** - Sets channel public keys
5. **TestGroth16Integration.s.sol** - Tests Groth16 integration

### Shell Scripts (.sh)

1. **deploy-v2.sh** - Executes main V2 deployment
2. **deploy-tokamak-verifier.sh** - Executes TokamakVerifier deployment
3. **register-function.sh** - Executes function registration
4. **set-channel-public-key.sh** - Executes channel public key setup
5. **test-groth16-integration.sh** - Executes Groth16 integration tests

## Configuration Files

- **env-v2.template** - Template for environment variables needed for V2 deployment

## Usage

### Prerequisites

1. Copy the environment template and configure it:
   ```bash
   cp env-v2.template .env
   # Edit .env with your specific values
   ```

2. Make sure you have all required environment variables set:
   ```bash
   PRIVATE_KEY=your_private_key_here
   RPC_URL=your_rpc_url_here
   ETHERSCAN_API_KEY=your_etherscan_api_key_here  # Optional, for verification
   
   # Add other deployment-specific variables as needed
   ```

### Running Deployments

```bash
# Navigate to the deploy directory
cd script/deploy

# Run main V2 deployment
./deploy-v2.sh --verify

# Deploy TokamakVerifier
./deploy-tokamak-verifier.sh --verify

# Register functions
./register-function.sh

# Set channel public key
./set-channel-public-key.sh

# Test Groth16 integration
./test-groth16-integration.sh
```

## Important Notes

1. **Environment Setup**: Always ensure your `.env` file is properly configured before running any deployment scripts.

2. **Network Configuration**: Make sure `RPC_URL` points to the correct network (testnet for testing, mainnet for production).

3. **Verification**: Use the `--verify` flag to automatically verify contracts on Etherscan.

4. **Gas Costs**: Deployment can be expensive on mainnet. Test thoroughly on testnet first.

5. **Security**: Never commit your `.env` file with real private keys to version control.

## Script Features

All shell scripts include:
- Environment validation
- Color-coded output for better readability
- Error handling with proper exit codes
- Optional contract verification
- Gas limit configuration
- Success/failure reporting


================================================
FILE: script/deploy/deploy-v2.sh
================================================
#!/bin/bash

# RollupBridgeV2 Deployment Script
# Usage: ./deploy-v2.sh <network>
# Example: ./deploy-v2.sh sepolia

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Function to print colored output
print_status() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

print_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

print_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Function to generate comprehensive contracts JSON
generate_contracts_json() {
    local broadcast_file="$1"
    local output_file="$2"
    local network="$3"
    
    if ! command -v jq &> /dev/null; then
        print_warning "jq not installed - cannot generate contracts JSON"
        return 1
    fi
    
    # Direct deployment contracts (not proxies)
    local direct_contracts=(
        "TokamakVerifier:src/verifier/TokamakVerifier.sol"
        "Groth16Verifier16Leaves:src/verifier/Groth16Verifier16Leaves.sol"
        "Groth16Verifier32Leaves:src/verifier/Groth16Verifier32Leaves.sol"
        "Groth16Verifier64Leaves:src/verifier/Groth16Verifier64Leaves.sol"
        "Groth16Verifier64LeavesIC:src/verifier/Groth16Verifier64LeavesIC.sol"
        "Groth16Verifier128Leaves:src/verifier/Groth16Verifier128Leaves.sol"
        "Groth16Verifier128LeavesIC1:src/verifier/Groth16Verifier128LeavesIC1.sol"
        "Groth16Verifier128LeavesIC2:src/verifier/Groth16Verifier128LeavesIC2.sol"
        "ZecFrost:src/library/ZecFrost.sol"
    )
    
    # Proxy contracts (use proxy address but implementation ABI)
    # Order independent - proxies are dynamically linked to implementations
    local proxy_contracts=(
        "BridgeCore:src/BridgeCore.sol"
        "BridgeDepositManager:src/BridgeDepositManager.sol"
        "BridgeProofManager:src/BridgeProofManager.sol"
        "BridgeWithdrawManager:src/BridgeWithdrawManager.sol"
        "BridgeAdminManager:src/BridgeAdminManager.sol"
    )
    
    # Start building the JSON
    printf '{\n  "network": "%s",\n  "deploymentDate": "%s",\n  "contracts": {\n' \
        "$network" "$(date -u +"%Y-%m-%dT%H:%M:%SZ")" > "$output_file"

    local first_contract=true
    
    # Process direct contracts
    for contract_info in "${direct_contracts[@]}"; do
        local contract_name="${contract_info%%:*}"
        local source_file="${contract_info##*:}"
        
        # Get contract address from broadcast file
        local address=$(jq -r --arg name "$contract_name" '
            .transactions[] | 
            select(.transactionType == "CREATE" or .transactionType == "CREATE2") |
            select(.contractName == $name) |
            .contractAddress' "$broadcast_file" 2>/dev/null | head -1)
        
        if [ "$address" != "null" ] && [ -n "$address" ]; then
            # Add comma for all but first contract
            if [ "$first_contract" = false ]; then
                printf ',\n' >> "$output_file"
            fi
            first_contract=false
            
            # Get ABI from forge artifacts - fix path
            local abi_file="$PROJECT_ROOT/out/${contract_name}.sol/${contract_name}.json"
            local abi="[]"
            
            if [ -f "$abi_file" ]; then
                abi=$(jq -c '.abi' "$abi_file" 2>/dev/null || echo "[]")
            fi
            
            # Add contract entry
            printf '    "%s": {\n      "address": "%s",\n      "abi": %s\n    }' \
                "$contract_name" "$address" "$abi" >> "$output_file"
        fi
    done
    
    # Process proxy contracts - dynamically link proxies to implementations
    for contract_info in "${proxy_contracts[@]}"; do
        local contract_name="${contract_info%%:*}"
        local source_file="${contract_info##*:}"
        
        # Get implementation address for the contract
        local impl_address
        impl_address=$(jq -r --arg name "$contract_name" \
            '.transactions[] |
            select(.transactionType == "CREATE" or .transactionType == "CREATE2") |
            select(.contractName == $name) |
            .contractAddress' "$broadcast_file" 2>/dev/null | head -1)

        if [ -z "$impl_address" ] || [ "$impl_address" == "null" ]; then
            print_warning "Could not find implementation address for $contract_name"
            continue
        fi

        # Find the proxy that was deployed with this implementation address
        # Convert addresses to lowercase for case-insensitive comparison
        local proxy_address
        proxy_address=$(jq -r --arg impl_addr "$(echo "$impl_address" | tr '[:upper:]' '[:lower:]')" \
            '.transactions[] |
            select(.contractName == "ERC1967Proxy") |
            # The implementation address is the first argument to the proxy constructor
            select(try (.arguments[0] | ascii_downcase) == $impl_addr) |
            .contractAddress' "$broadcast_file" 2>/dev/null | head -1)
        
        if [ -n "$proxy_address" ] && [ "$proxy_address" != "null" ]; then
            print_status "Linked $contract_name implementation ($impl_address) to proxy ($proxy_address)"
            # Add comma for all but first contract
            if [ "$first_contract" = false ]; then
                printf ',\n' >> "$output_file"
            fi
            first_contract=false
            
            # Get ABI from implementation contract - fix path
            local abi_file="$PROJECT_ROOT/out/${contract_name}.sol/${contract_name}.json"
            local abi="[]"
            
            if [ -f "$abi_file" ]; then
                abi=$(jq -c '.abi' "$abi_file" 2>/dev/null || echo "[]")
            fi
            
            # Add proxy contract entry
            printf '    "%s": {\n      "address": "%s",\n      "abi": %s\n    }' \
                "$contract_name" "$proxy_address" "$abi" >> "$output_file"
        else
            print_warning "Could not find proxy address for $contract_name implementation ($impl_address)"
        fi
    done
    
    # Close the JSON
    printf '\n  }\n}\n' >> "$output_file"

    print_success "Generated contracts JSON with $(jq '.contracts | length' "$output_file" 2>/dev/null || echo "unknown") contracts"
}

# Check if network argument is provided
if [ $# -eq 0 ]; then
    print_error "Please provide a network name"
    echo "Usage: $0 <network>"
    echo "Examples:"
    echo "  $0 sepolia"
    echo "  $0 mainnet"
    echo "  $0 arbitrum"
    exit 1
fi

NETWORK=$1
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

print_status "Starting RollupBridgeV2 deployment on $NETWORK"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    print_error ".env file not found in project root"
    echo "Please create a .env file using the template:"
    echo "cp script/env-v2.template .env"
    echo "Then edit .env with your configuration"
    exit 1
fi

print_success "Found .env file"

# Source the environment variables
source "$ENV_FILE"

# Validate required environment variables
required_vars=("PRIVATE_KEY" "ZK_VERIFIER_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL" "CHAIN_ID")
missing_vars=()

for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        missing_vars+=("$var")
    fi
done

if [ ${#missing_vars[@]} -ne 0 ]; then
    print_error "Missing required environment variables:"
    for var in "${missing_vars[@]}"; do
        echo "  - $var"
    done
    exit 1
fi

print_success "All required environment variables are set"

# Set default values for optional variables  
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-true}
export ETHERSCAN_API_KEY=${ETHERSCAN_API_KEY:-""}

# Build the forge command
FORGE_CMD="forge script script/deploy/DeployV2.s.sol:DeployV2Script"
FORGE_CMD="$FORGE_CMD --rpc-url $RPC_URL"
FORGE_CMD="$FORGE_CMD --broadcast"
FORGE_CMD="$FORGE_CMD --slow" # Add delay between transactions
FORGE_CMD="$FORGE_CMD --ffi" # Enable FFI for contract verification

# Add verification if enabled and API key is provided
if [ "$VERIFY_CONTRACTS" = "true" ] && [ -n "$ETHERSCAN_API_KEY" ]; then
    print_status "Contract verification enabled"
    FORGE_CMD="$FORGE_CMD --verify --etherscan-api-key $ETHERSCAN_API_KEY"
else
    print_warning "Contract verification disabled or API key not provided"
fi

print_status "Deployment configuration:"
echo "  Network: $NETWORK"
echo "  RPC URL: $RPC_URL"
echo "  Chain ID: $CHAIN_ID"
echo "  Deployer: $DEPLOYER_ADDRESS"
echo "  ZK Verifier: $ZK_VERIFIER_ADDRESS"
echo "  Contract: RollupBridgeV2 (with embedded Merkle operations)"
echo "  Verify Contracts: $VERIFY_CONTRACTS"

# Confirm deployment
echo ""
read -p "Do you want to proceed with the deployment? (y/N): " -n 1 -r
echo ""
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    print_warning "Deployment cancelled"
    exit 0
fi

# Create broadcast directory if it doesn't exist
mkdir -p "$PROJECT_ROOT/broadcast"

print_status "Starting deployment..."
print_status "Command: $FORGE_CMD"

# Run the deployment
cd "$PROJECT_ROOT"
if eval $FORGE_CMD; then
    print_success "Deployment completed successfully!"
    
    # Extract deployment addresses from broadcast files
    BROADCAST_DIR="$PROJECT_ROOT/broadcast/DeployV2.s.sol/$CHAIN_ID"
    LATEST_RUN="$BROADCAST_DIR/run-latest.json"
    
    if [ -f "$LATEST_RUN" ]; then
        print_status "Extracting deployment addresses..."
        
        # Parse JSON to extract addresses (requires jq)
        if command -v jq &> /dev/null; then
            echo ""
            echo "=== DEPLOYMENT SUMMARY ==="
            
            # Extract transaction receipts and find contract deployments
            echo "Deployed contracts:"
            
            # Try to extract addresses from the broadcast file
            jq -r '.transactions[] | select(.transactionType == "CREATE" or .transactionType == "CREATE2") | "  \(.contractName // "Contract"): \(.contractAddress)"' "$LATEST_RUN" 2>/dev/null || {
                print_warning "Could not parse deployment addresses automatically"
                echo "Please check the broadcast file: $LATEST_RUN"
            }
            
            echo "=========================="
        else
            print_warning "jq not installed - cannot parse deployment addresses automatically"
            print_status "Check broadcast file for addresses: $LATEST_RUN"
        fi
        
        # Save deployment info
        DEPLOYMENT_INFO="$PROJECT_ROOT/deployments-$NETWORK-$(date +%Y%m%d-%H%M%S).json"
        cp "$LATEST_RUN" "$DEPLOYMENT_INFO"
        print_success "Deployment info saved to: $DEPLOYMENT_INFO"
        
        # Generate single comprehensive JSON with all contract info
        print_status "Generating comprehensive deployment JSON with addresses and ABIs..."
        
        # Create output directory
        OUTPUT_DIR="$PROJECT_ROOT/script/output"
        mkdir -p "$OUTPUT_DIR"
        
        CONTRACTS_JSON="$OUTPUT_DIR/contracts-$NETWORK.json"
        
        # Create the deployment artifacts JSON
        generate_contracts_json "$LATEST_RUN" "$CONTRACTS_JSON" "$NETWORK"
        
        if [ -f "$CONTRACTS_JSON" ]; then
            print_success "Contract addresses and ABIs saved to: $CONTRACTS_JSON"
        fi
        
    else
        print_warning "Broadcast file not found, deployment may have failed"
    fi
    
    echo ""
    print_success "Next steps:"
    echo "1. Verify the deployed addresses"
    echo "2. Test the contracts functionality"
    echo "3. Authorize channel creators if needed"
    echo "4. Consider setting up timelock or multisig for upgrades"
    echo "5. Save the proxy addresses for future interactions"
    
else
    print_error "Deployment failed!"
    echo "Check the error messages above for details"
    exit 1
fi


================================================
FILE: script/deploy/DeployTokamakVerifier.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "../../src/verifier/TokamakVerifier.sol";

contract DeployTokamakVerifierScript is Script {
    address public tokamakVerifier;
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load environment variables
        deployer = vm.envOr("DEPLOYER_ADDRESS", msg.sender);
        shouldVerify = vm.envOr("VERIFY_CONTRACTS", false);
        etherscanApiKey = vm.envOr("ETHERSCAN_API_KEY", string(""));
        chainId = vm.envOr("CHAIN_ID", string("31337"));
    }

    function run() external {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");
        vm.startBroadcast(deployerPrivateKey);

        deployer = vm.addr(deployerPrivateKey);
        console.log("Deploying TokamakVerifier with account:", deployer);
        console.log("Account balance:", deployer.balance);

        // Deploy TokamakVerifier
        console.log("Deploying TokamakVerifier...");
        TokamakVerifier verifierContract = new TokamakVerifier();
        tokamakVerifier = address(verifierContract);
        console.log("TokamakVerifier deployed at:", tokamakVerifier);

        vm.stopBroadcast();

        console.log("\n=== DEPLOYMENT COMPLETE ===");
        console.log("TokamakVerifier:", tokamakVerifier);
        console.log("Deployer:", deployer);

        // Verify contract if requested
        if (shouldVerify && bytes(etherscanApiKey).length > 0) {
            console.log("\n=== STARTING CONTRACT VERIFICATION ===");
            console.log("Waiting 30 seconds before verification to allow Etherscan indexing...");
            vm.sleep(30000); // Wait 30 seconds
            verifyContract();
        } else {
            console.log("\n=== SKIPPING CONTRACT VERIFICATION ===");
            if (!shouldVerify) {
                console.log("Reason: VERIFY_CONTRACTS=false");
            }
            if (bytes(etherscanApiKey).length == 0) {
                console.log("Reason: No ETHERSCAN_API_KEY provided");
            }
        }
    }

    function verifyContract() internal {
        console.log("\n=== VERIFYING TOKAMAK VERIFIER ===");

        // Ensure contract is deployed before verification
        require(tokamakVerifier != address(0), "TokamakVerifier not deployed");

        console.log("Verifying TokamakVerifier...");
        string[] memory verifierCmd = new string[](6);
        verifierCmd[0] = "forge";
        verifierCmd[1] = "verify-contract";
        verifierCmd[2] = vm.toString(tokamakVerifier);
        verifierCmd[3] = "src/verifier/TokamakVerifier.sol:TokamakVerifier";
        verifierCmd[4] = "--etherscan-api-key";
        verifierCmd[5] = etherscanApiKey;
        _verifyWithRetry(verifierCmd, "TokamakVerifier");

        console.log("TokamakVerifier verification complete!");
    }

    function _verifyWithRetry(string[] memory cmd, string memory contractName) internal {
        uint256 maxRetries = 3;
        uint256 retryDelay = 15000; // 15 seconds

        for (uint256 i = 0; i < maxRetries; i++) {
            try vm.ffi(cmd) {
                console.log(string.concat(contractName, " verified successfully"));
                return;
            } catch {
                if (i < maxRetries - 1) {
                    console.log(string.concat("Verification failed for ", contractName, ", retrying in 15 seconds..."));
                    vm.sleep(retryDelay);
                } else {
                    console.log(
                        string.concat(
                            "Verification failed for ", contractName, " after ", vm.toString(maxRetries), " attempts"
                        )
                    );
                }
            }
        }
    }
}



================================================
FILE: script/deploy/DeployV2.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeWithdrawManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/verifier/TokamakVerifier.sol";
import "../../src/verifier/Groth16Verifier16Leaves.sol";
import "../../src/verifier/Groth16Verifier32Leaves.sol";
import "../../src/verifier/Groth16Verifier64Leaves.sol";
import "../../src/verifier/Groth16Verifier64LeavesIC.sol";
import "../../src/verifier/Groth16Verifier128Leaves.sol";
import "../../src/verifier/Groth16Verifier128LeavesIC1.sol";
import "../../src/verifier/Groth16Verifier128LeavesIC2.sol";
import "../../src/library/ZecFrost.sol";

contract DeployV2Script is Script {
    // Implementation addresses
    address public rollupBridgeImpl;
    address public depositManagerImpl;
    address public proofManagerImpl;
    address public withdrawManagerImpl;
    address public adminManagerImpl;

    // Proxy addresses (main contracts)
    address public rollupBridge;
    address public depositManager;
    address public proofManager;
    address public withdrawManager;
    address public adminManager;

    // Environment variables
    address public zkVerifier;
    address public zecFrost;
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load environment variables
        deployer = vm.envOr("DEPLOYER_ADDRESS", msg.sender);
        shouldVerify = vm.envOr("VERIFY_CONTRACTS", false);
        etherscanApiKey = vm.envOr("ETHERSCAN_API_KEY", string(""));
        chainId = vm.envOr("CHAIN_ID", string("31337"));

        // Always deploy a new TokamakVerifier
        console.log("Will deploy new TokamakVerifier (forced deployment)");

        // ZecFrost can be provided or we deploy a new one
        try vm.envAddress("ZEC_FROST_ADDRESS") returns (address frost) {
            zecFrost = frost;
        } catch {
            console.log("No ZEC_FROST_ADDRESS provided, will deploy new ZecFrost");
        }
    }

    function run() external {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");
        vm.startBroadcast(deployerPrivateKey);

        deployer = vm.addr(deployerPrivateKey);
        console.log("Deploying with account:", deployer);
        console.log("Account balance:", deployer.balance);

        // Always deploy a new TokamakVerifier
        console.log("Deploying new TokamakVerifier...");
        TokamakVerifier verifierContract = new TokamakVerifier();
        zkVerifier = address(verifierContract);
        console.log("TokamakVerifier deployed at:", zkVerifier);

        // Deploy Groth16 Verifiers
        console.log("Deploying Groth16Verifier16Leaves...");
        Groth16Verifier16Leaves groth16VerifierContract16 = new Groth16Verifier16Leaves();
        address groth16Verifier16 = address(groth16VerifierContract16);
        console.log("Groth16Verifier16Leaves deployed at:", groth16Verifier16);

        console.log("Deploying Groth16Verifier32Leaves...");
        Groth16Verifier32Leaves groth16VerifierContract32 = new Groth16Verifier32Leaves();
        address groth16Verifier32 = address(groth16VerifierContract32);
        console.log("Groth16Verifier32Leaves deployed at:", groth16Verifier32);

        console.log("Deploying Groth16Verifier64LeavesIC...");
        Groth16Verifier64LeavesIC groth16Verifier64IC = new Groth16Verifier64LeavesIC();
        console.log("Groth16Verifier64LeavesIC deployed at:", address(groth16Verifier64IC));

        console.log("Deploying Groth16Verifier64Leaves...");
        Groth16Verifier64Leaves groth16VerifierContract64 = new Groth16Verifier64Leaves(address(groth16Verifier64IC));
        address groth16Verifier64 = address(groth16VerifierContract64);
        console.log("Groth16Verifier64Leaves deployed at:", groth16Verifier64);

        console.log("Deploying Groth16Verifier128LeavesIC1...");
        Groth16Verifier128LeavesIC1 groth16Verifier128IC1 = new Groth16Verifier128LeavesIC1();
        console.log("Groth16Verifier128LeavesIC1 deployed at:", address(groth16Verifier128IC1));

        console.log("Deploying Groth16Verifier128LeavesIC2...");
        Groth16Verifier128LeavesIC2 groth16Verifier128IC2 = new Groth16Verifier128LeavesIC2();
        console.log("Groth16Verifier128LeavesIC2 deployed at:", address(groth16Verifier128IC2));

        console.log("Deploying Groth16Verifier128Leaves...");
        Groth16Verifier128Leaves groth16VerifierContract128 =
            new Groth16Verifier128Leaves(address(groth16Verifier128IC1), address(groth16Verifier128IC2));
        address groth16Verifier128 = address(groth16VerifierContract128);
        console.log("Groth16Verifier128Leaves deployed at:", groth16Verifier128);

        // Deploy ZecFrost if not provided
        if (zecFrost == address(0)) {
            console.log("Deploying ZecFrost...");
            ZecFrost zecFrostContract = new ZecFrost();
            zecFrost = address(zecFrostContract);
            console.log("ZecFrost deployed at:", zecFrost);
        } else {
            console.log("Using existing ZecFrost at:", zecFrost);
        }

        // Deploy Bridge implementation
        console.log("Deploying Bridge implementation...");
        BridgeCore rollupBridgeImplementation = new BridgeCore();
        rollupBridgeImpl = address(rollupBridgeImplementation);
        console.log("Bridge implementation deployed at:", rollupBridgeImpl);

        // Deploy manager implementations
        console.log("Deploying BridgeDepositManager implementation...");
        BridgeDepositManager depositManagerImplementation = new BridgeDepositManager();
        depositManagerImpl = address(depositManagerImplementation);
        console.log("BridgeDepositManager implementation deployed at:", depositManagerImpl);

        console.log("Deploying BridgeProofManager implementation...");
        BridgeProofManager proofManagerImplementation = new BridgeProofManager();
        proofManagerImpl = address(proofManagerImplementation);
        console.log("BridgeProofManager implementation deployed at:", proofManagerImpl);

        console.log("Deploying BridgeWithdrawManager implementation...");
        BridgeWithdrawManager withdrawManagerImplementation = new BridgeWithdrawManager();
        withdrawManagerImpl = address(withdrawManagerImplementation);
        console.log("BridgeWithdrawManager implementation deployed at:", withdrawManagerImpl);

        console.log("Deploying BridgeAdminManager implementation...");
        BridgeAdminManager adminManagerImplementation = new BridgeAdminManager();
        adminManagerImpl = address(adminManagerImplementation);
        console.log("BridgeAdminManager implementation deployed at:", adminManagerImpl);

        // Deploy Bridge proxy with temporary zero addresses
        console.log("Deploying Bridge proxy...");
        bytes memory rollupBridgeInitData =
            abi.encodeCall(BridgeCore.initialize, (address(0), address(0), address(0), address(0), deployer));

        ERC1967Proxy rollupBridgeProxy = new ERC1967Proxy(rollupBridgeImpl, rollupBridgeInitData);
        rollupBridge = address(rollupBridgeProxy);
        console.log("Bridge proxy deployed at:", rollupBridge);

        // Deploy manager proxies and initialize
        console.log("Deploying manager proxies...");

        // Deploy DepositManager proxy
        bytes memory depositManagerInitData = abi.encodeCall(BridgeDepositManager.initialize, (rollupBridge, deployer));
        ERC1967Proxy depositManagerProxy = new ERC1967Proxy(depositManagerImpl, depositManagerInitData);
        depositManager = address(depositManagerProxy);
        console.log("BridgeDepositManager proxy deployed at:", depositManager);

        // Deploy ProofManager proxy
        address[4] memory groth16Verifiers =
            [groth16Verifier16, groth16Verifier32, groth16Verifier64, groth16Verifier128];
        bytes memory proofManagerInitData = abi.encodeCall(
            BridgeProofManager.initialize, (rollupBridge, zkVerifier, zecFrost, groth16Verifiers, deployer)
        );
        ERC1967Proxy proofManagerProxy = new ERC1967Proxy(proofManagerImpl, proofManagerInitData);
        proofManager = address(proofManagerProxy);
        console.log("BridgeProofManager proxy deployed at:", proofManager);

        // Deploy WithdrawManager proxy
        bytes memory withdrawManagerInitData =
            abi.encodeCall(BridgeWithdrawManager.initialize, (rollupBridge, deployer));
        ERC1967Proxy withdrawManagerProxy = new ERC1967Proxy(withdrawManagerImpl, withdrawManagerInitData);
        withdrawManager = address(withdrawManagerProxy);
        console.log("BridgeWithdrawManager proxy deployed at:", withdrawManager);

        // Deploy AdminManager proxy
        bytes memory adminManagerInitData = abi.encodeCall(BridgeAdminManager.initialize, (rollupBridge, deployer));
        ERC1967Proxy adminManagerProxy = new ERC1967Proxy(adminManagerImpl, adminManagerInitData);
        adminManager = address(adminManagerProxy);
        console.log("BridgeAdminManager proxy deployed at:", adminManager);

        // Update bridge with correct manager addresses
        console.log("Updating bridge with manager addresses...");
        BridgeCore(rollupBridge).updateManagerAddresses(depositManager, proofManager, withdrawManager, adminManager);

        // Configure TON target contract
        console.log("Configuring TON target contract...");
        _configureTONContract(adminManager);

        vm.stopBroadcast();

        console.log("\n=== DEPLOYMENT COMPLETE ===");
        console.log("All contracts deployed successfully!");

        // Log final addresses
        console.log("\n=== DEPLOYMENT SUMMARY ===");
        console.log("Tokamak Verifier:", zkVerifier);
        console.log("Groth16 Verifier16:", groth16Verifier16);
        console.log("Groth16 Verifier32:", groth16Verifier32);
        console.log("Groth16 Verifier64:", groth16Verifier64);
        console.log("Groth16 Verifier128:", groth16Verifier128);
        console.log("ZecFrost:", zecFrost);
        console.log("\n=== IMPLEMENTATIONS ===");
        console.log("Bridge Implementation:", rollupBridgeImpl);
        console.log("Deposit Manager Implementation:", depositManagerImpl);
        console.log("Proof Manager Implementation:", proofManagerImpl);
        console.log("Withdraw Manager Implementation:", withdrawManagerImpl);
        console.log("Admin Manager Implementation:", adminManagerImpl);
        console.log("\n=== PROXIES ===");
        console.log("Bridge Proxy:", rollupBridge);
        console.log("Deposit Manager Proxy:", depositManager);
        console.log("Proof Manager Proxy:", proofManager);
        console.log("Withdraw Manager Proxy:", withdrawManager);
        console.log("Admin Manager Proxy:", adminManager);
        console.log("\nDeployer (Owner):", deployer);

        // Post-deployment verification
        if (shouldVerify && bytes(etherscanApiKey).length > 0) {
            console.log("\n=== STARTING CONTRACT VERIFICATION ===");
            console.log("Note: Verification happens AFTER all contracts are deployed");
            console.log("Waiting 30 seconds before verification to allow Etherscan indexing...");
            vm.sleep(30000); // Wait 30 seconds
            verifyContracts();
        } else {
            console.log("\n=== SKIPPING CONTRACT VERIFICATION ===");
            if (!shouldVerify) {
                console.log("Reason: VERIFY_CONTRACTS=false");
            }
            if (bytes(etherscanApiKey).length == 0) {
                console.log("Reason: No ETHERSCAN_API_KEY provided");
            }
        }
    }

    function verifyContracts() internal {
        console.log("\n=== VERIFYING CONTRACTS ===");
        console.log("IMPORTANT: All contracts have been deployed. Now starting verification process.");

        // Ensure all required contracts are deployed before verification
        require(rollupBridgeImpl != address(0), "Bridge implementation not deployed");
        require(depositManagerImpl != address(0), "Deposit manager implementation not deployed");
        require(proofManagerImpl != address(0), "Proof manager implementation not deployed");
        require(withdrawManagerImpl != address(0), "Withdraw manager implementation not deployed");
        require(adminManagerImpl != address(0), "Admin manager implementation not deployed");
        require(rollupBridge != address(0), "Bridge proxy not deployed");
        require(depositManager != address(0), "Deposit manager proxy not deployed");
        require(proofManager != address(0), "Proof manager proxy not deployed");
        require(withdrawManager != address(0), "Withdraw manager proxy not deployed");
        require(adminManager != address(0), "Admin manager proxy not deployed");

        // Always verify TokamakVerifier since we always deploy a new one
        console.log("Verifying TokamakVerifier...");
        string[] memory verifierCmd = new string[](6);
        verifierCmd[0] = "forge";
        verifierCmd[1] = "verify-contract";
        verifierCmd[2] = vm.toString(zkVerifier);
        verifierCmd[3] = "src/verifier/TokamakVerifier.sol:TokamakVerifier";
        verifierCmd[4] = "--etherscan-api-key";
        verifierCmd[5] = etherscanApiKey;
        _verifyWithRetry(verifierCmd, "TokamakVerifier");

        // Only verify if we deployed a new ZecFrost (not using existing)
        bool deployedNewZecFrost = false;
        try vm.parseAddress(vm.envString("ZEC_FROST_ADDRESS")) {
            console.log("Skipping ZecFrost verification (pre-existing)");
        } catch {
            deployedNewZecFrost = true;
            console.log("Verifying ZecFrost...");
            string[] memory zecFrostCmd = new string[](6);
            zecFrostCmd[0] = "forge";
            zecFrostCmd[1] = "verify-contract";
            zecFrostCmd[2] = vm.toString(zecFrost);
            zecFrostCmd[3] = "src/library/ZecFrost.sol:ZecFrost";
            zecFrostCmd[4] = "--etherscan-api-key";
            zecFrostCmd[5] = etherscanApiKey;
            _verifyWithRetry(zecFrostCmd, "ZecFrost");
        }

        // Verify Bridge Implementation
        console.log("Verifying Bridge Implementation...");
        string[] memory rollupCmd = new string[](6);
        rollupCmd[0] = "forge";
        rollupCmd[1] = "verify-contract";
        rollupCmd[2] = vm.toString(rollupBridgeImpl);
        rollupCmd[3] = "src/BridgeCore.sol:BridgeCore";
        rollupCmd[4] = "--etherscan-api-key";
        rollupCmd[5] = etherscanApiKey;
        _verifyWithRetry(rollupCmd, "BridgeCore");

        // Verify Manager contracts
        console.log("Verifying BridgeDepositManager implementation...");
        string[] memory depositCmd = new string[](6);
        depositCmd[0] = "forge";
        depositCmd[1] = "verify-contract";
        depositCmd[2] = vm.toString(depositManagerImpl);
        depositCmd[3] = "src/BridgeDepositManager.sol:BridgeDepositManager";
        depositCmd[4] = "--etherscan-api-key";
        depositCmd[5] = etherscanApiKey;
        _verifyWithRetry(depositCmd, "BridgeDepositManager");

        console.log("Verifying BridgeProofManager implementation...");
        string[] memory proofCmd = new string[](6);
        proofCmd[0] = "forge";
        proofCmd[1] = "verify-contract";
        proofCmd[2] = vm.toString(proofManagerImpl);
        proofCmd[3] = "src/BridgeProofManager.sol:BridgeProofManager";
        proofCmd[4] = "--etherscan-api-key";
        proofCmd[5] = etherscanApiKey;
        _verifyWithRetry(proofCmd, "BridgeProofManager");

        console.log("Verifying BridgeWithdrawManager implementation...");
        string[] memory withdrawCmd = new string[](6);
        withdrawCmd[0] = "forge";
        withdrawCmd[1] = "verify-contract";
        withdrawCmd[2] = vm.toString(withdrawManagerImpl);
        withdrawCmd[3] = "src/BridgeWithdrawManager.sol:BridgeWithdrawManager";
        withdrawCmd[4] = "--etherscan-api-key";
        withdrawCmd[5] = etherscanApiKey;
        _verifyWithRetry(withdrawCmd, "BridgeWithdrawManager");

        console.log("Verifying BridgeAdminManager implementation...");
        string[] memory adminCmd = new string[](6);
        adminCmd[0] = "forge";
        adminCmd[1] = "verify-contract";
        adminCmd[2] = vm.toString(adminManagerImpl);
        adminCmd[3] = "src/BridgeAdminManager.sol:BridgeAdminManager";
        adminCmd[4] = "--etherscan-api-key";
        adminCmd[5] = etherscanApiKey;
        _verifyWithRetry(adminCmd, "BridgeAdminManager");

        console.log("Contract verification complete!");
    }

    function _verifyWithRetry(string[] memory cmd, string memory contractName) internal {
        uint256 maxRetries = 3;
        uint256 retryDelay = 15000; // 15 seconds

        for (uint256 i = 0; i < maxRetries; i++) {
            try vm.ffi(cmd) {
                console.log(string.concat(contractName, " verified successfully"));
                return;
            } catch {
                if (i < maxRetries - 1) {
                    console.log(string.concat("Verification failed for ", contractName, ", retrying in 15 seconds..."));
                    vm.sleep(retryDelay);
                } else {
                    console.log(
                        string.concat(
                            "Verification failed for ", contractName, " after ", vm.toString(maxRetries), " attempts"
                        )
                    );
                }
            }
        }
    }

    function _configureTONContract(address adminManagerAddress) internal {
        // TON contract address
        address tonAddress = 0xa30fe40285B8f5c0457DbC3B7C8A280373c40044;

        // TON preprocess data from WTON_preprocess.json
        uint128[] memory tonPreprocessedPart1 = new uint128[](4);
        tonPreprocessedPart1[0] = 0x11b01d3b7756a1e2c84462f2a011f8cf;
        tonPreprocessedPart1[1] = 0x110f0dbdfee1e30c55061363fd147c5f;
        tonPreprocessedPart1[2] = 0x02e86220169ffc66feac2bca980de255;
        tonPreprocessedPart1[3] = 0x12d32a9d10236151ea94eddd2de15df4;

        uint256[] memory tonPreprocessedPart2 = new uint256[](4);
        tonPreprocessedPart2[0] = 0xe2285fde54386faf68544ac49ac3f620c84265d1e76dffbbb780329a35c798f2;
        tonPreprocessedPart2[1] = 0x85767f719652f5fcde0bc847a1af46c16c3ffab6bded47addd0f8215588f1684;
        tonPreprocessedPart2[2] = 0xd775a85c51e4d33eaccca66cd04346c2d291b2c777daa08b093d91a9475e1623;
        tonPreprocessedPart2[3] = 0x3e984d129c3dab74f9d13ab9ab66d5d826fca5e1f6270242aaa5dedeedf2fe58;

        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory emptyUserStorageSlots = new IBridgeCore.UserStorageSlot[](0);
        BridgeAdminManager(adminManagerAddress).setAllowedTargetContract(tonAddress, emptySlots, emptyUserStorageSlots, true);

        // Setup TON pre-allocated leaf for decimals (slot 0x07 with value 18)
        BridgeAdminManager(adminManagerAddress).setupTonTransferPreAllocatedLeaf(tonAddress);

        // Register TON transfer function
        bytes32 tonTransferSig = 0xa9059cbb00000000000000000000000000000000000000000000000000000000;
        bytes32 instanceHash = 0xd157cb883adb9cb0e27d9dc419e2a4be817d856281b994583b5bae64be94d35a;
        BridgeAdminManager(adminManagerAddress).registerFunction(
            tonAddress, tonTransferSig, tonPreprocessedPart1, tonPreprocessedPart2, instanceHash
        );

        console.log("TON target contract configured:", tonAddress);
        console.log("TON pre-allocated leaf (0x07 decimals) configured for:", tonAddress);
    }
}



================================================
FILE: script/deploy/env-v2.template
================================================
# Environment Configuration for RollupBridgeV2 Deployment
# Copy this file to .env and fill in your values

# ===========================================
# REQUIRED CONFIGURATION
# ===========================================

# Private key for deployment (without 0x prefix)
PRIVATE_KEY=your_private_key_here

# Address of the deployed ZK verifier contract (optional - will deploy new one if not provided)
# ZK_VERIFIER_ADDRESS=0x1234567890123456789012345678901234567890

# Address that will own the upgradeable contracts (can perform upgrades)
DEPLOYER_ADDRESS=0x1234567890123456789012345678901234567890

# RPC endpoint for the target network
RPC_URL=https://your-rpc-endpoint-here

# Chain ID of the target network
CHAIN_ID=11155111

# ===========================================
# OPTIONAL CONFIGURATION
# ===========================================

# Whether to verify contracts on block explorer (default: true)
VERIFY_CONTRACTS=true

# Etherscan API key for contract verification (required if VERIFY_CONTRACTS=true)
ETHERSCAN_API_KEY=your_etherscan_api_key_here

# ===========================================
# ROLLUPBRIDGE V2 FEATURES
# ===========================================
#
# RollupBridgeV2 includes the following optimizations:
# - Embedded Merkle tree operations (no external MerkleTreeManager needed)
# - 39-55% gas reduction for initializeChannelState
# - 19,915 bytes contract size (optimized)
# - 100% functional equivalence with V1
# - Fixed quaternary Merkle tree depth (no configuration needed)
#
# ===========================================
# NETWORK-SPECIFIC EXAMPLES
# ===========================================

# Ethereum Sepolia Testnet
# CHAIN_ID=11155111
# RPC_URL=https://sepolia.infura.io/v3/YOUR_PROJECT_ID

# Ethereum Mainnet
# CHAIN_ID=1
# RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID

# Arbitrum One
# CHAIN_ID=42161
# RPC_URL=https://arb1.arbitrum.io/rpc

# Arbitrum Sepolia
# CHAIN_ID=421614
# RPC_URL=https://sepolia-rollup.arbitrum.io/rpc

# Optimism
# CHAIN_ID=10
# RPC_URL=https://mainnet.optimism.io

# Polygon
# CHAIN_ID=137
# RPC_URL=https://polygon-rpc.com

# ===========================================
# SECURITY NOTES
# ===========================================
# 
# 1. NEVER commit your .env file to version control
# 2. Use a dedicated deployer account with minimal funds
# 3. Consider using a hardware wallet for mainnet deployments
# 4. The DEPLOYER_ADDRESS will be the initial owner of the contract
# 5. Owners can upgrade contracts - consider transferring to a multisig
# 6. Store your deployment addresses safely after deployment
# 7. RollupBridgeV2 is gas-optimized with embedded Merkle operations
#
# ===========================================


================================================
FILE: script/deploy/register-function.sh
================================================
#!/bin/bash

# Script to register function
# Usage: ./register-function.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Check if .env file exists
if [ ! -f ".env" ]; then
    echo -e "${RED}Error: .env file not found${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source .env

# Verify required environment variables
required_vars=("PRIVATE_KEY" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

echo -e "${YELLOW}=== Register Function Script ===${NC}"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the script
echo -e "${YELLOW}Starting RegisterFunction script...${NC}"
forge script script/deploy/RegisterFunction.s.sol:RegisterFunctionScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 3000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… RegisterFunction script completed successfully!${NC}"
else
    echo -e "${RED}âŒ RegisterFunction script failed${NC}"
    exit 1
fi


================================================
FILE: script/deploy/RegisterFunction.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import {Script} from "forge-std/Script.sol";
import {BridgeAdminManager} from "../../src/BridgeAdminManager.sol";

contract RegisterFunctionScript is Script {
    function run() external {
        vm.startBroadcast();

        address adminManagerAddress = 0x374c2a109C59c60E18af161F263689520eBd6932;
        BridgeAdminManager adminManager = BridgeAdminManager(adminManagerAddress);

        address targetContract = 0xa30fe40285B8f5c0457DbC3B7C8A280373c40044;
        bytes32 functionSignature = 0xa9059cbb00000000000000000000000000000000000000000000000000000000;
        bytes32 instanceHash = 0xd157cb883adb9cb0e27d9dc419e2a4be817d856281b994583b5bae64be94d35a;

        uint128[] memory preprocessPart1 = new uint128[](4);
        preprocessPart1[0] = 0x11b01d3b7756a1e2c84462f2a011f8cf;
        preprocessPart1[1] = 0x110f0dbdfee1e30c55061363fd147c5f;
        preprocessPart1[2] = 0x02e86220169ffc66feac2bca980de255;
        preprocessPart1[3] = 0x12d32a9d10236151ea94eddd2de15df4;

        uint256[] memory preprocessPart2 = new uint256[](4);
        preprocessPart2[0] = 0xe2285fde54386faf68544ac49ac3f620c84265d1e76dffbbb780329a35c798f2;
        preprocessPart2[1] = 0x85767f719652f5fcde0bc847a1af46c16c3ffab6bded47addd0f8215588f1684;
        preprocessPart2[2] = 0xd775a85c51e4d33eaccca66cd04346c2d291b2c777daa08b093d91a9475e1623;
        preprocessPart2[3] = 0x3e984d129c3dab74f9d13ab9ab66d5d826fca5e1f6270242aaa5dedeedf2fe58;

        adminManager.unregisterFunction(targetContract, functionSignature);

        adminManager.registerFunction(targetContract, functionSignature, preprocessPart1, preprocessPart2, instanceHash);

        vm.stopBroadcast();
    }
}



================================================
FILE: script/deploy/set-channel-public-key.sh
================================================
#!/bin/bash

# Script to set channel public key
# Usage: ./set-channel-public-key.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Check if .env file exists
if [ ! -f ".env" ]; then
    echo -e "${RED}Error: .env file not found${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source .env

# Verify required environment variables
required_vars=("PRIVATE_KEY" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

echo -e "${YELLOW}=== Set Channel Public Key Script ===${NC}"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the script
echo -e "${YELLOW}Starting SetChannelPublicKey script...${NC}"
forge script script/deploy/SetChannelPublicKey.s.sol:SetChannelPublicKeyScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 3000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… SetChannelPublicKey script completed successfully!${NC}"
else
    echo -e "${RED}âŒ SetChannelPublicKey script failed${NC}"
    exit 1
fi


================================================
FILE: script/deploy/SetChannelPublicKey.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import {Script, console} from "forge-std/Script.sol";
import {BridgeCore} from "../../src/BridgeCore.sol";

contract SetChannelPublicKeyScript is Script {
    function run() external {
        // Get environment variables
        address bridgeCoreProxy = vm.envAddress("ROLLUP_BRIDGE_CORE_PROXY_ADDRESS");
        uint256 leaderPrivateKey = vm.envUint("LEADER_PRIVATE_KEY");

        // Parameters for setChannelPublicKey
        bytes32 channelId = bytes32(uint256(5));
        uint256 pkx = 0x65ceb565a2028bcc940074da00994958c1965a0f801fc1a06811a1195426db0b;
        uint256 pky = 0x767293b33676de95ce3d0acf97e1bb0326fe7e2896d17c4df5d7055b4699445c;

        // Get leader address from private key
        address leader = vm.addr(leaderPrivateKey);

        console.log("Bridge Core Proxy:", bridgeCoreProxy);
        console.log("Leader Address:", leader);
        console.logBytes32(channelId);
        console.log("Public Key X:", pkx);
        console.log("Public Key Y:", pky);

        // Create bridge instance
        BridgeCore bridge = BridgeCore(bridgeCoreProxy);

        // Start broadcasting with leader's private key
        vm.startBroadcast(leaderPrivateKey);

        // Call setChannelPublicKey
        try bridge.setChannelPublicKey(channelId, pkx, pky) {
            console.log("Successfully set channel public key");

            // Verify the public key was set correctly
            (uint256 storedPkx, uint256 storedPky) = bridge.getChannelPublicKey(channelId);
            address signerAddr = bridge.getChannelSignerAddr(channelId);

            console.log("Stored PKX:", storedPkx);
            console.log("Stored PKY:", storedPky);
            console.log("Computed Signer Address:", signerAddr);
        } catch Error(string memory reason) {
            console.log("Transaction failed with reason:", reason);
        } catch (bytes memory) {
            console.log("Transaction failed with unknown error");
        }

        vm.stopBroadcast();
    }
}



================================================
FILE: script/deploy/test-groth16-integration.sh
================================================
#!/bin/bash

# Script to test Groth16 integration
# Usage: ./test-groth16-integration.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Check if .env file exists
if [ ! -f ".env" ]; then
    echo -e "${RED}Error: .env file not found${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source .env

# Verify required environment variables
required_vars=("PRIVATE_KEY" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

echo -e "${YELLOW}=== Test Groth16 Integration Script ===${NC}"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the script
echo -e "${YELLOW}Starting TestGroth16Integration script...${NC}"
forge script script/deploy/TestGroth16Integration.s.sol:TestGroth16IntegrationScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 3000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… TestGroth16Integration script completed successfully!${NC}"
else
    echo -e "${RED}âŒ TestGroth16Integration script failed${NC}"
    exit 1
fi


================================================
FILE: script/deploy/TestGroth16Integration.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Script.sol";
import "forge-std/console.sol";
import "../../src/verifier/Groth16Verifier16Leaves.sol";

contract TestGroth16Integration is Script {
    function run() public {
        console.log("Testing Groth16 Integration...");

        // Deploy the real Groth16Verifier
        Groth16Verifier16Leaves verifier = new Groth16Verifier16Leaves();
        console.log("Groth16Verifier deployed at:", address(verifier));

        // Test with mock proof data
        uint256[4] memory pA = [uint256(1), uint256(2), uint256(3), uint256(4)];
        uint256[8] memory pB =
            [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)];
        uint256[4] memory pC = [uint256(13), uint256(14), uint256(15), uint256(16)];

        // Create test public signals (33 elements for 16-leaf tree)
        uint256[33] memory publicSignals;

        // Fill with test MPT keys and balances
        publicSignals[0] = uint256(uint160(address(0xd69B7AaaE8C1c9F0546AfA4Fd8eD39741cE3f59F))); // MPT key 1
        publicSignals[1] = uint256(uint160(address(0xb18E7CdB6Aa28Cc645227041329896446A1478bd))); // MPT key 2
        publicSignals[2] = uint256(uint160(address(0x9D70617FF571Ac34516C610a51023EE1F28373e8))); // MPT key 3

        publicSignals[16] = 1000000000000000000; // Balance 1: 1 ETH
        publicSignals[17] = 2000000000000000000; // Balance 2: 2 ETH
        publicSignals[18] = 3000000000000000000; // Balance 3: 3 ETH

        // Mock merkle root as last element
        publicSignals[32] = uint256(keccak256("test_merkle_root"));

        console.log("Testing proof verification...");

        try verifier.verifyProof(pA, pB, pC, publicSignals) returns (bool result) {
            console.log("Proof verification result:", result);
            console.log("Note: This will likely be false with mock data, but verifier is working");
        } catch Error(string memory reason) {
            console.log("Verification failed with reason:", reason);
        } catch {
            console.log("Verification failed with unknown error");
        }

        console.log("Groth16 integration test completed");
    }
}



================================================
FILE: script/output/README.md
================================================
# Script Output Directory

This directory contains generated JSON files with contract addresses and ABIs.

## File Types

### `contracts-<network>.json`
- Generated by deployment scripts (`deploy-v2.sh`), upgrade scripts (`upgrade-contracts.sh`) or the standalone generator (`generate-contracts-json.sh`)
- Contains all contract addresses and their corresponding ABIs
- For proxy contracts, shows proxy addresses with implementation ABIs

## JSON Structure

```json
{
  "network": "sepolia",
  "generatedDate": "2026-01-05T09:13:59Z",
  "source": "env_addresses",
  "contracts": {
    "ContractName": {
      "address": "0x...",
      "abi": [...]
    }
  }
}
```

## Usage

These JSON files can be used by:
- Frontend applications to interact with contracts
- Testing frameworks to get contract addresses and ABIs
- Deployment verification scripts
- Integration with web3 libraries

## Notes

- Addresses are normalized to lowercase for consistency


================================================
FILE: script/output/contracts-sepolia.json
================================================
{
  "network": "sepolia",
  "deploymentDate": "2026-01-26T09:29:51Z",
  "contracts": {
    "TokamakVerifier": {
      "address": "0x87d51311a936b940578116b70592ad6eb8b5f830",
      "abi": [{"type":"function","name":"verify","inputs":[{"name":"","type":"uint128[]","internalType":"uint128[]"},{"name":"","type":"uint256[]","internalType":"uint256[]"},{"name":"","type":"uint128[]","internalType":"uint128[]"},{"name":"","type":"uint256[]","internalType":"uint256[]"},{"name":"","type":"uint256[]","internalType":"uint256[]"},{"name":"","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"final_result","type":"bool","internalType":"bool"}],"stateMutability":"view"}]
    },
    "Groth16Verifier16Leaves": {
      "address": "0xc167f315aef4319a686b7728e8de71f9da3f62bc",
      "abi": [{"type":"function","name":"verifyProof","inputs":[{"name":"_pA","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pB","type":"uint256[8]","internalType":"uint256[8]"},{"name":"_pC","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pubSignals","type":"uint256[33]","internalType":"uint256[33]"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"}]
    },
    "Groth16Verifier32Leaves": {
      "address": "0xb86b79c36b8eacc669e12f235f36d6bee1d40eff",
      "abi": [{"type":"function","name":"verifyProof","inputs":[{"name":"_pA","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pB","type":"uint256[8]","internalType":"uint256[8]"},{"name":"_pC","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pubSignals","type":"uint256[65]","internalType":"uint256[65]"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"}]
    },
    "Groth16Verifier64Leaves": {
      "address": "0x64ba1c608b794537499b973b3b97e2d01edeabf6",
      "abi": [{"type":"constructor","inputs":[{"name":"_icContract","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"icContract","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract Groth16Verifier64LeavesIC"}],"stateMutability":"view"},{"type":"function","name":"verifyProof","inputs":[{"name":"_pA","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pB","type":"uint256[8]","internalType":"uint256[8]"},{"name":"_pC","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pubSignals","type":"uint256[129]","internalType":"uint256[129]"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"}]
    },
    "Groth16Verifier64LeavesIC": {
      "address": "0xe51267903c53c1b6790e69382b5898b1961cddb6",
      "abi": [{"type":"function","name":"getIC","inputs":[{"name":"index","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"pure"}]
    },
    "Groth16Verifier128Leaves": {
      "address": "0x91bc1281733aaf2bbf7f45e0098f9e0439f459dd",
      "abi": [{"type":"constructor","inputs":[{"name":"_icContract1","type":"address","internalType":"address"},{"name":"_icContract2","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"function","name":"icContract1","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract Groth16Verifier128LeavesIC1"}],"stateMutability":"view"},{"type":"function","name":"icContract2","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract Groth16Verifier128LeavesIC2"}],"stateMutability":"view"},{"type":"function","name":"verifyProof","inputs":[{"name":"_pA","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pB","type":"uint256[8]","internalType":"uint256[8]"},{"name":"_pC","type":"uint256[4]","internalType":"uint256[4]"},{"name":"_pubSignals","type":"uint256[257]","internalType":"uint256[257]"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"}]
    },
    "Groth16Verifier128LeavesIC1": {
      "address": "0xa768eee04d2c6d423ce9cf981073ce83542ba327",
      "abi": [{"type":"function","name":"getIC1","inputs":[{"name":"index","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"pure"}]
    },
    "Groth16Verifier128LeavesIC2": {
      "address": "0xc415c4fbb9e9a4cc5beda6e916ea4210ea1fd848",
      "abi": [{"type":"function","name":"getIC2","inputs":[{"name":"index","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"},{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"pure"}]
    },
    "BridgeCore": {
      "address": "0x081603c6bfbd62b55016ddb6cce3706f59463204",
      "abi": [{"type":"constructor","inputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"CHANNEL_TIMEOUT","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"MAX_PARTICIPANTS","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"MIN_PARTICIPANTS","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"addParticipantOnDeposit","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"user","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"cleanupChannel","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"clearValidatedUserStorage","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participant","type":"address","internalType":"address"},{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"depositManager","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"generateChannelId","inputs":[{"name":"leader","type":"address","internalType":"address"},{"name":"salt","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"stateMutability":"pure"},{"type":"function","name":"getBalanceSlotIndex","inputs":[{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"uint8","internalType":"uint8"}],"stateMutability":"view"},{"type":"function","name":"getChannelBlockInfosHash","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"getChannelFinalStateRoot","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"getChannelInfo","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"state","type":"uint8","internalType":"enum BridgeCore.ChannelState"},{"name":"participantCount","type":"uint256","internalType":"uint256"},{"name":"initialRoot","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"getChannelInitialStateRoot","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"getChannelLeader","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"getChannelParticipants","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"address[]","internalType":"address[]"}],"stateMutability":"view"},{"type":"function","name":"getChannelPreAllocatedLeavesCount","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"count","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getChannelPublicKey","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"pkx","type":"uint256","internalType":"uint256"},{"name":"pky","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getChannelSignerAddr","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"getChannelState","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"uint8","internalType":"enum BridgeCore.ChannelState"}],"stateMutability":"view"},{"type":"function","name":"getChannelTargetContract","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"getChannelTreeSize","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getImplementation","inputs":[],"outputs":[{"name":"implementation","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"getL2MptKey","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participant","type":"address","internalType":"address"},{"name":"slotIndex","type":"uint8","internalType":"uint8"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getPreAllocatedKeys","inputs":[{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"keys","type":"bytes32[]","internalType":"bytes32[]"}],"stateMutability":"view"},{"type":"function","name":"getPreAllocatedLeaf","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"key","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"value","type":"uint256","internalType":"uint256"},{"name":"exists","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"getPreAllocatedLeavesCount","inputs":[{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"count","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getTargetContractData","inputs":[{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"tuple","internalType":"struct BridgeCore.TargetContract","components":[{"name":"preAllocatedLeaves","type":"tuple[]","internalType":"struct BridgeCore.PreAllocatedLeaf[]","components":[{"name":"value","type":"uint256","internalType":"uint256"},{"name":"key","type":"bytes32","internalType":"bytes32"},{"name":"isActive","type":"bool","internalType":"bool"}]},{"name":"registeredFunctions","type":"tuple[]","internalType":"struct BridgeCore.RegisteredFunction[]","components":[{"name":"functionSignature","type":"bytes32","internalType":"bytes32"},{"name":"instancesHash","type":"bytes32","internalType":"bytes32"},{"name":"preprocessedPart1","type":"uint128[]","internalType":"uint128[]"},{"name":"preprocessedPart2","type":"uint256[]","internalType":"uint256[]"}]},{"name":"userStorageSlots","type":"tuple[]","internalType":"struct BridgeCore.UserStorageSlot[]","components":[{"name":"slotOffset","type":"uint8","internalType":"uint8"},{"name":"getterFunctionSignature","type":"bytes32","internalType":"bytes32"},{"name":"isLoadedOnChain","type":"bool","internalType":"bool"}]}]}],"stateMutability":"view"},{"type":"function","name":"getValidatedUserSlotValue","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participant","type":"address","internalType":"address"},{"name":"slotIndex","type":"uint8","internalType":"uint8"}],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"hasUserWithdrawn","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participant","type":"address","internalType":"address"},{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"initialize","inputs":[{"name":"_depositManager","type":"address","internalType":"address"},{"name":"_proofManager","type":"address","internalType":"address"},{"name":"_withdrawManager","type":"address","internalType":"address"},{"name":"_adminManager","type":"address","internalType":"address"},{"name":"_owner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"isAllowedTargetContract","inputs":[{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isChannelPublicKeySet","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isChannelTimedOut","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isChannelWhitelisted","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"addr","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isFrostSignatureEnabled","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isMarkedChannelLeader","inputs":[{"name":"addr","type":"address","internalType":"address"},{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"isSignatureVerified","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"openChannel","inputs":[{"name":"params","type":"tuple","internalType":"struct BridgeCore.ChannelParams","components":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"targetContract","type":"address","internalType":"address"},{"name":"whitelisted","type":"address[]","internalType":"address[]"},{"name":"enableFrostSignature","type":"bool","internalType":"bool"}]}],"outputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"}],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"proxiableUUID","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"registerFunction","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"functionSignature","type":"bytes32","internalType":"bytes32"},{"name":"preprocessedPart1","type":"uint128[]","internalType":"uint128[]"},{"name":"preprocessedPart2","type":"uint256[]","internalType":"uint256[]"},{"name":"instancesHash","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"removePreAllocatedLeaf","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"key","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"renounceOwnership","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setAllowedTargetContract","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"leaves","type":"tuple[]","internalType":"struct BridgeCore.PreAllocatedLeaf[]","components":[{"name":"value","type":"uint256","internalType":"uint256"},{"name":"key","type":"bytes32","internalType":"bytes32"},{"name":"isActive","type":"bool","internalType":"bool"}]},{"name":"userStorageSlots","type":"tuple[]","internalType":"struct BridgeCore.UserStorageSlot[]","components":[{"name":"slotOffset","type":"uint8","internalType":"uint8"},{"name":"getterFunctionSignature","type":"bytes32","internalType":"bytes32"},{"name":"isLoadedOnChain","type":"bool","internalType":"bool"}]},{"name":"allowed","type":"bool","internalType":"bool"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelBlockInfosHash","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"blockInfosHash","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelCloseTimestamp","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"timestamp","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelFinalStateRoot","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"stateRoot","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelInitialStateRoot","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"stateRoot","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelL2MptKeys","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participant","type":"address","internalType":"address"},{"name":"mptKeys","type":"uint256[]","internalType":"uint256[]"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelPublicKey","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"pkx","type":"uint256","internalType":"uint256"},{"name":"pky","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelSignatureVerified","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"verified","type":"bool","internalType":"bool"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelState","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"state","type":"uint8","internalType":"enum BridgeCore.ChannelState"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setChannelValidatedUserStorage","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participants","type":"address[]","internalType":"address[]"},{"name":"slotValues","type":"uint256[][]","internalType":"uint256[][]"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setPreAllocatedLeaf","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"key","type":"bytes32","internalType":"bytes32"},{"name":"value","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferOwnership","inputs":[{"name":"newOwner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"unregisterFunction","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"functionSignature","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateChannelUserDeposits","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"participant","type":"address","internalType":"address"},{"name":"slotIndex","type":"uint8","internalType":"uint8"},{"name":"amount","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateManagerAddresses","inputs":[{"name":"_depositManager","type":"address","internalType":"address"},{"name":"_proofManager","type":"address","internalType":"address"},{"name":"_withdrawManager","type":"address","internalType":"address"},{"name":"_adminManager","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeTo","inputs":[{"name":"newImplementation","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeToAndCall","inputs":[{"name":"newImplementation","type":"address","internalType":"address"},{"name":"data","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"withdrawManager","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"event","name":"AdminChanged","inputs":[{"name":"previousAdmin","type":"address","indexed":false,"internalType":"address"},{"name":"newAdmin","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"BeaconUpgraded","inputs":[{"name":"beacon","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"ChannelDeleted","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"cleanupTime","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"ChannelOpened","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"targetContract","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"ChannelPublicKeySet","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"pkx","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"pky","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"signerAddr","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"Initialized","inputs":[{"name":"version","type":"uint8","indexed":false,"internalType":"uint8"}],"anonymous":false},{"type":"event","name":"OwnershipTransferred","inputs":[{"name":"previousOwner","type":"address","indexed":true,"internalType":"address"},{"name":"newOwner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"PreAllocatedLeafRemoved","inputs":[{"name":"targetContract","type":"address","indexed":true,"internalType":"address"},{"name":"mptKey","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"PreAllocatedLeafSet","inputs":[{"name":"targetContract","type":"address","indexed":true,"internalType":"address"},{"name":"mptKey","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"value","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"Upgraded","inputs":[{"name":"implementation","type":"address","indexed":true,"internalType":"address"}],"anonymous":false}]
    },
    "BridgeDepositManager": {
      "address": "0x95fb509ec82897da57a1684e031dc5b6ac6b4d36",
      "abi": [{"type":"constructor","inputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"bridge","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IBridgeCore"}],"stateMutability":"view"},{"type":"function","name":"depositToken","inputs":[{"name":"_channelId","type":"bytes32","internalType":"bytes32"},{"name":"_amount","type":"uint256","internalType":"uint256"},{"name":"_mptKeys","type":"bytes32[]","internalType":"bytes32[]"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"getImplementation","inputs":[],"outputs":[{"name":"implementation","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"initialize","inputs":[{"name":"_bridgeCore","type":"address","internalType":"address"},{"name":"_owner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"proxiableUUID","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"renounceOwnership","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferForWithdrawal","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"to","type":"address","internalType":"address"},{"name":"amount","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferOwnership","inputs":[{"name":"newOwner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateBridge","inputs":[{"name":"_newBridge","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeTo","inputs":[{"name":"newImplementation","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeToAndCall","inputs":[{"name":"newImplementation","type":"address","internalType":"address"},{"name":"data","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"payable"},{"type":"event","name":"AdminChanged","inputs":[{"name":"previousAdmin","type":"address","indexed":false,"internalType":"address"},{"name":"newAdmin","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"BeaconUpgraded","inputs":[{"name":"beacon","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"Deposited","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"token","type":"address","indexed":false,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"Initialized","inputs":[{"name":"version","type":"uint8","indexed":false,"internalType":"uint8"}],"anonymous":false},{"type":"event","name":"OwnershipTransferred","inputs":[{"name":"previousOwner","type":"address","indexed":true,"internalType":"address"},{"name":"newOwner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"Upgraded","inputs":[{"name":"implementation","type":"address","indexed":true,"internalType":"address"}],"anonymous":false}]
    },
    "BridgeProofManager": {
      "address": "0x38e6ae9cdf587795e80444c63abcd2701907f455",
      "abi": [{"type":"constructor","inputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"bridge","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IBridgeCore"}],"stateMutability":"view"},{"type":"function","name":"getImplementation","inputs":[],"outputs":[{"name":"implementation","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"groth16Verifier128","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IGroth16Verifier128Leaves"}],"stateMutability":"view"},{"type":"function","name":"groth16Verifier16","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IGroth16Verifier16Leaves"}],"stateMutability":"view"},{"type":"function","name":"groth16Verifier32","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IGroth16Verifier32Leaves"}],"stateMutability":"view"},{"type":"function","name":"groth16Verifier64","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IGroth16Verifier64Leaves"}],"stateMutability":"view"},{"type":"function","name":"initialize","inputs":[{"name":"_bridgeCore","type":"address","internalType":"address"},{"name":"_zkVerifier","type":"address","internalType":"address"},{"name":"_zecFrost","type":"address","internalType":"address"},{"name":"_groth16Verifiers","type":"address[4]","internalType":"address[4]"},{"name":"_owner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"initializeChannelState","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"proof","type":"tuple","internalType":"struct BridgeProofManager.ChannelInitializationProof","components":[{"name":"pA","type":"uint256[4]","internalType":"uint256[4]"},{"name":"pB","type":"uint256[8]","internalType":"uint256[8]"},{"name":"pC","type":"uint256[4]","internalType":"uint256[4]"},{"name":"merkleRoot","type":"bytes32","internalType":"bytes32"}]}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"proxiableUUID","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"renounceOwnership","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"submitProofAndSignature","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"proofs","type":"tuple[]","internalType":"struct BridgeProofManager.ProofData[]","components":[{"name":"proofPart1","type":"uint128[]","internalType":"uint128[]"},{"name":"proofPart2","type":"uint256[]","internalType":"uint256[]"},{"name":"publicInputs","type":"uint256[]","internalType":"uint256[]"},{"name":"smax","type":"uint256","internalType":"uint256"}]},{"name":"signature","type":"tuple","internalType":"struct BridgeProofManager.Signature","components":[{"name":"message","type":"bytes32","internalType":"bytes32"},{"name":"rx","type":"uint256","internalType":"uint256"},{"name":"ry","type":"uint256","internalType":"uint256"},{"name":"z","type":"uint256","internalType":"uint256"}]}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferOwnership","inputs":[{"name":"newOwner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateBridge","inputs":[{"name":"_newBridge","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateGroth16Verifiers","inputs":[{"name":"_newVerifiers","type":"address[4]","internalType":"address[4]"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateValidatedUserStorage","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"finalSlotValues","type":"uint256[][]","internalType":"uint256[][]"},{"name":"permutation","type":"uint256[]","internalType":"uint256[]"},{"name":"groth16Proof","type":"tuple","internalType":"struct BridgeProofManager.ChannelFinalizationProof","components":[{"name":"pA","type":"uint256[4]","internalType":"uint256[4]"},{"name":"pB","type":"uint256[8]","internalType":"uint256[8]"},{"name":"pC","type":"uint256[4]","internalType":"uint256[4]"}]}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateVerifier","inputs":[{"name":"_newVerifier","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateZecFrost","inputs":[{"name":"_newZecFrost","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeTo","inputs":[{"name":"newImplementation","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeToAndCall","inputs":[{"name":"newImplementation","type":"address","internalType":"address"},{"name":"data","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"zecFrost","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IZecFrost"}],"stateMutability":"view"},{"type":"function","name":"zkVerifier","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract ITokamakVerifier"}],"stateMutability":"view"},{"type":"event","name":"AdminChanged","inputs":[{"name":"previousAdmin","type":"address","indexed":false,"internalType":"address"},{"name":"newAdmin","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"BeaconUpgraded","inputs":[{"name":"beacon","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"FinalBalancesGroth16Verified","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"finalStateRoot","type":"bytes32","indexed":false,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"Initialized","inputs":[{"name":"version","type":"uint8","indexed":false,"internalType":"uint8"}],"anonymous":false},{"type":"event","name":"OwnershipTransferred","inputs":[{"name":"previousOwner","type":"address","indexed":true,"internalType":"address"},{"name":"newOwner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"ProofSigned","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"signer","type":"address","indexed":true,"internalType":"address"},{"name":"finalStateRoot","type":"bytes32","indexed":false,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"StateInitialized","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"currentStateRoot","type":"bytes32","indexed":false,"internalType":"bytes32"},{"name":"blockInfos","type":"tuple","indexed":false,"internalType":"struct BridgeProofManager.BlockInfos","components":[{"name":"blockNumber","type":"uint256","internalType":"uint256"},{"name":"timestamp","type":"uint256","internalType":"uint256"},{"name":"prevrandao","type":"uint256","internalType":"uint256"},{"name":"gaslimit","type":"uint256","internalType":"uint256"},{"name":"basefee","type":"uint256","internalType":"uint256"},{"name":"coinbase","type":"address","internalType":"address"},{"name":"chainId","type":"uint256","internalType":"uint256"},{"name":"selfbalance","type":"uint256","internalType":"uint256"},{"name":"blockHash1","type":"uint256","internalType":"uint256"},{"name":"blockHash2","type":"uint256","internalType":"uint256"},{"name":"blockHash3","type":"uint256","internalType":"uint256"},{"name":"blockHash4","type":"uint256","internalType":"uint256"}]}],"anonymous":false},{"type":"event","name":"TokamakZkSnarkProofsVerified","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"signer","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"Upgraded","inputs":[{"name":"implementation","type":"address","indexed":true,"internalType":"address"}],"anonymous":false}]
    },
    "BridgeWithdrawManager": {
      "address": "0xa1ab9d54ec6975cc11391f1667e1fe2527deb30e",
      "abi": [{"type":"constructor","inputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"bridge","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IBridgeCore"}],"stateMutability":"view"},{"type":"function","name":"getImplementation","inputs":[],"outputs":[{"name":"implementation","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"initialize","inputs":[{"name":"_bridgeCore","type":"address","internalType":"address"},{"name":"_owner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"proxiableUUID","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"renounceOwnership","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferOwnership","inputs":[{"name":"newOwner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateBridge","inputs":[{"name":"_newBridge","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeTo","inputs":[{"name":"newImplementation","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeToAndCall","inputs":[{"name":"newImplementation","type":"address","internalType":"address"},{"name":"data","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"withdraw","inputs":[{"name":"channelId","type":"bytes32","internalType":"bytes32"},{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"event","name":"AdminChanged","inputs":[{"name":"previousAdmin","type":"address","indexed":false,"internalType":"address"},{"name":"newAdmin","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"BeaconUpgraded","inputs":[{"name":"beacon","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"ChannelClosed","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"EmergencyWithdrawalsEnabled","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"Initialized","inputs":[{"name":"version","type":"uint8","indexed":false,"internalType":"uint8"}],"anonymous":false},{"type":"event","name":"OwnershipTransferred","inputs":[{"name":"previousOwner","type":"address","indexed":true,"internalType":"address"},{"name":"newOwner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"TimeoutWithdrawn","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"token","type":"address","indexed":false,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false},{"type":"event","name":"Upgraded","inputs":[{"name":"implementation","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"Withdrawn","inputs":[{"name":"channelId","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"user","type":"address","indexed":true,"internalType":"address"},{"name":"token","type":"address","indexed":false,"internalType":"address"},{"name":"amount","type":"uint256","indexed":false,"internalType":"uint256"}],"anonymous":false}]
    },
    "BridgeAdminManager": {
      "address": "0xd335d1f8aefe6e77aa8f70dac90b99128d183615",
      "abi": [{"type":"constructor","inputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"bridge","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract IBridgeCore"}],"stateMutability":"view"},{"type":"function","name":"getImplementation","inputs":[],"outputs":[{"name":"implementation","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"getPreAllocatedLeaf","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"key","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"value","type":"uint256","internalType":"uint256"},{"name":"exists","type":"bool","internalType":"bool"}],"stateMutability":"view"},{"type":"function","name":"getRegisteredFunction","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"functionSignature","type":"bytes32","internalType":"bytes32"}],"outputs":[{"name":"","type":"tuple","internalType":"struct IBridgeCore.RegisteredFunction","components":[{"name":"functionSignature","type":"bytes32","internalType":"bytes32"},{"name":"instancesHash","type":"bytes32","internalType":"bytes32"},{"name":"preprocessedPart1","type":"uint128[]","internalType":"uint128[]"},{"name":"preprocessedPart2","type":"uint256[]","internalType":"uint256[]"}]}],"stateMutability":"view"},{"type":"function","name":"getTargetContractData","inputs":[{"name":"targetContract","type":"address","internalType":"address"}],"outputs":[{"name":"","type":"tuple","internalType":"struct IBridgeCore.TargetContract","components":[{"name":"preAllocatedLeaves","type":"tuple[]","internalType":"struct IBridgeCore.PreAllocatedLeaf[]","components":[{"name":"value","type":"uint256","internalType":"uint256"},{"name":"key","type":"bytes32","internalType":"bytes32"},{"name":"isActive","type":"bool","internalType":"bool"}]},{"name":"registeredFunctions","type":"tuple[]","internalType":"struct IBridgeCore.RegisteredFunction[]","components":[{"name":"functionSignature","type":"bytes32","internalType":"bytes32"},{"name":"instancesHash","type":"bytes32","internalType":"bytes32"},{"name":"preprocessedPart1","type":"uint128[]","internalType":"uint128[]"},{"name":"preprocessedPart2","type":"uint256[]","internalType":"uint256[]"}]},{"name":"userStorageSlots","type":"tuple[]","internalType":"struct IBridgeCore.UserStorageSlot[]","components":[{"name":"slotOffset","type":"uint8","internalType":"uint8"},{"name":"getterFunctionSignature","type":"bytes32","internalType":"bytes32"},{"name":"isLoadedOnChain","type":"bool","internalType":"bool"}]}]}],"stateMutability":"view"},{"type":"function","name":"initialize","inputs":[{"name":"_bridgeCore","type":"address","internalType":"address"},{"name":"_owner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"owner","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"proxiableUUID","inputs":[],"outputs":[{"name":"","type":"bytes32","internalType":"bytes32"}],"stateMutability":"view"},{"type":"function","name":"registerFunction","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"functionSignature","type":"bytes32","internalType":"bytes32"},{"name":"preprocessedPart1","type":"uint128[]","internalType":"uint128[]"},{"name":"preprocessedPart2","type":"uint256[]","internalType":"uint256[]"},{"name":"instancesHash","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"removePreAllocatedLeaf","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"key","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"renounceOwnership","inputs":[],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setAllowedTargetContract","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"storageSlots","type":"tuple[]","internalType":"struct IBridgeCore.PreAllocatedLeaf[]","components":[{"name":"value","type":"uint256","internalType":"uint256"},{"name":"key","type":"bytes32","internalType":"bytes32"},{"name":"isActive","type":"bool","internalType":"bool"}]},{"name":"userStorageSlots","type":"tuple[]","internalType":"struct IBridgeCore.UserStorageSlot[]","components":[{"name":"slotOffset","type":"uint8","internalType":"uint8"},{"name":"getterFunctionSignature","type":"bytes32","internalType":"bytes32"},{"name":"isLoadedOnChain","type":"bool","internalType":"bool"}]},{"name":"allowed","type":"bool","internalType":"bool"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setPreAllocatedLeaf","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"key","type":"bytes32","internalType":"bytes32"},{"name":"value","type":"uint256","internalType":"uint256"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"setupTonTransferPreAllocatedLeaf","inputs":[{"name":"tonContractAddress","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"transferOwnership","inputs":[{"name":"newOwner","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"unregisterFunction","inputs":[{"name":"targetContract","type":"address","internalType":"address"},{"name":"functionSignature","type":"bytes32","internalType":"bytes32"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"updateBridge","inputs":[{"name":"_newBridge","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeTo","inputs":[{"name":"newImplementation","type":"address","internalType":"address"}],"outputs":[],"stateMutability":"nonpayable"},{"type":"function","name":"upgradeToAndCall","inputs":[{"name":"newImplementation","type":"address","internalType":"address"},{"name":"data","type":"bytes","internalType":"bytes"}],"outputs":[],"stateMutability":"payable"},{"type":"event","name":"AdminChanged","inputs":[{"name":"previousAdmin","type":"address","indexed":false,"internalType":"address"},{"name":"newAdmin","type":"address","indexed":false,"internalType":"address"}],"anonymous":false},{"type":"event","name":"BeaconUpgraded","inputs":[{"name":"beacon","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"FunctionRegistered","inputs":[{"name":"functionSignature","type":"bytes32","indexed":true,"internalType":"bytes32"},{"name":"preprocessedPart1Length","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"preprocessedPart2Length","type":"uint256","indexed":false,"internalType":"uint256"},{"name":"instancesHash","type":"bytes32","indexed":false,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"FunctionUnregistered","inputs":[{"name":"functionSignature","type":"bytes32","indexed":true,"internalType":"bytes32"}],"anonymous":false},{"type":"event","name":"Initialized","inputs":[{"name":"version","type":"uint8","indexed":false,"internalType":"uint8"}],"anonymous":false},{"type":"event","name":"OwnershipTransferred","inputs":[{"name":"previousOwner","type":"address","indexed":true,"internalType":"address"},{"name":"newOwner","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"TargetContractAllowed","inputs":[{"name":"targetContract","type":"address","indexed":true,"internalType":"address"},{"name":"allowed","type":"bool","indexed":false,"internalType":"bool"}],"anonymous":false},{"type":"event","name":"TreasuryAddressUpdated","inputs":[{"name":"oldTreasury","type":"address","indexed":true,"internalType":"address"},{"name":"newTreasury","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"Upgraded","inputs":[{"name":"implementation","type":"address","indexed":true,"internalType":"address"}],"anonymous":false},{"type":"event","name":"VerifierUpdated","inputs":[{"name":"oldVerifier","type":"address","indexed":true,"internalType":"address"},{"name":"newVerifier","type":"address","indexed":true,"internalType":"address"}],"anonymous":false}]
    }
  }
}



================================================
FILE: script/upgrade/README.md
================================================
# Upgrade Scripts

This folder contains all contract upgrade scripts for the Tokamak zk-EVM bridge system.

## Available Upgrade Scripts

### Solidity Scripts (.sol)

1. **UpgradeBridgeCore.s.sol** - Upgrades the BridgeCore contract implementation
2. **UpgradeBridgeProofManager.s.sol** - Upgrades the BridgeProofManager contract implementation  
3. **UpgradeBridgeAdminManager.s.sol** - Upgrades the BridgeAdminManager contract implementation
4. **UpgradeBridgeDepositManager.s.sol** - Upgrades the BridgeDepositManager contract implementation
5. **UpgradeBridgeWithdrawManager.s.sol** - Upgrades the BridgeWithdrawManager contract implementation
6. **UpgradeTokamakVerifier.s.sol** - Upgrades the TokamakVerifier contract implementation
7. **UpgradeContracts.s.sol** - Upgrades multiple contracts in a single transaction
8. **UpdateGroth16Verifier16.s.sol** - Updates the Groth16Verifier16 contract

### Shell Scripts (.sh)

Each Solidity script has a corresponding shell script for easy execution:

1. **upgrade-bridge-core.sh** - Executes BridgeCore upgrade
2. **upgrade-bridge-proof-manager.sh** - Executes BridgeProofManager upgrade
3. **upgrade-bridge-admin-manager.sh** - Executes BridgeAdminManager upgrade
4. **upgrade-bridge-deposit-manager.sh** - Executes BridgeDepositManager upgrade
5. **upgrade-bridge-withdraw-manager.sh** - Executes BridgeWithdrawManager upgrade
6. **upgrade-tokamak-verifier.sh** - Executes TokamakVerifier upgrade
7. **upgrade-contracts.sh** - Executes multiple contract upgrades
8. **update-groth16-verifier16.sh** - Executes Groth16Verifier16 update

## Usage

### Prerequisites

1. Make sure you have a `.env` file in the project root with the required environment variables:
   ```bash
   PRIVATE_KEY=your_private_key_here
   RPC_URL=your_rpc_url_here
   ETHERSCAN_API_KEY=your_etherscan_api_key_here  # Optional, for verification
   
   # Proxy addresses for individual upgrades
   ROLLUP_BRIDGE_CORE_PROXY_ADDRESS=0x...
   ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS=0x...
   ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS=0x...
   ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS=0x...
   ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS=0x...
   TOKAMAK_VERIFIER_PROXY_ADDRESS=0x...
   
   # Additional variables for specific scripts
   DEPLOYER_ADDRESS=0x...  # Required for BridgeProofManager upgrade
   CHAIN_ID=11155111       # Optional, defaults to Sepolia
   VERIFY_CONTRACTS=false  # Optional, for BridgeProofManager script
   ```

### Running Individual Upgrades

To upgrade a specific contract:

```bash
# Navigate to the upgrade directory
cd script/upgrade

# Run individual upgrade (without verification)
./upgrade-bridge-core.sh

# Run with contract verification
./upgrade-bridge-core.sh sepolia --verify
```

### Running Multiple Upgrades

To upgrade all contracts at once:

```bash
cd script/upgrade
./upgrade-contracts.sh sepolia --verify
```

## Important Notes

1. **Proxy Addresses**: Each upgrade script targets a specific proxy address. Make sure the correct proxy addresses are set in your `.env` file.

2. **Verification**: Use the `--verify` flag to automatically verify contracts on Etherscan. This requires `ETHERSCAN_API_KEY` to be set.

3. **Gas Limits**: All scripts use a default gas limit of 3,000,000. Adjust if needed based on network conditions.

4. **Permissions**: The account associated with `PRIVATE_KEY` must have upgrade permissions (usually the owner) for the contracts being upgraded.

5. **Testing**: Always test upgrades on testnet before deploying to mainnet.

## Script Structure

Each shell script follows this pattern:
- Environment validation
- Color-coded output for better readability
- Error handling with proper exit codes
- Optional contract verification
- Success/failure reporting

## Troubleshooting

1. **Environment Variable Errors**: Make sure all required environment variables are set in your `.env` file.

2. **Permission Errors**: Ensure the deployer account has the necessary permissions to upgrade the contracts.

3. **Gas Estimation Errors**: Try increasing the gas limit or check network conditions.

4. **Verification Failures**: Ensure `ETHERSCAN_API_KEY` is valid and the network supports verification.


================================================
FILE: script/upgrade/update-groth16-verifier16.sh
================================================
#!/bin/bash

# Script to update Groth16Verifier16 contract
# Usage: ./update-groth16-verifier16.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

echo -e "${YELLOW}=== Update Groth16Verifier16 Script ===${NC}"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the script
echo -e "${YELLOW}Starting UpdateGroth16Verifier16 script...${NC}"
forge script script/upgrade/UpdateGroth16Verifier16.s.sol:UpdateGroth16Verifier16Script \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 3000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… UpdateGroth16Verifier16 script completed successfully!${NC}"
else
    echo -e "${RED}âŒ UpdateGroth16Verifier16 script failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/UpdateGroth16Verifier16.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "../../src/verifier/Groth16Verifier16Leaves.sol";
import "../../src/BridgeProofManager.sol";

contract UpdateGroth16Verifier16Script is Script {
    function run() public {
        // Load environment variables
        uint256 privateKey = vm.envUint("PRIVATE_KEY");
        // Use the deployed ProofManager proxy address
        address proofManagerAddress = 0xd89A53b0edC82351A300a0779A6f4bA5a310f34E;

        console.log("=== Updating Groth16 16-Leaves Verifier ===");
        console.log("Using ProofManager address:", proofManagerAddress);
        console.log("Deployer address:", vm.addr(privateKey));

        vm.startBroadcast(privateKey);

        // Deploy the new Groth16Verifier16Leaves contract
        console.log("\n1. Deploying new Groth16Verifier16Leaves...");
        Groth16Verifier16Leaves newVerifier16 = new Groth16Verifier16Leaves();
        console.log("New Groth16Verifier16Leaves deployed at:", address(newVerifier16));

        // Get the BridgeProofManager instance
        BridgeProofManager proofManager = BridgeProofManager(proofManagerAddress);

        // Get current verifier addresses to maintain the other verifiers unchanged
        console.log("\n2. Getting current verifier addresses...");
        address currentVerifier16 = address(proofManager.groth16Verifier16());
        address currentVerifier32 = address(proofManager.groth16Verifier32());
        address currentVerifier64 = address(proofManager.groth16Verifier64());
        address currentVerifier128 = address(proofManager.groth16Verifier128());

        console.log("Current 16-leaves verifier:", currentVerifier16);
        console.log("Current 32-leaves verifier:", currentVerifier32);
        console.log("Current 64-leaves verifier:", currentVerifier64);
        console.log("Current 128-leaves verifier:", currentVerifier128);

        // Prepare the new verifiers array (only updating the 16-leaves verifier)
        address[4] memory newVerifiers = [
            address(newVerifier16), // Updated 16-leaves verifier
            currentVerifier32, // Keep existing 32-leaves verifier
            currentVerifier64, // Keep existing 64-leaves verifier
            currentVerifier128 // Keep existing 128-leaves verifier
        ];

        // Update the verifiers
        console.log("\n3. Updating verifiers in ProofManager...");
        proofManager.updateGroth16Verifiers(newVerifiers);
        console.log("Groth16 verifiers updated successfully!");

        // Verify the update
        console.log("\n4. Verifying the update...");
        address updatedVerifier16 = address(proofManager.groth16Verifier16());
        console.log("New 16-leaves verifier address:", updatedVerifier16);
        console.log("Update successful:", updatedVerifier16 == address(newVerifier16));

        vm.stopBroadcast();

        console.log("\n=== Deployment Summary ===");
        console.log("New Groth16Verifier16Leaves:", address(newVerifier16));
        console.log("ProofManager Address:", proofManagerAddress);
        console.log("Transaction completed successfully!");
    }
}



================================================
FILE: script/upgrade/upgrade-bridge-admin-manager.sh
================================================
#!/bin/bash

# Script to upgrade BridgeAdminManager contract
# Usage: ./upgrade-bridge-admin-manager.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

# Set default values for verification variables if not set
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-false}
export CHAIN_ID=${CHAIN_ID:-11155111}

echo -e "${YELLOW}=== BridgeAdminManager Upgrade Script ===${NC}"
echo "Proxy Address: $ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS"
echo "Deployer: $DEPLOYER_ADDRESS"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the upgrade script
echo -e "${YELLOW}Starting BridgeAdminManager upgrade...${NC}"
forge script script/upgrade/UpgradeBridgeAdminManager.s.sol:UpgradeBridgeAdminManagerScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 10000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… BridgeAdminManager upgrade completed successfully!${NC}"
    
    # Check if --verify flag is passed and perform contract verification
    if [ "$1" = "--verify" ]; then
        echo -e "${YELLOW}Starting contract verification...${NC}"
        
        # Find the most recent upgrade addresses file
        ADDRESSES_FILE=$(ls -t upgrade_addresses_*.txt 2>/dev/null | head -n1)
        
        if [ -f "$ADDRESSES_FILE" ]; then
            source $ADDRESSES_FILE
            
            if [ -n "$BRIDGE_ADMIN_MANAGER_IMPL" ]; then
                echo "Verifying BridgeAdminManager implementation at: $BRIDGE_ADMIN_MANAGER_IMPL"
                
                forge verify-contract $BRIDGE_ADMIN_MANAGER_IMPL \
                    src/BridgeAdminManager.sol:BridgeAdminManager \
                    --chain-id $CHAIN_ID \
                    --etherscan-api-key $ETHERSCAN_API_KEY \
                    --watch
                
                if [ $? -eq 0 ]; then
                    echo -e "${GREEN}âœ… BridgeAdminManager implementation verified on Etherscan!${NC}"
                else
                    echo -e "${RED}âŒ Contract verification failed${NC}"
                fi
            else
                echo -e "${RED}âŒ Could not find BRIDGE_ADMIN_MANAGER_IMPL address${NC}"
            fi
            
            # Clean up the addresses file
            rm -f $ADDRESSES_FILE
        else
            echo -e "${RED}âŒ Could not find upgrade addresses file${NC}"
        fi
    fi
else
    echo -e "${RED}âŒ BridgeAdminManager upgrade failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/upgrade-bridge-core.sh
================================================
#!/bin/bash

# Script to upgrade BridgeCore contract
# Usage: ./upgrade-bridge-core.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Function to update or create contracts JSON
update_contracts_json() {
    local contract_name="$1"
    local contract_address="$2"
    local network="$3"
    local source_file="$4"
    local is_upgrade="${5:-false}"
    
    if ! command -v jq &> /dev/null; then
        echo -e "${YELLOW}jq not installed - cannot update contracts JSON${NC}"
        return 1
    fi
    
    local contracts_json="$PROJECT_ROOT/contracts-$network.json"
    
    # Get ABI from forge artifacts
    local abi_file="$PROJECT_ROOT/out/${source_file##*/}/${contract_name}.json"
    local abi="[]"
    
    if [ -f "$abi_file" ]; then
        abi=$(jq -c '.abi' "$abi_file" 2>/dev/null || echo "[]")
    fi
    
    # Create or update JSON file
    if [ -f "$contracts_json" ]; then
        # Update existing JSON
        if [ "$is_upgrade" = "true" ]; then
            # For upgrades, update the implementation address but keep proxy info
            jq --arg name "$contract_name" \
               --arg impl_addr "$contract_address" \
               --argjson abi "$abi" \
               --arg date "$(date -u +"%Y-%m-%dT%H:%M:%SZ")" \
               'if .contracts[$name] then 
                  .contracts[$name].implementationAddress = $impl_addr | 
                  .contracts[$name].abi = $abi |
                  .contracts[$name].lastUpgraded = $date
                else 
                  .contracts[$name] = {implementationAddress: $impl_addr, abi: $abi, lastUpgraded: $date}
                end | .lastUpdated = $date' \
               "$contracts_json" > "${contracts_json}.tmp" && mv "${contracts_json}.tmp" "$contracts_json"
        else
            # For regular deployments
            jq --arg name "$contract_name" \
               --arg addr "$contract_address" \
               --argjson abi "$abi" \
               --arg date "$(date -u +"%Y-%m-%dT%H:%M:%SZ")" \
               '.contracts[$name] = {address: $addr, abi: $abi} | .lastUpdated = $date' \
               "$contracts_json" > "${contracts_json}.tmp" && mv "${contracts_json}.tmp" "$contracts_json"
        fi
        echo -e "${GREEN}Updated existing contracts JSON: $contracts_json${NC}"
    else
        # Create new JSON
        if [ "$is_upgrade" = "true" ]; then
            cat > "$contracts_json" << EOF
{
  "network": "$network",
  "deploymentDate": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
  "lastUpdated": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
  "contracts": {
    "$contract_name": {
      "implementationAddress": "$contract_address",
      "abi": $abi,
      "lastUpgraded": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")"
    }
  }
}
EOF
        else
            cat > "$contracts_json" << EOF
{
  "network": "$network",
  "deploymentDate": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
  "lastUpdated": "$(date -u +"%Y-%m-%dT%H:%M:%SZ")",
  "contracts": {
    "$contract_name": {
      "address": "$contract_address",
      "abi": $abi
    }
  }
}
EOF
        fi
        echo -e "${GREEN}Created new contracts JSON: $contracts_json${NC}"
    fi
}

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "ROLLUP_BRIDGE_CORE_PROXY_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

# Set default values for verification variables if not set
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-false}
export CHAIN_ID=${CHAIN_ID:-11155111}

echo -e "${YELLOW}=== BridgeCore Upgrade Script ===${NC}"
echo "Proxy Address: $ROLLUP_BRIDGE_CORE_PROXY_ADDRESS"
echo "Deployer: $DEPLOYER_ADDRESS"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
SHOULD_VERIFY=false

# Parse arguments
for arg in "$@"; do
    case $arg in
        --verify)
            SHOULD_VERIFY=true
            VERIFY_FLAG="--verify"
            ;;
        sepolia|mainnet|arbitrum|optimism)
            # Network names are ignored - we use RPC_URL from .env
            ;;
        *)
            echo -e "${YELLOW}Unknown argument: $arg${NC}"
            ;;
    esac
done

if [ "$SHOULD_VERIFY" = true ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the upgrade script and capture output
echo -e "${YELLOW}Starting BridgeCore upgrade...${NC}"
SCRIPT_OUTPUT=$(forge script script/upgrade/UpgradeBridgeCore.s.sol:UpgradeBridgeCoreScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 10000000 \
    $VERIFY_FLAG 2>&1)

SCRIPT_EXIT_CODE=$?
echo "$SCRIPT_OUTPUT"

if [ $SCRIPT_EXIT_CODE -eq 0 ]; then
    echo -e "${GREEN}âœ… BridgeCore upgrade completed successfully!${NC}"
    
    # Extract implementation address from script output
    IMPL_ADDRESS=$(echo "$SCRIPT_OUTPUT" | grep "VERIFY_IMPL_ADDRESS:" | awk '{print $2}')
    
    # Update contracts JSON file with new implementation
    if [ -n "$IMPL_ADDRESS" ]; then
        NETWORK=${NETWORK:-"unknown"}
        echo -e "${YELLOW}Updating contracts JSON...${NC}"
        update_contracts_json "BridgeCore" "$IMPL_ADDRESS" "$NETWORK" "src/BridgeCore.sol" "true"
    fi
    
    # Check if --verify flag is passed and perform contract verification
    if [ "$SHOULD_VERIFY" = true ]; then
        echo -e "${YELLOW}Starting contract verification...${NC}"
        
        if [ -n "$IMPL_ADDRESS" ]; then
            echo "Verifying BridgeCore implementation at: $IMPL_ADDRESS"
            
            forge verify-contract $IMPL_ADDRESS \
                src/BridgeCore.sol:BridgeCore \
                --chain-id $CHAIN_ID \
                --etherscan-api-key $ETHERSCAN_API_KEY \
                --watch
            
            if [ $? -eq 0 ]; then
                echo -e "${GREEN}âœ… BridgeCore implementation verified on Etherscan!${NC}"
            else
                echo -e "${RED}âŒ Contract verification failed${NC}"
            fi
        else
            echo -e "${RED}âŒ Could not extract implementation address from script output${NC}"
        fi
    fi
else
    echo -e "${RED}âŒ BridgeCore upgrade failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/upgrade-bridge-deposit-manager.sh
================================================
#!/bin/bash

# Script to upgrade BridgeDepositManager contract
# Usage: ./upgrade-bridge-deposit-manager.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

# Set default values for verification variables if not set
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-false}
export CHAIN_ID=${CHAIN_ID:-11155111}

echo -e "${YELLOW}=== BridgeDepositManager Upgrade Script ===${NC}"
echo "Proxy Address: $ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS"
echo "Deployer: $DEPLOYER_ADDRESS"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the upgrade script
echo -e "${YELLOW}Starting BridgeDepositManager upgrade...${NC}"
forge script script/upgrade/UpgradeBridgeDepositManager.s.sol:UpgradeBridgeDepositManagerScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 10000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… BridgeDepositManager upgrade completed successfully!${NC}"
else
    echo -e "${RED}âŒ BridgeDepositManager upgrade failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/upgrade-bridge-proof-manager.sh
================================================
#!/bin/bash

# Script to upgrade BridgeProofManager contract
# Usage: ./upgrade-bridge-proof-manager.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

echo -e "${YELLOW}=== BridgeProofManager Upgrade Script ===${NC}"
echo "Proxy Address: $ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS"
echo "Deployer: $DEPLOYER_ADDRESS"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Set default values for verification variables if not set
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-false}
export CHAIN_ID=${CHAIN_ID:-11155111}

# Run the upgrade script
echo -e "${YELLOW}Starting BridgeProofManager upgrade...${NC}"
forge script script/upgrade/UpgradeBridgeProofManager.s.sol:UpgradeBridgeProofManagerScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 10000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… BridgeProofManager upgrade completed successfully!${NC}"
    
    # Check if --verify flag is passed and perform contract verification
    if [ "$1" = "--verify" ]; then
        echo -e "${YELLOW}Starting contract verification...${NC}"
        
        # Find the most recent upgrade addresses file
        ADDRESSES_FILE=$(ls -t upgrade_addresses_*.txt 2>/dev/null | head -n1)
        
        if [ -f "$ADDRESSES_FILE" ]; then
            source $ADDRESSES_FILE
            
            if [ -n "$BRIDGE_PROOF_MANAGER_IMPL" ]; then
                echo "Verifying BridgeProofManager implementation at: $BRIDGE_PROOF_MANAGER_IMPL"
                
                forge verify-contract $BRIDGE_PROOF_MANAGER_IMPL \
                    src/BridgeProofManager.sol:BridgeProofManager \
                    --chain-id $CHAIN_ID \
                    --etherscan-api-key $ETHERSCAN_API_KEY \
                    --watch
                
                if [ $? -eq 0 ]; then
                    echo -e "${GREEN}âœ… BridgeProofManager implementation verified on Etherscan!${NC}"
                else
                    echo -e "${RED}âŒ Contract verification failed${NC}"
                fi
            else
                echo -e "${RED}âŒ Could not find BRIDGE_PROOF_MANAGER_IMPL address${NC}"
            fi
            
            # Clean up the addresses file
            rm -f $ADDRESSES_FILE
        else
            echo -e "${RED}âŒ Could not find upgrade addresses file${NC}"
        fi
    fi
else
    echo -e "${RED}âŒ BridgeProofManager upgrade failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/upgrade-bridge-withdraw-manager.sh
================================================
#!/bin/bash

# Script to upgrade BridgeWithdrawManager contract
# Usage: ./upgrade-bridge-withdraw-manager.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

# Set default values for verification variables if not set
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-false}
export CHAIN_ID=${CHAIN_ID:-11155111}

echo -e "${YELLOW}=== BridgeWithdrawManager Upgrade Script ===${NC}"
echo "Proxy Address: $ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS"
echo "Deployer: $DEPLOYER_ADDRESS"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the upgrade script
echo -e "${YELLOW}Starting BridgeWithdrawManager upgrade...${NC}"
forge script script/upgrade/UpgradeBridgeWithdrawManager.s.sol:UpgradeBridgeWithdrawManagerScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 10000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… BridgeWithdrawManager upgrade completed successfully!${NC}"
else
    echo -e "${RED}âŒ BridgeWithdrawManager upgrade failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/upgrade-contracts.sh
================================================
#!/bin/bash

# Bridge Contracts Upgrade Script
# Usage: ./upgrade-contracts.sh <network>
# Example: ./upgrade-contracts.sh sepolia

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Function to print colored output
print_status() {
    echo -e "${BLUE}[INFO]${NC} $1"
}

print_success() {
    echo -e "${GREEN}[SUCCESS]${NC} $1"
}

print_warning() {
    echo -e "${YELLOW}[WARNING]${NC} $1"
}

print_error() {
    echo -e "${RED}[ERROR]${NC} $1"
}

# Function to generate comprehensive contracts JSON (same structure as deploy script)
generate_upgrade_contracts_json() {
    local output_file="$1"
    local network="$2"
    
    if ! command -v jq &> /dev/null; then
        print_warning "jq not installed - cannot generate contracts JSON"
        return 1
    fi
    
    # Direct deployment contracts (not proxies) - from environment variables
    local direct_contracts=(
        "TokamakVerifier:src/verifier/TokamakVerifier.sol"
        "Groth16Verifier16Leaves:src/verifier/Groth16Verifier16Leaves.sol"
        "Groth16Verifier32Leaves:src/verifier/Groth16Verifier32Leaves.sol"
        "Groth16Verifier64Leaves:src/verifier/Groth16Verifier64Leaves.sol"
        "Groth16Verifier64LeavesIC:src/verifier/Groth16Verifier64LeavesIC.sol"
        "Groth16Verifier128Leaves:src/verifier/Groth16Verifier128Leaves.sol"
        "Groth16Verifier128LeavesIC1:src/verifier/Groth16Verifier128LeavesIC1.sol"
        "Groth16Verifier128LeavesIC2:src/verifier/Groth16Verifier128LeavesIC2.sol"
        "ZecFrost:src/library/ZecFrost.sol"
    )
    
    # Proxy contracts (use proxy address but implementation ABI)
    # Order independent - addresses come from environment variables
    local proxy_contracts=(
        "BridgeCore:src/BridgeCore.sol"
        "BridgeDepositManager:src/BridgeDepositManager.sol"
        "BridgeProofManager:src/BridgeProofManager.sol"
        "BridgeWithdrawManager:src/BridgeWithdrawManager.sol"
        "BridgeAdminManager:src/BridgeAdminManager.sol"
    )
    
    # Start building the JSON
    printf '{\n  "network": "%s",\n  "upgradeDate": "%s",\n  "contracts": {\n' \
        "$network" "$(date -u +"%Y-%m-%dT%H:%M:%SZ")" > "$output_file"

    local first_contract=true
    
    # Process direct contracts from environment variables
    for contract_info in "${direct_contracts[@]}"; do
        local contract_name="${contract_info%%:*}"
        local source_file="${contract_info##*:}"
        
        # Get contract address from environment variable
        local address=""
        case "$contract_name" in
            "TokamakVerifier")
                address="$ZK_VERIFIER_ADDRESS"
                ;;
            "Groth16Verifier16Leaves")
                address="$Groth16_Verifier16"
                ;;
            "Groth16Verifier32Leaves")
                address="$Groth16_Verifier32"
                ;;
            "Groth16Verifier64Leaves")
                address="$Groth16_Verifier64"
                ;;
            "Groth16Verifier64LeavesIC")
                address="$Groth16_Verifier64_IC"
                ;;
            "Groth16Verifier128Leaves")
                address="$Groth16_Verifier128"
                ;;
            "Groth16Verifier128LeavesIC1")
                address="$Groth16_Verifier128_IC1"
                ;;
            "Groth16Verifier128LeavesIC2")
                address="$Groth16_Verifier128_IC2"
                ;;
            "ZecFrost")
                address="$ZECFROST_ADDRESS"
                ;;
        esac
        
        if [ -n "$address" ] && [ "$address" != "null" ]; then
            print_status "Adding $contract_name direct address: $address"
            
            # Add comma for all but first contract
            if [ "$first_contract" = false ]; then
                printf ',\n' >> "$output_file"
            fi
            first_contract=false
            
            # Get ABI from contract artifacts
            local abi_file="$PROJECT_ROOT/out/${contract_name}.sol/${contract_name}.json"
            local abi="[]"
            
            if [ -f "$abi_file" ]; then
                abi=$(jq -c '.abi' "$abi_file" 2>/dev/null || echo "[]")
            fi
            
            # Add direct contract entry
            printf '    "%s": {\n      "address": "%s",\n      "abi": %s\n    }' \
                "$contract_name" "$address" "$abi" >> "$output_file"
        fi
    done
    
    # Process proxy contracts using environment variables
    for contract_info in "${proxy_contracts[@]}"; do
        local contract_name="${contract_info%%:*}"
        local source_file="${contract_info##*:}"
        
        # Get proxy address from environment variable
        local proxy_address=""
        case "$contract_name" in
            "BridgeCore")
                proxy_address="$ROLLUP_BRIDGE_CORE_PROXY_ADDRESS"
                ;;
            "BridgeDepositManager") 
                proxy_address="$ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS"
                ;;
            "BridgeProofManager")
                proxy_address="$ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS"
                ;;
            "BridgeWithdrawManager")
                proxy_address="$ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS"
                ;;
            "BridgeAdminManager")
                proxy_address="$ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS"
                ;;
        esac
        
        if [ -n "$proxy_address" ] && [ "$proxy_address" != "null" ]; then
            print_status "Adding $contract_name proxy address: $proxy_address"
            
            # Add comma for all but first contract
            if [ "$first_contract" = false ]; then
                printf ',\n' >> "$output_file"
            fi
            first_contract=false
            
            # Get ABI from implementation contract
            local abi_file="$PROJECT_ROOT/out/${contract_name}.sol/${contract_name}.json"
            local abi="[]"
            
            if [ -f "$abi_file" ]; then
                abi=$(jq -c '.abi' "$abi_file" 2>/dev/null || echo "[]")
            fi
            
            # Add proxy contract entry
            printf '    "%s": {\n      "address": "%s",\n      "abi": %s\n    }' \
                "$contract_name" "$proxy_address" "$abi" >> "$output_file"
        else
            print_warning "Missing proxy address for $contract_name"
        fi
    done
    
    # Close the JSON
    printf '\n  }\n}\n' >> "$output_file"

    print_success "Generated upgrade contracts JSON with $(jq '.contracts | length' "$output_file" 2>/dev/null || echo "unknown") contracts"
}

# Function to show usage
show_usage() {
    echo "Usage: $0 <network>"
    echo ""
    echo "This script upgrades ALL 5 bridge contracts simultaneously:"
    echo "  - BridgeCore (main bridge logic)"
    echo "  - BridgeDepositManager (handles deposits)"
    echo "  - BridgeProofManager (handles proofs and state)"
    echo "  - BridgeWithdrawManager (handles withdrawals)"
    echo "  - BridgeAdminManager (handles administration)"
    echo ""
    echo "Options:"
    echo "  --help             Show this help message"
    echo ""
    echo "Examples:"
    echo "  $0 sepolia"
    echo "  $0 mainnet"
    echo "  $0 arbitrum"
    echo ""
    echo "Required environment variables:"
    echo "  PRIVATE_KEY                                     - Private key for deployment"
    echo "  ROLLUP_BRIDGE_CORE_PROXY_ADDRESS               - Address of BridgeCore proxy"
    echo "  ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS     - Address of DepositManager proxy"
    echo "  ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS       - Address of ProofManager proxy"
    echo "  ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS    - Address of WithdrawManager proxy"
    echo "  ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS       - Address of AdminManager proxy"
    echo "  DEPLOYER_ADDRESS                               - Address of contract owner"
    echo "  RPC_URL                                        - RPC endpoint"
    echo "  CHAIN_ID                                       - Chain ID"
    echo ""
    echo "Optional environment variables:"
    echo "  VERIFY_CONTRACTS             - Verify contracts (default: true)"
    echo "  ETHERSCAN_API_KEY           - Etherscan API key for verification"
}

# Check if network argument is provided
if [ $# -eq 0 ]; then
    print_error "Please provide a network name"
    show_usage
    exit 1
fi

# Check for help flag
if [[ "$1" == "--help" || "$1" == "-h" ]]; then
    show_usage
    exit 0
fi

NETWORK=$1
shift

# Parse options (only --help is supported)
while [[ $# -gt 0 ]]; do
    case $1 in
        --help|-h)
            show_usage
            exit 0
            ;;
        *)
            print_error "Unknown option: $1"
            print_error "This script only accepts a network name. Use --help for usage."
            show_usage
            exit 1
            ;;
    esac
done

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

print_status "Starting Bridge Contracts upgrade on $NETWORK"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    print_error ".env file not found in project root"
    echo "Please create a .env file with the required environment variables"
    show_usage
    exit 1
fi

print_success "Found .env file"

# Source the environment variables
source "$ENV_FILE"

# Validate required environment variables
required_vars=(
    "PRIVATE_KEY" 
    "DEPLOYER_ADDRESS" 
    "RPC_URL" 
    "CHAIN_ID"
    "ROLLUP_BRIDGE_CORE_PROXY_ADDRESS"
    "ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS"
    "ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS"
    "ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS"
    "ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS"
)

missing_vars=()

for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        missing_vars+=("$var")
    fi
done

if [ ${#missing_vars[@]} -ne 0 ]; then
    print_error "Missing required environment variables:"
    for var in "${missing_vars[@]}"; do
        echo "  - $var"
    done
    exit 1
fi

print_success "All required environment variables are set"

# Set default values for optional variables
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-true}
export ETHERSCAN_API_KEY=${ETHERSCAN_API_KEY:-""}

# Build the forge command
FORGE_CMD="forge script script/upgrade/UpgradeContracts.s.sol:UpgradeContractsScript"
FORGE_CMD="$FORGE_CMD --rpc-url $RPC_URL"
FORGE_CMD="$FORGE_CMD --broadcast"
FORGE_CMD="$FORGE_CMD --slow" # Add delay between transactions

# Add verification if enabled and API key is provided
if [ "$VERIFY_CONTRACTS" = "true" ] && [ -n "$ETHERSCAN_API_KEY" ]; then
    print_status "Contract verification enabled"
    FORGE_CMD="$FORGE_CMD --verify --etherscan-api-key $ETHERSCAN_API_KEY"
else
    print_warning "Contract verification disabled or API key not provided"
fi

print_status "Upgrade configuration:"
echo "  Network: $NETWORK"
echo "  RPC URL: $RPC_URL"
echo "  Chain ID: $CHAIN_ID"
echo "  Deployer (Owner): $DEPLOYER_ADDRESS"
echo ""
echo "  Bridge Contract Proxies:"
echo "    BridgeCore: $ROLLUP_BRIDGE_CORE_PROXY_ADDRESS"
echo "    DepositManager: $ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS"
echo "    ProofManager: $ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS"
echo "    WithdrawManager: $ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS"
echo "    AdminManager: $ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS"
echo ""
echo "  Verify Contracts: $VERIFY_CONTRACTS"

# Confirmation with extra warning for mainnet
echo ""
if [[ "$NETWORK" =~ ^(mainnet|ethereum|eth)$ ]]; then
    print_warning "âš ï¸  MAINNET BRIDGE UPGRADE DETECTED âš ï¸"
    print_warning "This will upgrade ALL 5 bridge contracts on MAINNET!"
    print_warning "Make sure you have tested on testnet first!"
    print_warning "This affects BridgeCore, DepositManager, ProofManager, WithdrawManager, and AdminManager"
    echo ""
    read -p "Are you absolutely sure you want to upgrade ALL bridge contracts on MAINNET? Type 'YES' to continue: " -r
    if [[ $REPLY != "YES" ]]; then
        print_warning "Upgrade cancelled"
        exit 0
    fi
else
    print_warning "This will upgrade ALL 5 bridge contracts simultaneously"
    read -p "Do you want to proceed with the bridge contracts upgrade? (y/N): " -n 1 -r
    echo ""
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        print_warning "Upgrade cancelled"
        exit 0
    fi
fi

# Create broadcast directory if it doesn't exist
mkdir -p "$PROJECT_ROOT/broadcast"

print_status "Starting upgrade..."
print_status "Command: $FORGE_CMD"

# Run the upgrade
cd "$PROJECT_ROOT"
if eval $FORGE_CMD; then
    print_success "Upgrade completed successfully!"
    
    # Extract deployment addresses from broadcast files
    BROADCAST_DIR="$PROJECT_ROOT/broadcast/UpgradeContracts.s.sol/$CHAIN_ID"
    LATEST_RUN="$BROADCAST_DIR/run-latest.json"
    
    if [ -f "$LATEST_RUN" ]; then
        print_status "Extracting upgrade information..."
        
        # Parse JSON to extract addresses (requires jq)
        if command -v jq &> /dev/null; then
            echo ""
            echo "=== UPGRADE SUMMARY ==="
            
            # Try to extract addresses from the broadcast file
            echo "New bridge implementation contracts:"
            jq -r '.transactions[] | select(.transactionType == "CREATE" or .transactionType == "CREATE2") | "  \(.contractName // "Contract"): \(.contractAddress)"' "$LATEST_RUN" 2>/dev/null || {
                print_warning "Could not parse implementation addresses automatically"
                echo "Please check the broadcast file: $LATEST_RUN"
            }
            
            echo "===================="
        else
            print_warning "jq not installed - cannot parse upgrade addresses automatically"
            print_status "Check broadcast file for addresses: $LATEST_RUN"
        fi
        
        # Save upgrade info
        UPGRADE_INFO="$PROJECT_ROOT/upgrades-$NETWORK-$(date +%Y%m%d-%H%M%S).json"
        cp "$LATEST_RUN" "$UPGRADE_INFO"
        print_success "Upgrade info saved to: $UPGRADE_INFO"
        
        # Generate single comprehensive JSON with all contract info
        print_status "Generating comprehensive upgrade JSON with addresses and ABIs..."
        
        # Create output directory
        OUTPUT_DIR="$PROJECT_ROOT/script/output"
        mkdir -p "$OUTPUT_DIR"
        
        CONTRACTS_JSON="$OUTPUT_DIR/contracts-$NETWORK.json"
        
        # Create the upgrade contracts JSON
        generate_upgrade_contracts_json "$CONTRACTS_JSON" "$NETWORK"
        
        if [ -f "$CONTRACTS_JSON" ]; then
            print_success "Contract addresses and ABIs saved to: $CONTRACTS_JSON"
        fi
        
    else
        print_warning "Broadcast file not found, upgrade may have failed"
    fi
    
    echo ""
    print_success "Next steps:"
    echo "1. Test ALL bridge contract functionality thoroughly"
    echo "   - Test deposits, proofs, withdrawals, and admin functions"
    echo "   - Verify cross-contract interactions work correctly"
    echo "2. Verify that all state is preserved correctly across all contracts"
    echo "3. Monitor ALL 5 contracts for any issues"
    echo "4. Update any off-chain systems with new implementation addresses"
    echo "5. Announce the upgrade to users if appropriate"
    
    print_warning "Important reminders:"
    echo "- ALL 5 proxy addresses remain the same for user interactions"
    echo "- ALL 5 implementation addresses have changed simultaneously"
    echo "- All existing state should be preserved across all contracts"
    echo "- Contract interdependencies should remain intact"
    
else
    print_error "Upgrade failed!"
    echo "Check the error messages above for details"
    exit 1
fi


================================================
FILE: script/upgrade/upgrade-tokamak-verifier.sh
================================================
#!/bin/bash

# Script to upgrade TokamakVerifier contract
# Usage: ./upgrade-tokamak-verifier.sh [--verify]

set -e

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Get script directory and project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

# Check if .env file exists
ENV_FILE="$PROJECT_ROOT/.env"
if [ ! -f "$ENV_FILE" ]; then
    echo -e "${RED}Error: .env file not found in project root${NC}"
    echo "Please create a .env file with the required environment variables"
    exit 1
fi

# Source environment variables
source "$ENV_FILE"

# Verify required environment variables
required_vars=("PRIVATE_KEY" "TOKAMAK_VERIFIER_PROXY_ADDRESS" "DEPLOYER_ADDRESS" "RPC_URL")
for var in "${required_vars[@]}"; do
    if [ -z "${!var}" ]; then
        echo -e "${RED}Error: Environment variable $var is not set${NC}"
        exit 1
    fi
done

# Set default values for verification variables if not set
export VERIFY_CONTRACTS=${VERIFY_CONTRACTS:-false}
export CHAIN_ID=${CHAIN_ID:-11155111}

echo -e "${YELLOW}=== TokamakVerifier Upgrade Script ===${NC}"
echo "Proxy Address: $TOKAMAK_VERIFIER_PROXY_ADDRESS"
echo "Deployer: $DEPLOYER_ADDRESS"
echo "RPC URL: $RPC_URL"
echo ""

# Check if --verify flag is passed
VERIFY_FLAG=""
if [ "$1" = "--verify" ]; then
    if [ -z "$ETHERSCAN_API_KEY" ]; then
        echo -e "${RED}Error: ETHERSCAN_API_KEY is required for verification${NC}"
        exit 1
    fi
    VERIFY_FLAG="--verify"
    echo -e "${YELLOW}Contract verification enabled${NC}"
fi

# Run the upgrade script
echo -e "${YELLOW}Starting TokamakVerifier upgrade...${NC}"
forge script script/upgrade/UpgradeTokamakVerifier.s.sol:UpgradeTokamakVerifierScript \
    --rpc-url $RPC_URL \
    --broadcast \
    --gas-limit 10000000 \
    $VERIFY_FLAG

if [ $? -eq 0 ]; then
    echo -e "${GREEN}âœ… TokamakVerifier upgrade completed successfully!${NC}"
else
    echo -e "${RED}âŒ TokamakVerifier upgrade failed${NC}"
    exit 1
fi


================================================
FILE: script/upgrade/UpgradeBridgeAdminManager.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/BridgeAdminManager.sol";

contract UpgradeBridgeAdminManagerScript is Script {
    // Existing proxy address (to be set via environment variables)
    address public adminManagerProxy;

    // New implementation address (will be deployed)
    address public newAdminManagerImpl;

    // Environment variables
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load existing proxy address
        adminManagerProxy = vm.envAddress("ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS");

        // Load deployer (must be owner of contract)
        deployer = vm.envAddress("DEPLOYER_ADDRESS");

        // Load verification settings
        shouldVerify = vm.envBool("VERIFY_CONTRACTS");
        etherscanApiKey = vm.envString("ETHERSCAN_API_KEY");
        chainId = vm.envString("CHAIN_ID");

        console.log("Upgrade Configuration:");
        console.log("Admin Manager proxy:", adminManagerProxy);
        console.log("Deployer (must be owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("Verify Contract:", shouldVerify);
    }

    function run() public {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");

        vm.startBroadcast(deployerPrivateKey);

        console.log("\n[START] Starting BridgeAdminManager upgrade...");

        // Verify current ownership
        _verifyOwnership();

        _upgradeContract();

        // Verify upgrade
        console.log("\n[VERIFY] Verifying upgrade...");
        _verifyUpgrade();

        vm.stopBroadcast();

        // Verify contract on block explorer (if enabled)
        if (shouldVerify) {
            console.log("\n[VERIFY EXPLORER] Verifying new implementation on block explorer...");
            _verifyContractOnExplorer();
        }

        console.log("\n[COMPLETE] BridgeAdminManager upgrade completed successfully!");
        _printUpgradeSummary();
    }

    function _verifyOwnership() internal view {
        console.log("\n[OWNERSHIP] Verifying contract ownership...");

        BridgeAdminManager adminManager = BridgeAdminManager(payable(adminManagerProxy));
        address adminOwner = adminManager.owner();
        require(adminOwner == deployer, "Deployer is not owner of BridgeAdminManager");
        console.log("[SUCCESS] Deployer is owner of BridgeAdminManager");
    }

    function _upgradeContract() internal {
        console.log("\n[UPGRADE] Upgrading BridgeAdminManager...");

        // Deploy new implementation
        _deployNewImplementation();

        // Perform upgrade
        _performUpgrade();

        console.log("[SUCCESS] BridgeAdminManager upgraded successfully");
    }

    function _deployNewImplementation() internal {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Deploy new BridgeAdminManager implementation
        console.log("Deploying new BridgeAdminManager implementation...");
        BridgeAdminManager newAdminManagerContract = new BridgeAdminManager();
        newAdminManagerImpl = address(newAdminManagerContract);
        address currentAdminImpl = address(uint160(uint256(vm.load(adminManagerProxy, implementationSlot))));
        console.log("Current AdminManager implementation:", currentAdminImpl);
        console.log("New AdminManager implementation:", newAdminManagerImpl);
        require(currentAdminImpl != newAdminManagerImpl, "AdminManager implementation addresses are the same");
    }

    function _performUpgrade() internal {
        // Upgrade BridgeAdminManager
        console.log("Upgrading BridgeAdminManager...");
        BridgeAdminManager adminManager = BridgeAdminManager(payable(adminManagerProxy));
        adminManager.upgradeTo(newAdminManagerImpl);
        console.log("[SUCCESS] BridgeAdminManager upgraded");
    }

    function _verifyUpgrade() internal view {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Verify BridgeAdminManager upgrade
        address currentAdminImpl = address(uint160(uint256(vm.load(adminManagerProxy, implementationSlot))));
        require(currentAdminImpl == newAdminManagerImpl, "AdminManager upgrade verification failed");
        BridgeAdminManager adminManager = BridgeAdminManager(payable(adminManagerProxy));
        require(adminManager.owner() == deployer, "AdminManager owner verification failed after upgrade");
        console.log("[SUCCESS] AdminManager upgrade verified");
    }

    function _verifyContractOnExplorer() internal {
        if (bytes(etherscanApiKey).length == 0) {
            console.log("[WARNING] ETHERSCAN_API_KEY not set, skipping verification");
            return;
        }

        console.log("[INFO] Contract verification will be performed by the shell script...");
        console.log("[INFO] The following new implementation will be verified:");
        console.log("  - AdminManager implementation:", newAdminManagerImpl);

        // Create a file to store the implementation address for the shell script to use
        string memory addressFile = string.concat("./upgrade_addresses_", vm.toString(block.timestamp), ".txt");
        vm.writeFile(addressFile, string.concat("BRIDGE_ADMIN_MANAGER_IMPL=", vm.toString(newAdminManagerImpl), "\n"));
        console.log("[INFO] Implementation address saved to:", addressFile);
    }

    function _printUpgradeSummary() internal view {
        console.log("\n[UPGRADE SUMMARY]");
        console.log("========================");
        console.log("PROXY ADDRESS (unchanged):");
        console.log("AdminManager proxy:", adminManagerProxy);
        console.log("");
        console.log("NEW IMPLEMENTATION ADDRESS:");
        console.log("AdminManager implementation:", newAdminManagerImpl);
        console.log("");
        console.log("Deployer (Owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("========================");

        console.log("\n[IMPORTANT NOTES]");
        console.log("1. Proxy address remains the same - use this for interactions");
        console.log("2. Implementation address has changed - save for future reference");
        console.log("3. All state and functionality should be preserved");
        console.log("4. Test thoroughly before relying on upgraded contract");

        console.log("\n[NEXT STEPS]");
        console.log("1. Test BridgeAdminManager functionality");
        console.log("2. Update any off-chain systems with new implementation address");
        console.log("3. Monitor contract for any issues");
        console.log("4. Consider announcing the upgrade to users");

        if (shouldVerify) {
            console.log("\n[VERIFICATION COMMANDS]");
            console.log("New implementation will be verified automatically with --verify flag");
            console.log("Manual verification command:");
            console.log("  forge verify-contract", newAdminManagerImpl, "src/BridgeAdminManager.sol:BridgeAdminManager");
        }
    }
}



================================================
FILE: script/upgrade/UpgradeBridgeCore.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/BridgeCore.sol";

contract UpgradeBridgeCoreScript is Script {
    // Existing proxy address (to be set via environment variables)
    address public bridgeCoreProxy;

    // New implementation address (will be deployed)
    address public newBridgeCoreImpl;

    // Environment variables
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load existing proxy address
        bridgeCoreProxy = vm.envAddress("ROLLUP_BRIDGE_CORE_PROXY_ADDRESS");

        // Load deployer (must be owner of contract)
        deployer = vm.envAddress("DEPLOYER_ADDRESS");

        // Load verification settings
        shouldVerify = vm.envBool("VERIFY_CONTRACTS");
        etherscanApiKey = vm.envString("ETHERSCAN_API_KEY");
        chainId = vm.envString("CHAIN_ID");

        console.log("Upgrade Configuration:");
        console.log("Bridge Core proxy:", bridgeCoreProxy);
        console.log("Deployer (must be owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("Verify Contract:", shouldVerify);
    }

    function run() public {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");

        vm.startBroadcast(deployerPrivateKey);

        console.log("\n[START] Starting BridgeCore upgrade...");

        // Verify current ownership
        _verifyOwnership();

        _upgradeContract();

        // Verify upgrade
        console.log("\n[VERIFY] Verifying upgrade...");
        _verifyUpgrade();

        vm.stopBroadcast();

        // Verify contract on block explorer (if enabled)
        if (shouldVerify) {
            console.log("\n[VERIFY EXPLORER] Verifying new implementation on block explorer...");
            _verifyContractOnExplorer();
        }

        console.log("\n[COMPLETE] BridgeCore upgrade completed successfully!");
        _printUpgradeSummary();
    }

    function _verifyOwnership() internal view {
        console.log("\n[OWNERSHIP] Verifying contract ownership...");

        BridgeCore bridgeCore = BridgeCore(payable(bridgeCoreProxy));
        address coreOwner = bridgeCore.owner();
        require(coreOwner == deployer, "Deployer is not owner of BridgeCore");
        console.log("[SUCCESS] Deployer is owner of BridgeCore");
    }

    function _upgradeContract() internal {
        console.log("\n[UPGRADE] Upgrading BridgeCore...");

        // Deploy new implementation
        _deployNewImplementation();

        // Perform upgrade
        _performUpgrade();

        console.log("[SUCCESS] BridgeCore upgraded successfully");
    }

    function _deployNewImplementation() internal {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Deploy new BridgeCore implementation
        console.log("Deploying new BridgeCore implementation...");
        BridgeCore newBridgeCoreContract = new BridgeCore();
        newBridgeCoreImpl = address(newBridgeCoreContract);
        address currentCoreImpl = address(uint160(uint256(vm.load(bridgeCoreProxy, implementationSlot))));
        console.log("Current BridgeCore implementation:", currentCoreImpl);
        console.log("New BridgeCore implementation:", newBridgeCoreImpl);
        require(currentCoreImpl != newBridgeCoreImpl, "BridgeCore implementation addresses are the same");
    }

    function _performUpgrade() internal {
        // Upgrade BridgeCore
        console.log("Upgrading BridgeCore...");
        BridgeCore bridgeCore = BridgeCore(payable(bridgeCoreProxy));
        bridgeCore.upgradeTo(newBridgeCoreImpl);
        console.log("[SUCCESS] BridgeCore upgraded");
    }

    function _verifyUpgrade() internal view {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Verify BridgeCore upgrade
        address currentCoreImpl = address(uint160(uint256(vm.load(bridgeCoreProxy, implementationSlot))));
        require(currentCoreImpl == newBridgeCoreImpl, "BridgeCore upgrade verification failed");
        BridgeCore bridgeCore = BridgeCore(payable(bridgeCoreProxy));
        require(bridgeCore.owner() == deployer, "BridgeCore owner verification failed after upgrade");
        console.log("[SUCCESS] BridgeCore upgrade verified");
    }

    function _verifyContractOnExplorer() internal view {
        if (bytes(etherscanApiKey).length == 0) {
            console.log("[WARNING] ETHERSCAN_API_KEY not set, skipping verification");
            return;
        }

        console.log("[INFO] Contract verification will be performed by the shell script...");
        console.log("[INFO] The following new implementation will be verified:");
        console.log("  - BridgeCore implementation:", newBridgeCoreImpl);

        // Output implementation address in a format the shell script can parse
        console.log("VERIFY_IMPL_ADDRESS:", newBridgeCoreImpl);
    }

    function _printUpgradeSummary() internal view {
        console.log("\n[UPGRADE SUMMARY]");
        console.log("========================");
        console.log("PROXY ADDRESS (unchanged):");
        console.log("BridgeCore proxy:", bridgeCoreProxy);
        console.log("");
        console.log("NEW IMPLEMENTATION ADDRESS:");
        console.log("BridgeCore implementation:", newBridgeCoreImpl);
        console.log("");
        console.log("Deployer (Owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("========================");

        console.log("\n[IMPORTANT NOTES]");
        console.log("1. Proxy address remains the same - use this for interactions");
        console.log("2. Implementation address has changed - save for future reference");
        console.log("3. All state and functionality should be preserved");
        console.log("4. Test thoroughly before relying on upgraded contract");

        console.log("\n[NEXT STEPS]");
        console.log("1. Test BridgeCore functionality");
        console.log("2. Update any off-chain systems with new implementation address");
        console.log("3. Monitor contract for any issues");
        console.log("4. Consider announcing the upgrade to users");

        if (shouldVerify) {
            console.log("\n[VERIFICATION COMMANDS]");
            console.log("New implementation will be verified automatically with --verify flag");
            console.log("Manual verification command:");
            console.log("  forge verify-contract", newBridgeCoreImpl, "src/BridgeCore.sol:BridgeCore");
        }
    }
}



================================================
FILE: script/upgrade/UpgradeBridgeDepositManager.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/BridgeDepositManager.sol";

contract UpgradeBridgeDepositManagerScript is Script {
    // Existing proxy address (to be set via environment variables)
    address public depositManagerProxy;

    // New implementation address (will be deployed)
    address public newDepositManagerImpl;

    // Environment variables
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load existing proxy address
        depositManagerProxy = vm.envAddress("ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS");

        // Load deployer (must be owner of contract)
        deployer = vm.envAddress("DEPLOYER_ADDRESS");

        // Load verification settings
        shouldVerify = vm.envBool("VERIFY_CONTRACTS");
        etherscanApiKey = vm.envString("ETHERSCAN_API_KEY");
        chainId = vm.envString("CHAIN_ID");

        console.log("Upgrade Configuration:");
        console.log("Deposit Manager proxy:", depositManagerProxy);
        console.log("Deployer (must be owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("Verify Contract:", shouldVerify);
    }

    function run() public {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");

        vm.startBroadcast(deployerPrivateKey);

        console.log("\n[START] Starting BridgeDepositManager upgrade...");

        // Verify current ownership
        _verifyOwnership();

        _upgradeContract();

        // Verify upgrade
        console.log("\n[VERIFY] Verifying upgrade...");
        _verifyUpgrade();

        vm.stopBroadcast();

        // Verify contract on block explorer (if enabled)
        if (shouldVerify) {
            console.log("\n[VERIFY EXPLORER] Verifying new implementation on block explorer...");
            _verifyContractOnExplorer();
        }

        console.log("\n[COMPLETE] BridgeDepositManager upgrade completed successfully!");
        _printUpgradeSummary();
    }

    function _verifyOwnership() internal view {
        console.log("\n[OWNERSHIP] Verifying contract ownership...");

        BridgeDepositManager depositManager = BridgeDepositManager(payable(depositManagerProxy));
        address depositOwner = depositManager.owner();
        require(depositOwner == deployer, "Deployer is not owner of BridgeDepositManager");
        console.log("[SUCCESS] Deployer is owner of BridgeDepositManager");
    }

    function _upgradeContract() internal {
        console.log("\n[UPGRADE] Upgrading BridgeDepositManager...");

        // Deploy new implementation
        _deployNewImplementation();

        // Perform upgrade
        _performUpgrade();

        console.log("[SUCCESS] BridgeDepositManager upgraded successfully");
    }

    function _deployNewImplementation() internal {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Deploy new BridgeDepositManager implementation
        console.log("Deploying new BridgeDepositManager implementation...");
        BridgeDepositManager newDepositManagerContract = new BridgeDepositManager();
        newDepositManagerImpl = address(newDepositManagerContract);
        address currentDepositImpl = address(uint160(uint256(vm.load(depositManagerProxy, implementationSlot))));
        console.log("Current DepositManager implementation:", currentDepositImpl);
        console.log("New DepositManager implementation:", newDepositManagerImpl);
        require(currentDepositImpl != newDepositManagerImpl, "DepositManager implementation addresses are the same");
    }

    function _performUpgrade() internal {
        // Upgrade BridgeDepositManager
        console.log("Upgrading BridgeDepositManager...");
        BridgeDepositManager depositManager = BridgeDepositManager(payable(depositManagerProxy));
        depositManager.upgradeTo(newDepositManagerImpl);
        console.log("[SUCCESS] BridgeDepositManager upgraded");
    }

    function _verifyUpgrade() internal view {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Verify BridgeDepositManager upgrade
        address currentDepositImpl = address(uint160(uint256(vm.load(depositManagerProxy, implementationSlot))));
        require(currentDepositImpl == newDepositManagerImpl, "DepositManager upgrade verification failed");
        BridgeDepositManager depositManager = BridgeDepositManager(payable(depositManagerProxy));
        require(depositManager.owner() == deployer, "DepositManager owner verification failed after upgrade");
        console.log("[SUCCESS] DepositManager upgrade verified");
    }

    function _verifyContractOnExplorer() internal view {
        if (bytes(etherscanApiKey).length == 0) {
            console.log("[WARNING] ETHERSCAN_API_KEY not set, skipping verification");
            return;
        }

        console.log("[INFO] Starting contract verification...");
        console.log("[INFO] The following new implementation will be verified:");
        console.log("  - DepositManager implementation:", newDepositManagerImpl);

        console.log("[INFO] Use --verify flag with forge script for automatic verification");
        console.log("[INFO] Or verify manually using foundry verify-contract command");
    }

    function _printUpgradeSummary() internal view {
        console.log("\n[UPGRADE SUMMARY]");
        console.log("========================");
        console.log("PROXY ADDRESS (unchanged):");
        console.log("DepositManager proxy:", depositManagerProxy);
        console.log("");
        console.log("NEW IMPLEMENTATION ADDRESS:");
        console.log("DepositManager implementation:", newDepositManagerImpl);
        console.log("");
        console.log("Deployer (Owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("========================");

        console.log("\n[IMPORTANT NOTES]");
        console.log("1. Proxy address remains the same - use this for interactions");
        console.log("2. Implementation address has changed - save for future reference");
        console.log("3. All state and functionality should be preserved");
        console.log("4. Test thoroughly before relying on upgraded contract");

        console.log("\n[NEXT STEPS]");
        console.log("1. Test BridgeDepositManager functionality");
        console.log("2. Update any off-chain systems with new implementation address");
        console.log("3. Monitor contract for any issues");
        console.log("4. Consider announcing the upgrade to users");

        if (shouldVerify) {
            console.log("\n[VERIFICATION COMMANDS]");
            console.log("New implementation will be verified automatically with --verify flag");
            console.log("Manual verification command:");
            console.log(
                "  forge verify-contract", newDepositManagerImpl, "src/BridgeDepositManager.sol:BridgeDepositManager"
            );
        }
    }
}



================================================
FILE: script/upgrade/UpgradeBridgeProofManager.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "../../src/BridgeProofManager.sol";

contract UpgradeBridgeProofManagerScript is Script {
    // Existing proxy address (to be set via environment variables)
    address public proofManagerProxy;

    // New implementation address (will be deployed)
    address public newProofManagerImpl;

    // Environment variables
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load existing proxy address
        proofManagerProxy = vm.envAddress("ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS");

        // Load deployer (must be owner of contract)
        deployer = vm.envAddress("DEPLOYER_ADDRESS");

        // Load verification settings
        shouldVerify = vm.envBool("VERIFY_CONTRACTS");
        etherscanApiKey = vm.envString("ETHERSCAN_API_KEY");
        chainId = vm.envString("CHAIN_ID");

        console.log("Upgrade Configuration:");
        console.log("Proof Manager proxy:", proofManagerProxy);
        console.log("Deployer (must be owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("Verify Contract:", shouldVerify);
    }

    function run() public {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");

        vm.startBroadcast(deployerPrivateKey);

        console.log("\n[START] Starting BridgeProofManager upgrade...");

        // Verify current ownership
        _verifyOwnership();

        _upgradeContract();

        // Verify upgrade
        console.log("\n[VERIFY] Verifying upgrade...");
        _verifyUpgrade();

        vm.stopBroadcast();

        // Verify contract on block explorer (if enabled)
        if (shouldVerify) {
            console.log("\n[VERIFY EXPLORER] Verifying new implementation on block explorer...");
            _verifyContractOnExplorer();
        }

        console.log("\n[COMPLETE] BridgeProofManager upgrade completed successfully!");
        _printUpgradeSummary();
    }

    function _verifyOwnership() internal view {
        console.log("\n[OWNERSHIP] Verifying contract ownership...");

        BridgeProofManager proofManager = BridgeProofManager(payable(proofManagerProxy));
        address proofOwner = proofManager.owner();
        require(proofOwner == deployer, "Deployer is not owner of ProofManager");
        console.log("[SUCCESS] Deployer is owner of ProofManager");
    }

    function _upgradeContract() internal {
        console.log("\n[UPGRADE] Upgrading BridgeProofManager...");

        // Deploy new implementation
        _deployNewImplementation();

        // Perform upgrade
        _performUpgrade();

        console.log("[SUCCESS] BridgeProofManager upgraded successfully");
    }

    function _deployNewImplementation() internal {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Deploy new BridgeProofManager implementation
        console.log("Deploying new BridgeProofManager implementation...");
        BridgeProofManager newProofManagerContract = new BridgeProofManager();
        newProofManagerImpl = address(newProofManagerContract);
        address currentProofImpl = address(uint160(uint256(vm.load(proofManagerProxy, implementationSlot))));
        console.log("Current ProofManager implementation:", currentProofImpl);
        console.log("New ProofManager implementation:", newProofManagerImpl);
        require(currentProofImpl != newProofManagerImpl, "ProofManager implementation addresses are the same");
    }

    function _performUpgrade() internal {
        // Upgrade BridgeProofManager
        console.log("Upgrading BridgeProofManager...");
        BridgeProofManager proofManager = BridgeProofManager(payable(proofManagerProxy));
        proofManager.upgradeTo(newProofManagerImpl);
        console.log("[SUCCESS] BridgeProofManager upgraded");
    }

    function _verifyUpgrade() internal view {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Verify BridgeProofManager upgrade
        address currentProofImpl = address(uint160(uint256(vm.load(proofManagerProxy, implementationSlot))));
        require(currentProofImpl == newProofManagerImpl, "ProofManager upgrade verification failed");
        BridgeProofManager proofManager = BridgeProofManager(payable(proofManagerProxy));
        require(proofManager.owner() == deployer, "ProofManager owner verification failed after upgrade");
        console.log("[SUCCESS] ProofManager upgrade verified");
    }

    function _verifyContractOnExplorer() internal {
        if (bytes(etherscanApiKey).length == 0) {
            console.log("[WARNING] ETHERSCAN_API_KEY not set, skipping verification");
            return;
        }

        console.log("[INFO] Contract verification will be performed by the shell script...");
        console.log("[INFO] The following new implementation will be verified:");
        console.log("  - ProofManager implementation:", newProofManagerImpl);

        // Create a file to store the implementation address for the shell script to use
        string memory addressFile = string.concat("./upgrade_addresses_", vm.toString(block.timestamp), ".txt");
        vm.writeFile(addressFile, string.concat("BRIDGE_PROOF_MANAGER_IMPL=", vm.toString(newProofManagerImpl), "\n"));
        console.log("[INFO] Implementation address saved to:", addressFile);
    }

    function _printUpgradeSummary() internal view {
        console.log("\n[UPGRADE SUMMARY]");
        console.log("========================");
        console.log("PROXY ADDRESS (unchanged):");
        console.log("ProofManager proxy:", proofManagerProxy);
        console.log("");
        console.log("NEW IMPLEMENTATION ADDRESS:");
        console.log("ProofManager implementation:", newProofManagerImpl);
        console.log("");
        console.log("Deployer (Owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("========================");

        console.log("\n[IMPORTANT NOTES]");
        console.log("1. Proxy address remains the same - use this for interactions");
        console.log("2. Implementation address has changed - save for future reference");
        console.log("3. All state and functionality should be preserved");
        console.log("4. Test thoroughly before relying on upgraded contract");

        console.log("\n[NEXT STEPS]");
        console.log("1. Test BridgeProofManager functionality");
        console.log("2. Update any off-chain systems with new implementation address");
        console.log("3. Monitor contract for any issues");
        console.log("4. Consider announcing the upgrade to users");

        if (shouldVerify) {
            console.log("\n[VERIFICATION COMMANDS]");
            console.log("New implementation will be verified automatically with --verify flag");
            console.log("Manual verification command:");
            console.log("  forge verify-contract", newProofManagerImpl, "src/BridgeProofManager.sol:BridgeProofManager");
        }
    }
}



================================================
FILE: script/upgrade/UpgradeBridgeWithdrawManager.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/BridgeWithdrawManager.sol";

contract UpgradeBridgeWithdrawManagerScript is Script {
    function run() external {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");
        address payable proxyAddress = payable(vm.envAddress("ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS"));

        vm.startBroadcast(deployerPrivateKey);

        address deployer = vm.addr(deployerPrivateKey);
        console.log("Upgrading with account:", deployer);
        console.log("Account balance:", deployer.balance);
        console.log("Target proxy address:", proxyAddress);

        // Deploy new BridgeWithdrawManager implementation
        console.log("Deploying new BridgeWithdrawManager implementation...");
        BridgeWithdrawManager newImplementation = new BridgeWithdrawManager();
        address newImplAddress = address(newImplementation);
        console.log("New BridgeWithdrawManager implementation deployed at:", newImplAddress);

        // Get the proxy contract and upgrade it
        BridgeWithdrawManager proxy = BridgeWithdrawManager(proxyAddress);

        // Check current implementation before upgrade
        console.log("Current implementation address:", _getImplementationAddress(proxyAddress));

        // Perform the upgrade
        console.log("Upgrading proxy to new implementation...");
        proxy.upgradeTo(newImplAddress);

        // Verify the upgrade
        address currentImpl = _getImplementationAddress(proxyAddress);
        console.log("New implementation address:", currentImpl);

        require(currentImpl == newImplAddress, "Upgrade failed: implementation address mismatch");
        console.log("Upgrade successful!");

        vm.stopBroadcast();

        console.log("\n=== UPGRADE COMPLETE ===");
        console.log("BridgeWithdrawManager proxy:", proxyAddress);
        console.log("New implementation:", newImplAddress);
        console.log("Deployer:", deployer);
    }

    // Helper function to get implementation address from proxy
    function _getImplementationAddress(address proxy) internal view returns (address) {
        // ERC1967 implementation slot
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        return address(uint160(uint256(vm.load(proxy, slot))));
    }
}



================================================
FILE: script/upgrade/UpgradeContracts.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeWithdrawManager.sol";
import "../../src/BridgeAdminManager.sol";

contract UpgradeContractsScript is Script {
    // Existing proxy addresses (to be set via environment variables)
    address public bridgeCoreProxy;
    address public depositManagerProxy;
    address public proofManagerProxy;
    address public withdrawManagerProxy;
    address public adminManagerProxy;

    // New implementation addresses (will be deployed)
    address public newBridgeCoreImpl;
    address public newDepositManagerImpl;
    address public newProofManagerImpl;
    address public newWithdrawManagerImpl;
    address public newAdminManagerImpl;

    // Environment variables
    address public deployer;

    // Verification settings
    bool public shouldVerify;
    string public etherscanApiKey;
    string public chainId;

    function setUp() public {
        // Load existing proxy addresses
        bridgeCoreProxy = vm.envAddress("ROLLUP_BRIDGE_CORE_PROXY_ADDRESS");
        depositManagerProxy = vm.envAddress("ROLLUP_BRIDGE_DEPOSIT_MANAGER_PROXY_ADDRESS");
        proofManagerProxy = vm.envAddress("ROLLUP_BRIDGE_PROOF_MANAGER_PROXY_ADDRESS");
        withdrawManagerProxy = vm.envAddress("ROLLUP_BRIDGE_WITHDRAW_MANAGER_PROXY_ADDRESS");
        adminManagerProxy = vm.envAddress("ROLLUP_BRIDGE_ADMIN_MANAGER_PROXY_ADDRESS");

        // Load deployer (must be owner of contracts)
        deployer = vm.envAddress("DEPLOYER_ADDRESS");

        // Load verification settings
        shouldVerify = vm.envBool("VERIFY_CONTRACTS");
        etherscanApiKey = vm.envString("ETHERSCAN_API_KEY");
        chainId = vm.envString("CHAIN_ID");

        console.log("Upgrade Configuration:");
        console.log("Bridge Core proxy:", bridgeCoreProxy);
        console.log("Deposit Manager proxy:", depositManagerProxy);
        console.log("Proof Manager proxy:", proofManagerProxy);
        console.log("Withdraw Manager proxy:", withdrawManagerProxy);
        console.log("Admin Manager proxy:", adminManagerProxy);
        console.log("Deployer (must be owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("Verify Contracts:", shouldVerify);
    }

    function run() public {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");

        vm.startBroadcast(deployerPrivateKey);

        console.log("\n[START] Starting Bridge Contracts upgrade...");

        // Verify current ownership
        _verifyOwnership();

        _upgradeContracts();

        // Verify upgrades
        console.log("\n[VERIFY] Verifying upgrades...");
        _verifyUpgrades();

        vm.stopBroadcast();

        // Verify contracts on block explorer (if enabled)
        if (shouldVerify) {
            console.log("\n[VERIFY EXPLORER] Verifying new implementations on block explorer...");
            _verifyContractsOnExplorer();
        }

        console.log("\n[COMPLETE] Bridge Contracts upgrade completed successfully!");
        _printUpgradeSummary();
    }

    function _verifyOwnership() internal view {
        console.log("\n[OWNERSHIP] Verifying contract ownership...");

        BridgeCore bridgeCore = BridgeCore(payable(bridgeCoreProxy));
        address coreOwner = bridgeCore.owner();
        require(coreOwner == deployer, "Deployer is not owner of BridgeCore");
        console.log("[SUCCESS] Deployer is owner of BridgeCore");

        BridgeDepositManager depositManager = BridgeDepositManager(payable(depositManagerProxy));
        address depositOwner = depositManager.owner();
        require(depositOwner == deployer, "Deployer is not owner of DepositManager");
        console.log("[SUCCESS] Deployer is owner of DepositManager");

        BridgeProofManager proofManager = BridgeProofManager(payable(proofManagerProxy));
        address proofOwner = proofManager.owner();
        require(proofOwner == deployer, "Deployer is not owner of ProofManager");
        console.log("[SUCCESS] Deployer is owner of ProofManager");

        BridgeWithdrawManager withdrawManager = BridgeWithdrawManager(payable(withdrawManagerProxy));
        address withdrawOwner = withdrawManager.owner();
        require(withdrawOwner == deployer, "Deployer is not owner of WithdrawManager");
        console.log("[SUCCESS] Deployer is owner of WithdrawManager");

        BridgeAdminManager adminManager = BridgeAdminManager(payable(adminManagerProxy));
        address adminOwner = adminManager.owner();
        require(adminOwner == deployer, "Deployer is not owner of AdminManager");
        console.log("[SUCCESS] Deployer is owner of AdminManager");
    }

    function _upgradeContracts() internal {
        console.log("\n[UPGRADE] Upgrading Bridge Contracts...");

        // Deploy all new implementations
        _deployNewImplementations();

        // Perform upgrades
        _performUpgrades();

        console.log("[SUCCESS] All bridge contracts upgraded successfully");
    }

    function _deployNewImplementations() internal {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Deploy new BridgeCore implementation
        console.log("Deploying new BridgeCore implementation...");
        BridgeCore newBridgeCoreContract = new BridgeCore();
        newBridgeCoreImpl = address(newBridgeCoreContract);
        address currentCoreImpl = address(uint160(uint256(vm.load(bridgeCoreProxy, implementationSlot))));
        console.log("Current BridgeCore implementation:", currentCoreImpl);
        console.log("New BridgeCore implementation:", newBridgeCoreImpl);
        require(currentCoreImpl != newBridgeCoreImpl, "BridgeCore implementation addresses are the same");

        // Deploy new BridgeDepositManager implementation
        console.log("Deploying new BridgeDepositManager implementation...");
        BridgeDepositManager newDepositManagerContract = new BridgeDepositManager();
        newDepositManagerImpl = address(newDepositManagerContract);
        address currentDepositImpl = address(uint160(uint256(vm.load(depositManagerProxy, implementationSlot))));
        console.log("Current DepositManager implementation:", currentDepositImpl);
        console.log("New DepositManager implementation:", newDepositManagerImpl);
        require(currentDepositImpl != newDepositManagerImpl, "DepositManager implementation addresses are the same");

        // Deploy new BridgeProofManager implementation
        console.log("Deploying new BridgeProofManager implementation...");
        BridgeProofManager newProofManagerContract = new BridgeProofManager();
        newProofManagerImpl = address(newProofManagerContract);
        address currentProofImpl = address(uint160(uint256(vm.load(proofManagerProxy, implementationSlot))));
        console.log("Current ProofManager implementation:", currentProofImpl);
        console.log("New ProofManager implementation:", newProofManagerImpl);
        require(currentProofImpl != newProofManagerImpl, "ProofManager implementation addresses are the same");

        // Deploy new BridgeWithdrawManager implementation
        console.log("Deploying new BridgeWithdrawManager implementation...");
        BridgeWithdrawManager newWithdrawManagerContract = new BridgeWithdrawManager();
        newWithdrawManagerImpl = address(newWithdrawManagerContract);
        address currentWithdrawImpl = address(uint160(uint256(vm.load(withdrawManagerProxy, implementationSlot))));
        console.log("Current WithdrawManager implementation:", currentWithdrawImpl);
        console.log("New WithdrawManager implementation:", newWithdrawManagerImpl);
        require(currentWithdrawImpl != newWithdrawManagerImpl, "WithdrawManager implementation addresses are the same");

        // Deploy new BridgeAdminManager implementation
        console.log("Deploying new BridgeAdminManager implementation...");
        BridgeAdminManager newAdminManagerContract = new BridgeAdminManager();
        newAdminManagerImpl = address(newAdminManagerContract);
        address currentAdminImpl = address(uint160(uint256(vm.load(adminManagerProxy, implementationSlot))));
        console.log("Current AdminManager implementation:", currentAdminImpl);
        console.log("New AdminManager implementation:", newAdminManagerImpl);
        require(currentAdminImpl != newAdminManagerImpl, "AdminManager implementation addresses are the same");
    }

    function _performUpgrades() internal {
        // Upgrade BridgeCore
        console.log("Upgrading BridgeCore...");
        BridgeCore bridgeCore = BridgeCore(payable(bridgeCoreProxy));
        bridgeCore.upgradeTo(newBridgeCoreImpl);
        console.log("[SUCCESS] BridgeCore upgraded");

        // Upgrade BridgeDepositManager
        console.log("Upgrading BridgeDepositManager...");
        BridgeDepositManager depositManager = BridgeDepositManager(payable(depositManagerProxy));
        depositManager.upgradeTo(newDepositManagerImpl);
        console.log("[SUCCESS] BridgeDepositManager upgraded");

        // Upgrade BridgeProofManager
        console.log("Upgrading BridgeProofManager...");
        BridgeProofManager proofManager = BridgeProofManager(payable(proofManagerProxy));
        proofManager.upgradeTo(newProofManagerImpl);
        console.log("[SUCCESS] BridgeProofManager upgraded");

        // Upgrade BridgeWithdrawManager
        console.log("Upgrading BridgeWithdrawManager...");
        BridgeWithdrawManager withdrawManager = BridgeWithdrawManager(payable(withdrawManagerProxy));
        withdrawManager.upgradeTo(newWithdrawManagerImpl);
        console.log("[SUCCESS] BridgeWithdrawManager upgraded");

        // Upgrade BridgeAdminManager
        console.log("Upgrading BridgeAdminManager...");
        BridgeAdminManager adminManager = BridgeAdminManager(payable(adminManagerProxy));
        adminManager.upgradeTo(newAdminManagerImpl);
        console.log("[SUCCESS] BridgeAdminManager upgraded");
    }

    function _verifyUpgrades() internal view {
        bytes32 implementationSlot = bytes32(uint256(keccak256("eip1967.proxy.implementation")) - 1);

        // Verify BridgeCore upgrade
        address currentCoreImpl = address(uint160(uint256(vm.load(bridgeCoreProxy, implementationSlot))));
        require(currentCoreImpl == newBridgeCoreImpl, "BridgeCore upgrade verification failed");
        BridgeCore bridgeCore = BridgeCore(payable(bridgeCoreProxy));
        require(bridgeCore.owner() == deployer, "BridgeCore owner verification failed after upgrade");
        console.log("[SUCCESS] BridgeCore upgrade verified");

        // Verify BridgeDepositManager upgrade
        address currentDepositImpl = address(uint160(uint256(vm.load(depositManagerProxy, implementationSlot))));
        require(currentDepositImpl == newDepositManagerImpl, "DepositManager upgrade verification failed");
        BridgeDepositManager depositManager = BridgeDepositManager(payable(depositManagerProxy));
        require(depositManager.owner() == deployer, "DepositManager owner verification failed after upgrade");
        console.log("[SUCCESS] DepositManager upgrade verified");

        // Verify BridgeProofManager upgrade
        address currentProofImpl = address(uint160(uint256(vm.load(proofManagerProxy, implementationSlot))));
        require(currentProofImpl == newProofManagerImpl, "ProofManager upgrade verification failed");
        BridgeProofManager proofManager = BridgeProofManager(payable(proofManagerProxy));
        require(proofManager.owner() == deployer, "ProofManager owner verification failed after upgrade");
        console.log("[SUCCESS] ProofManager upgrade verified");

        // Verify BridgeWithdrawManager upgrade
        address currentWithdrawImpl = address(uint160(uint256(vm.load(withdrawManagerProxy, implementationSlot))));
        require(currentWithdrawImpl == newWithdrawManagerImpl, "WithdrawManager upgrade verification failed");
        BridgeWithdrawManager withdrawManager = BridgeWithdrawManager(payable(withdrawManagerProxy));
        require(withdrawManager.owner() == deployer, "WithdrawManager owner verification failed after upgrade");
        console.log("[SUCCESS] WithdrawManager upgrade verified");

        // Verify BridgeAdminManager upgrade
        address currentAdminImpl = address(uint160(uint256(vm.load(adminManagerProxy, implementationSlot))));
        require(currentAdminImpl == newAdminManagerImpl, "AdminManager upgrade verification failed");
        BridgeAdminManager adminManager = BridgeAdminManager(payable(adminManagerProxy));
        require(adminManager.owner() == deployer, "AdminManager owner verification failed after upgrade");
        console.log("[SUCCESS] AdminManager upgrade verified");

        console.log("[SUCCESS] All bridge contract upgrades verified");
    }

    function _verifyContractsOnExplorer() internal view {
        if (bytes(etherscanApiKey).length == 0) {
            console.log("[WARNING] ETHERSCAN_API_KEY not set, skipping verification");
            return;
        }

        console.log("[INFO] Starting contract verification...");
        console.log("[INFO] The following new implementations will be verified:");
        console.log("  - BridgeCore implementation:", newBridgeCoreImpl);
        console.log("  - DepositManager implementation:", newDepositManagerImpl);
        console.log("  - ProofManager implementation:", newProofManagerImpl);
        console.log("  - WithdrawManager implementation:", newWithdrawManagerImpl);
        console.log("  - AdminManager implementation:", newAdminManagerImpl);

        console.log("[INFO] Use --verify flag with forge script for automatic verification");
        console.log("[INFO] Or verify manually using foundry verify-contract command");
    }

    function _printUpgradeSummary() internal view {
        console.log("\n[UPGRADE SUMMARY]");
        console.log("========================");
        console.log("PROXY ADDRESSES (unchanged):");
        console.log("BridgeCore proxy:", bridgeCoreProxy);
        console.log("DepositManager proxy:", depositManagerProxy);
        console.log("ProofManager proxy:", proofManagerProxy);
        console.log("WithdrawManager proxy:", withdrawManagerProxy);
        console.log("AdminManager proxy:", adminManagerProxy);
        console.log("");
        console.log("NEW IMPLEMENTATION ADDRESSES:");
        console.log("BridgeCore implementation:", newBridgeCoreImpl);
        console.log("DepositManager implementation:", newDepositManagerImpl);
        console.log("ProofManager implementation:", newProofManagerImpl);
        console.log("WithdrawManager implementation:", newWithdrawManagerImpl);
        console.log("AdminManager implementation:", newAdminManagerImpl);
        console.log("");
        console.log("Deployer (Owner):", deployer);
        console.log("Chain ID:", chainId);
        console.log("========================");

        console.log("\n[IMPORTANT NOTES]");
        console.log("1. Proxy addresses remain the same - use these for interactions");
        console.log("2. Implementation addresses have changed - save for future reference");
        console.log("3. All state and functionality should be preserved");
        console.log("4. Test thoroughly before relying on upgraded contracts");
        console.log("5. All 5 bridge contracts have been upgraded simultaneously");

        console.log("\n[NEXT STEPS]");
        console.log("1. Test all contract functionality across all managers");
        console.log("2. Update any off-chain systems with new implementation addresses");
        console.log("3. Monitor contracts for any issues");
        console.log("4. Consider announcing the upgrade to users");

        if (shouldVerify) {
            console.log("\n[VERIFICATION COMMANDS]");
            console.log("New implementations will be verified automatically with --verify flag");
            console.log("Manual verification commands:");
            console.log("  forge verify-contract", newBridgeCoreImpl, "src/BridgeCore.sol:BridgeCore");
            console.log(
                "  forge verify-contract", newDepositManagerImpl, "src/BridgeDepositManager.sol:BridgeDepositManager"
            );
            console.log("  forge verify-contract", newProofManagerImpl, "src/BridgeProofManager.sol:BridgeProofManager");
            console.log(
                "  forge verify-contract", newWithdrawManagerImpl, "src/BridgeWithdrawManager.sol:BridgeWithdrawManager"
            );
            console.log("  forge verify-contract", newAdminManagerImpl, "src/BridgeAdminManager.sol:BridgeAdminManager");
        }
    }
}



================================================
FILE: script/upgrade/UpgradeTokamakVerifier.s.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.29;

import "forge-std/Script.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/verifier/TokamakVerifier.sol";

contract UpgradeTokamakVerifierScript is Script {
    function run() external {
        uint256 deployerPrivateKey = vm.envUint("PRIVATE_KEY");
        address proxyAddress = vm.envAddress("TOKAMAK_VERIFIER_PROXY_ADDRESS");

        vm.startBroadcast(deployerPrivateKey);

        address deployer = vm.addr(deployerPrivateKey);
        console.log("Upgrading with account:", deployer);
        console.log("Account balance:", deployer.balance);
        console.log("Target proxy address:", proxyAddress);

        // Deploy new TokamakVerifier implementation
        console.log("Deploying new TokamakVerifier implementation...");
        TokamakVerifier newImplementation = new TokamakVerifier();
        address newImplAddress = address(newImplementation);
        console.log("New TokamakVerifier implementation deployed at:", newImplAddress);

        // Note: TokamakVerifier is not upgradeable, this script just deploys a new instance
        console.log("Note: TokamakVerifier is not upgradeable");

        console.log("New TokamakVerifier deployed successfully!");

        vm.stopBroadcast();

        console.log("\n=== UPGRADE COMPLETE ===");
        console.log("TokamakVerifier proxy:", proxyAddress);
        console.log("New implementation:", newImplAddress);
        console.log("Deployer:", deployer);
    }

    // Helper function to get implementation address from proxy
    function _getImplementationAddress(address proxy) internal view returns (address) {
        // ERC1967 implementation slot
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        return address(uint160(uint256(vm.load(proxy, slot))));
    }
}



================================================
FILE: src/BridgeAdminManager.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "lib/openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/UUPSUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/Initializable.sol";
import {ITokamakVerifier} from "./interface/ITokamakVerifier.sol";
import "./interface/IGroth16Verifier16Leaves.sol";
import "./interface/IBridgeCore.sol";

contract BridgeAdminManager is Initializable, OwnableUpgradeable, UUPSUpgradeable {
    /// @custom:oz-upgrades-unsafe-allow constructor
    constructor() {
        _disableInitializers();
    }

    IBridgeCore public bridge;

    event VerifierUpdated(address indexed oldVerifier, address indexed newVerifier);
    event TargetContractAllowed(address indexed targetContract, bool allowed);
    event FunctionRegistered(
        bytes32 indexed functionSignature,
        uint256 preprocessedPart1Length,
        uint256 preprocessedPart2Length,
        bytes32 instancesHash
    );
    event FunctionUnregistered(bytes32 indexed functionSignature);
    event TreasuryAddressUpdated(address indexed oldTreasury, address indexed newTreasury);

    modifier onlyBridge() {
        require(msg.sender == address(bridge), "Only bridge can call");
        _;
    }

    function initialize(address _bridgeCore, address _owner) public initializer {
        __Ownable_init_unchained();
        __UUPSUpgradeable_init();
        _transferOwnership(_owner);

        require(_bridgeCore != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_bridgeCore);
    }

    function setAllowedTargetContract(
        address targetContract,
        IBridgeCore.PreAllocatedLeaf[] memory storageSlots,
        IBridgeCore.UserStorageSlot[] memory userStorageSlots,
        bool allowed
    ) external onlyOwner {
        require(targetContract != address(0), "Invalid target contract address");

        bridge.setAllowedTargetContract(targetContract, storageSlots, userStorageSlots, allowed);
        emit TargetContractAllowed(targetContract, allowed);
    }

    function registerFunction(
        address targetContract,
        bytes32 functionSignature,
        uint128[] memory preprocessedPart1,
        uint256[] memory preprocessedPart2,
        bytes32 instancesHash
    ) external onlyOwner {
        require(targetContract != address(0), "Invalid target contract address");
        require(functionSignature != bytes32(0), "Invalid function signature");
        require(preprocessedPart1.length > 0, "preprocessedPart1 cannot be empty");
        require(preprocessedPart2.length > 0, "preprocessedPart2 cannot be empty");

        bridge.registerFunction(targetContract, functionSignature, preprocessedPart1, preprocessedPart2, instancesHash);
        emit FunctionRegistered(functionSignature, preprocessedPart1.length, preprocessedPart2.length, instancesHash);
    }

    function unregisterFunction(address targetContract, bytes32 functionSignature) external onlyOwner {
        require(targetContract != address(0), "Invalid target contract address");
        require(functionSignature != bytes32(0), "Invalid function signature");

        // Get target contract data and check if function exists
        IBridgeCore.TargetContract memory targetData = bridge.getTargetContractData(targetContract);
        bool found = false;
        for (uint256 i = 0; i < targetData.registeredFunctions.length; i++) {
            if (targetData.registeredFunctions[i].functionSignature == functionSignature) {
                found = true;
                break;
            }
        }
        require(found, "Function not registered");

        bridge.unregisterFunction(targetContract, functionSignature);
        emit FunctionUnregistered(functionSignature);
    }

    function getRegisteredFunction(address targetContract, bytes32 functionSignature)
        external
        view
        returns (IBridgeCore.RegisteredFunction memory)
    {
        IBridgeCore.TargetContract memory targetData = bridge.getTargetContractData(targetContract);
        for (uint256 i = 0; i < targetData.registeredFunctions.length; i++) {
            if (targetData.registeredFunctions[i].functionSignature == functionSignature) {
                return targetData.registeredFunctions[i];
            }
        }
        revert("Function not registered");
    }

    function getTargetContractData(address targetContract) external view returns (IBridgeCore.TargetContract memory) {
        return bridge.getTargetContractData(targetContract);
    }

    function updateBridge(address _newBridge) external onlyOwner {
        require(_newBridge != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_newBridge);
    }

    // ========== PRE-ALLOCATED LEAVES MANAGEMENT ==========

    /**
     * @notice Set a pre-allocated leaf for a target contract
     * @param targetContract The target contract address
     * @param key The MPT key for the pre-allocated leaf
     * @param value The value for the pre-allocated leaf
     */
    function setPreAllocatedLeaf(address targetContract, bytes32 key, uint256 value) external onlyOwner {
        bridge.setPreAllocatedLeaf(targetContract, key, value);
    }

    /**
     * @notice Remove a pre-allocated leaf for a target contract
     * @param targetContract The target contract address
     * @param key The MPT key to remove
     */
    function removePreAllocatedLeaf(address targetContract, bytes32 key) external onlyOwner {
        bridge.removePreAllocatedLeaf(targetContract, key);
    }

    /**
     * @notice Setup TON transfer pre-allocated leaf (convenience function)
     * @dev Sets up the standard 0x07 slot with decimals value 18 for TON transfers
     * @param tonContractAddress The TON contract address
     */
    function setupTonTransferPreAllocatedLeaf(address tonContractAddress) external onlyOwner {
        // TON transfer uses slot 0x07 with decimals value 18
        bytes32 tonDecimalsSlot = bytes32(uint256(0x07));
        uint256 tonDecimalsValue = 18;

        bridge.setPreAllocatedLeaf(tonContractAddress, tonDecimalsSlot, tonDecimalsValue);
    }

    /**
     * @notice Get pre-allocated leaf information
     * @param targetContract The target contract address
     * @param key The key
     * @return value The value of the pre-allocated leaf
     * @return exists Whether the leaf exists
     */
    function getPreAllocatedLeaf(address targetContract, bytes32 key)
        external
        view
        returns (uint256 value, bool exists)
    {
        return bridge.getPreAllocatedLeaf(targetContract, key);
    }

    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}

    /**
     * @notice Returns the address of the current implementation contract
     * @dev Uses EIP-1967 standard storage slot for implementation address
     * @return implementation The address of the implementation contract
     */
    function getImplementation() external view returns (address implementation) {
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        assembly {
            implementation := sload(slot)
        }
    }

    uint256[47] private __gap;
}



================================================
FILE: src/BridgeCore.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "lib/openzeppelin-contracts-upgradeable/contracts/utils/cryptography/ECDSAUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/UUPSUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/security/ReentrancyGuardUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/Initializable.sol";

contract BridgeCore is ReentrancyGuardUpgradeable, OwnableUpgradeable, UUPSUpgradeable {
    using ECDSAUpgradeable for bytes32;

    enum ChannelState {
        None,
        Initialized,
        Open,
        Closing
    }

    struct ChannelParams {
        bytes32 channelId;
        address targetContract;
        address[] whitelisted;
        bool enableFrostSignature;
    }

    struct TargetContract {
        PreAllocatedLeaf[] preAllocatedLeaves;
        RegisteredFunction[] registeredFunctions;
        UserStorageSlot[] userStorageSlots;
    }

    struct UserStorageSlot {
        uint8 slotOffset;
        bytes32 getterFunctionSignature;
        bool isLoadedOnChain; // false = value from deposits (balance), true = fetch via staticcall
    }

    struct ValidatedUserStorage {
        address targetContract;
        mapping(uint8 => uint256) value; // Usage: value[SLOT_NUMBER]
        bool isLocked;
    }

    struct PreAllocatedLeaf {
        uint256 value;
        bytes32 key;
        bool isActive;
    }

    struct RegisteredFunction {
        bytes32 functionSignature;
        bytes32 instancesHash;
        uint128[] preprocessedPart1;
        uint256[] preprocessedPart2;
    }

    struct Channel {
        // Slot 0
        bytes32 id;
        // Slot 1-2: pack addresses and small values (20 + 20 + 1 + 1 + 1 + 1 = 44 bytes)
        address targetContract; // 20 bytes
        address leader; // 20 bytes
        ChannelState state; // 1 byte
        bool sigVerified; // 1 byte
        bool frostSignatureEnabled; // 1 byte

        // Slot 3: signer and counts (20 + 8 + 4 bytes = 32 bytes)
        address signerAddr; // 20 bytes
        uint64 requiredTreeSize; // 8 bytes (enough for tree size)
        uint32 preAllocatedLeavesCount; // 4 bytes (max 4.2B leaves)
        // Slot 4-5: timestamps (each 128 bits is enough until year 10^38)
        uint128 openTimestamp; // 16 bytes
        uint128 closeTimestamp; // 16 bytes
        uint128 _reserved; // 16 bytes for future use
        // Slots 6-7: state roots
        bytes32 initialStateRoot;
        bytes32 finalStateRoot;
        // Slot 8: block info
        bytes32 blockInfosHash;
        // Slots 9-10: public key
        uint256 pkx;
        uint256 pky;
        // Dynamic storage (mappings and arrays)
        mapping(address => bool) isWhiteListed;
        address[] participants;
        mapping(address => mapping(uint8 => uint256)) l2MptKey; // l2MptKey[participant][slotIndex]
    }

    uint256 public constant MIN_PARTICIPANTS = 1;
    uint256 public constant MAX_PARTICIPANTS = 128;
    uint256 public constant CHANNEL_TIMEOUT = 7 days;
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;

    /// @custom:storage-location erc7201:tokamak.storage.BridgeCore
    struct BridgeCoreStorage {
        mapping(bytes32 => Channel) channels;
        mapping(address => TargetContract) allowedTargetContracts;
        address depositManager;
        address proofManager;
        address withdrawManager;
        address adminManager;
        mapping(address => mapping(bytes32 => PreAllocatedLeaf)) preAllocatedLeaves;
        mapping(address => bytes32[]) targetContractPreAllocatedKeys;
        // Usage: validatedUserStorage[USER_ADDRESS][CHANNEL_ID]
        mapping(address => mapping(bytes32 => ValidatedUserStorage[])) validatedUserStorage;
    }

    bytes32 private constant BridgeCoreStorageLocation =
        0x1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a00;

    event ChannelOpened(bytes32 indexed channelId, address targetContract);
    event ChannelPublicKeySet(bytes32 indexed channelId, uint256 pkx, uint256 pky, address signerAddr);
    event PreAllocatedLeafSet(address indexed targetContract, bytes32 indexed mptKey, uint256 value);
    event PreAllocatedLeafRemoved(address indexed targetContract, bytes32 indexed mptKey);
    event ChannelDeleted(bytes32 indexed channelId, uint256 cleanupTime);

    modifier onlyManager() {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        require(
            msg.sender == $.depositManager || msg.sender == $.proofManager || msg.sender == $.withdrawManager
                || msg.sender == $.adminManager,
            "Only managers can call"
        );
        _;
    }

    /// @custom:oz-upgrades-unsafe-allow constructor
    constructor() {
        _disableInitializers();
    }

    function initialize(
        address _depositManager,
        address _proofManager,
        address _withdrawManager,
        address _adminManager,
        address _owner
    ) public initializer {
        __ReentrancyGuard_init();
        __Ownable_init_unchained();
        _transferOwnership(_owner);
        __UUPSUpgradeable_init();

        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.depositManager = _depositManager;
        $.proofManager = _proofManager;
        $.withdrawManager = _withdrawManager;
        $.adminManager = _adminManager;
    }

    // ========== EXTERNAL FUNCTIONS ==========

    function openChannel(ChannelParams calldata params) external returns (bytes32 channelId) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();

        require(params.channelId != bytes32(0), "Channel ID cannot be zero");
        require(params.targetContract != address(0), "Target contract cannot be zero address");
        require(_isTargetContractAllowed(params.targetContract), "Target contract not allowed");
        require($.channels[params.channelId].leader == address(0), "Channel ID already exists");

        channelId = params.channelId;

        // Get number of active pre-allocated leaves for this target contract
        uint256 preAllocatedCount = _getActivePreAllocatedCount(params.targetContract);
        uint256 numberOfUserStorageSlot = $.allowedTargetContracts[params.targetContract].userStorageSlots.length;

        // Calculate maximum allowed participants considering pre-allocated leaves and leader
        // Formula: (availableLeaves / slotsPerParticipant) - (1 * numberOfUserStorageSlot) for leader
        // Example: tree=16, preAlloc=4, slots=2 => ((16-4)/2)-1 = 5 whitelisted (6 total with leader)
        uint256 maxAllowedParticipants = ((MAX_PARTICIPANTS - preAllocatedCount) / numberOfUserStorageSlot) - (1 * numberOfUserStorageSlot);

        require(
            params.whitelisted.length >= MIN_PARTICIPANTS && params.whitelisted.length <= maxAllowedParticipants,
            "Invalid whitelisted count considering pre-allocated leaves"
        );

        // Include leader in tree size calculation (+1 for leader)
        uint256 requiredTreeSize = determineTreeSize(params.whitelisted.length + 1 + preAllocatedCount, 1);

        Channel storage channel = $.channels[channelId];

        channel.id = channelId;
        channel.targetContract = params.targetContract;
        channel.leader = msg.sender;
        channel.openTimestamp = uint128(block.timestamp);
        channel.state = ChannelState.Initialized;
        channel.requiredTreeSize = uint64(requiredTreeSize);
        channel.preAllocatedLeavesCount = uint32(preAllocatedCount);
        channel.frostSignatureEnabled = params.enableFrostSignature;

        // Automatically whitelist the channel leader
        channel.isWhiteListed[msg.sender] = true;

        uint256 whitelistedLength = params.whitelisted.length;
        for (uint256 i = 0; i < whitelistedLength;) {
            address whitelistedUser = params.whitelisted[i];

            channel.isWhiteListed[whitelistedUser] = true;
            unchecked {
                ++i;
            }
        }

        emit ChannelOpened(channelId, params.targetContract);
    }

    function setChannelPublicKey(bytes32 channelId, uint256 pkx, uint256 pky) external {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];

        require(channel.leader != address(0), "Channel does not exist");
        require(msg.sender == channel.leader, "Only channel leader can set public key");
        require(channel.frostSignatureEnabled, "frost is disabled");

        require(channel.state == ChannelState.Initialized, "Can only set public key for initialized channel");
        require(channel.pkx == 0 && channel.pky == 0, "Public key already set");

        channel.pkx = pkx;
        channel.pky = pky;
        address signerAddr = deriveAddressFromPubkey(pkx, pky);
        channel.signerAddr = signerAddr;

        emit ChannelPublicKeySet(channelId, pkx, pky, signerAddr);
    }

    // Manager setter functions
    function updateChannelUserDeposits(bytes32 channelId, address participant, uint8 slotIndex, uint256 amount) external onlyManager {
        require(amount < R_MOD, "Amount exceeds R_MOD");

        // Validate slotIndex has isLoadedOnChain == false (i.e., it's a balance slot)
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        address targetContract = $.channels[channelId].targetContract;
        require(slotIndex < $.allowedTargetContracts[targetContract].userStorageSlots.length, "Invalid slot index");
        require(!$.allowedTargetContracts[targetContract].userStorageSlots[slotIndex].isLoadedOnChain, "Slot must be off-chain");

        ValidatedUserStorage storage entry = _getOrCreateValidatedUserStorage(participant, channelId);
        entry.value[slotIndex] += amount;
    }

    function setChannelL2MptKeys(bytes32 channelId, address participant, uint256[] calldata mptKeys) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];

        // Get expected number of slots from userStorageSlots
        uint256 expectedSlots = $.allowedTargetContracts[channel.targetContract].userStorageSlots.length;
        require(mptKeys.length == expectedSlots, "MPT keys count mismatch");

        // Validate and store each mptKey by slot index
        for (uint8 i = 0; i < mptKeys.length; i++) {
            require(mptKeys[i] < R_MOD, "MPT key exceeds R_MOD");
            channel.l2MptKey[participant][i] = mptKeys[i];
        }
    }

    function setChannelInitialStateRoot(bytes32 channelId, bytes32 stateRoot) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.channels[channelId].initialStateRoot = stateRoot;
    }

    function setChannelFinalStateRoot(bytes32 channelId, bytes32 stateRoot) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.channels[channelId].finalStateRoot = stateRoot;
    }

    function setChannelState(bytes32 channelId, ChannelState state) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.channels[channelId].state = state;
    }

    function setChannelValidatedUserStorage(bytes32 channelId, address[] memory participants, uint256[][] memory slotValues)
        external
        onlyManager
    {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        address targetContract = $.channels[channelId].targetContract;
        uint256 numSlots = $.allowedTargetContracts[targetContract].userStorageSlots.length;

        for (uint256 participantIdx = 0; participantIdx < participants.length; participantIdx++) {
            address participant = participants[participantIdx];
            require(slotValues[participantIdx].length == numSlots, "Slot values count mismatch");

            ValidatedUserStorage storage entry = _getOrCreateValidatedUserStorage(participant, channelId);
            for (uint8 slotIdx = 0; slotIdx < numSlots; slotIdx++) {
                entry.value[slotIdx] = slotValues[participantIdx][slotIdx];
            }
            entry.isLocked = false;
        }
    }

    function setChannelSignatureVerified(bytes32 channelId, bool verified) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.channels[channelId].sigVerified = verified;
    }

    function setAllowedTargetContract(
        address targetContract,
        PreAllocatedLeaf[] memory leaves,
        UserStorageSlot[] memory userStorageSlots,
        bool allowed
    ) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();

        if (allowed) {
            // Clear existing pre-allocated leaves
            delete $.allowedTargetContracts[targetContract].preAllocatedLeaves;

            // Add new pre-allocated leaves
            for (uint256 i = 0; i < leaves.length; i++) {
                $.allowedTargetContracts[targetContract].preAllocatedLeaves.push(leaves[i]);
            }

            // Clear existing user storage slots
            delete $.allowedTargetContracts[targetContract].userStorageSlots;

            // Add new user storage slots
            for (uint256 i = 0; i < userStorageSlots.length; i++) {
                $.allowedTargetContracts[targetContract].userStorageSlots.push(userStorageSlots[i]);
            }

            // If no pre-allocated leaves provided and no functions registered, add a dummy entry
            // to mark the contract as allowed
            if (leaves.length == 0 && $.allowedTargetContracts[targetContract].registeredFunctions.length == 0) {
                // Push a dummy inactive leaf to mark as allowed
                $.allowedTargetContracts[targetContract].preAllocatedLeaves.push(
                    PreAllocatedLeaf({value: 0, key: bytes32(0), isActive: false})
                );
            }
        } else {
            delete $.allowedTargetContracts[targetContract];
        }
    }

    function registerFunction(
        address targetContract,
        bytes32 functionSignature,
        uint128[] memory preprocessedPart1,
        uint256[] memory preprocessedPart2,
        bytes32 instancesHash
    ) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();

        require(_isTargetContractAllowed(targetContract), "Target contract not allowed");

        // Also add to target contract's registered functions
        TargetContract storage target = $.allowedTargetContracts[targetContract];

        // Check if function already exists for this target
        bool functionExists = false;
        for (uint256 i = 0; i < target.registeredFunctions.length; i++) {
            if (target.registeredFunctions[i].functionSignature == functionSignature) {
                // Update existing function
                target.registeredFunctions[i] = RegisteredFunction({
                    functionSignature: functionSignature,
                    instancesHash: instancesHash,
                    preprocessedPart1: preprocessedPart1,
                    preprocessedPart2: preprocessedPart2
                });
                functionExists = true;
                break;
            }
        }

        // If function doesn't exist, add it
        if (!functionExists) {
            target.registeredFunctions.push(
                RegisteredFunction({
                    functionSignature: functionSignature,
                    instancesHash: instancesHash,
                    preprocessedPart1: preprocessedPart1,
                    preprocessedPart2: preprocessedPart2
                })
            );
        }
    }

    function unregisterFunction(address targetContract, bytes32 functionSignature) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();

        require(_isTargetContractAllowed(targetContract), "Target contract not allowed");

        // Remove from target contract's registered functions
        TargetContract storage target = $.allowedTargetContracts[targetContract];
        uint256 functionsLength = target.registeredFunctions.length;

        for (uint256 i = 0; i < functionsLength; i++) {
            if (target.registeredFunctions[i].functionSignature == functionSignature) {
                // Move the last element to this position and pop
                if (i != functionsLength - 1) {
                    target.registeredFunctions[i] = target.registeredFunctions[functionsLength - 1];
                }
                target.registeredFunctions.pop();
                break;
            }
        }
    }

    function clearValidatedUserStorage(bytes32 channelId, address participant, address targetContract)
        external
        onlyManager
    {
        if (!_hasValidatedUserStorage(participant, channelId)) {
            return; // Nothing to clear
        }
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        uint256 numSlots = $.allowedTargetContracts[targetContract].userStorageSlots.length;

        ValidatedUserStorage storage entry = _getValidatedUserStorage(participant, channelId);
        for (uint8 slotIdx = 0; slotIdx < numSlots; slotIdx++) {
            entry.value[slotIdx] = 0;
        }
        entry.isLocked = false;
    }

    function setChannelCloseTimestamp(bytes32 channelId, uint256 timestamp) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.channels[channelId].closeTimestamp = uint128(timestamp);
    }

    function setChannelBlockInfosHash(bytes32 channelId, bytes32 blockInfosHash) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        $.channels[channelId].blockInfosHash = blockInfosHash;
    }

    function addParticipantOnDeposit(bytes32 channelId, address user) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];

        require(channel.isWhiteListed[user], "User not whitelisted");

        // Check if user is already in participants array
        for (uint256 i = 0; i < channel.participants.length; i++) {
            if (channel.participants[i] == user) {
                return; // User already in participants
            }
        }

        // Add user to participants array
        channel.participants.push(user);
    }

    function cleanupChannel(bytes32 channelId) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];

        require(channel.leader != address(0), "Channel does not exist");

        // Get participants and target contract before cleanup
        address[] memory participants = channel.participants;
        address targetContract = channel.targetContract;

        // Get number of user storage slots for this target contract (now includes balance)
        uint256 numSlots = $.allowedTargetContracts[targetContract].userStorageSlots.length;

        // Clean up mappings inside the channel struct
        // Note: Arrays are cleared by delete, but mappings must be manually cleared
        for (uint256 i = 0; i < participants.length; i++) {
            address participant = participants[i];
            delete channel.isWhiteListed[participant];
            // Clear each slot index in the nested mapping
            for (uint8 j = 0; j < numSlots; j++) {
                delete channel.l2MptKey[participant][j];
            }
        }

        // Now delete the channel struct
        delete $.channels[channelId];

        emit ChannelDeleted(channelId, block.timestamp);
    }

    // ========== PRE-ALLOCATED LEAVES MANAGEMENT ==========

    /**
     * @notice Set a pre-allocated leaf value for a target contract
     * @dev Only managers can call this function
     * @param targetContract The target contract address
     * @param key The MPT key for the pre-allocated leaf
     * @param value The value for the pre-allocated leaf
     */
    function setPreAllocatedLeaf(address targetContract, bytes32 key, uint256 value) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();

        require(_isTargetContractAllowed(targetContract), "Target contract not allowed");
        require(key != bytes32(0), "MPT key cannot be zero");

        PreAllocatedLeaf storage leaf = $.preAllocatedLeaves[targetContract][key];
        bool isNewLeaf = !leaf.isActive;

        // If this is a new pre-allocated leaf, add it to the keys array
        if (isNewLeaf) {
            $.targetContractPreAllocatedKeys[targetContract].push(key);
        }

        leaf.key = key;
        leaf.value = value;
        leaf.isActive = true;

        // Update the allowedTargetContracts preAllocatedLeaves array
        TargetContract storage targetContractData = $.allowedTargetContracts[targetContract];

        if (isNewLeaf) {
            // Add new leaf to preAllocatedLeaves array
            targetContractData.preAllocatedLeaves.push(PreAllocatedLeaf({key: key, value: value, isActive: true}));
        } else {
            // Update existing leaf in preAllocatedLeaves array
            for (uint256 i = 0; i < targetContractData.preAllocatedLeaves.length; i++) {
                if (targetContractData.preAllocatedLeaves[i].key == key) {
                    targetContractData.preAllocatedLeaves[i].value = value;
                    targetContractData.preAllocatedLeaves[i].isActive = true;
                    break;
                }
            }
        }

        emit PreAllocatedLeafSet(targetContract, key, value);
    }

    /**
     * @notice Remove a pre-allocated leaf for a target contract
     * @dev Only managers can call this function
     * @param targetContract The target contract address
     * @param key The MPT key to remove
     */
    function removePreAllocatedLeaf(address targetContract, bytes32 key) external onlyManager {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();

        PreAllocatedLeaf storage leaf = $.preAllocatedLeaves[targetContract][key];
        require(leaf.isActive, "Pre-allocated leaf does not exist");

        // Remove from the keys array
        bytes32[] storage keys = $.targetContractPreAllocatedKeys[targetContract];
        for (uint256 i = 0; i < keys.length; i++) {
            if (keys[i] == key) {
                keys[i] = keys[keys.length - 1];
                keys.pop();
                break;
            }
        }

        // Remove from the allowedTargetContracts preAllocatedLeaves array
        TargetContract storage targetContractData = $.allowedTargetContracts[targetContract];
        for (uint256 i = 0; i < targetContractData.preAllocatedLeaves.length; i++) {
            if (targetContractData.preAllocatedLeaves[i].key == key) {
                // Move the last element to this position and pop
                if (i != targetContractData.preAllocatedLeaves.length - 1) {
                    targetContractData.preAllocatedLeaves[i] =
                        targetContractData.preAllocatedLeaves[targetContractData.preAllocatedLeaves.length - 1];
                }
                targetContractData.preAllocatedLeaves.pop();
                break;
            }
        }

        // Remove the leaf
        delete $.preAllocatedLeaves[targetContract][key];

        emit PreAllocatedLeafRemoved(targetContract, key);
    }

    /**
     * @notice Get a pre-allocated leaf value
     * @param targetContract The target contract address
     * @param key The MPT key
     * @return value The value of the pre-allocated leaf
     * @return exists Whether the leaf exists
     */
    function getPreAllocatedLeaf(address targetContract, bytes32 key)
        external
        view
        returns (uint256 value, bool exists)
    {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        PreAllocatedLeaf storage leaf = $.preAllocatedLeaves[targetContract][key];
        return (leaf.value, leaf.isActive);
    }

    /**
     * @notice Get all pre-allocated leaves for a target contract
     * @param targetContract The target contract address
     * @return keys Array of pre-allocated keys
     */
    function getPreAllocatedKeys(address targetContract) external view returns (bytes32[] memory keys) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.targetContractPreAllocatedKeys[targetContract];
    }

    /**
     * @notice Get the number of pre-allocated leaves for a target contract
     * @param targetContract The target contract address
     * @return count Number of pre-allocated leaves
     */
    function getPreAllocatedLeavesCount(address targetContract) external view returns (uint256 count) {
        return _getActivePreAllocatedCount(targetContract);
    }

    /**
     * @notice Get the number of pre-allocated leaves for a specific channel
     * @param channelId The channel ID
     * @return count Number of pre-allocated leaves in the channel
     */
    function getChannelPreAllocatedLeavesCount(bytes32 channelId) external view returns (uint256 count) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].preAllocatedLeavesCount;
    }

    // ========== INTERNAL FUNCTIONS ==========

    function _getBridgeCoreStorage() internal pure returns (BridgeCoreStorage storage $) {
        assembly {
            $.slot := BridgeCoreStorageLocation
        }
    }

    function _isTargetContractAllowed(address targetContract) internal view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        TargetContract storage target = $.allowedTargetContracts[targetContract];
        // A target contract is allowed if it has pre-allocated leaves or registered functions
        // (including dummy inactive entries used just to mark as allowed)
        return target.preAllocatedLeaves.length > 0 || target.registeredFunctions.length > 0;
    }

    function _getActivePreAllocatedCount(address targetContract) internal view returns (uint256) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        uint256 count = 0;
        bytes32[] memory keys = $.targetContractPreAllocatedKeys[targetContract];
        for (uint256 i = 0; i < keys.length; i++) {
            if ($.preAllocatedLeaves[targetContract][keys[i]].isActive) {
                count++;
            }
        }
        return count;
    }

    /**
     * @dev Get or create ValidatedUserStorage entry for a channel
     * @param participant The user address
     * @param channelId The channel ID
     * @return storage pointer to the ValidatedUserStorage entry
     */
    function _getOrCreateValidatedUserStorage(
        address participant,
        bytes32 channelId
    ) internal returns (ValidatedUserStorage storage) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        ValidatedUserStorage[] storage entries = $.validatedUserStorage[participant][channelId];

        // Return existing entry if exists
        if (entries.length > 0) {
            return entries[0];
        }

        // Create new entry with channel's targetContract
        address targetContract = $.channels[channelId].targetContract;
        entries.push();
        ValidatedUserStorage storage newEntry = entries[0];
        newEntry.targetContract = targetContract;
        return newEntry;
    }

    /**
     * @dev Get ValidatedUserStorage entry for a channel (read-only)
     * @param participant The user address
     * @param channelId The channel ID
     * @return storage pointer to the ValidatedUserStorage entry (reverts if not found)
     */
    function _getValidatedUserStorage(
        address participant,
        bytes32 channelId
    ) internal view returns (ValidatedUserStorage storage) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        ValidatedUserStorage[] storage entries = $.validatedUserStorage[participant][channelId];

        require(entries.length > 0, "ValidatedUserStorage not found");
        return entries[0];
    }

    /**
     * @dev Check if ValidatedUserStorage entry exists for a channel
     */
    function _hasValidatedUserStorage(
        address participant,
        bytes32 channelId
    ) internal view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.validatedUserStorage[participant][channelId].length > 0;
    }

    /**
     * @dev Get the balance slot index for a target contract (the one with isLoadedOnChain == false)
     */
    function _getBalanceSlotIndex(address targetContract) internal view returns (uint8) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        UserStorageSlot[] storage slots = $.allowedTargetContracts[targetContract].userStorageSlots;
        for (uint8 i = 0; i < slots.length; i++) {
            if (!slots[i].isLoadedOnChain) {
                return i;
            }
        }
        revert("No balance slot found");
    }

    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}

    function deriveAddressFromPubkey(uint256 pkx, uint256 pky) internal pure returns (address) {
        bytes32 h = keccak256(abi.encodePacked(pkx, pky));
        return address(uint160(uint256(h)));
    }

    function determineTreeSize(uint256 participantCount, uint256 contractCount) internal pure returns (uint256) {
        uint256 totalLeaves = participantCount * contractCount;

        if (totalLeaves <= 16) {
            return 16;
        } else if (totalLeaves <= 32) {
            return 32;
        } else if (totalLeaves <= 64) {
            return 64;
        } else if (totalLeaves <= 128) {
            return 128;
        } else {
            revert("Too many participant-contract combinations");
        }
    }

    // ========== OWNER FUNCTIONS ==========

    function updateManagerAddresses(
        address _depositManager,
        address _proofManager,
        address _withdrawManager,
        address _adminManager
    ) external onlyOwner {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        if (_depositManager != address(0)) $.depositManager = _depositManager;
        if (_proofManager != address(0)) $.proofManager = _proofManager;
        if (_withdrawManager != address(0)) $.withdrawManager = _withdrawManager;
        if (_adminManager != address(0)) $.adminManager = _adminManager;
    }

    // ========== GETTER FUNCTIONS ==========

    function depositManager() external view returns (address) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.depositManager;
    }

    function withdrawManager() external view returns (address) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.withdrawManager;
    }

    function getChannelState(bytes32 channelId) external view returns (ChannelState) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].state;
    }
    function getChannelTargetContract(bytes32 channelId) external view returns (address) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].targetContract;
    }

    function getChannelLeader(bytes32 channelId) external view returns (address) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].leader;
    }

    function getChannelParticipants(bytes32 channelId) external view returns (address[] memory) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].participants;
    }

    function isChannelWhitelisted(bytes32 channelId, address addr) external view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].isWhiteListed[addr];
    }

    function getChannelTreeSize(bytes32 channelId) external view returns (uint256) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].requiredTreeSize;
    }

    function getL2MptKey(bytes32 channelId, address participant, uint8 slotIndex) external view returns (uint256) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].l2MptKey[participant][slotIndex];
    }

    function getChannelPublicKey(bytes32 channelId) external view returns (uint256 pkx, uint256 pky) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];
        return (channel.pkx, channel.pky);
    }

    function isChannelPublicKeySet(bytes32 channelId) external view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];
        return channel.pkx != 0 && channel.pky != 0;
    }

    function getChannelSignerAddr(bytes32 channelId) external view returns (address) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].signerAddr;
    }

    function getChannelFinalStateRoot(bytes32 channelId) external view returns (bytes32) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].finalStateRoot;
    }

    function getChannelInitialStateRoot(bytes32 channelId) external view returns (bytes32) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].initialStateRoot;
    }

    function isAllowedTargetContract(address targetContract) external view returns (bool) {
        return _isTargetContractAllowed(targetContract);
    }

    function getTargetContractData(address targetContract) external view returns (TargetContract memory) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        require(_isTargetContractAllowed(targetContract), "Target contract not allowed");
        return $.allowedTargetContracts[targetContract];
    }

    function getChannelInfo(bytes32 channelId)
        external
        view
        returns (address targetContract, ChannelState state, uint256 participantCount, bytes32 initialRoot)
    {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];
        return (channel.targetContract, channel.state, channel.participants.length, channel.initialStateRoot);
    }

    function isSignatureVerified(bytes32 channelId) external view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].sigVerified;
    }

    function getValidatedUserSlotValue(bytes32 channelId, address participant, uint8 slotIndex)
        external
        view
        returns (uint256)
    {
        if (!_hasValidatedUserStorage(participant, channelId)) {
            return 0;
        }
        ValidatedUserStorage storage entry = _getValidatedUserStorage(participant, channelId);
        return entry.value[slotIndex];
    }

    function hasUserWithdrawn(bytes32 channelId, address participant, address targetContract)
        external
        view
        returns (bool)
    {
        if (!_hasValidatedUserStorage(participant, channelId)) {
            return true; // No entry means nothing to withdraw
        }
        uint8 balanceSlotIndex = _getBalanceSlotIndex(targetContract);

        ValidatedUserStorage storage entry = _getValidatedUserStorage(participant, channelId);
        return entry.value[balanceSlotIndex] == 0;
    }

    function getBalanceSlotIndex(address targetContract) external view returns (uint8) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        UserStorageSlot[] storage slots = $.allowedTargetContracts[targetContract].userStorageSlots;
        for (uint8 i = 0; i < slots.length; i++) {
            if (!slots[i].isLoadedOnChain) {
                return i;
            }
        }
        revert("No balance slot found");
    }

    function getChannelBlockInfosHash(bytes32 channelId) external view returns (bytes32) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].blockInfosHash;
    }

    function isMarkedChannelLeader(address addr, bytes32 channelId) external view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].leader == addr;
    }

    function isFrostSignatureEnabled(bytes32 channelId) external view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        return $.channels[channelId].frostSignatureEnabled;
    }

    function isChannelTimedOut(bytes32 channelId) external view returns (bool) {
        BridgeCoreStorage storage $ = _getBridgeCoreStorage();
        Channel storage channel = $.channels[channelId];
        require(channel.leader != address(0), "Channel does not exist");
        return block.timestamp > channel.openTimestamp + CHANNEL_TIMEOUT;
    }

    /**
     * @notice Returns the address of the current implementation contract
     * @dev Uses EIP-1967 standard storage slot for implementation address
     * @return implementation The address of the implementation contract
     */
    function getImplementation() external view returns (address implementation) {
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        assembly {
            implementation := sload(slot)
        }
    }

    /**
     * @notice Generate a channel ID hash from leader address and salt
     * @dev This is a pure function that can be called off-chain to generate channel IDs
     * @param leader The channel leader address
     * @param salt Any salt value to ensure uniqueness
     * @return channelId The generated channel ID
     */
    function generateChannelId(address leader, bytes32 salt) external pure returns (bytes32 channelId) {
        return keccak256(abi.encodePacked(leader, salt));
    }

    uint256[42] private __gap;
}



================================================
FILE: src/BridgeDepositManager.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "lib/openzeppelin-contracts-upgradeable/contracts/token/ERC20/IERC20Upgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/token/ERC20/utils/SafeERC20Upgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/security/ReentrancyGuardUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/UUPSUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/Initializable.sol";
import "./interface/IBridgeCore.sol";

contract BridgeDepositManager is Initializable, ReentrancyGuardUpgradeable, OwnableUpgradeable, UUPSUpgradeable {
    /// @custom:oz-upgrades-unsafe-allow constructor
    constructor() {
        _disableInitializers();
    }

    using SafeERC20Upgradeable for IERC20Upgradeable;

    IBridgeCore public bridge;

    event Deposited(bytes32 indexed channelId, address indexed user, address token, uint256 amount);

    modifier onlyBridge() {
        require(msg.sender == address(bridge), "Only bridge can call");
        _;
    }

    function initialize(address _bridgeCore, address _owner) public initializer {
        __ReentrancyGuard_init();
        __Ownable_init_unchained();
        __UUPSUpgradeable_init();
        _transferOwnership(_owner);

        require(_bridgeCore != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_bridgeCore);
    }

    function depositToken(bytes32 _channelId, uint256 _amount, bytes32[] calldata _mptKeys) external nonReentrant {
        require(bridge.getChannelState(_channelId) == IBridgeCore.ChannelState.Initialized, "Invalid channel state");
        require(bridge.isChannelWhitelisted(_channelId, msg.sender), "Not whitelisted");

        // Only require public key to be set if frost signature is enabled
        bool frostEnabled = bridge.isFrostSignatureEnabled(_channelId);
        if (frostEnabled) {
            require(bridge.isChannelPublicKeySet(_channelId), "Channel leader must set public key first");
        }

        address targetContract = bridge.getChannelTargetContract(_channelId);
        require(targetContract != address(0), "Invalid target contract");

        // Validate MPT keys count matches expected storage slots
        IBridgeCore.TargetContract memory targetContractData = bridge.getTargetContractData(targetContract);
        require(_mptKeys.length == targetContractData.userStorageSlots.length, "MPT keys count mismatch");

        uint256 userBalance = IERC20Upgradeable(targetContract).balanceOf(msg.sender);
        require(
            userBalance >= _amount,
            string(abi.encodePacked("Insufficient token balance: ", toString(userBalance), " < ", toString(_amount)))
        );

        uint256 userAllowance = IERC20Upgradeable(targetContract).allowance(msg.sender, address(this));
        require(
            userAllowance >= _amount,
            string(
                abi.encodePacked("Insufficient token allowance: ", toString(userAllowance), " < ", toString(_amount))
            )
        );

        if (_amount > 0) {
            uint256 balanceBefore = IERC20Upgradeable(targetContract).balanceOf(address(this));
            IERC20Upgradeable(targetContract).safeTransferFrom(msg.sender, address(this), _amount);
            uint256 balanceAfter = IERC20Upgradeable(targetContract).balanceOf(address(this));
            uint256 actualAmount = balanceAfter - balanceBefore;
            require(actualAmount > 0, "No tokens transferred");
            // Find the balance slot index (the one with isLoadedOnChain == false)
            uint8 balanceSlotIndex = bridge.getBalanceSlotIndex(targetContract);
            bridge.updateChannelUserDeposits(_channelId, msg.sender, balanceSlotIndex, actualAmount);
        }

        // Add user to participants array when they make their first deposit
        bridge.addParticipantOnDeposit(_channelId, msg.sender);

        // Convert bytes32[] to uint256[] and set MPT keys
        uint256[] memory mptKeysUint = new uint256[](_mptKeys.length);
        for (uint256 i = 0; i < _mptKeys.length; i++) {
            mptKeysUint[i] = uint256(_mptKeys[i]);
        }
        bridge.setChannelL2MptKeys(_channelId, msg.sender, mptKeysUint);

        emit Deposited(_channelId, msg.sender, targetContract, _amount);
    }

    function updateBridge(address _newBridge) external onlyOwner {
        require(_newBridge != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_newBridge);
    }

    function transferForWithdrawal(address targetContract, address to, uint256 amount) external {
        require(msg.sender == address(bridge.withdrawManager()), "Only withdraw manager can call");
        require(targetContract != address(0), "Invalid target contract");
        require(to != address(0), "Invalid recipient");
        require(amount > 0, "Invalid amount");

        IERC20Upgradeable(targetContract).safeTransfer(to, amount);
    }

    function toString(uint256 value) internal pure returns (string memory) {
        if (value == 0) {
            return "0";
        }
        uint256 temp = value;
        uint256 digits;
        while (temp != 0) {
            digits++;
            temp /= 10;
        }
        bytes memory buffer = new bytes(digits);
        while (value != 0) {
            digits -= 1;
            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));
            value /= 10;
        }
        return string(buffer);
    }

    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}

    /**
     * @notice Returns the address of the current implementation contract
     * @dev Uses EIP-1967 standard storage slot for implementation address
     * @return implementation The address of the implementation contract
     */
    function getImplementation() external view returns (address implementation) {
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        assembly {
            implementation := sload(slot)
        }
    }

    uint256[47] private __gap;
}



================================================
FILE: src/BridgeProofManager.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "lib/openzeppelin-contracts-upgradeable/contracts/security/ReentrancyGuardUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/UUPSUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/Initializable.sol";
import {ITokamakVerifier} from "./interface/ITokamakVerifier.sol";
import {IZecFrost} from "./interface/IZecFrost.sol";
import "./interface/IGroth16Verifier16Leaves.sol";
import "./interface/IGroth16Verifier32Leaves.sol";
import "./interface/IGroth16Verifier64Leaves.sol";
import "./interface/IGroth16Verifier128Leaves.sol";
import "./interface/IBridgeCore.sol";

contract BridgeProofManager is Initializable, ReentrancyGuardUpgradeable, OwnableUpgradeable, UUPSUpgradeable {
    /// @custom:oz-upgrades-unsafe-allow constructor
    constructor() {
        _disableInitializers();
    }

    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;

    struct ChannelInitializationProof {
        uint256[4] pA;
        uint256[8] pB;
        uint256[4] pC;
        bytes32 merkleRoot;
    }

    struct ChannelFinalizationProof {
        uint256[4] pA;
        uint256[8] pB;
        uint256[4] pC;
    }

    struct ProofData {
        uint128[] proofPart1;
        uint256[] proofPart2;
        uint256[] publicInputs;
        uint256 smax;
    }

    struct Signature {
        bytes32 message;
        uint256 rx;
        uint256 ry;
        uint256 z;
    }

    struct BlockInfos {
        uint256 blockNumber;
        uint256 timestamp;
        uint256 prevrandao;
        uint256 gaslimit;
        uint256 basefee;
        address coinbase;
        uint256 chainId;
        uint256 selfbalance;
        uint256 blockHash1;
        uint256 blockHash2;
        uint256 blockHash3;
        uint256 blockHash4;
    }

    struct ChannelContext {
        address[] participants;
        address targetContract;
        uint256 treeSize;
        IBridgeCore.TargetContract targetContractData;
        uint256 userStorageSlotsCount;
    }

    IBridgeCore public bridge;
    ITokamakVerifier public zkVerifier;
    IZecFrost public zecFrost;
    IGroth16Verifier16Leaves public groth16Verifier16;
    IGroth16Verifier32Leaves public groth16Verifier32;
    IGroth16Verifier64Leaves public groth16Verifier64;
    IGroth16Verifier128Leaves public groth16Verifier128;

    event StateInitialized(bytes32 indexed channelId, bytes32 currentStateRoot, BlockInfos blockInfos);
    event TokamakZkSnarkProofsVerified(bytes32 indexed channelId, address indexed signer);
    event FinalBalancesGroth16Verified(bytes32 indexed channelId, bytes32 finalStateRoot);
    event ProofSigned(bytes32 indexed channelId, address indexed signer, bytes32 finalStateRoot);

    modifier onlyBridge() {
        require(msg.sender == address(bridge), "Only bridge can call");
        _;
    }

    function initialize(
        address _bridgeCore,
        address _zkVerifier,
        address _zecFrost,
        address[4] memory _groth16Verifiers,
        address _owner
    ) public initializer {
        __ReentrancyGuard_init();
        __Ownable_init_unchained();
        __UUPSUpgradeable_init();
        _transferOwnership(_owner);

        require(_bridgeCore != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_bridgeCore);
        zkVerifier = ITokamakVerifier(_zkVerifier);
        zecFrost = IZecFrost(_zecFrost);
        groth16Verifier16 = IGroth16Verifier16Leaves(_groth16Verifiers[0]);
        groth16Verifier32 = IGroth16Verifier32Leaves(_groth16Verifiers[1]);
        groth16Verifier64 = IGroth16Verifier64Leaves(_groth16Verifiers[2]);
        groth16Verifier128 = IGroth16Verifier128Leaves(_groth16Verifiers[3]);
    }

    function initializeChannelState(bytes32 channelId, ChannelInitializationProof calldata proof)
        external
        nonReentrant
    {
        require(bridge.getChannelState(channelId) == IBridgeCore.ChannelState.Initialized, "Invalid state");
        require(msg.sender == bridge.getChannelLeader(channelId), "Not leader");

        // Only require public key to be set if frost signature is enabled
        bool frostEnabled = bridge.isFrostSignatureEnabled(channelId);
        if (frostEnabled) {
            require(bridge.isChannelPublicKeySet(channelId), "Channel leader must set public key first");
        }

        ChannelContext memory ctx = _getChannelContext(channelId);
        uint256 preAllocatedCount = bridge.getChannelPreAllocatedLeavesCount(channelId);

        // Verify that the leader has deposited (is in participants array)
        bool leaderIsParticipant = false;
        for (uint256 i = 0; i < ctx.participants.length; i++) {
            if (ctx.participants[i] == msg.sender) {
                leaderIsParticipant = true;
                break;
            }
        }
        require(leaderIsParticipant, "Leader must deposit before initializing");

        // Total entries = pre-allocated + (participants * userStorageSlots)
        uint256 totalEntries = preAllocatedCount + (ctx.participants.length * ctx.userStorageSlotsCount);
        require(totalEntries <= ctx.treeSize, "Too many entries for circuit");

        uint256 publicSignalsLength = ctx.treeSize * 2 + 1;
        uint256[] memory publicSignals = new uint256[](publicSignalsLength);

        publicSignals[0] = uint256(proof.merkleRoot);

        uint256 currentIndex = 0;

        // Add pre-allocated leaves data FIRST
        if (preAllocatedCount > 0) {
            bytes32[] memory preAllocatedKeys = bridge.getPreAllocatedKeys(ctx.targetContract);
            for (uint256 i = 0; i < preAllocatedKeys.length; i++) {
                bytes32 key = preAllocatedKeys[i];
                (uint256 value, bool exists) = bridge.getPreAllocatedLeaf(ctx.targetContract, key);

                if (exists) {
                    _setLeafInPublicSignals(publicSignals, ctx.treeSize, currentIndex, uint256(key), value);
                    currentIndex++;
                }
            }
        }

        // Add participant data AFTER pre-allocated leaves
        // Iterate through all user storage slots
        for (uint256 j = 0; j < ctx.userStorageSlotsCount; j++) {
            IBridgeCore.UserStorageSlot memory slot = ctx.targetContractData.userStorageSlots[j];

            for (uint256 i = 0; i < ctx.participants.length; i++) {
                address l1Address = ctx.participants[i];
                uint256 l2MptKey = bridge.getL2MptKey(channelId, l1Address, uint8(j));

                uint256 slotValue;
                if (!slot.isLoadedOnChain) {
                    // Balance slot: value comes from deposits
                    slotValue = bridge.getValidatedUserSlotValue(channelId, l1Address, uint8(j));
                    if (slotValue > 0) {
                        require(l2MptKey != 0, "Participant MPT key not set");
                    }
                } else {
                    // On-chain slot: fetch via staticcall
                    bytes memory callData = abi.encodePacked(slot.getterFunctionSignature, abi.encode(l1Address));
                    (bool success, bytes memory returnData) = ctx.targetContract.staticcall(callData);

                    slotValue = 0;
                    if (success && returnData.length >= 32) {
                        slotValue = abi.decode(returnData, (uint256));
                    }
                }

                // Add leaf: POSEIDON2(L2MptKey, slotValue)
                _setLeafInPublicSignals(publicSignals, ctx.treeSize, currentIndex, l2MptKey, slotValue);
                currentIndex++;
            }
        }

        // Fill remaining entries with zeros
        for (uint256 i = currentIndex; i < ctx.treeSize; i++) {
            _setLeafInPublicSignals(publicSignals, ctx.treeSize, i, 0, 0);
        }

        bool proofValid = verifyGroth16Proof(
            ctx.treeSize,
            groth16Verifier16,
            groth16Verifier32,
            groth16Verifier64,
            groth16Verifier128,
            proof.pA,
            proof.pB,
            proof.pC,
            publicSignals
        );

        require(proofValid, "Invalid Groth16 proof");

        // Compute blockInfosHash
        BlockInfos memory blockInfos = BlockInfos({
            blockNumber: block.number,
            timestamp: block.timestamp,
            prevrandao: block.prevrandao,
            gaslimit: block.gaslimit,
            basefee: block.basefee,
            coinbase: block.coinbase,
            chainId: block.chainid,
            selfbalance: address(this).balance,
            blockHash1: uint256(blockhash(block.number - 1)),
            blockHash2: uint256(blockhash(block.number - 2)),
            blockHash3: uint256(blockhash(block.number - 3)),
            blockHash4: uint256(blockhash(block.number - 4))
        });
        bytes32 blockInfosHash = _computeBlockInfosHash();

        bridge.setChannelInitialStateRoot(channelId, proof.merkleRoot);
        bridge.setChannelBlockInfosHash(channelId, blockInfosHash);
        bridge.setChannelState(channelId, IBridgeCore.ChannelState.Open);

        emit StateInitialized(channelId, proof.merkleRoot, blockInfos);
    }

    function submitProofAndSignature(bytes32 channelId, ProofData[] calldata proofs, Signature calldata signature)
        external
    {
        require(bridge.getChannelState(channelId) == IBridgeCore.ChannelState.Open, "Invalid state");
        require(proofs.length > 0 && proofs.length <= 5, "Must provide 1-5 proofs");
        
        // Check timeout conditions
        bool isTimedOut = bridge.isChannelTimedOut(channelId);
        
        // If channel is timed out AND someone has withdrawn, reject proof submission
        require(!isTimedOut, "Cannot submit proof after timeout");

        // Extract finalStateRoot from the last proof's output state root (indices 0-1)
        ProofData calldata lastProof = proofs[proofs.length - 1];
        require(lastProof.publicInputs.length >= 12, "Invalid public inputs length");
        bytes32 finalStateRoot = _concatenateStateRoot(lastProof.publicInputs[1], lastProof.publicInputs[0]);
        bytes32 initialStateRoot = bridge.getChannelInitialStateRoot(channelId);

        // STEP 1: verify order of proofs
        // Validate proof chain and state root consistency
        bytes32 expectedPrevRoot = initialStateRoot;

        for (uint256 i = 0; i < proofs.length; i++) {
            ProofData calldata currentProof = proofs[i];
            require(currentProof.publicInputs.length >= 12, "Invalid public inputs length");

            // Extract input state root (rows 8 & 9) and output state root (rows 0 & 1)
            bytes32 inputStateRoot = _concatenateStateRoot(currentProof.publicInputs[9], currentProof.publicInputs[8]);
            bytes32 outputStateRoot = _concatenateStateRoot(currentProof.publicInputs[1], currentProof.publicInputs[0]);

            // For first proof, input state root should match the stored initial state root
            // For subsequent proofs, input state root should match previous proof's output state root
            require(inputStateRoot == expectedPrevRoot, "State root chain broken");

            // Update expected previous root for next iteration
            expectedPrevRoot = outputStateRoot;
        }

        // Final verification: last proof's output state root should match the final state root
        require(expectedPrevRoot == finalStateRoot, "Final state root mismatch");

        // STEP2: Conditional Signature verification
        // Check if frost signature is enabled for this channel
        bool frostEnabled = bridge.isFrostSignatureEnabled(channelId);

        if (frostEnabled) {
            // Verify that signature commits to the specific channel and final state root from the proof
            bytes32 commitmentHash = keccak256(abi.encodePacked(channelId, finalStateRoot));
            require(signature.message == commitmentHash, "Signature must commit to proof content");

            (uint256 pkx, uint256 pky) = bridge.getChannelPublicKey(channelId);
            address signerAddr = bridge.getChannelSignerAddr(channelId);
            address recovered = zecFrost.verify(signature.message, pkx, pky, signature.rx, signature.ry, signature.z);
            require(recovered == signerAddr, "Invalid group threshold signature");
        }

        // STEP2.5: Block info validation
        // Verify that each proof's block info matches the stored block info hash
        bytes32 storedBlockInfoHash = bridge.getChannelBlockInfosHash(channelId);
        require(storedBlockInfoHash != bytes32(0), "Block info hash not set for channel");

        for (uint256 i = 0; i < proofs.length; i++) {
            ProofData calldata currentProof = proofs[i];
            bytes32 proofBlockInfoHash = _extractBlockInfoHashFromProof(currentProof.publicInputs);
            require(proofBlockInfoHash == storedBlockInfoHash, "Block info mismatch in proof");
        }

    
        // STEP3: zk-SNARK proof verification
        // Only after signature validation, verify ZK proofs
        for (uint256 i = 0; i < proofs.length; i++) {
            ProofData calldata currentProof = proofs[i];
            require(currentProof.publicInputs.length >= 19, "Public inputs too short for function signature");

            // Extract function signature from publicInputs at row 16 (0-indexed)
            // Row 18: Selector for a function to call (complete 4-byte selector)
            bytes32 funcSig = _extractFunctionSignatureFromProof(currentProof.publicInputs);

            // Get target contract data and find the registered function
            address targetContract = bridge.getChannelTargetContract(channelId);
            IBridgeCore.TargetContract memory targetData = bridge.getTargetContractData(targetContract);

            IBridgeCore.RegisteredFunction memory registeredFunc;
            bool found = false;
            for (uint256 j = 0; j < targetData.registeredFunctions.length; j++) {
                if (targetData.registeredFunctions[j].functionSignature == funcSig) {
                    registeredFunc = targetData.registeredFunctions[j];
                    found = true;
                    break;
                }
            }
            require(found, "Function not registered");

            // Validate function instance hash
            bytes32 proofInstanceHash = _extractFunctionInstanceHashFromProof(currentProof.publicInputs);
            require(proofInstanceHash == registeredFunc.instancesHash, "Function instance hash mismatch");

            bool proofValid = zkVerifier.verify(
                currentProof.proofPart1,
                currentProof.proofPart2,
                registeredFunc.preprocessedPart1,
                registeredFunc.preprocessedPart2,
                currentProof.publicInputs,
                currentProof.smax
            );

            require(proofValid, "Invalid ZK proof");
        }

        // STEP4: Channel state update
        // Atomically update state only after all validations pass
        bridge.setChannelFinalStateRoot(channelId, finalStateRoot);
        bridge.setChannelSignatureVerified(channelId, frostEnabled);
        bridge.setChannelState(channelId, IBridgeCore.ChannelState.Closing);

        emit TokamakZkSnarkProofsVerified(channelId, msg.sender);
        emit ProofSigned(channelId, msg.sender, finalStateRoot);
    }

    function updateValidatedUserStorage(
        bytes32 channelId,
        uint256[][] calldata finalSlotValues, // finalSlotValues[participant][slot]
        uint256[] calldata permutation,
        ChannelFinalizationProof calldata groth16Proof
    ) external {
        require(bridge.getChannelState(channelId) == IBridgeCore.ChannelState.Closing, "Invalid state");

        // Only require signature verification if frost signature is enabled for this channel
        bool frostEnabled = bridge.isFrostSignatureEnabled(channelId);
        if (frostEnabled) {
            require(bridge.isSignatureVerified(channelId), "signature not verified");
        }

        ChannelContext memory ctx = _getChannelContext(channelId);
        uint256 preAllocatedCount = bridge.getPreAllocatedLeavesCount(ctx.targetContract);

        // Validate finalSlotValues dimensions
        require(finalSlotValues.length == ctx.participants.length, "Invalid slot values length");
        for (uint256 i = 0; i < ctx.participants.length; i++) {
            require(finalSlotValues[i].length == ctx.userStorageSlotsCount, "Invalid storage slots count for participant");
        }

        // Get the final state root stored
        bytes32 finalStateRoot = bridge.getChannelFinalStateRoot(channelId);

        // Total entries = pre-allocated + (participants * userStorageSlotsCount)
        uint256 totalEntries = preAllocatedCount + (ctx.participants.length * ctx.userStorageSlotsCount);
        require(totalEntries == permutation.length, "Invalid permutation length");

        uint256[] memory publicSignals = new uint256[](1 + 2 * ctx.treeSize);

        // Set final state root as first public signal
        publicSignals[0] = uint256(finalStateRoot);

        uint256 currentIndex = 0;

        // Add pre-allocated leaves data FIRST
        if (preAllocatedCount > 0) {
            bytes32[] memory preAllocatedKeys = bridge.getPreAllocatedKeys(ctx.targetContract);
            for (uint256 i = 0; i < preAllocatedKeys.length; i++) {
                bytes32 key = preAllocatedKeys[i];
                (uint256 value, bool exists) = bridge.getPreAllocatedLeaf(ctx.targetContract, key);
                require(exists, "Pre-allocated leaf not found");

                _setLeafInPublicSignals(publicSignals, ctx.treeSize, permutation[currentIndex], uint256(key), value);
                currentIndex++;
            }
        }

        // Add participant data AFTER pre-allocated leaves
        // Iterate through all user storage slots
        for (uint256 j = 0; j < ctx.userStorageSlotsCount; j++) {
            for (uint256 i = 0; i < ctx.participants.length; i++) {
                address participant = ctx.participants[i];
                uint256 l2MptKey = bridge.getL2MptKey(channelId, participant, uint8(j));

                uint256 slotValue = finalSlotValues[i][j];

                _setLeafInPublicSignals(publicSignals, ctx.treeSize, permutation[currentIndex], l2MptKey, slotValue);
                currentIndex++;
            }
        }

        // Verify the groth16 proof
        bool proofValid = verifyGroth16Proof(
            ctx.treeSize,
            groth16Verifier16,
            groth16Verifier32,
            groth16Verifier64,
            groth16Verifier128,
            groth16Proof.pA,
            groth16Proof.pB,
            groth16Proof.pC,
            publicSignals
        );

        require(proofValid, "Invalid Groth16 proof");

        // Store all final slot values for all participants
        bridge.setChannelValidatedUserStorage(channelId, ctx.participants, finalSlotValues);
        bridge.setChannelCloseTimestamp(channelId, block.timestamp);

        // Cleanup channel by removing channel leader flag and deleting channel data
        bridge.cleanupChannel(channelId);

        emit FinalBalancesGroth16Verified(channelId, finalStateRoot);
    }

    function updateVerifier(address _newVerifier) external onlyOwner {
        require(_newVerifier != address(0), "Invalid verifier address");
        zkVerifier = ITokamakVerifier(_newVerifier);
    }

    function updateZecFrost(address _newZecFrost) external onlyOwner {
        require(_newZecFrost != address(0), "Invalid ZecFrost address");
        zecFrost = IZecFrost(_newZecFrost);
    }

    function updateGroth16Verifiers(address[4] memory _newVerifiers) external onlyOwner {
        groth16Verifier16 = IGroth16Verifier16Leaves(_newVerifiers[0]);
        groth16Verifier32 = IGroth16Verifier32Leaves(_newVerifiers[1]);
        groth16Verifier64 = IGroth16Verifier64Leaves(_newVerifiers[2]);
        groth16Verifier128 = IGroth16Verifier128Leaves(_newVerifiers[3]);
    }

    function verifyGroth16Proof(
        uint256 treeSize,
        IGroth16Verifier16Leaves verifier16,
        IGroth16Verifier32Leaves verifier32,
        IGroth16Verifier64Leaves verifier64,
        IGroth16Verifier128Leaves verifier128,
        uint256[4] calldata pA,
        uint256[8] calldata pB,
        uint256[4] calldata pC,
        uint256[] memory publicSignals
    ) internal view returns (bool) {
        if (treeSize == 16) {
            require(publicSignals.length == 33, "Invalid public signals length for 16 leaves");
            uint256[33] memory signals16;
            for (uint256 i = 0; i < 33; i++) {
                signals16[i] = publicSignals[i];
            }
            return verifier16.verifyProof(pA, pB, pC, signals16);
        } else if (treeSize == 32) {
            require(publicSignals.length == 65, "Invalid public signals length for 32 leaves");
            uint256[65] memory signals32;
            for (uint256 i = 0; i < 65; i++) {
                signals32[i] = publicSignals[i];
            }
            return verifier32.verifyProof(pA, pB, pC, signals32);
        } else if (treeSize == 64) {
            require(publicSignals.length == 129, "Invalid public signals length for 64 leaves");
            uint256[129] memory signals64;
            for (uint256 i = 0; i < 129; i++) {
                signals64[i] = publicSignals[i];
            }
            return verifier64.verifyProof(pA, pB, pC, signals64);
        } else if (treeSize == 128) {
            require(publicSignals.length == 257, "Invalid public signals length for 128 leaves");
            uint256[257] memory signals128;
            for (uint256 i = 0; i < 257; i++) {
                signals128[i] = publicSignals[i];
            }
            return verifier128.verifyProof(pA, pB, pC, signals128);
        } else {
            revert("Invalid tree size");
        }
    }

    function updateBridge(address _newBridge) external onlyOwner {
        require(_newBridge != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_newBridge);
    }

    function _concatenateStateRoot(uint256 part1, uint256 part2) internal pure returns (bytes32) {
        return bytes32((part1 << 128) | part2);
    }

    function _getChannelContext(bytes32 channelId) internal view returns (ChannelContext memory ctx) {
        ctx.participants = bridge.getChannelParticipants(channelId);
        ctx.targetContract = bridge.getChannelTargetContract(channelId);
        ctx.treeSize = bridge.getChannelTreeSize(channelId);
        ctx.targetContractData = bridge.getTargetContractData(ctx.targetContract);
        ctx.userStorageSlotsCount = ctx.targetContractData.userStorageSlots.length;
    }

    function _setLeafInPublicSignals(
        uint256[] memory publicSignals,
        uint256 treeSize,
        uint256 physicalIndex,
        uint256 key,
        uint256 value
    ) internal pure {
        publicSignals[1 + physicalIndex] = key;
        publicSignals[1 + treeSize + physicalIndex] = value;
    }

    function _computeBlockInfosHash() internal view returns (bytes32) {
        require(block.number > 0, "Block number must be greater than 0");

        bytes memory blockInfo;
        uint256 targetBlockNumber = block.number;

        // COINBASE (32 bytes total - upper 16 + lower 16)
        address coinbaseAddr = block.coinbase;
        uint256 coinbaseValue = uint256(uint160(coinbaseAddr));
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(coinbaseValue >> 128)), bytes16(uint128(coinbaseValue)));

        // TIMESTAMP (32 bytes total - upper 16 + lower 16)
        uint256 timestamp = block.timestamp;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(timestamp >> 128)), bytes16(uint128(timestamp)));

        // NUMBER (32 bytes total - upper 16 + lower 16) 
        uint256 number = targetBlockNumber;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(number >> 128)), bytes16(uint128(number)));

        // PREVRANDAO (32 bytes total - upper 16 + lower 16)
        uint256 prevrandao = block.prevrandao;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(prevrandao >> 128)), bytes16(uint128(prevrandao)));

        // GASLIMIT (32 bytes total - upper 16 + lower 16)
        uint256 gaslimit = block.gaslimit;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(gaslimit >> 128)), bytes16(uint128(gaslimit)));

        // CHAINID (32 bytes total - upper 16 + lower 16)
        uint256 chainid = block.chainid;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(chainid >> 128)), bytes16(uint128(chainid)));

        // SELFBALANCE (32 bytes total - upper 16 + lower 16)
        uint256 selfbalance = address(this).balance;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(selfbalance >> 128)), bytes16(uint128(selfbalance)));

        // BASEFEE (32 bytes total - upper 16 + lower 16)
        uint256 basefee = block.basefee;
        blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(basefee >> 128)), bytes16(uint128(basefee)));

        // Block hashes 1-4 blocks ago from current block (32 bytes each - upper 16 + lower 16)
        // Since we're hashing for block n, these are blocks (n-1), (n-2), (n-3), (n-4)
        for (uint256 i = 1; i <= 4; i++) {
            bytes32 blockHash;
            if (block.number >= i) {
                blockHash = blockhash(block.number - i);
            }
            // If block.number < i, blockHash remains 0x0 (default value)
            uint256 hashValue = uint256(blockHash);
            blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(hashValue >> 128)), bytes16(uint128(hashValue)));
        }

        return keccak256(blockInfo);
    }

    function _extractBlockInfoHashFromProof(uint256[] calldata publicInputs) internal pure returns (bytes32) {
        require(publicInputs.length >= 64, "Public inputs too short for block info");

        bytes memory blockInfo;

        // Extract block info from public inputs (indices 42-65 based on instance_description.json)
        // Each block variable is stored as lower 16 bytes + upper 16 bytes
        for (uint256 i = 40; i < 64; i += 2) {
            // Combine lower and upper 16 bytes back to 32 bytes
            uint256 lower = publicInputs[i];
            uint256 upper = publicInputs[i + 1];
            blockInfo = abi.encodePacked(blockInfo, bytes16(uint128(upper)), bytes16(uint128(lower)));
        }

        return keccak256(blockInfo);
    }

    function _extractFunctionSignatureFromProof(uint256[] calldata publicInputs) internal pure returns (bytes32) {
        // Function signature is located at row 14 (0-indexed) in the user data section
        // Row 14: Selector for a function to call (complete 4-byte selector)
        require(publicInputs.length >= 19, "Public inputs too short for function signature");

        // Extract the function selector from index 14
        // The value is already a complete 4-byte selector stored as uint256
        uint256 selectorValue = publicInputs[14];
        bytes4 selector = bytes4(uint32(selectorValue));

        return bytes32(selector);
    }

    function _extractFunctionInstanceHashFromProof(uint256[] calldata publicInputs) internal pure returns (bytes32) {
        // Function instance data starts at index 66 (based on instance_description.json)
        // User data: 0-41, Block data: 42-63, Function data: 64+
        require(publicInputs.length > 64, "Public inputs too short for function instance data");

        // Extract function instance data starting from index 64
        uint256 functionDataLength = publicInputs.length - 64;
        uint256[] memory functionInstanceData = new uint256[](functionDataLength);

        for (uint256 i = 0; i < functionDataLength; i++) {
            functionInstanceData[i] = publicInputs[64 + i];
        }

        return keccak256(abi.encodePacked(functionInstanceData));
    }

    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}

    /**
     * @notice Returns the address of the current implementation contract
     * @dev Uses EIP-1967 standard storage slot for implementation address
     * @return implementation The address of the implementation contract
     */
    function getImplementation() external view returns (address implementation) {
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        assembly {
            implementation := sload(slot)
        }
    }

    uint256[41] private __gap;
}



================================================
FILE: src/BridgeWithdrawManager.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "lib/openzeppelin-contracts-upgradeable/contracts/security/ReentrancyGuardUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/UUPSUpgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/proxy/utils/Initializable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/token/ERC20/IERC20Upgradeable.sol";
import "lib/openzeppelin-contracts-upgradeable/contracts/token/ERC20/utils/SafeERC20Upgradeable.sol";
import "./interface/IBridgeCore.sol";
import "./BridgeDepositManager.sol";

contract BridgeWithdrawManager is Initializable, ReentrancyGuardUpgradeable, OwnableUpgradeable, UUPSUpgradeable {
    /// @custom:oz-upgrades-unsafe-allow constructor
    constructor() {
        _disableInitializers();
    }

    using SafeERC20Upgradeable for IERC20Upgradeable;

    IBridgeCore public bridge;

    event ChannelClosed(bytes32 indexed channelId);
    event EmergencyWithdrawalsEnabled(bytes32 indexed channelId);
    event Withdrawn(bytes32 indexed channelId, address indexed user, address token, uint256 amount);
    event TimeoutWithdrawn(bytes32 indexed channelId, address indexed user, address token, uint256 amount);

    modifier onlyBridge() {
        require(msg.sender == address(bridge), "Only bridge can call");
        _;
    }

    function initialize(address _bridgeCore, address _owner) public initializer {
        __ReentrancyGuard_init();
        __Ownable_init_unchained();
        __UUPSUpgradeable_init();
        _transferOwnership(_owner);

        require(_bridgeCore != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_bridgeCore);
    }

    function withdraw(bytes32 channelId, address targetContract) external nonReentrant {
        require(targetContract != address(0), "Invalid target contract");

        // Check that channel is deleted or timed out before allowing withdrawal
        require(
            bridge.getChannelLeader(channelId) == address(0) || bridge.isChannelTimedOut(channelId),
            "Channel must be deleted or timed out"
        );

        // Get the balance slot index for this target contract
        uint8 balanceSlotIndex = bridge.getBalanceSlotIndex(targetContract);

        // Check if there's a withdrawable amount for this specific target contract
        uint256 withdrawAmount = bridge.getValidatedUserSlotValue(channelId, msg.sender, balanceSlotIndex);
        require(withdrawAmount > 0, "No withdrawable amount");

        // Clear the withdrawable amount
        bridge.clearValidatedUserStorage(channelId, msg.sender, targetContract);

        // Transfer the token from deposit manager (where tokens are held)
        BridgeDepositManager(bridge.depositManager()).transferForWithdrawal(targetContract, msg.sender, withdrawAmount);

        emit Withdrawn(channelId, msg.sender, targetContract, withdrawAmount);
    }

    function updateBridge(address _newBridge) external onlyOwner {
        require(_newBridge != address(0), "Invalid bridge address");
        bridge = IBridgeCore(_newBridge);
    }

    function _authorizeUpgrade(address newImplementation) internal override onlyOwner {}

    /**
     * @notice Returns the address of the current implementation contract
     * @dev Uses EIP-1967 standard storage slot for implementation address
     * @return implementation The address of the implementation contract
     */
    function getImplementation() external view returns (address implementation) {
        bytes32 slot = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;
        assembly {
            implementation := sload(slot)
        }
    }

    uint256[45] private __gap;
}



================================================
FILE: src/interface/IBridgeCore.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

interface IBridgeCore {
    enum ChannelState {
        None,
        Initialized,
        Open,
        Closing
    }

    struct PreAllocatedLeaf {
        uint256 value;
        bytes32 key;
        bool isActive;
    }

    struct UserStorageSlot {
        uint8 slotOffset;
        bytes32 getterFunctionSignature;
        bool isLoadedOnChain; // false = value from deposits (balance), true = fetch via staticcall
    }

    struct TargetContract {
        PreAllocatedLeaf[] preAllocatedLeaves;
        RegisteredFunction[] registeredFunctions;
        UserStorageSlot[] userStorageSlots;
    }

    struct RegisteredFunction {
        bytes32 functionSignature;
        bytes32 instancesHash;
        uint128[] preprocessedPart1;
        uint256[] preprocessedPart2;
    }

    // View functions
    function depositManager() external view returns (address);
    function withdrawManager() external view returns (address);
    function getChannelState(bytes32 channelId) external view returns (ChannelState);
    function getChannelTargetContract(bytes32 channelId) external view returns (address);
    function getChannelLeader(bytes32 channelId) external view returns (address);
    function getChannelParticipants(bytes32 channelId) external view returns (address[] memory);
    function isChannelWhitelisted(bytes32 channelId, address addr) external view returns (bool);
    function getChannelTreeSize(bytes32 channelId) external view returns (uint256);
    function getL2MptKey(bytes32 channelId, address participant, uint8 slotIndex) external view returns (uint256);
    function getChannelPublicKey(bytes32 channelId) external view returns (uint256 pkx, uint256 pky);
    function isChannelPublicKeySet(bytes32 channelId) external view returns (bool);
    function getChannelSignerAddr(bytes32 channelId) external view returns (address);
    function getChannelFinalStateRoot(bytes32 channelId) external view returns (bytes32);
    function getChannelInitialStateRoot(bytes32 channelId) external view returns (bytes32);
    function isAllowedTargetContract(address targetContract) external view returns (bool);
    function getTargetContractData(address targetContract) external view returns (TargetContract memory);
    function getChannelInfo(bytes32 channelId)
        external
        view
        returns (address targetContract, ChannelState state, uint256 participantCount, bytes32 initialRoot);
    function getValidatedUserSlotValue(bytes32 channelId, address participant, uint8 slotIndex)
        external
        view
        returns (uint256);
    function hasUserWithdrawn(bytes32 channelId, address participant, address targetContract)
        external
        view
        returns (bool);
    function getBalanceSlotIndex(address targetContract) external view returns (uint8);
    function isSignatureVerified(bytes32 channelId) external view returns (bool);
    function getChannelBlockInfosHash(bytes32 channelId) external view returns (bytes32);
    function isFrostSignatureEnabled(bytes32 channelId) external view returns (bool);
    function isChannelTimedOut(bytes32 channelId) external view returns (bool);

    // Setter functions (only callable by managers)
    function updateChannelUserDeposits(bytes32 channelId, address participant, uint8 slotIndex, uint256 amount)
        external;
    function setChannelL2MptKeys(bytes32 channelId, address participant, uint256[] calldata mptKeys) external;
    function setChannelInitialStateRoot(bytes32 channelId, bytes32 stateRoot) external;
    function setChannelFinalStateRoot(bytes32 channelId, bytes32 stateRoot) external;
    function setChannelState(bytes32 channelId, ChannelState state) external;
    function setChannelCloseTimestamp(bytes32 channelId, uint256 timestamp) external;
    function setChannelValidatedUserStorage(bytes32 channelId, address[] memory participants, uint256[][] memory slotValues)
        external;
    function setChannelSignatureVerified(bytes32 channelId, bool verified) external;
    function setAllowedTargetContract(
        address targetContract,
        PreAllocatedLeaf[] memory leaves,
        UserStorageSlot[] memory userStorageSlots,
        bool allowed
    ) external;
    function registerFunction(
        address targetContract,
        bytes32 functionSignature,
        uint128[] memory preprocessedPart1,
        uint256[] memory preprocessedPart2,
        bytes32 instancesHash
    ) external;
    function unregisterFunction(address targetContract, bytes32 functionSignature) external;
    function clearValidatedUserStorage(bytes32 channelId, address participant, address targetContract) external;
    function setChannelBlockInfosHash(bytes32 channelId, bytes32 blockInfosHash) external;
    function addParticipantOnDeposit(bytes32 channelId, address user) external;
    function cleanupChannel(bytes32 channelId) external;

    // === PRE-ALLOCATED LEAVES FUNCTIONS ===
    function setPreAllocatedLeaf(address targetContract, bytes32 mptKey, uint256 value) external;
    function removePreAllocatedLeaf(address targetContract, bytes32 mptKey) external;
    function getPreAllocatedLeaf(address targetContract, bytes32 mptKey)
        external
        view
        returns (uint256 value, bool exists);
    function getPreAllocatedKeys(address targetContract) external view returns (bytes32[] memory keys);
    function getPreAllocatedLeavesCount(address targetContract) external view returns (uint256 count);
    function getMaxAllowedParticipants(address targetContract) external view returns (uint256 maxParticipants);
    function getChannelPreAllocatedLeavesCount(bytes32 channelId) external view returns (uint256 count);

    function generateChannelId(address leader, bytes32 salt) external pure returns (bytes32 channelId);
}



================================================
FILE: src/interface/IGroth16Verifier128Leaves.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/// @title Interface for Groth16 proof verifier with 128 leaves
/// @notice Interface for the generated Groth16 verifier contract supporting 128 leaves
interface IGroth16Verifier128Leaves {
    /// @notice Verifies a Groth16 proof
    /// @param _pA The A component of the proof
    /// @param _pB The B component of the proof
    /// @param _pC The C component of the proof
    /// @param _pubSignals The public signals (merkle keys and storage values for 128 leaves)
    /// @return True if the proof is valid
    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[257] calldata _pubSignals
    ) external view returns (bool);
}



================================================
FILE: src/interface/IGroth16Verifier16Leaves.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/// @title Interface for Groth16 proof verifier with 16 leaves
/// @notice Interface for the generated Groth16 verifier contract supporting 16 leaves
interface IGroth16Verifier16Leaves {
    /// @notice Verifies a Groth16 proof
    /// @param _pA The A component of the proof
    /// @param _pB The B component of the proof
    /// @param _pC The C component of the proof
    /// @param _pubSignals The public signals (merkle keys and storage values for 16 leaves)
    /// @return True if the proof is valid
    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[33] calldata _pubSignals
    ) external view returns (bool);
}



================================================
FILE: src/interface/IGroth16Verifier32Leaves.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/// @title Interface for Groth16 proof verifier with 32 leaves
/// @notice Interface for the generated Groth16 verifier contract supporting 32 leaves
interface IGroth16Verifier32Leaves {
    /// @notice Verifies a Groth16 proof
    /// @param _pA The A component of the proof
    /// @param _pB The B component of the proof
    /// @param _pC The C component of the proof
    /// @param _pubSignals The public signals (merkle keys and storage values for 32 leaves)
    /// @return True if the proof is valid
    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[65] calldata _pubSignals
    ) external view returns (bool);
}



================================================
FILE: src/interface/IGroth16Verifier64Leaves.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/// @title Interface for Groth16 proof verifier
/// @notice Interface for the generated Groth16 verifier contract
interface IGroth16Verifier64Leaves {
    /// @notice Verifies a Groth16 proof
    /// @param _pA The A component of the proof
    /// @param _pB The B component of the proof
    /// @param _pC The C component of the proof
    /// @param _pubSignals The public signals (merkle keys and storage values)
    /// @return True if the proof is valid
    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[129] calldata _pubSignals
    ) external view returns (bool);
}



================================================
FILE: src/interface/ITokamakVerifier.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/// @title The interface of the Verifier contract, responsible for the zero knowledge proof verification.
/// @author TOKAMAK project Ooo
interface ITokamakVerifier {
    /// @dev Verifies a zk-SNARK proof.
    /// Note: The function may revert execution instead of returning false in some cases.
    function verify(
        uint128[] calldata _proof_part1,
        uint256[] calldata _proof_part2,
        uint128[] calldata _preprocessedpart1,
        uint256[] calldata _preprocessedpart2,
        uint256[] calldata publicInputs,
        uint256 smax
    ) external view returns (bool);
}



================================================
FILE: src/interface/IZecFrost.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/// @notice Minimal interface to the on-chain Schnorr verifier.
/// @dev Expected to return the recovered signer address from (R, z, msg) against (pkx, pky).
interface IZecFrost {
    function verify(bytes32 message, uint256 pkx, uint256 pky, uint256 rx, uint256 ry, uint256 z)
        external
        view
        returns (address recovered);
}



================================================
FILE: src/library/RLP.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

/**
 * @title RLP
 * @dev Gas-optimized RLP encoding/decoding library for Merkle Patricia Trie
 */
library RLP {
    // Structs for decoded data
    struct RLPItem {
        uint256 len;
        uint256 memPtr;
    }

    struct Iterator {
        RLPItem item;
        uint256 nextPtr;
    }

    // Custom errors
    error InvalidRLPData();
    error InvalidRLPListData();

    // ========== Encoding Functions (existing) ==========

    function encode(bytes memory item) internal pure returns (bytes memory) {
        if (item.length == 1 && uint8(item[0]) <= 0x7f) {
            return item;
        } else if (item.length <= 55) {
            bytes memory result = new bytes(item.length + 1);
            result[0] = bytes1(uint8(0x80 + item.length));
            for (uint256 i = 0; i < item.length; i++) {
                result[i + 1] = item[i];
            }
            return result;
        } else {
            return encodeLongItem(item);
        }
    }

    function encodeLongItem(bytes memory item) private pure returns (bytes memory) {
        uint256 length = item.length;
        uint256 lenLen = 0;
        uint256 temp = length;

        while (temp != 0) {
            lenLen++;
            temp /= 256;
        }

        bytes memory result = new bytes(1 + lenLen + length);
        result[0] = bytes1(uint8(0xb7 + lenLen));

        for (uint256 i = 0; i < lenLen; i++) {
            result[lenLen - i] = bytes1(uint8(length / (256 ** i)));
        }

        for (uint256 i = 0; i < length; i++) {
            result[i + 1 + lenLen] = item[i];
        }

        return result;
    }

    function encodeList(bytes[] memory items) internal pure returns (bytes memory) {
        uint256 totalLen = 0;
        for (uint256 i = 0; i < items.length; i++) {
            totalLen += items[i].length;
        }

        bytes memory list = new bytes(totalLen);
        uint256 offset = 0;
        for (uint256 i = 0; i < items.length; i++) {
            for (uint256 j = 0; j < items[i].length; j++) {
                list[offset + j] = items[i][j];
            }
            offset += items[i].length;
        }

        if (totalLen <= 55) {
            bytes memory result = new bytes(totalLen + 1);
            result[0] = bytes1(uint8(0xc0 + totalLen));
            for (uint256 i = 0; i < totalLen; i++) {
                result[i + 1] = list[i];
            }
            return result;
        } else {
            return encodeLongList(list, totalLen);
        }
    }

    function encodeLongList(bytes memory list, uint256 length) private pure returns (bytes memory) {
        uint256 lenLen = 0;
        uint256 temp = length;

        while (temp != 0) {
            lenLen++;
            temp /= 256;
        }

        bytes memory result = new bytes(1 + lenLen + length);
        result[0] = bytes1(uint8(0xf7 + lenLen));

        for (uint256 i = 0; i < lenLen; i++) {
            result[lenLen - i] = bytes1(uint8(length / (256 ** i)));
        }

        for (uint256 i = 0; i < length; i++) {
            result[i + 1 + lenLen] = list[i];
        }

        return result;
    }

    // ========== Gas-Optimized Decoding Functions ==========

    /**
     * @dev Convert bytes to RLPItem. Gas-optimized version.
     * @notice This function is very cheap - just returns a struct with memory pointer
     */
    function toRLPItem(bytes memory item) internal pure returns (RLPItem memory) {
        if (item.length == 0) {
            revert InvalidRLPData();
        }

        uint256 memPtr;
        assembly {
            memPtr := add(item, 0x20)
        }

        return RLPItem(item.length, memPtr);
    }

    /**
     * @dev Decode an RLPItem into bytes. Optimized for minimal gas usage.
     */
    function toBytes(RLPItem memory item) internal pure returns (bytes memory) {
        uint256 memPtr = item.memPtr;
        uint256 offset = _payloadOffset(memPtr);
        uint256 len = _itemLength(memPtr);
        uint256 payloadLen = len - offset;

        bytes memory result = new bytes(payloadLen);
        uint256 destPtr;
        assembly {
            destPtr := add(result, 0x20)
            let srcPtr := add(memPtr, offset)

            // Copy word by word for better gas efficiency
            for { let i := 0 } lt(i, payloadLen) { i := add(i, 0x20) } {
                mstore(add(destPtr, i), mload(add(srcPtr, i)))
            }
        }

        return result;
    }

    /**
     * @dev Decode an RLPItem into a list of RLPItems. Optimized version.
     */
    function toList(RLPItem memory item) internal pure returns (RLPItem[] memory) {
        if (!isList(item)) {
            revert InvalidRLPListData();
        }

        uint256 itemCount = numItems(item);
        RLPItem[] memory result = new RLPItem[](itemCount);

        uint256 memPtr = item.memPtr;
        uint256 currPtr = memPtr + _payloadOffset(memPtr);
        uint256 dataLen;

        // Unroll the loop for better gas efficiency
        for (uint256 i = 0; i < itemCount; ++i) {
            dataLen = _itemLength(currPtr);
            result[i] = RLPItem(dataLen, currPtr);
            currPtr += dataLen;
        }

        return result;
    }

    /**
     * @dev Decode bytes into a list of bytes arrays. Optimized version.
     */
    function decode(bytes memory data) internal pure returns (bytes[] memory) {
        RLPItem memory rlpItem = toRLPItem(data);

        if (isList(rlpItem)) {
            RLPItem[] memory items = toList(rlpItem);
            bytes[] memory result = new bytes[](items.length);

            for (uint256 i = 0; i < items.length; ++i) {
                result[i] = toBytes(items[i]);
            }

            return result;
        } else {
            // Single item, return as array with one element
            bytes[] memory result = new bytes[](1);
            result[0] = toBytes(rlpItem);
            return result;
        }
    }

    /**
     * @dev Decode bytes into a single bytes item. Optimized version.
     */
    function decodeSingle(bytes memory data) internal pure returns (bytes memory) {
        RLPItem memory rlpItem = toRLPItem(data);
        return toBytes(rlpItem);
    }

    /**
     * @dev Check if the RLPItem is a list. Gas-optimized.
     */
    function isList(RLPItem memory item) internal pure returns (bool) {
        uint256 memPtr = item.memPtr;
        uint8 byte0;
        assembly {
            byte0 := byte(0, mload(memPtr))
        }
        return byte0 >= 0xc0;
    }

    /**
     * @dev Get the number of items in a list. Optimized version.
     */
    function numItems(RLPItem memory item) internal pure returns (uint256) {
        if (!isList(item)) {
            return 0;
        }

        uint256 memPtr = item.memPtr;
        uint256 count = 0;
        uint256 currPtr = memPtr + _payloadOffset(memPtr);
        uint256 endPtr = memPtr + _itemLength(memPtr);

        while (currPtr < endPtr) {
            currPtr += _itemLength(currPtr);
            count++;
        }

        return count;
    }

    // ========== Gas-Optimized Helper Functions ==========

    /**
     * @dev Get the payload offset of an RLP item. Highly optimized.
     * @notice Uses bit manipulation and minimal branching for gas efficiency
     */
    function _payloadOffset(uint256 memPtr) private pure returns (uint256) {
        uint8 byte0;
        assembly {
            byte0 := byte(0, mload(memPtr))
        }

        // Use bit manipulation for faster comparison
        if (byte0 < 0x80) {
            return 0;
        }

        // Combine multiple conditions to reduce branching
        if (byte0 < 0xc0) {
            // For strings: 0x80-0xb7 = 1 byte offset, 0xb8-0xbf = variable
            return byte0 < 0xb8 ? 1 : byte0 - 0xb6;
        }

        // For lists: 0xc0-0xf7 = 1 byte offset, 0xf8+ = variable
        return byte0 < 0xf8 ? 1 : byte0 - 0xf6;
    }

    /**
     * @dev Get the full length of an RLP item. Highly optimized.
     * @notice Minimizes memory operations and uses efficient math
     */
    function _itemLength(uint256 memPtr) private pure returns (uint256 len) {
        uint8 byte0;
        assembly {
            byte0 := byte(0, mload(memPtr))
        }

        // Single byte items
        if (byte0 < 0x80) {
            return 1;
        }

        // Short strings
        if (byte0 < 0xb8) {
            return byte0 - 0x7f;
        }

        // Long strings
        if (byte0 < 0xc0) {
            uint256 stringLenOfLen = byte0 - 0xb7;
            assembly {
                // Optimized: read length bytes and calculate in one operation
                let dataLen := shr(sub(256, mul(8, stringLenOfLen)), mload(add(memPtr, 1)))
                len := add(dataLen, add(1, stringLenOfLen))
            }
            return len;
        }

        // Short lists
        if (byte0 < 0xf8) {
            return byte0 - 0xbf;
        }

        // Long lists
        uint256 listLenOfLen = byte0 - 0xf7;
        assembly {
            // Optimized: read length bytes and calculate in one operation
            let dataLen := shr(sub(256, mul(8, listLenOfLen)), mload(add(memPtr, 1)))
            len := add(dataLen, add(1, listLenOfLen))
        }
        return len;
    }

    // ========== Specialized MPT Functions for Gas Optimization ==========

    /**
     * @dev Extract balance directly from MPT leaf without creating intermediate RLPItem
     * @notice This is the most gas-efficient way to extract balance from MPT leaves
     * @param mptLeaf The MPT leaf data in bytes format
     * @return extractedBalance The balance value extracted from the leaf
     */
    function extractBalanceFromMPTLeaf(bytes calldata mptLeaf) internal pure returns (uint256 extractedBalance) {
        assembly {
            let dataPtr := mptLeaf.offset
            let dataLen := mptLeaf.length

            // Minimal validation
            if iszero(dataLen) {
                mstore(0, 0x01)
                revert(0, 0x20)
            }

            // Read first byte
            let firstByte := byte(0, calldataload(dataPtr))

            // Check if it's a list (>= 0xc0)
            if lt(firstByte, 0xc0) {
                mstore(0, 0x02)
                revert(0, 0x20)
            }

            // Calculate list content offset
            let contentOffset := 1
            if gt(firstByte, 0xf7) {
                // Long list (0xf8+)
                let lenOfLen := sub(firstByte, 0xf7)
                contentOffset := add(1, lenOfLen)
            }

            // Move to list content
            dataPtr := add(dataPtr, contentOffset)

            // Skip nonce (first field) - optimized nonce parsing
            let nonceHeader := byte(0, calldataload(dataPtr))
            let skipBytes := 1

            if gt(nonceHeader, 0x7f) {
                if lt(nonceHeader, 0xb8) {
                    // Short string (0x80-0xb7)
                    skipBytes := add(1, sub(nonceHeader, 0x80))
                }
                if gt(nonceHeader, 0xb7) {
                    // Long string (0xb8+)
                    let lenOfLen := sub(nonceHeader, 0xb7)
                    let lengthBytes := byte(0, calldataload(add(dataPtr, 1)))
                    skipBytes := add(add(1, lenOfLen), lengthBytes)
                }
            }

            // Move pointer past nonce to balance field
            dataPtr := add(dataPtr, skipBytes)

            // Read balance header
            let balHeader := byte(0, calldataload(dataPtr))

            // Extract balance value based on encoding - optimized balance parsing
            switch lt(balHeader, 0x80)
            case 1 {
                // Single byte (0x00-0x7f)
                extractedBalance := balHeader
            }
            default {
                switch eq(balHeader, 0x80)
                case 1 {
                    // Empty string = 0
                    extractedBalance := 0
                }
                default {
                    if lt(balHeader, 0xb8) {
                        // Short string (0x81-0xb7)
                        let balLen := sub(balHeader, 0x80)
                        let rawData := calldataload(add(dataPtr, 1))
                        extractedBalance := shr(sub(256, mul(8, balLen)), rawData)
                    }
                    if gt(balHeader, 0xb7) {
                        // Long string (0xb8+) - rare for balances
                        let lenOfLen := sub(balHeader, 0xb7)
                        let lengthData := calldataload(add(dataPtr, 1))
                        let balLen := shr(sub(256, mul(8, lenOfLen)), lengthData)

                        if gt(balLen, 32) {
                            mstore(0, 0x04)
                            revert(0, 0x20)
                        }

                        let rawData := calldataload(add(add(dataPtr, 1), lenOfLen))
                        extractedBalance := shr(sub(256, mul(8, balLen)), rawData)
                    }
                }
            }
        }
    }

    /**
     * @dev Extract nonce directly from MPT leaf for gas optimization
     * @param mptLeaf The MPT leaf data
     * @return extractedNonce The nonce value
     */
    function extractNonceFromMPTLeaf(bytes calldata mptLeaf) internal pure returns (uint256 extractedNonce) {
        assembly {
            let dataPtr := mptLeaf.offset
            let dataLen := mptLeaf.length

            if iszero(dataLen) {
                mstore(0, 0x01)
                revert(0, 0x20)
            }

            let firstByte := byte(0, calldataload(dataPtr))
            if lt(firstByte, 0xc0) {
                mstore(0, 0x02)
                revert(0, 0x20)
            }

            // Calculate list content offset
            let contentOffset := 1
            if gt(firstByte, 0xf7) {
                let lenOfLen := sub(firstByte, 0xf7)
                contentOffset := add(1, lenOfLen)
            }

            // Move to list content and read nonce
            dataPtr := add(dataPtr, contentOffset)
            let nonceHeader := byte(0, calldataload(dataPtr))

            // Parse nonce based on encoding
            switch lt(nonceHeader, 0x80)
            case 1 { extractedNonce := nonceHeader }
            default {
                if eq(nonceHeader, 0x80) { extractedNonce := 0 }
                if lt(nonceHeader, 0xb8) {
                    let nonceLen := sub(nonceHeader, 0x80)
                    let rawData := calldataload(add(dataPtr, 1))
                    extractedNonce := shr(sub(256, mul(8, nonceLen)), rawData)
                }
                if gt(nonceHeader, 0xb7) {
                    let lenOfLen := sub(nonceHeader, 0xb7)
                    let lengthData := calldataload(add(dataPtr, 1))
                    let nonceLen := shr(sub(256, mul(8, lenOfLen)), lengthData)

                    if gt(nonceLen, 32) {
                        mstore(0, 0x04)
                        revert(0, 0x20)
                    }

                    let rawData := calldataload(add(add(dataPtr, 1), lenOfLen))
                    extractedNonce := shr(sub(256, mul(8, nonceLen)), rawData)
                }
            }
        }
    }

    // ========== Existing Conversion Functions (Optimized) ==========

    /**
     * @dev Convert address to bytes. Optimized version.
     */
    function toAddress(RLPItem memory item) internal pure returns (address) {
        bytes memory addrBytes = toBytes(item);
        if (addrBytes.length != 20) {
            revert InvalidRLPData();
        }

        address addr;
        assembly {
            addr := div(mload(add(addrBytes, 32)), exp(256, 12))
        }
        return addr;
    }

    /**
     * @dev Convert uint to bytes. Optimized version.
     */
    function toUint(RLPItem memory item) internal pure returns (uint256) {
        bytes memory data = toBytes(item);
        if (data.length == 0) {
            return 0;
        }
        if (data.length > 32) {
            revert InvalidRLPData();
        }

        uint256 result;
        assembly {
            result := mload(add(data, 32))
            // Optimized shift operation
            result := shr(sub(256, mul(8, mload(data))), result)
        }
        return result;
    }

    /**
     * @dev Convert bytes32 to bytes. Optimized version.
     */
    function toBytes32(RLPItem memory item) internal pure returns (bytes32) {
        bytes memory data = toBytes(item);
        if (data.length != 32) {
            revert InvalidRLPData();
        }

        bytes32 result;
        assembly {
            result := mload(add(data, 32))
        }
        return result;
    }

    // ========== Iterator Functions (Optimized) ==========

    /**
     * @dev Iterator to easily loop through list items. Optimized version.
     */
    function iterator(RLPItem memory self) internal pure returns (Iterator memory it) {
        if (!isList(self)) {
            revert InvalidRLPListData();
        }
        uint256 ptr = self.memPtr + _payloadOffset(self.memPtr);
        it.item = RLPItem(_itemLength(ptr), ptr);
        it.nextPtr = ptr + _itemLength(ptr);
    }

    /**
     * @dev Check if iterator has next item. Optimized version.
     */
    function hasNext(Iterator memory self, RLPItem memory item) internal pure returns (bool) {
        uint256 itemMemPtr = item.memPtr;
        return self.nextPtr < itemMemPtr + _itemLength(itemMemPtr);
    }

    /**
     * @dev Get next item from iterator. Optimized version.
     */
    function next(Iterator memory self) internal pure returns (Iterator memory) {
        uint256 ptr = self.nextPtr;
        uint256 itemLength = _itemLength(ptr);
        self.item = RLPItem(itemLength, ptr);
        self.nextPtr = ptr + itemLength;
        return self;
    }
}



================================================
FILE: src/library/ZecFrost.sol
================================================
// SPDX-License-Identifier: LGPLv3
pragma solidity ^0.8.29;

/// @title FROST(secp256k1, SHA-256) On-chain Verifier (ecrecover trick)
/// @notice Verifies Schnorr signatures produced by FROST (Zcash Foundation style).
/// @dev Uses the ecrecover-based mulâ€“mulâ€“add trick:
///      checks that address(-z*G + e*P) == address(-R), with
///      e = H2( Serialize(R) || Serialize(P) || msg ),
///      H2 = hash_to_field via ExpandMessageXMD(SHA-256) as per RFC 9591 Â§6.5.
contract ZecFrost {
    // secp256k1 base field prime and scalar field order
    uint256 private constant _P = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f;
    uint256 private constant _N = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141;

    // ------------------------------- internal utils -------------------------------

    // address(-z*G + e*P) using ecrecover trick (ethresear.ch/2384)
    function _ecmulmuladd(uint256 z, uint256 x, uint256 y, uint256 e) private view returns (address result) {
        assembly ("memory-safe") {
            let ptr := mload(0x40)
            // v = 27 + (y mod 2)
            mstore(ptr, mulmod(z, x, _N)) // r = z*x  (mod n)
            mstore(add(ptr, 0x20), add(and(y, 1), 27)) // v
            mstore(add(ptr, 0x40), x) // s = x
            mstore(add(ptr, 0x60), mulmod(e, x, _N)) // hash = e*x (mod n)
            result := mul(mload(0x00), staticcall(gas(), 0x01, ptr, 0x80, 0x00, 0x20))
        }
    }

    // Ethereum address of a point (truncated keccak of (x||y))
    function _address(uint256 x, uint256 y) private pure returns (address result) {
        assembly ("memory-safe") {
            mstore(0x00, x)
            mstore(0x20, y)
            result := and(keccak256(0x00, 0x40), 0xffffffffffffffffffffffffffffffffffffffff)
        }
    }

    // y^2 == x^3 + 7  (and coordinates in range)
    function _isOnCurve(uint256 x, uint256 y) private pure returns (bool result) {
        assembly ("memory-safe") {
            result :=
                and(eq(mulmod(y, y, _P), addmod(mulmod(x, mulmod(x, x, _P), _P), 7, _P)), and(lt(x, _P), lt(y, _P)))
        }
    }

    // 0 < a < n
    function _isScalar(uint256 a) private pure returns (bool result) {
        assembly ("memory-safe") {
            result := and(gt(a, 0), lt(a, _N))
        }
    }

    // ------------------------------- RFC 9591 H2 preimage -------------------------------

    /// @dev SEC1-compressed R || SEC1-compressed P || msg (msg is bytes32 here)
    function _preimage(uint256 rx, uint256 ry, uint256 px, uint256 py, bytes32 message)
        private
        pure
        returns (bytes memory preimage)
    {
        // 33 + 33 + 32 = 98 bytes
        preimage = new bytes(98);
        assembly ("memory-safe") {
            // SEC1(R)
            mstore8(add(preimage, 0x20), add(2, and(ry, 1))) // 0x02 if even(ry), 0x03 if odd
            mstore(add(preimage, 0x21), rx) // x
            // SEC1(P)
            mstore8(add(preimage, 0x41), add(2, and(py, 1)))
            mstore(add(preimage, 0x42), px)
            // msg (bytes32)
            mstore(add(preimage, 0x62), message)
        }
    }

    // ------------------------------- ExpandMessageXMD & hash_to_field -------------------------------

    /// @dev ExpandMessageXMD(SHA-256) producing `len` bytes (RFC 9380 Â§5.4.1)
    function _expandMessageXmd(bytes memory message, string memory dst, uint256 len)
        private
        view
        returns (bytes memory uniform)
    {
        // This is your safe, gas-optimized XMD from the working version
        assembly ("memory-safe") {
            uniform := mload(0x40)
            mstore(0x40, add(uniform, and(add(0x3f, len), 0xffe0)))
            mstore(uniform, len)

            let prime := mload(0x40)
            let ptr := prime

            // Z_pad = 64 zero bytes (SHA-256 block size)
            mstore(ptr, 0)
            ptr := add(ptr, 0x20)
            mstore(ptr, 0)
            ptr := add(ptr, 0x20)

            // msg || I2OSP(len, 2) || I2OSP(0,1) || DST' (where DST' = DST || I2OSP(len(DST),1))
            mcopy(ptr, add(message, 0x20), mload(message))
            ptr := add(ptr, mload(message))
            mstore(ptr, shl(240, len))
            ptr := add(ptr, 3)

            let bPtr := sub(ptr, 0x21)
            let iPtr := sub(ptr, 0x01)

            mcopy(ptr, add(dst, 0x20), mload(dst))
            ptr := add(ptr, mload(dst))
            mstore8(ptr, mload(dst))
            ptr := add(ptr, 0x01)

            let bLen := sub(ptr, bPtr)

            // b0 = H( Z_pad || msg || l_i_b_str || I2OSP(0,1) || DST' )
            if iszero(staticcall(gas(), 0x2, prime, sub(ptr, prime), bPtr, 0x20)) { revert(0x00, 0x00) }
            let b0 := mload(bPtr)

            // b1 = H( b0 || I2OSP(1,1) || DST' )
            mstore8(iPtr, 1)
            if iszero(staticcall(gas(), 0x2, bPtr, bLen, add(uniform, 0x20), 0x20)) { revert(0x00, 0x00) }

            // fill remaining blocks: bi = H( (b_{i-1} xor b0) || I2OSP(i,1) || DST' )
            for { let i := 2 } gt(len, 0x20) {
                i := add(i, 1)
                len := sub(len, 32)
            } {
                let uPtr := add(uniform, shl(5, i))
                mstore(bPtr, xor(b0, mload(sub(uPtr, 0x20))))
                mstore8(iPtr, i)
                if iszero(staticcall(gas(), 0x2, bPtr, bLen, uPtr, 0x20)) { revert(0x00, 0x00) }
            }
        }
    }

    /// @dev hash_to_field into secp256k1 scalar field (order n), L=48 (RFC 9591 Â§6.5)
    function _hashToField(bytes memory msgBytes, string memory dst) private view returns (uint256 e) {
        bytes memory okm = _expandMessageXmd(msgBytes, dst, 48);
        // take 48 bytes, big-endian, mod n
        assembly ("memory-safe") {
            e := mulmod(mload(add(okm, 0x20)), 0x100000000000000000000000000000000, _N)
            e := addmod(e, shr(128, mload(add(okm, 0x40))), _N)
        }
    }

    /// @dev H2 for FROST(secp256k1, SHA-256): DST = "FROST-secp256k1-SHA256-v1chal"
    function _challenge(uint256 rx, uint256 ry, uint256 px, uint256 py, bytes32 message)
        private
        view
        returns (uint256 e)
    {
        return _hashToField(_preimage(rx, ry, px, py, message), "FROST-secp256k1-SHA256-v1chal");
    }

    // ------------------------------- Public API -------------------------------

    /// @notice Verify a FROST(secp256k1, SHA-256) Schnorr signature (bytes32 message).
    /// @dev This verifier reduces the public key's x-coordinate modulo n when using the
    /// ecrecover trick. The only unusable edge case is when x â‰¡ 0 (mod n), because then
    /// s = 0 and the precompile rejects the signature. So we require:
    ///   â€¢ P is on secp256k1 and coordinates are < p, and
    ///   â€¢ x mod n != 0.
    /// Also note: in Schnorr, the scalar `z` is part of the signature and cannot be
    /// recovered from (R, P, msg); it must be supplied.
    /// @param message 32-byte message (if you have arbitrary bytes, use verifyBytes).
    /// @param px,py   Public key affine coordinates.
    /// @param rx,ry   Signature R point affine coordinates.
    /// @param z       Schnorr signature scalar.
    /// @return signer The address corresponding to P if valid; address(0) otherwise.
    function verify(bytes32 message, uint256 px, uint256 py, uint256 rx, uint256 ry, uint256 z)
        public
        view
        returns (address signer)
    {
        // Basic validation: P on-curve with x<n; R on-curve; z in (0,n)
        {
            bool pOk = isValidPublicKey(px, py);
            bool rOk = _isOnCurve(rx, ry);
            bool zOk = _isScalar(z);
            bool ok;
            assembly ("memory-safe") {
                ok := and(pOk, and(rOk, zOk))
            }
            if (!ok) return address(0);
        }

        uint256 e = _challenge(rx, ry, px, py, message);

        unchecked {
            // Compare address(-z*G + e*P) with address(-R)
            address minusR = _address(rx, _P - ry);
            address combo = _ecmulmuladd(z, px, py, e);
            signer = _address(px, py);
            assembly ("memory-safe") {
                signer := mul(signer, eq(minusR, combo))
            }
        }
    }

    /// @notice Verify with an arbitrary-length message; we pre-hash to bytes32 via keccak256.
    /// @dev Ensure your signer also used `keccak256(message)` as the `msg` when producing (R, z).
    function verifyBytes(bytes calldata message, uint256 px, uint256 py, uint256 rx, uint256 ry, uint256 z)
        public
        view
        returns (address signer)
    {
        return verify(keccak256(message), px, py, rx, ry, z);
    }

    /// @notice Check P is usable with this verifier (on-curve, coordinates < p, and x mod n != 0).
    function isValidPublicKey(uint256 x, uint256 y) public pure returns (bool result) {
        assembly ("memory-safe") {
            // On-curve check, coordinates within field, and x mod n != 0 (so ecrecover's s != 0)
            // let oncurve := eq(mulmod(y, y, _P), addmod(mulmod(x, mulmod(x, x, _P), _P), 7, _P))
            // let infield := and(lt(x, _P), lt(y, _P))
            // let xmodn := mod(x, _N)
            result :=
                and(
                    eq(mulmod(y, y, _P), addmod(mulmod(x, mulmod(x, x, _P), _P), 7, _P)),
                    and(and(lt(x, _P), lt(y, _P)), gt(mod(x, _N), 0))
                )
        }
    }

    /// @notice Gas sampling helper (unchanged).
    function measureVerify(bytes32 message, uint256 px, uint256 py, uint256 rx, uint256 ry, uint256 z)
        external
        view
        returns (uint256 cold, uint256 warm)
    {
        uint256 g0 = gasleft();
        verify(message, px, py, rx, ry, z);
        uint256 g1 = gasleft();
        verify(message, px, py, rx, ry, z);
        uint256 g2 = gasleft();
        unchecked {
            cold = g0 - g1;
            warm = g1 - g2;
        }
    }
}



================================================
FILE: src/verifier/Groth16Verifier128Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

import "./Groth16Verifier128LeavesIC1.sol";
import "./Groth16Verifier128LeavesIC2.sol";

contract Groth16Verifier128Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key constants for 128 leaves
    uint256 internal constant alphax_PART1 = 0x000000000000000000000000000000000b64c080c737ba7a22eb10bdd910a8dd;
    uint256 internal constant alphax_PART2 = 0xeaf6fee44136b7f01137411d704ce9834d1206f96c1e5b0d85331112474e00fd;
    uint256 internal constant alphay_PART1 = 0x0000000000000000000000000000000009b199d1d14d750ab035b0f175586479;
    uint256 internal constant alphay_PART2 = 0x6f17a9a71f42a94e5bc1cb31785503a35a264c9170aa22170403ace2330d9b46;

    uint256 constant betax1_PART1 = 0x0000000000000000000000000000000007708cfcadb0c0530028dcd0e1f21c08;
    uint256 constant betax1_PART2 = 0x7b7e3f36d98ff6be8ca8eb662fe3d824790d3570616010f104e99848f87d0c83;
    uint256 constant betax2_PART1 = 0x000000000000000000000000000000000048ff455eaf220d0cfa22014ef3aaf2;
    uint256 constant betax2_PART2 = 0xc5209615cf3a98e2545004b3d43a3591c1acbeefe16e3cf81155bc3aad5e3fe9;
    uint256 constant betay1_PART1 = 0x000000000000000000000000000000000349bdb043c0d6f663b59fb2ac8f80e1;
    uint256 constant betay1_PART2 = 0xb90ec6fcb9b51c11e201999fd2948b90db942941ee71a7ce24fac1a6b233da26;
    uint256 constant betay2_PART1 = 0x000000000000000000000000000000000adb0437246524e1737815ce833f795f;
    uint256 constant betay2_PART2 = 0x910b4c67537881a1a9901e5c9b2b3f43fbe23043e117d11be4b69f03e24f2a20;

    uint256 constant gammax1_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax1_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammax2_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax2_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay1_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay2_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;

    uint256 constant deltax1_PART1 = 0x0000000000000000000000000000000013050b3285c66c8f497615385adc5768;
    uint256 constant deltax1_PART2 = 0xced23aadc067103cc4f3b64756da70798782b5724ea5c47f1e16cc6221bb8ab8;
    uint256 constant deltax2_PART1 = 0x00000000000000000000000000000000130c513fe69286b5af813425020f8fd6;
    uint256 constant deltax2_PART2 = 0xcc38314d8adbab980acb5c0dcac40fe380949dbc1157d836e0f8039a8f205d63;
    uint256 constant deltay1_PART1 = 0x000000000000000000000000000000000f44469cd5169bb372ed871e49995a1d;
    uint256 constant deltay1_PART2 = 0x696ea6525f9b14e10ef6aeaa3675ee6b80952412c3f26da6c378c76161f05013;
    uint256 constant deltay2_PART1 = 0x00000000000000000000000000000000047c36e0f2612a960fa3d199dec78241;
    uint256 constant deltay2_PART2 = 0x0f1475fd53b59ee860cca26cfeded69370d498d6fd8847db8002e07ce87caff5;

    // References to the IC constants contracts
    Groth16Verifier128LeavesIC1 public icContract1;
    Groth16Verifier128LeavesIC2 public icContract2;

    // Memory layout for pairing check
    uint16 constant pPairing = 1408;
    uint16 constant pVk = 0;
    uint16 constant pLastMem = 1664;

    constructor(address _icContract1, address _icContract2) {
        icContract1 = Groth16Verifier128LeavesIC1(_icContract1);
        icContract2 = Groth16Verifier128LeavesIC2(_icContract2);
    }

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[257] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function getICValues1(index, ic_contract_addr) -> x0, x1, y0, y1 {
                let mIn := mload(0x40)

                // Prepare call data for getIC1(index)
                mstore(mIn, 0xf231279100000000000000000000000000000000000000000000000000000000) // getIC1 function selector
                mstore(add(mIn, 4), index)

                let success := staticcall(gas(), ic_contract_addr, mIn, 36, mIn, 128)
                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                x0 := mload(mIn)
                x1 := mload(add(mIn, 32))
                y0 := mload(add(mIn, 64))
                y1 := mload(add(mIn, 96))
            }

            function getICValues2(index, ic_contract_addr) -> x0, x1, y0, y1 {
                let mIn := mload(0x40)

                // Prepare call data for getIC2(index)
                mstore(mIn, 0x49d837fe00000000000000000000000000000000000000000000000000000000) // getIC2 function selector
                mstore(add(mIn, 4), index)

                let success := staticcall(gas(), ic_contract_addr, mIn, 36, mIn, 128)
                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                x0 := mload(mIn)
                x1 := mload(add(mIn, 32))
                y0 := mload(add(mIn, 64))
                y1 := mload(add(mIn, 96))
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem, ic_contract_addr1, ic_contract_addr2) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Get IC0 values and store (always from contract 1)
                let ic0_x0, ic0_x1, ic0_y0, ic0_y1 := getICValues1(0, ic_contract_addr1)
                mstore(_pVk, ic0_x0)
                mstore(add(_pVk, 32), ic0_x1)
                mstore(add(_pVk, 64), ic0_y0)
                mstore(add(_pVk, 96), ic0_y1)

                // Compute the linear combination vk_x using external IC values
                // Process first 128 signals (indices 1-128) from IC1
                for { let i := 1 } lt(i, 129) { i := add(i, 1) } {
                    let ic_x0, ic_x1, ic_y0, ic_y1 := getICValues1(i, ic_contract_addr1)
                    let pubSignalOffset := mul(sub(i, 1), 32)
                    g1_mulAccC(_pVk, ic_x0, ic_x1, ic_y0, ic_y1, calldataload(add(pubSignals, pubSignalOffset)))
                }

                // Process remaining 129 signals (indices 129-257) from IC2
                for { let i := 129 } lt(i, 258) { i := add(i, 1) } {
                    let ic_x0, ic_x1, ic_y0, ic_y1 := getICValues2(sub(i, 129), ic_contract_addr2)
                    let pubSignalOffset := mul(sub(i, 1), 32)
                    g1_mulAccC(_pVk, ic_x0, ic_x1, ic_y0, ic_y1, calldataload(add(pubSignals, pubSignalOffset)))
                }

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default { neg_y_low := sub(Q_MOD_PART2, y_low) }

                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // -y_PART1
                mstore(add(_pPairing, 96), neg_y_low) // -y_PART2

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 2 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax1_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax1_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax2_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax2_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay1_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay1_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay2_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay2_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 3 G1
                mstore(add(_pPairing, 768), mload(_pVk)) // x_PART1
                mstore(add(_pPairing, 800), mload(add(_pVk, 32))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(_pVk, 64))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(_pVk, 96))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax1_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax1_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax2_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax2_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay1_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay1_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay2_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay2_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 4 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax1_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax1_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax2_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax2_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay1_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay1_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay2_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay2_PART2) // y0_PART2

                // Call pairing check
                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Check the pairing
            let ic1_addr := sload(icContract1.slot)
            let ic2_addr := sload(icContract2.slot)
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem, ic1_addr, ic2_addr)

            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}



================================================
FILE: src/verifier/Groth16Verifier128LeavesIC1.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

contract Groth16Verifier128LeavesIC1 {
    function getIC1(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {
        if (index == 0) {
            return (
                0x0000000000000000000000000000000009491f91b0c4bba7662630ba128854a4,
                0xda0bcbe761207a3f8bace46d3ca71e7d7e2e542d84d92b1d5b7e38571517a08c,
                0x00000000000000000000000000000000038b7069d4468f0e5219a93f601b9492,
                0xd5d23d1e943ccb61bb8fc136682d38998893116deed68388b49a3060e4c27242
            );
        }
        if (index == 1) {
            return (
                0x000000000000000000000000000000000a8484cc2e8465c2ef1eb86ce562f8ab,
                0x42da6c71093a7b9903c26ec0e5ba2c8abfca8a3543c269eee1167fea78f3b08d,
                0x0000000000000000000000000000000000cf8792bda6bdddf11e61100fe6f14f,
                0xad4207b316d72255e11c7a839fc1f9af565943d4747ca878e88814f8fdf75cba
            );
        }
        if (index == 2) {
            return (
                0x0000000000000000000000000000000017a45e61fa584ae0c9985f0be0be2ef6,
                0xbe96098359937be293e9de3fc5f324ef0d88d10b8b3a070e3ba9ccf6a4cd8b73,
                0x0000000000000000000000000000000019875ae3355164b800371a2e1df8f82c,
                0x1ab2586ffd0b9eb42b4c289800ceb2e1229e5273836b0be2bc317189cf6efad7
            );
        }
        if (index == 3) {
            return (
                0x0000000000000000000000000000000001759e3ec0f6ba2c620c3b6b9d6bdedf,
                0x0978c4365b36ae2979c1dff40c93d20efdfbaf3ba618f414eb3e5286db770f3e,
                0x000000000000000000000000000000000be0670ba488675eb09fc46437c0b090,
                0xfd0c46faf8a282eb6d811b27ed060ace92b45b313490ca47f86ce8c0e784cfab
            );
        }
        if (index == 4) {
            return (
                0x00000000000000000000000000000000125537b974d8df81b7ee61d951e2feaa,
                0xe2a62b3d94529da36245c943d3b3a3ae7f35c9f2bb937944c07a204a8abb4324,
                0x000000000000000000000000000000000bba0b4ba650ce8727c364a8caac57e9,
                0xc9fcfd33677abe3e5cc466485b705e3eecf7830c41773e1128fc63f71adbb983
            );
        }
        if (index == 5) {
            return (
                0x0000000000000000000000000000000010fd65cd798a58d87a9eee50e9d3eeb5,
                0x7e937e53a86baa2fe747ad4021d9d4d24bd843272fc1f4554a17ea8f31bd1365,
                0x00000000000000000000000000000000002a0eb119676923c64538c34608fa76,
                0x1300ff9b356b95701071bcdf7800b36617a6944458e7f12c8e43f83c2b55a3f1
            );
        }
        if (index == 6) {
            return (
                0x000000000000000000000000000000000c4219d9e8e2d23d0679140e8d41e68a,
                0x924509593e1677d14c508917412009917908960860d0f4b7023b9fe1abcf6f30,
                0x000000000000000000000000000000000880d8015d2b765f27107d850f131443,
                0xbdf5f8432c8c47a18f7889ad28361ca2136d872ed9966dc87f45ad8da088ac2e
            );
        }
        if (index == 7) {
            return (
                0x0000000000000000000000000000000008dc866d8c6bad74294a8c24ccf3e5e2,
                0x858ecd7a8c3ea400456cbad33baca8c9db83277454a5e943927594dedea722cf,
                0x000000000000000000000000000000001207b9ef4037e516f85c0e5691bc54fb,
                0x4d2e6c2a977468487adf5f02acf8d0a815057b9502cc3cff9b45370d1adc61aa
            );
        }
        if (index == 8) {
            return (
                0x0000000000000000000000000000000012f28fbcf9f12ecbe4478b0b6818a644,
                0x7f90a7fd4ab786466843f8af6f54aa5b3ee5d95243e1cc19325b3598ea59049e,
                0x0000000000000000000000000000000013ad3d54cb768f73de6b74e2824aba84,
                0x6cc47311e3a447860b0c54f4a8b9bebfde7d6b4a2a3a0d1738075a680364047d
            );
        }
        if (index == 9) {
            return (
                0x000000000000000000000000000000000c6dbd22fe3ff9797a93b82f556886f2,
                0x16d80ebb8f8e15cb0b96d6703d6ef75124c7a227e79da9dda8e9a3523bfec641,
                0x0000000000000000000000000000000013d7f065b5bf6dfbbf2851bf8b67dac3,
                0x9490774ac6d70ab1082fe1323521f61a4a5b3e69f3d6b5e2660d3569d4e0358a
            );
        }
        if (index == 10) {
            return (
                0x000000000000000000000000000000000cc9999cfb10cd6c727d2bc0aed74d0a,
                0x421f45195ddacf06ce92ce043ae3510b4f9dc48704747031e48d6e7c7dceb828,
                0x000000000000000000000000000000000758f19cd498f342659919b002d3a22d,
                0x0d49a1622dbae1550cf380f38bac971a3035bb2011fd5356ed0a9a8bad24c274
            );
        }
        if (index == 11) {
            return (
                0x000000000000000000000000000000000458282a5f5c7126c06f2a9b6ceede75,
                0x1e9fe6d4310aaf1d162086df8f1ac7ca9b1a7ca7065bf4d021cf705109f2976f,
                0x00000000000000000000000000000000187a327c7daccd5d2f6fd1e81f4a3f99,
                0xdf287b71410b174e7024699dc17b12950dfa6129afd9124aa7868c52ab3cbd27
            );
        }
        if (index == 12) {
            return (
                0x0000000000000000000000000000000019f2bc6912582504afc4b642aed98b1e,
                0x4d180d34a252d832abd2c0cea4d9cbb4c7df63682c8a6d581a5718a2c01a5a13,
                0x000000000000000000000000000000000a4998533b2f768b36cad9a72cfb6fdf,
                0x0c683651deefb6648802cea547782996193cadd163b565a112cb8f63e390b2c7
            );
        }
        if (index == 13) {
            return (
                0x000000000000000000000000000000000bd1533b74e939075aa53d362b3148c5,
                0x3c3f10cde31fc140add7ebb71b47f524a0391f3a0aa9da7d3715429dc2ec67e6,
                0x0000000000000000000000000000000007a3db89c0367839d6a26481a5fd1675,
                0x5ad49efb8ce86c8df698d8be74f44d44f5cc650a6104d0ddcba34cdcbeb3b91f
            );
        }
        if (index == 14) {
            return (
                0x0000000000000000000000000000000017f29902aab7921b55889300cdab18bc,
                0x32170d089c1c4e889e2c32d69252e4f72707070bc6d32cb9e8ee9cff47785f86,
                0x00000000000000000000000000000000014e07938fcd3955ca933ef484cdf632,
                0x5570101f99cade58c6dcdd20150bb68599c3fbb97b537ae07b414915a4910117
            );
        }
        if (index == 15) {
            return (
                0x0000000000000000000000000000000009eb58d0142e36eb1da1cc88add394f8,
                0xd4940e323d0be51c5e8fc1952d256ed07519675057b820e05cb2ca9da46438a9,
                0x000000000000000000000000000000000845d0cb6dcb32f84b509399025eff53,
                0x71bec943e2d9668acd6de216b925076b9c466afa8cb6fa936f74bace19d5c643
            );
        }
        if (index == 16) {
            return (
                0x0000000000000000000000000000000001ea35476ba690e3ae4b8ea437ec9ed9,
                0xbcc70a679ff5687ad405a434fb4417870344b753bf2618fbf05135988a6c195e,
                0x000000000000000000000000000000000590e1dedebbed4e21b103709555af10,
                0xe24e76c69e1b1b7cb9bae40fa9704e5a60f78823db850a148112b167295053ae
            );
        }
        if (index == 17) {
            return (
                0x0000000000000000000000000000000009c848d1ebc2f4b8c1ac1a3ec60319dc,
                0x49c9d82a5f0726f9b49a24e510a6051e0ebf073bf97d43b7557c33551c625652,
                0x000000000000000000000000000000000d4cf13349dbfd5f014bea8200a164c7,
                0xbbe30d6e2502cbf440790801d118aaece673b8e01cd1bb8e6da30acc46e99178
            );
        }
        if (index == 18) {
            return (
                0x00000000000000000000000000000000013e12a7af3131c432a0c43b0f189d83,
                0xba3ded0d73fc06665f0ee2c2af4cd98388e70772f29196411d159c9067daf234,
                0x000000000000000000000000000000000f22b2f42f1853fa6eadd0eaded1375a,
                0x27e1a2c958de3dc91a18bf75094c8d0c1391c321eb78c799dc113e413666a40b
            );
        }
        if (index == 19) {
            return (
                0x000000000000000000000000000000000faa61874f89b952dd55fbed932f8559,
                0xafeaeeede3b8ca3e8b542c5250c76fc484e6780128a7359213037102de504107,
                0x0000000000000000000000000000000003c426ad064f0937e8db00e12bd79746,
                0xeecd920612dfb02145db269c3266d65d27b3453c9e584edb8e7762fd089ec8f2
            );
        }
        if (index == 20) {
            return (
                0x00000000000000000000000000000000048cc8007aa9c9e1a4bb6c67695e8398,
                0xcb712022f93d36e1fdf1b215a0a615c7fb8d88278fe49f77696bd076ec774ff3,
                0x000000000000000000000000000000001631f6e39fdc7ccb81037937117902bc,
                0x7281dcdcc3c4d796562483c6d730ab305513eec2fd897577e1c55cf4f9427c97
            );
        }
        if (index == 21) {
            return (
                0x00000000000000000000000000000000033bd12858aef0e85133e1a533dd3879,
                0x315c656a5a4c5091af9d98e7bf4fa7726240ccc563f8b6f8503b7fe6bb2bc68e,
                0x0000000000000000000000000000000004f67e99b845c912163fd6f38ce1b66e,
                0x817ad044d61f486ea2a4d346801984f78d30c278ab10acb27ae4ca4e308e9038
            );
        }
        if (index == 22) {
            return (
                0x0000000000000000000000000000000008c5e8dbb20065927e16e2bb3cd4afbc,
                0xfda447dc7bff1bd5b3310669ee604915c4211955d40084180e338d504c67fecb,
                0x0000000000000000000000000000000010d2dff7af4e7ab71e2c5a7f46981a7b,
                0x8d01ccbba3b4c4565f23cd5203ffeda33ab8ad52995d82f7131ef7d16f603a08
            );
        }
        if (index == 23) {
            return (
                0x0000000000000000000000000000000006714aa49eb4cf2dfcbab0053ffe5089,
                0xc4f785fd051a77f6b0ddb61791b755d3eb8ee6b39452bbf73d595237b9d7bc6f,
                0x0000000000000000000000000000000015f30b8146873d35ef650f7dbd47eaf0,
                0xcdae51652a4d2b37a090d4badfd035312205e504cf67a55286769e426141c094
            );
        }
        if (index == 24) {
            return (
                0x000000000000000000000000000000000bae166936107b3124738807668f37bf,
                0x951da1acb5d79b3882ce136b3075fade73e589d997b19de046fcbcabc01c5374,
                0x0000000000000000000000000000000013fc6b706e8f2a7a2fc4cfdf68c5e982,
                0xc7e9c6b973a6fd47cde4f28ed98bd7a1b02a11832d0b3ef0ad5eaab1817ed229
            );
        }
        if (index == 25) {
            return (
                0x0000000000000000000000000000000001d8cd4383ce616409a6f9296581437c,
                0x56a6dae348b10884fbc81e4291186976ea34b8f2962a5f37822a1f1a6d35c74c,
                0x000000000000000000000000000000001106226dabacc0cc28717a0a9b4fa970,
                0x21dceb09fc1f5f968fc196d96f4551f080fcbd2cda30039bfbefdf09aa0c85e8
            );
        }
        if (index == 26) {
            return (
                0x0000000000000000000000000000000017af7986df25fc2e0c831663325bcf40,
                0x4accd346c5cb3a896d868608fbcd3dcaa6195c31e7293de63017835565487d09,
                0x00000000000000000000000000000000047787c72c52774e25439048e056dedf,
                0x0e9b5cea6fa686a54f969623881f4cc63845e27a41585395792a1f83fc3eeaf9
            );
        }
        if (index == 27) {
            return (
                0x000000000000000000000000000000001541e433325d4c579f66a5429fcc022c,
                0x7641b92e9b9be94684c0a74dcf513bc094cbc82ccad4dc79477d1f113e5cb6c6,
                0x00000000000000000000000000000000184186928d906af802a732be18fdac5f,
                0x38cd95704922a3bc6facc0e4e0aa99226c73d663503716b54559127183436d3d
            );
        }
        if (index == 28) {
            return (
                0x0000000000000000000000000000000012dc93efce52a6983d4b6faa07fb1c25,
                0xf2664e73b0255336b31b1ae155ed1f1161f5af2ea0d5556075dda1f007062b67,
                0x0000000000000000000000000000000009d660141c72b8f5301fa54411acd660,
                0x38f307eddb00a1ff50108176c6373b0f6d244727e2b1331f3760251a6258fb9f
            );
        }
        if (index == 29) {
            return (
                0x000000000000000000000000000000000bfbf735c0f7df7f9729ee997012a07e,
                0x94ad48deb2a5feb47e868609750318e0503497b7ec8371fe286ec9935ba31bb9,
                0x0000000000000000000000000000000016f2e7e8795e4201d21ef06516fce3e4,
                0x8ff1666b6f8524b052677522f30cabee0b82b3acc7e87493dc22a89c39b03d8d
            );
        }
        if (index == 30) {
            return (
                0x0000000000000000000000000000000006da68870124c4b9fada8a3bafdd8d65,
                0x8a5ba41d65db3eea209dd7f0c8997ca64ff694ebb3ce7fa5e2718484e0ce8b2a,
                0x0000000000000000000000000000000001786e9afe2c8a9c9016b4a48857d1b7,
                0xcd7c620805c297c64ba204baddafc28bb115997da776b581d540453122b22f33
            );
        }
        if (index == 31) {
            return (
                0x0000000000000000000000000000000004662dc0cf3df3872be081adeb169ed1,
                0x323cf78c05645deba62573b19792134b62a17c9f30bea99b1e5a11bb9f39b4c5,
                0x00000000000000000000000000000000022b3eef92eb6df872cb17f142341cff,
                0x6cc9c97a5ced2d77b826bc016925076d43255b41e968c55625dc816aa4bfe94e
            );
        }
        if (index == 32) {
            return (
                0x000000000000000000000000000000000f37b3302124df0e181a5909ce0aef08,
                0x05951bca0804d15f7e640f7034e9a4cabc55eb754fd0b30df39005dc876cb565,
                0x0000000000000000000000000000000006c4673a33c9bd316dc82432759ff83e,
                0xdc75a76e84ddec23de08788773f261d54dfca5cbb5d858579ebce420718b5c63
            );
        }
        if (index == 33) {
            return (
                0x0000000000000000000000000000000007472916f6c4ff3f080fa62dd361f357,
                0xac2bc9ee8cc37f81191b312091cb5a074e26b5dc1dcfd1ae72d5ef5b2d7fce32,
                0x000000000000000000000000000000000944aa6e054611b7078fd28f1a9d8108,
                0xa5ba88cac5289f94a35ce683ee9c11c913c8154719db938fc8ebd670a6076184
            );
        }
        if (index == 34) {
            return (
                0x0000000000000000000000000000000016d8a30501263760dd0bd7b4667b9eaa,
                0x78d7b34b8cac9f838be4a97e6abdab47a4883d202c39069e55cc3bbcebfbfc28,
                0x0000000000000000000000000000000005e911727443d4265a2fce0914ad223a,
                0x8fa1937f1000550961d047f9760918c70c9379d4b334ec86e48966994d72d87b
            );
        }
        if (index == 35) {
            return (
                0x00000000000000000000000000000000026aeafb83d1818758f2bc68271d38b0,
                0xd485c4dbc6b0bde3ea17565a41d068e7b82180635a738844b738b9aa15615efa,
                0x00000000000000000000000000000000192652d0a7fbcd8f0231e475a9ef246c,
                0x36452fbf1a0bc59901e6905bc8f03a7f4ce042b344ed3333dd814f05b1e87eee
            );
        }
        if (index == 36) {
            return (
                0x00000000000000000000000000000000080d9e86abb135d8355d448ce16ab008,
                0x13014b51b63d9b85d0158682db994774b52bdf9ab447922f19a0afc0c8b32c73,
                0x00000000000000000000000000000000053e2b02ac5a6327bb66b9924f15fe59,
                0x9b53dfbef4354bcea3c1a1fdaabfccb5d7a6f40139aaa7233a27ff5fda5dccb2
            );
        }
        if (index == 37) {
            return (
                0x0000000000000000000000000000000003b561e84ef8292c3da66823a05656b2,
                0x21063a091b6d5d4da823e45e42fe6413d4bfc4e60e4b37edafe0c0e6aa40c417,
                0x00000000000000000000000000000000056f1a3ecaba2c36f58e4979191e1746,
                0xcdf9e944ba76d8a538d1f1b3813cb3f1a4673bc567724e041d52ebd2e4f59563
            );
        }
        if (index == 38) {
            return (
                0x0000000000000000000000000000000005b6e8577baf786a9ef1bf1f256c2741,
                0x1982bc4f4f7d42504cddc1e1263b4f15c5036bd583e8a5ec3fd71d4cbf94a7f0,
                0x0000000000000000000000000000000012cf4cd92f56243b30b10771bf2437a4,
                0x2fd2e9be6b36b1118a646a26ec4c31b82a5b2f92ac1ea5a54b24202a08bbfec3
            );
        }
        if (index == 39) {
            return (
                0x000000000000000000000000000000001468f85fd032b5fc460683a385eea02e,
                0x0b73b7069de517ca5bcd09b37f7dc296e228c19a69fe558f44bc333e05bef7eb,
                0x000000000000000000000000000000000c6c956e1ea6b2d91e56a5d8262c691b,
                0x0848c694a7f791fd49ad1f3eee287463a24e61c1204ba96e8ac5a48db5590c29
            );
        }
        if (index == 40) {
            return (
                0x0000000000000000000000000000000017cb0887f0e130a86f6b446940e0395e,
                0xc57c5948c5d538d61303b175fcfe0dbb95c3ead648a37d4c96fa9feb717a5d2d,
                0x0000000000000000000000000000000007141ba98e5af768675e2791ce67cebe,
                0x4923ab455f356170e43493d3c8939afff7784a86fb80ce0e2079d0de034df4b8
            );
        }
        if (index == 41) {
            return (
                0x000000000000000000000000000000000b550028982b3e01cb4574a012d6ddea,
                0x7ce04d56706cb346389d6397abddfd60284dd858bd8933f4700beccc5a252dc9,
                0x000000000000000000000000000000000010a5c2c1119b27c01e8ca4ea8220f7,
                0x9a40b9f98803644860ce9c1fbc22bf6a54d11e2159353799f9c077d5f644a3a2
            );
        }
        if (index == 42) {
            return (
                0x000000000000000000000000000000000840b67d96e505cba031a4025011a21d,
                0xa1710ebb28b86f035805792c59b3190cf0c8facc13dc94881cca843448db469a,
                0x0000000000000000000000000000000009e213c5f8f14c4f63168650f95cb48a,
                0x46009b601104cd63c4d5eeb7ffeebac88aa627219a8a2f95de0eb96664b19cb0
            );
        }
        if (index == 43) {
            return (
                0x00000000000000000000000000000000072ed206e9f861ae94ae743aa5080a6a,
                0x66474d464fd0aa4406785c377e25de1fb85dc007a87a762dd4d10644b5f5663c,
                0x0000000000000000000000000000000000f2b973e54a07f27a144a6ee97df314,
                0x4c0c23946b5c5ef339c9d455c43bdb29cef38742f9725787fdb36e670fb8b9f0
            );
        }
        if (index == 44) {
            return (
                0x0000000000000000000000000000000004143bd916d4a26290796bf3724a5ab2,
                0xd005be3682170682ac1f96f0585047edba866a5244579e73899716679fe84014,
                0x0000000000000000000000000000000009f271daa568c1ec8b5a37b1f5486076,
                0xc631b486e2369a0d61f38cfaa7a3d89dac4d113bb5bf124927a36275ce2e3e55
            );
        }
        if (index == 45) {
            return (
                0x000000000000000000000000000000001831ae8b31ed6025eef66651598c85f4,
                0xe847b014b448213e7baf46c867e8d75dc2f45c9ea5a4a64921c1c2dddcfdde04,
                0x000000000000000000000000000000000ddb75492a89b615a4c6f66034ab9f3f,
                0x9a9c01b2ab1923816627d8ad57c251b3fe8d8955a58647fda5f02ac4bfca5bba
            );
        }
        if (index == 46) {
            return (
                0x0000000000000000000000000000000018b227baef37a038d288ad9cbc98e917,
                0x8683424d7b7e29dc6512688dca0a9f7abe28f65e835bcdbffc1e7157994a47d5,
                0x000000000000000000000000000000000f844e5399a634f385fc5bb0bfc5e702,
                0x5844b2828aef9405fbfd00982f4aff7215e51850e8ac2f78a79ef27cb1b84ecb
            );
        }
        if (index == 47) {
            return (
                0x000000000000000000000000000000000222158b31432909f2f01e7e223894fa,
                0x4e7e217df02b01d6312acf640cd4ebd0785347e96c407051a5947c3e4c22e257,
                0x000000000000000000000000000000000a0c1dbc99804314f5939b9902588ea9,
                0x24f50e5c9edbdb3fa6a745bb281fe1b55fd3d296deab7370c6cf7e03e768a267
            );
        }
        if (index == 48) {
            return (
                0x00000000000000000000000000000000146b86ee02e4a58afc0c41d98a9fe957,
                0x92e99e1de64b6f0469d285597c28bd06261714e43de2781642609b4f690b7fc4,
                0x0000000000000000000000000000000013f3d18609847343630e80bb95444556,
                0xe793351b5217ebeb373b6f4cffa64f969a40ee31c4ada19ef6d0486b20c84a53
            );
        }
        if (index == 49) {
            return (
                0x0000000000000000000000000000000001e0fdb506e82e66c8d292ebf4940ebe,
                0xb473b3837be5a85e1aad8d4e134bbc2b4250828dd4e308c111d6431806d82e06,
                0x000000000000000000000000000000000c12a47353e6f2fe1d5d550d3326c124,
                0x5504b6a8c151028e73c48027a929eafe878a562025176cea8cde3c787000e90b
            );
        }
        if (index == 50) {
            return (
                0x000000000000000000000000000000001521e38fcdc27ee1b9c40eb5815c320a,
                0x5eab543ff95134c8df0a43ed2ff42ccd6c3357f8e8d3a4f5a7e071ce00ee4121,
                0x000000000000000000000000000000000771408b04b3ba1913296d1190ec672c,
                0xb5211d54d62cacecbbdbe4a21b7afdbda33792ef6383cf1515dfc014ad2f090a
            );
        }
        if (index == 51) {
            return (
                0x0000000000000000000000000000000013a06a8ac393e6d3f0f1bbbc331a2849,
                0x7b57238cf6a6ba9410652b30e045c54c442cc0c4e35d95997c9323dce1961ea5,
                0x000000000000000000000000000000001535c818f245ab82cf8c16fbfb64cc33,
                0x5f37eacc96b9e77a7b3e2f644ffdc2f73e712b3c0c5b2bcc93bcdfdfcf4260c2
            );
        }
        if (index == 52) {
            return (
                0x0000000000000000000000000000000009b37dd8a537c33d9fbcf4d1d294fff6,
                0x3664e201fd9049628ca68b414c57369e0a5331bae977badb2debe4a696387e45,
                0x00000000000000000000000000000000069454a35a2bed15f8338b341ba0cdd5,
                0xf6ebb02491b81465c684de5977148b1dbff45d023f420a5be911b0bec80763ad
            );
        }
        if (index == 53) {
            return (
                0x000000000000000000000000000000001923cc40e6f506417490e7e7afdab5f4,
                0xf2d2ac2c8ab74335c0f33a4461e0bc869adcb322073590fda6dc33e534844be8,
                0x000000000000000000000000000000000ce43965e2a066ea2053ac42666bc5f4,
                0xa5b3ea9f07cc227b9e1ecf72dc8529819a878ec43ab7be6f6293805f5813b37f
            );
        }
        if (index == 54) {
            return (
                0x00000000000000000000000000000000136fa932884330963426a195ab3d90ef,
                0xf65a49bb75b0b7327df26fade022e73b3a09994d993968da20eb3014f84b80ca,
                0x0000000000000000000000000000000011eb23793793fa4b2cc3c2c645872546,
                0x79f895f50e77127b2903f2732161eca01cb9e6d7089ad8701f57e8f808cddecd
            );
        }
        if (index == 55) {
            return (
                0x00000000000000000000000000000000129b288a9221c82b78bd1bcefc1e8699,
                0x06f406837d4c8403f60d8c9a74b4b0365a223152cc2c3b6e0462d224c6ab6fe3,
                0x00000000000000000000000000000000056be125af8b41a98815522e2a3e6d8b,
                0x9aee00a2ab239ad1bf2318813a9fa798259883e0aa28e8c287777425eee0b0d1
            );
        }
        if (index == 56) {
            return (
                0x000000000000000000000000000000000e262d011e6ac1d4fd28cc811b5653dc,
                0x754650c6f8ec630985d18a99793195f35e95f7c6c72f76fbdb9f93ed4b9ebd18,
                0x0000000000000000000000000000000013d910a206591289f94715de3b2cdcda,
                0x8dacbfbb201664a3850b2fc353cc6257ae0dda911a6da6db35fc037b55047cef
            );
        }
        if (index == 57) {
            return (
                0x0000000000000000000000000000000012d3fe56eea91b72b10e5c32f8762837,
                0x2ded9da110458fe939cb5f51ed79b14de61970e6a4006a16af18d9ef04cf448a,
                0x000000000000000000000000000000001811c9262e82bdf89b513f73c34e3350,
                0x20bf3718a027a12f1f2a486951b47d33818aa7a29bf0f257bd6fbab9da910e9e
            );
        }
        if (index == 58) {
            return (
                0x00000000000000000000000000000000142efd9b3d2ecee8ec83c9cabe99a865,
                0x31060cc236c10819a569bbf17835e62355cc0d1cf7f3e5336d07e3d92e79ca83,
                0x0000000000000000000000000000000003f6a64d56ace1ccc22c475b86a4a9ab,
                0x1630f7f2fe95c1c0a6092c7d790ca681fc011d666f99428004119c7680fa8560
            );
        }
        if (index == 59) {
            return (
                0x00000000000000000000000000000000145595180453fe2a7a35cf3462bbef75,
                0x4542ed57dfd3c9d0a57acba52ef766bc16ea9f6ea830a8c12cd39f216b7b652a,
                0x000000000000000000000000000000000eb3c78dbc61f0d28280214353aee8d0,
                0xe5008620aca10e85a27662c1b650a3b1f4db3a1a0975d20a4414912bbae1b076
            );
        }
        if (index == 60) {
            return (
                0x000000000000000000000000000000000980dfba892bb6d122e0ba808d0c1258,
                0x17559887536a27629382bad0cf5b1cb6c2f9a00ce9f9d2b03644a50fc54f8fb6,
                0x000000000000000000000000000000000470ac4a94006342e067fae45b60e059,
                0x078b70afe54260adcb5a0e3ec3936a6eae1172d3e9760cd274d4ec444bafcc64
            );
        }
        if (index == 61) {
            return (
                0x0000000000000000000000000000000007b209574c63dbd91b73d7fc97fde09d,
                0x61019bedc88d489a0da9104adc6e7a78f480cb417e681c8a4deb17551b3bc41a,
                0x000000000000000000000000000000000e602eccc2bde1c44060f5d7e4bc4a9b,
                0x89b17b7f5981de54de41b6c8ab63603d52779e5b729875901099e2123b15d07c
            );
        }
        if (index == 62) {
            return (
                0x000000000000000000000000000000000c3255bbb5116bfd3e61e86478c42171,
                0xb1271d5abfe68a0778b24e13523f3702cc2563b6918b4105fe6ad39497125459,
                0x000000000000000000000000000000001617ca3a3ee3e5d43c511eb334d4995f,
                0x16e7a1532c4e0938a0190464a30a72e86578880b567489b08231aeee00fce352
            );
        }
        if (index == 63) {
            return (
                0x000000000000000000000000000000000f99d94003bf35a41b777d933d9986f3,
                0x51c0a7ab2fce0db4d9b0bebb4a173e32a070b04abbedbfdf99e0403a69cf87cf,
                0x0000000000000000000000000000000002e97b9ff4e1a54c4194a435f6caa37a,
                0x85cd2ff3776040d143459a14fee7d84a92cb92432a19897e201844dff67c7cf4
            );
        }
        if (index == 64) {
            return (
                0x00000000000000000000000000000000024a76538d948fa02c02044cc1e1f4d6,
                0x8a7c1785d7ae77e5bbe56cc3983be208fa964fe607cb694940435a8d5f15d308,
                0x0000000000000000000000000000000009bfd04956a08c80d2ef7e1b3e8bea41,
                0x774360d43e6ab5d39a4f9732d370dd0ba3f9bee733b5e35f331e1a8fee5fe917
            );
        }
        if (index == 65) {
            return (
                0x00000000000000000000000000000000049d721b3645146c1f3dbc0d9b5b9898,
                0x86a2838dc5047a65127732bd43fa1422556e1f431c376a02f706c42021bb92a9,
                0x0000000000000000000000000000000005f6a7b67d850b1d213f6ac649c515b2,
                0x3e70656f52cdad82178d4309fd504972b86f7f2b954a1fdbf0978c6f0851052b
            );
        }
        if (index == 66) {
            return (
                0x00000000000000000000000000000000082856bea0ef94082480e0fd6cb37586,
                0xf265e5f91705738b744f68ab0f5556c1f2b9d40396fee61e61728417d9f0aa0e,
                0x0000000000000000000000000000000001c458070ad6611cf699f3d457ed63c2,
                0xe34373911d80b262fd59fbd8d4456f849acb66f820d9f392559e5067ce0266a1
            );
        }
        if (index == 67) {
            return (
                0x0000000000000000000000000000000000ba0304cf075494ada4c1cb7dc53be7,
                0xd5f25d75e14df71c69cb3d7e7797f8883165987adc6c21234511f02e8570e230,
                0x000000000000000000000000000000000d7efea8bd255e2d26921a8410b80b9b,
                0x2507a2d4546034095292844d5fd481fc7813d80a01a89221616ac40f8780c012
            );
        }
        if (index == 68) {
            return (
                0x000000000000000000000000000000001922c80d7a5ae31dcca318c5b07bb4a1,
                0x3e152655d44dfd9dc39b5ee747dccec7b0f0a5810496d2bca448b516f5a914f8,
                0x0000000000000000000000000000000009a1de8e4c80191821465e98869eb30d,
                0x3b5437508543a6fdabfbf4971d4376c1023346ee7dbce69133d6304c3040c0b8
            );
        }
        if (index == 69) {
            return (
                0x000000000000000000000000000000000c3af3263cc107deab7d0e7ddce4efe3,
                0x9e73f04de2ccdefff5e43e997f82467af0a3038fcd8ff920638726701cdd4895,
                0x00000000000000000000000000000000041a30ab7408c8503cbc9e5ebf0cd171,
                0xa58eca0a037f0104f9ff6de54596fe661fd27cbd019df23a00e5daaa7d8e189b
            );
        }
        if (index == 70) {
            return (
                0x00000000000000000000000000000000107881efda31f890a898ab5697568cb2,
                0xefbed5b604d9381c2cc7b1740cda7323ab58fccc137f4c25f20efd7a561e8957,
                0x000000000000000000000000000000000a63d8169d7a158b21d7819f3f5d8d16,
                0x734e88a58e2701881b18acc2b887a6e77e911b880603c7341ad7fa2ebbccd609
            );
        }
        if (index == 71) {
            return (
                0x00000000000000000000000000000000052caa9934494338041d5f9f3af31ab0,
                0x027489b8186eb27e53e8b97c9f91a502c5abc163e88ef4dc0924caa36a05471b,
                0x0000000000000000000000000000000001c69ff528676f41f236b5ed57a03d4d,
                0x882026159afe8b57d830d69bcefe1a69248e01ee740bbb80715490b104c5c7e3
            );
        }
        if (index == 72) {
            return (
                0x0000000000000000000000000000000006aa8d98a4ed72d4cfe8641145243f9c,
                0xed05382720c50f2bf0ac22bcdb90baacf59c2202a688bcafc2b41f5fec7a532d,
                0x00000000000000000000000000000000143a3cf501e2461c3b63afe793b98cfd,
                0xe04a953d682f17970dfd14d97a36229e8d07e383872642e13ff0a7e634873b0e
            );
        }
        if (index == 73) {
            return (
                0x000000000000000000000000000000000cea041f4a24d0f8d44b48b557fcee4c,
                0x3b2d645666430a85c045cc3a174c3c5b6827379ac6d172b6811e9605e1613ae4,
                0x00000000000000000000000000000000001e0d14a998bb68ac7b8c2cab5813db,
                0x39d672bd6e18f21936fbfeb22b316efc7f369f7ca1e46a72fd83a99c40665617
            );
        }
        if (index == 74) {
            return (
                0x000000000000000000000000000000001380248c7519bcd42f76980ab6ed119e,
                0xdf193037400ea61c4e405e8fdde750af85a8739edd2f49a09bab80fe82f87fbf,
                0x00000000000000000000000000000000035f1cf009f5394628209c0f29b1e3a3,
                0xc46a951819fe2976885c38fb37e3d840f92f25c620ceddc91acb32df5ba55078
            );
        }
        if (index == 75) {
            return (
                0x00000000000000000000000000000000130b3b44c5a8638666af26dd5023e316,
                0x0a7c923f97bd53f97c19118b162ae51e7661fa3154fbe366084be826fc883576,
                0x0000000000000000000000000000000014e6f40cc980aac915fabaa94cc3a34e,
                0x8938e7cb7cb3e5d004920e4855dd6cbcbcab38f0c5178d03999266872e9decac
            );
        }
        if (index == 76) {
            return (
                0x0000000000000000000000000000000012b28d2edd7fbcb2f79a8542acf3f42f,
                0x5e15a92fd26cf77963ea06c6d96bab16a1e4fff33871f1c470084c2f389a4777,
                0x0000000000000000000000000000000003a0b11469da068c7d5735db3dd37e29,
                0x59ebeed985d8e4974997d4c9a0122900b4679ca1f23b29e5d9cfb8cc6796af64
            );
        }
        if (index == 77) {
            return (
                0x000000000000000000000000000000000846787e0f197da4c989ef2b2382fb09,
                0x3f91dff58840101dea5a81899f0e31a0cf9d619f3b0545205886d0c98c4daad1,
                0x000000000000000000000000000000000c5944706c741b3f6d9e4014a5cca5e9,
                0x9db184765e7a2accfbdebe8a7e15648779b0bb9fc38b99b6b96a78b5af517b0f
            );
        }
        if (index == 78) {
            return (
                0x000000000000000000000000000000001474b53f98e859c11c00b66391da4e67,
                0x4f24afcf407a857f9cbc3ad1edb4e26fe0e5ff0d0f9952a06fbd6b037f118b25,
                0x0000000000000000000000000000000004c7680a4838153feffa02310a2446fd,
                0x60e8613d23b480c35c10140325b4c3187c685e17d5bf97aa0c2dcad4a498db1f
            );
        }
        if (index == 79) {
            return (
                0x000000000000000000000000000000000b2b53aef371c194eee18630e87af946,
                0x982f05c8f3c1c9660a0f378d1b46cf81a443acea5853dd5a8079206e33157a13,
                0x0000000000000000000000000000000012cb47f9c0c57d0ee19fa2d777b67923,
                0x9af9a70cc86e3e8e5368325ac889da29b7a0340cd6ac61c12bdd2dde9289a651
            );
        }
        if (index == 80) {
            return (
                0x000000000000000000000000000000000f219a58acba71a7178586073aef3162,
                0x64e8fca0509eaf17f50ae7d453511a18011842d1689a499061022733834e4d73,
                0x000000000000000000000000000000001911f3fba88de2306c68a34c4b5eb168,
                0xff33ad9dba7f6f4a682cbd36cebfacaaa522d984de3a128bde53a0f5ea99d261
            );
        }
        if (index == 81) {
            return (
                0x00000000000000000000000000000000081e73eac6702d9f9a86f18d1dc0d5fe,
                0x683ffbefedf3a22a8d23d124ea1a40713004b69483c1f29f18995486a26f5c0a,
                0x000000000000000000000000000000000e87f30d1906243a3d0934d2dc56b833,
                0xe3be93228a32c0f91995cc01616658565846bc34a326a8028829d5380f34f8b4
            );
        }
        if (index == 82) {
            return (
                0x00000000000000000000000000000000132d2733329265012d712734192a0ba9,
                0x8d09bd13e6769a903b42bf07a542002b3a86bc201fb4180fc447e32c98d15a6e,
                0x00000000000000000000000000000000017b78b11c7b728938dffe43d293d700,
                0x23d20acfd93e9f51c0d2df05afed3d7c5494f43a3db0b7d35cd1e1ddcb63a931
            );
        }
        if (index == 83) {
            return (
                0x0000000000000000000000000000000014fdf0a0d839b54928a3f3190717c838,
                0xf99aed81b0c5b19d778029c15f1716a94618ff2a0b04d5ba82c80b6c79b616fb,
                0x00000000000000000000000000000000171c6e3abae712aeff00563d6f582456,
                0xe92b967b9bcfbee5f11d9f55e1ef23734bca1df5964cdd17f7025a89aabc6f7e
            );
        }
        if (index == 84) {
            return (
                0x000000000000000000000000000000000b8898b34cc5889c5bd02a20d9f83974,
                0x5325de8522be108b5c57011cce51eacc29064a6e612adf9e81feee3108eb3777,
                0x0000000000000000000000000000000015c9a88c20e712e45d77ce77024509bc,
                0x3fbb7f69605a9f414da31c0bc2227c514738c90dd29ac28f3ce00de997ea54aa
            );
        }
        if (index == 85) {
            return (
                0x000000000000000000000000000000001036c01af0ecf7313cfdc09549cd56b1,
                0x4ab0b804539000ef260225a6716744a7fb539c777df98162c2a9f5739ea51588,
                0x000000000000000000000000000000000e18975c2c9a453f7ec585abee7742e7,
                0xf863eff39a2599592c9a2f3b4a91e274fd37acd47ca9f51c769734fb288221f6
            );
        }
        if (index == 86) {
            return (
                0x00000000000000000000000000000000103e9436754811e1f2ebef1f74c43885,
                0xf6b29ae9a826dff5f9dd473451573b1f2d93905b824d02567e02930a283b9089,
                0x000000000000000000000000000000000523d6d1c06e67d2c56b54447709dbf0,
                0x4dd781dc4ab648ac211ee601fa1a010a09863a1b0106bf45fce562e52bca83c8
            );
        }
        if (index == 87) {
            return (
                0x000000000000000000000000000000000c0db793f60fae0a5ab145628fd9fa35,
                0x68b00d7c1068e33d647bd50a29c27d5b514a02fd0bc1736241c13bcdcac57e8c,
                0x0000000000000000000000000000000003fb5ce7d23eb0fc12855a9760eee15b,
                0xcaed080df0ca615c4948002c4644464df45c13a06c693799306d858f3dff3fbe
            );
        }
        if (index == 88) {
            return (
                0x000000000000000000000000000000000e44fc6b270a10f536e6ab1477b95486,
                0x7f2c5d560b743b11e90dbf645b39fe9151242a5e0cc9000f4332fefc2bcd2012,
                0x000000000000000000000000000000000a6ade38906049998f2393232817feaa,
                0x97352b2d46f45b018e1f3d0f0dd574180e3586c19fcf910805e9a7d8d241bcad
            );
        }
        if (index == 89) {
            return (
                0x0000000000000000000000000000000006c697593ae8b6b41445d76282a3e03c,
                0x516aa3f4d9e5597e44ffa929d94ebd9403f6f17f74057f8a52c19b4807d18ee5,
                0x0000000000000000000000000000000016cad077b8b00f6b6246f4b32e46b5bb,
                0xb4dd6cb6011d3172236654099eff4d6c20e82b8081461de67bdfb374c4cfa166
            );
        }
        if (index == 90) {
            return (
                0x00000000000000000000000000000000060e7083aa8bdd0617b2961e29b7ae3a,
                0x11edb37333d417b7c33e62459464f92dc735ce240ada05f98daac780df4bf3fa,
                0x00000000000000000000000000000000060bea70eaba83bcbf61e53f73361750,
                0xd93efb769f4e1269b4b040d5f19bbb141953521c87066f36b3cef920d631e530
            );
        }
        if (index == 91) {
            return (
                0x0000000000000000000000000000000010a2136d421480121096a64313e72c1b,
                0x347dcb17d847d7fb7d785a3da5692e925af0a02a33fbace5ab5ba3bb5d91a45e,
                0x000000000000000000000000000000000b3ccc9062e213763af5100b77977bef,
                0xa33357c6f39786f9c0f6ea98a9dd8c85d4fab5294b5914edd22a4a1ca492db59
            );
        }
        if (index == 92) {
            return (
                0x00000000000000000000000000000000017402928f767953a7fa49c62075349c,
                0xb43026867537e4ed7180f5262b6e89928bb0fbab6729347a2d7a04345960eeff,
                0x0000000000000000000000000000000018cf71de44b83d1c0900ca05e485b64e,
                0xc81cee8547254ca9e99b409ba5ea50f68a6b053358e09eec9975f512ae433ac6
            );
        }
        if (index == 93) {
            return (
                0x0000000000000000000000000000000006e2dc3c7670b0ada63fdc7f9b19aa0e,
                0xe541528025cee756babe2c63d4cfc876fb984c85e7bd09e90e53d0c4f539e333,
                0x0000000000000000000000000000000002e6eb36de5c1510ed8a2d8d4b9dad6d,
                0x0c3673ca04144986c3e42b69a318e6c003c5bfcdbaebd3ec8d8357612dabb432
            );
        }
        if (index == 94) {
            return (
                0x000000000000000000000000000000000e7d313104daf0811cbd56263a4c83eb,
                0x6355ddbf24639808bd26d0ef4a4b83dfb394b8f9a26025d2dcf1b5e2a843ca3a,
                0x00000000000000000000000000000000048568eaf715fd38e9054255d30696ce,
                0xe8b5daf36ff446df6f4d0bd5acb9fe3b53b8150a44aa6c4ee7556fda340f5d77
            );
        }
        if (index == 95) {
            return (
                0x000000000000000000000000000000000f06ad825d6b542138579124c0521899,
                0xaa4de483063712eee424fbca844421a96efb4e518c3400da49a699454829f630,
                0x000000000000000000000000000000001140e328fcca2c72171b9a5539c86457,
                0xed434ef38c021b23fad07834661825b00bf8afa39ee8eb213f9b5464448ce7ff
            );
        }
        if (index == 96) {
            return (
                0x0000000000000000000000000000000012a61638e354914f900179fa0f303d54,
                0xfa602f4deb5884f0ec2034b87a3233b24b726ec529d79f91201722672780ee33,
                0x00000000000000000000000000000000185bfbf63e43c22b37004f9d5d337382,
                0x94af47ce99f1f14f1e259632554e1970e93348b6524511a8af132f97c4cb40e1
            );
        }
        if (index == 97) {
            return (
                0x00000000000000000000000000000000110d509449c90d7c4b7d419f7284b22b,
                0x321baae7891b8da53c737765754ed1a01669c9829dc68db176f2e3a1490d64d0,
                0x0000000000000000000000000000000009df82a9a6a8b2dcf262e4081496e300,
                0xf41e47eb2d4582c8230848c8bae145dd972e5cdef648795a6876d751502e0a32
            );
        }
        if (index == 98) {
            return (
                0x000000000000000000000000000000000ae5be76dcdeafe6a5062e28e686d8ff,
                0x311c2f3994e81130c318172a114ba1b2defc3c7126593992b9df4b92ba189837,
                0x000000000000000000000000000000000a1be113e31fdb651c8e846d38ed62d4,
                0xaa3f8485a1e24f34ea1b2a9c74b4e274e6d3bbaa753008e9a563f25cdc22c1fd
            );
        }
        if (index == 99) {
            return (
                0x00000000000000000000000000000000109a56d12c9bc5c6ccdf5ae4c44f70d1,
                0x4e6a650b25dea0bb6b8233de62bc9f3ca970231c5dad18fe99159be165bdce8d,
                0x000000000000000000000000000000000b830520b9f593b52b58ed890af19961,
                0xad25af14e8d2ba61c4775637c963b7d31281b7a00cee960cbb3297eacf06f640
            );
        }
        if (index == 100) {
            return (
                0x0000000000000000000000000000000019fe6386c15cf47cfcacb2f8b264ac71,
                0xcb1aa2f3ba56f8bdfa6adfb805c7f4e014d221a6655499ca2c9c4bf2c8ed176d,
                0x0000000000000000000000000000000011d79a8fbb129d454a86767d3b591f56,
                0x6e005527ac61d33a1466a96599d69ed0db021feb3fa726faf04c11b08e4c7fd1
            );
        }
        if (index == 101) {
            return (
                0x0000000000000000000000000000000005b6e936c48c78122c58cd3679396548,
                0x94085fd19b3d3771759cdca3d6b85ecf4c0a2bae0ca14aa77ef13c51b2546433,
                0x0000000000000000000000000000000006e1fca862049b6ba6dbddb91fa0b797,
                0x16d5c647d671654669e0724f098c320ad327cf67eb2f69e9c208b60b29905968
            );
        }
        if (index == 102) {
            return (
                0x000000000000000000000000000000000ea2f48cf628aaed9bbf79b307eff11d,
                0xf3af3f67e98236cba3be70124d994ff20fa07129620bec910d6b318ebbeb26c6,
                0x0000000000000000000000000000000007974a841fa72486edc52024e3914714,
                0xafee34400d4ef676485d6fd22cd6c8004cb3382d95fe2a563aead7557b022949
            );
        }
        if (index == 103) {
            return (
                0x0000000000000000000000000000000012ac09949f9e26a08e4cbd59cdcf1f77,
                0x135b2093a58fe5db8aeb2eb990ad767d55775130fc222a2a3584817078cab92d,
                0x000000000000000000000000000000000e973cbd3ab7456f307eb91609ec5d83,
                0x7cd8ad37e941f82973624db701accc36356faaec61d0fd9883bfc392b60b03b1
            );
        }
        if (index == 104) {
            return (
                0x000000000000000000000000000000000ac317ce9594f0ebabfe65600b796b43,
                0x2c3d1ddc0badcf277e9c24c0e6f2c3a2b2e6c3b11e969aedf984d15975d84925,
                0x0000000000000000000000000000000010949b189161498782eff94557ceff3d,
                0xc45ca87ff4fd21d5c99de7734f47544932a3677f88ed77211dd3ad72840034b6
            );
        }
        if (index == 105) {
            return (
                0x000000000000000000000000000000000567502152399b741f926759c784a0af,
                0xcf71e4ec81935b12ba164c44f8e2960263421cf12a02d85695a09847b449d857,
                0x000000000000000000000000000000000f08fbbe29cb8616869bac2d9d46abfe,
                0xe78a477c823089e6c1794834e6892b272b456d3b28fefa1858d315712cbfd55b
            );
        }
        if (index == 106) {
            return (
                0x000000000000000000000000000000000ca5ab59829126d55fb05d4618c7b7e2,
                0x1f5901407beebb1d5a7748a01fb700ab1cb69734bc349447a2d436c58953ecfb,
                0x0000000000000000000000000000000001fe230432cf7bc0e3d8534f7e37bc8a,
                0x3d3a613b3060ca58c31b848394da7b44c0b18c909ca71cf46923acba314c8342
            );
        }
        if (index == 107) {
            return (
                0x0000000000000000000000000000000007dbbf0bcf91619d30f8b96299df83be,
                0x63ce42a54a39d96bf5b8deaef4862db6a6b61fc60fdacedaccc727acd9f7a984,
                0x000000000000000000000000000000001447b2ded9af18fe2318be5a85f4c6e1,
                0xa944133f3c2576dcbdce9e989da12e03d76e06bad7d717ba2380a2a425627b5c
            );
        }
        if (index == 108) {
            return (
                0x00000000000000000000000000000000129d14510d453b4fef49652a27c81373,
                0x08a08b2868355a1b9002230c6acfa7308b43d61b84825a082f07ab218d7f0914,
                0x00000000000000000000000000000000192b0861fd306f02eb72245009eb9c96,
                0xad2b0f90bd22dbf9cd6b368efaad4cfcd94e4b91ec01d7b00542c141cdb3ab85
            );
        }
        if (index == 109) {
            return (
                0x0000000000000000000000000000000012ae8231a25680c4c4ff748182644565,
                0xe859ff0a682968863c2b88e1002b21e1088e34f7d67fa764ebdc07ebb547dc25,
                0x00000000000000000000000000000000114374341243bd7e5e2af2e5b1d5722f,
                0xe679dd3eeb1527b455c044594ad378ceac5827d27fc6246532b35bdb9f337f25
            );
        }
        if (index == 110) {
            return (
                0x00000000000000000000000000000000091f2fa905d4dfd85b92f832e9ee58ac,
                0x0cb2d00f2896083d1f6d665b48b3b76a7abe4a72362781010d444b2d95307b99,
                0x000000000000000000000000000000000e85a0c11475ebe3c26c4b416a74ae6e,
                0xb4f88f6a551c7b715647b135ea92290a5883e58056f7aafa3a4b23c48fb9dd00
            );
        }
        if (index == 111) {
            return (
                0x000000000000000000000000000000001978a1b853adb610b31059b8c41454c9,
                0x273f33ab0d0fee274432bd68ee81d44753c4205dd18e3c00289f20b97049cded,
                0x00000000000000000000000000000000025fb45cdda70071e33948b2ce8cd01a,
                0xb82761521b70884b894e6559bb1085e7c915673b00a8fc36e311e8b9117709e2
            );
        }
        if (index == 112) {
            return (
                0x0000000000000000000000000000000000fd592c13c3ae7d9abf9afb3d947ef2,
                0xf4d73ca62d2f814f5a3a84ef3444476180355d6bf4a9a541ec56d916e1b57949,
                0x0000000000000000000000000000000012bbcbee817149b75325de59aa77808b,
                0x9ebe0c75ee9e7358fbcad0093168f8f6d096168326acb3a5d9d82a5d6d1d9672
            );
        }
        if (index == 113) {
            return (
                0x000000000000000000000000000000000ff4b64c2c376e9c593ef62d91998d6c,
                0x10aae2307160a192472075b1bb3aa61932b6dbe0e4eb1b28d4bac2dd5fa61e67,
                0x000000000000000000000000000000000aebe5fb906375a3ee3bbdd88fb20022,
                0xfc17c5468efe3cb64638c74cf2c6fba8a9d34d764764db1c8d94d6baa81d74a5
            );
        }
        if (index == 114) {
            return (
                0x0000000000000000000000000000000018c931f7ee83ff8fb10a2eed1dc3ba5b,
                0x440567b6db609861b7286013d12beb80ed13492a2856019083089f3ecac16e83,
                0x00000000000000000000000000000000052d8cf0fe6349a254a46ac48341bfdb,
                0x4f0d73ed03acb31f30ed44033b821022b0f1d866cbec8919fcce661df85be9b9
            );
        }
        if (index == 115) {
            return (
                0x0000000000000000000000000000000000f1689f8d4a11f0ec88c3f21ac88f40,
                0xa7e2d7a785429d4353a36959f9f24e547a3972f2589a5f39e9ce8b06c5a82868,
                0x000000000000000000000000000000000441a63ed77ad640181e26c81570ecb7,
                0xf6ee2dad57639a597ea1d31b2a386d4b6b3ba8d773246a8b17889f14e1fc0af8
            );
        }
        if (index == 116) {
            return (
                0x000000000000000000000000000000001383f171eb477a4f0475cad0b5871f79,
                0xa2b35bcff77eb7e7dc28a8c8ac56b9ee3eeba6b2bc28acf9533b92388049221b,
                0x00000000000000000000000000000000080a9c48d53cea6978e6dc48314d3e0f,
                0x6a7390d8c2ac51ae89cd171687f91ac3041609e1258932e46cdf1ac274837aca
            );
        }
        if (index == 117) {
            return (
                0x0000000000000000000000000000000015ba7e24096e429ecd820ff89ffb9e92,
                0xf703b128b76bdc915e820ea00fe11144aa0cb97ef0e1020495ee8e5d3177bb9a,
                0x000000000000000000000000000000000031239fde44a9cde9e94b134f381c67,
                0xa438d3b278ee9d83dc80ec10a5432404dca3953e2ec6dcca3ba322f78ec51c59
            );
        }
        if (index == 118) {
            return (
                0x000000000000000000000000000000001351d9c4343a70b4390ea821892ca6c6,
                0x996e1dc78148f6d074182ad931a1a259cc2866af28f31176f45e4fa201f93819,
                0x0000000000000000000000000000000016e513fd7bda2ae179a518e518cc21b2,
                0x09f50e812ea529793224035224a543162f384b6f457f45a95106f5b6c7cd1d0a
            );
        }
        if (index == 119) {
            return (
                0x0000000000000000000000000000000009822192df4a2e42cd2b14d0d83226f2,
                0x4d3a00aaa03b0a23c463b8ee1a85e912cbffcd05f0996be13b3204d1f3fb20c1,
                0x0000000000000000000000000000000002b415dc1b87909d5134a8a11edc6e11,
                0x96342035f93ccdf6fcc1bfeb0e0d1d692d4c3a9f07b30fa4f2ac2013a8203e48
            );
        }
        if (index == 120) {
            return (
                0x0000000000000000000000000000000017aba2d41dbcb716da3acdd7b01d630b,
                0xd5fc925adbb2596d457c2de0bb3db0d7e4e402e4285a0c2a4f75f906063691ae,
                0x0000000000000000000000000000000009b0231f21f51569467954037e1436d5,
                0x5e47617ada48a05f315067243e55305cb548be0a315d826ffaf6df91a731b1e7
            );
        }
        if (index == 121) {
            return (
                0x0000000000000000000000000000000014dbc63fe67a252043d5459f84c573ba,
                0xac004b75761a1fb54a95c3ab843208e1adb0fa3cea0acf8151404306f370e355,
                0x000000000000000000000000000000000b7ad7e26b9fb6fc5bd0396f9ba1adc8,
                0x9fd630cc99a682c757381e5e00105a5f0828f367f081804861fc64fa71b018c5
            );
        }
        if (index == 122) {
            return (
                0x0000000000000000000000000000000018358a3b0b1eb9d8e63bba0e221c815e,
                0x56953327076e18e6d9f827c77bff4c812a7d995aad2c3394a1123ef0aa1fe93b,
                0x000000000000000000000000000000000396e76afebb4b33faa7d5d4f96e03e6,
                0x044dbda62f9fdf8b7581239dadcc1dcc14d79fef70eb04391357ebc771b975fb
            );
        }
        if (index == 123) {
            return (
                0x0000000000000000000000000000000016e0c4ec28897a464c3eb245fd766da2,
                0x870e7d5aa4720f62cadd84dc852c01187b9412979ee69c43552dad54ab4e1d39,
                0x0000000000000000000000000000000017bdab917f9736cadb229300412e11ac,
                0xdba1aceaf8bbbb50062de9b5a1d9c34cd22fb37bfa2977f6f20a80d5285c66dd
            );
        }
        if (index == 124) {
            return (
                0x00000000000000000000000000000000143e4213aa10001bfb5f4b0f8f86e2a2,
                0x786cf2f3d2953a3af1bc3599782b1fc5758dc68d65df3a5ce94cb996974270f0,
                0x0000000000000000000000000000000006f2559e6268513599f7545910273964,
                0x15917c133bc71590eed31e64e5c09b90988421cf04499230a30c13495389ce84
            );
        }
        if (index == 125) {
            return (
                0x000000000000000000000000000000000eeb60a3aeb147ff750fa1857051c094,
                0x367e96e81bc912e7545cff44a1c243702b7e8f397683cbb7c6209639860fdeef,
                0x000000000000000000000000000000000f527e2abb9fe03f49352f69d25cb648,
                0xaf0ffc741a906a4a7d3c6cd428047d4626097c85c6bb66c186cb98280823bd47
            );
        }
        if (index == 126) {
            return (
                0x00000000000000000000000000000000028f200331a8438a448b7054f7c3be4a,
                0x466cd6113821740a318d92ca3d20e190aeec81a21dde84aa9b6315c9d58b54d5,
                0x000000000000000000000000000000000671251aba253f6481fcfea93ed57892,
                0x4db53062d40e62ee51ae94e4b4235111f7e38f1dc8e62b7179ffe53012fc386b
            );
        }
        if (index == 127) {
            return (
                0x000000000000000000000000000000000f9a252fb27fc3af07fefaa554a7ee1d,
                0xcc3be3fecd8ad42e2e9daffc05e60fc182d95335384005b0b68e6d4ac9c2e281,
                0x0000000000000000000000000000000005f52de1dcd996ae97faf4c0c4e142f2,
                0xc463fbaeff8d68047af29e2a9b11ef85ca58fb96fe9fdbb27b4cc8aa6340aa1a
            );
        }
        if (index == 128) {
            return (
                0x000000000000000000000000000000000d7be6fa00421a6b56117b123ac3b5c6,
                0xff4426b416cb9b2dc3d333650386da8db43683bfd0ad15c6232a267a125cf69d,
                0x0000000000000000000000000000000015e4dd4077efbc353b8764189b715874,
                0x73ff2e2282b3541a08c817a754011b5c3012e0b64afa7c362b907a58b707cfc0
            );
        }
        revert("Invalid IC index for IC1");
    }
}



================================================
FILE: src/verifier/Groth16Verifier128LeavesIC2.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

contract Groth16Verifier128LeavesIC2 {
    function getIC2(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {
        if (index == 0) {
            return (
                0x00000000000000000000000000000000116067bf31efc6cdde622ed857ec2f40,
                0xa45f627747bd594cbe26051b21e86a34a3f7e5d40dcad29eade13be48b1c13f6,
                0x00000000000000000000000000000000021e9c0edd587df0d18489e0c8e77da9,
                0xcdcb408531a61af85924eb57ae081800cd31ceb0f5ecea74930447d7d0ef449f
            );
        }
        if (index == 1) {
            return (
                0x00000000000000000000000000000000043e4b3001acbbf4ea41efb72c91bd5c,
                0x1383f1ae2e64abb5406acfa0f6cf48f5e9a18e0e54a2e656339ff7d5cdacf6d9,
                0x0000000000000000000000000000000000580bc14f092d185ad27f3cbf8e8615,
                0x8650e529f8d2271630fd86923a79833c7e1a979150f4c25bc61552ca5f7c278c
            );
        }
        if (index == 2) {
            return (
                0x000000000000000000000000000000000e9835351eca53382cf45bf355df9a44,
                0xd68ff6538930a6e10430217dc3b813f6ab1d855cb912fa5382a91882d88e2fa5,
                0x00000000000000000000000000000000063dfd9f1a4f57d576d4bc2fbda240aa,
                0x8f9e284f4b2d9c7f57aab982a113ea21a3d3c11244d1a4de73be5c095154d8cd
            );
        }
        if (index == 3) {
            return (
                0x000000000000000000000000000000000a95873f2185a94bbd60c1d67e08799a,
                0x787a69adf11541a5015f2d920385675a817b37d1eb6a2db3d7277f330f726973,
                0x0000000000000000000000000000000004a54dcfb0df23148cd15edb6732f970,
                0x427fd583c3824c935936013621cd119e2077d24b5bbcbf153825459fe8ee27d4
            );
        }
        if (index == 4) {
            return (
                0x0000000000000000000000000000000019541b86462cb241ae9d08657acefc62,
                0xcd0452a7c393b52deb97af49ab3b640bcf10b364f92948b786605ce85a2132ab,
                0x000000000000000000000000000000000cb34cee0f6e450e8e7f7dd3fa3a3b4d,
                0xcac666ee607d7b014bab12caec1dda4b1a5c9d3a2b8248f44f20c034f5186d50
            );
        }
        if (index == 5) {
            return (
                0x00000000000000000000000000000000196f2e05d5a96c258e1abf9350d8ac03,
                0x91781920a3fec51c0afa40e2d493982bdac60eca02ea745582dbbae231681440,
                0x000000000000000000000000000000000531ba881bd5e4fdf0dcb827a1eec3ab,
                0xed4d2a40923e46835cd17e849cf6013eadf79bbcfe10ad46c9c6b910d70577cb
            );
        }
        if (index == 6) {
            return (
                0x0000000000000000000000000000000017cec66ce08c3cf4d89fb21473257d89,
                0xa5be15821f403ab7baddba6b3d1e362be0fe80d7a78061975814841bcbc5d20b,
                0x0000000000000000000000000000000019557d6654061b82a7f81eaa83cd0db2,
                0x16d0a8c789901fcd4e353e3e519db941ad3eb6a40f10864a2f8a2ad8965b73c0
            );
        }
        if (index == 7) {
            return (
                0x00000000000000000000000000000000160df5b09203e2ca78bf7fa73b3f0c6e,
                0xbe5d7f586a735e516b5079566501d90ad21a31dc28679c6cfb158e04100e9bda,
                0x000000000000000000000000000000000ab1f3fb77d077b598bd4549b2a88f65,
                0x6458147f0d93f9d8e8f8fe5fec0097eb5dbdbc621fe8beea562f96cc0683c1a0
            );
        }
        if (index == 8) {
            return (
                0x00000000000000000000000000000000016eb4d651236c4293ae89ea260f7500,
                0x6e7c784b0ca29be306e497ad5ed4817ba12fd599937405262c27146d87d390d6,
                0x000000000000000000000000000000000c24cd6cc1b7a4ae7e07c9bb77f913de,
                0x9dd65f467e3ea49d1b7f80889c848758d594872043cec2e454f046a3a449928d
            );
        }
        if (index == 9) {
            return (
                0x000000000000000000000000000000000304ece0a1028ba9c33808207df5f97c,
                0x3c0b933c41751d1a7e1219428657544ce37b94d7dbb465530a6ef3ceb54c0fb5,
                0x0000000000000000000000000000000010f8b302cc49143aae36d08f183bd541,
                0x0c7b6490bc12d9babea02dbf7577a7942a55d691436659a5ca8bb9470cad1005
            );
        }
        if (index == 10) {
            return (
                0x0000000000000000000000000000000004c14a7b4f15df82f4116e9f134f7757,
                0x55495c6dce6fe045b7db483582048c522e44ba189f8fb7b970343a1a9e89bb6c,
                0x00000000000000000000000000000000005d4ff8f2ddb52ab16cb590a795ae67,
                0xd5d014ad7d2520bed2f16f1ecf042430b0f2fb8ca8bf560e0a4dad760661ae1d
            );
        }
        if (index == 11) {
            return (
                0x00000000000000000000000000000000180c32df91d2139d3737943b2289d136,
                0x00e44cba5da1d8dada7e4c91144e0552e33c79822721692610d944bd2e0118af,
                0x0000000000000000000000000000000015e8a97c3651612fb039b5692275d4fc,
                0x3fd99e7d3baeaaf534a013ba58dc250fd3bc53e7fdfdd6ef58a0370ddfef6dcc
            );
        }
        if (index == 12) {
            return (
                0x0000000000000000000000000000000015d9fcc5ac7f25cfaa0cc55e5edc6385,
                0x4fd8299c9b06468e257b0afe062ddd1ebeaf607e44303e27726cdf43b54d4f73,
                0x0000000000000000000000000000000010b71b20c2af54bb924e3f2647f26b20,
                0x79027f46d5ed2200dccce47a0d490274412693f45edaf2adffe67413cb3b84e3
            );
        }
        if (index == 13) {
            return (
                0x000000000000000000000000000000000614ce094be10e138a0bed910bc90bf9,
                0xe0e872c9ac90f98a0c9353dddc70e350af7b1bd7341c46a9a5d48396bd056ce1,
                0x00000000000000000000000000000000143ad2fe195234ca6a016edf161133b0,
                0xc61859ae118fd707d96d110f93fe7dc8e7c19d51a5454908af3146a62d66a3dd
            );
        }
        if (index == 14) {
            return (
                0x0000000000000000000000000000000005bc165fe59bdcb0184ca74e7f0fbbe6,
                0x61ff6b24afd8ac95d885a098835a4726dfb76aa263ec39182fe4d030bc99aa07,
                0x0000000000000000000000000000000000ea191dd137f50ba76ed191783301aa,
                0xdaca97564a406e8fd9336529043d642b526eae183ed89e7970c3ebf09b7dfce1
            );
        }
        if (index == 15) {
            return (
                0x00000000000000000000000000000000137b4700f40db94bb251170ee94bfde7,
                0xac0f348c0a5e9a895c213450b2f1b7afc4431f73921d264c2ef5f7933e8717b4,
                0x0000000000000000000000000000000014d2db4b898bc8d2cf87f3f2dda9be76,
                0x3b436a76d1217b82f6a108e80a3539e355f4c6c598ffdf88a223a8bf56c7c087
            );
        }
        if (index == 16) {
            return (
                0x0000000000000000000000000000000013301289b46ddf1ad22cca137ba7c7a2,
                0x8afd9bf89f7e943ef4ac0a65523f741918d5696fcdd44e8179fb8a848dad09bb,
                0x0000000000000000000000000000000002442e81e91cb9986a10dcce8e48274c,
                0x676673fe85b0520c1243d39a513c934bd437a6b2dfe8d49e145db1e4b4ae0755
            );
        }
        if (index == 17) {
            return (
                0x000000000000000000000000000000001336491519675f93448a5c45f2892028,
                0x34870626cee87bd9bacbdb9ec33cf52c38d030ae59b977c09992a4732c46e222,
                0x000000000000000000000000000000000c75ee22825d921872b174477f993cc5,
                0xf7b827d6484d0e2432e035cab63e14c894ed580ecb48803f4338052b4548be77
            );
        }
        if (index == 18) {
            return (
                0x000000000000000000000000000000000f51c900f9ba1350d69de30d6a054e74,
                0x3c4debc9689ae2aba52ddbdf4ff20e2f93a8048671ed3678d78d6e0f1357f328,
                0x0000000000000000000000000000000003c4a1bdfc8028f7781692f4fbdd47f1,
                0x4fa104619851e6e2686ff03133fa4c8704de652132e1ec4d8c9280821973fe02
            );
        }
        if (index == 19) {
            return (
                0x0000000000000000000000000000000013d652e55a4b0c17448300f2d139b250,
                0x06c5e83d0791672b7843aa38aea1eed0d410c9c5bf9add955b1551d4520870c6,
                0x00000000000000000000000000000000135029f54c19c309b3275f4546166eaa,
                0xa990adfa1a4a1c5ce9158c8a84aa8fb90ddb2e8fdd029b52536364c40c654f19
            );
        }
        if (index == 20) {
            return (
                0x0000000000000000000000000000000019d4b11dbe1a2cf8a8602bbcc98ab558,
                0x34d346f0ac04078784da8194ade32188171ba191be9248e80e338b978602532e,
                0x0000000000000000000000000000000012185f0c5927166cf206a2a0b9ec2e52,
                0x509affa53368f1caea22f627d0053c513bbcc14d060544fd0210dd826f87b836
            );
        }
        if (index == 21) {
            return (
                0x0000000000000000000000000000000011ea323f2674c5b2517de7909afcee93,
                0x9cc975b5440913a352374fd80b6a8d0c5ff681f252d318cac113f3a29693ca6c,
                0x000000000000000000000000000000000c52dd5809a3949af4ca69c121d748ae,
                0x0a47cc6d03c68152b34469e3c000b5feb5338640ca55c0fbdd86b0484d8b0344
            );
        }
        if (index == 22) {
            return (
                0x00000000000000000000000000000000182915ea51e860981a0a2a6a0a0cb945,
                0x19b86e985e7f406b59c9a9f4e05ee8bfc273a89e8057bc1db4097c7a46d5dda5,
                0x0000000000000000000000000000000001bf18233fa0ef72f041f89e7b03d3f7,
                0xe969934a7715b5664c244cb8a058ba93320c37f629627a8cb1cd356ad0b2d0f3
            );
        }
        if (index == 23) {
            return (
                0x0000000000000000000000000000000015a3b4ef834939985b797c1d4a61161e,
                0x5961aa7009d03071206b0599db6bfb1093d3426ac7621783cc5545b4feab90ae,
                0x000000000000000000000000000000001786195f582cd05f52a507aaca31ba0c,
                0x2ae84fac4a6037378e7b8481ee31c12eb2ff3e056efcbaf39b366e0a3d507402
            );
        }
        if (index == 24) {
            return (
                0x000000000000000000000000000000000aa31f7feeb0735a8f9e08c869bdfbf4,
                0x050234b879dffee33fcc047b06794b27b779a51e95c5e9a7e6f6468c206f3f3f,
                0x00000000000000000000000000000000038601bebbbd35b3b13c45fc322d7c8f,
                0x77cc422339426f430e7894d4f4fb1a0fdf8e70b7fefa108a7301c7a35c80ac25
            );
        }
        if (index == 25) {
            return (
                0x00000000000000000000000000000000163cfb0d327d6a414be9b8f9f88b511e,
                0x9cdb7e060eb62aea6b08f70b9d5d8c1ed03ef0cec73483422445727cde65e509,
                0x00000000000000000000000000000000057ed36595678a9bb9c131868388ed6d,
                0xe3acfe7f9d90918de9fb228d6d292c33485ae5b27e72ea5ee0676e71e8ea588d
            );
        }
        if (index == 26) {
            return (
                0x000000000000000000000000000000000c194802df9e5e7b90a7d29d078066cb,
                0xa2995017314e50721d758b5f615002859a2ff2256263eff04a1a59a9e97502e8,
                0x000000000000000000000000000000000f3bcf9e0d4a7958f627fd91a889789f,
                0xf19946150214c741cf6fe3c743bf719244447a65b0b0a5753c57279dcf090760
            );
        }
        if (index == 27) {
            return (
                0x00000000000000000000000000000000099433baea80a9b89cd8b040066db983,
                0x540294cabbc8a5fc09e5038b3ddc2ceafde4e328780760d78a91bcd4645db0fd,
                0x00000000000000000000000000000000138050db62f9ded0ab2d3d6c0ce0d819,
                0x7243f85d96030f1a8d0bd57d05a7afcd0f7bae6cf53714f6bb6c5d28ba13e403
            );
        }
        if (index == 28) {
            return (
                0x0000000000000000000000000000000019cd71836716f2810871728124d1c82f,
                0x87d58247a902e9f53aba217ee656eceb44999f8bcfdbe098fe8ea20af2829977,
                0x0000000000000000000000000000000001f29aee4445e8cb84698675161ca3f2,
                0xf07930dc167a998a8fc714cd07c44fc66c37dd86930142af32a9dde5c8e6deef
            );
        }
        if (index == 29) {
            return (
                0x0000000000000000000000000000000019312e4f34aebcdc3b51c8e884a817c5,
                0xc289671dca89fe47061ed5a180287596b0a5fbfae0a6008bab21bc26ac30a8a2,
                0x0000000000000000000000000000000005fbc9b23ef87e9f40323d42d5d977e6,
                0x1656ae46d15768dd938620c83b6dd87855c388cf706cd007fd1de5c9f0d67dfe
            );
        }
        if (index == 30) {
            return (
                0x00000000000000000000000000000000166b89b1a8507872c80d6f6a43683f60,
                0xfa82bebd1093e112dbad24e5119eabcfebbb02a59b1552c30e24af8752f911dd,
                0x00000000000000000000000000000000087fbe17d1193d2ad794a9b67a2fc80f,
                0x18b77fe23d1d94c5da31a90640ac9cd2990edcc04b6163d0af23dc828d46e281
            );
        }
        if (index == 31) {
            return (
                0x0000000000000000000000000000000003b4fe86ee1b0889fbff9634887ac640,
                0xc70099b0609cb4374dd5407906fc6f84ec16bad0b59808635bd1237820fe3965,
                0x000000000000000000000000000000000f4ef545bd12800c849b978df29e9a13,
                0x255e3232990eb593de0c2e2ab471d4e25b6b1f4468f5254943ed8511170dd6a7
            );
        }
        if (index == 32) {
            return (
                0x0000000000000000000000000000000009531eddd902c1c78a9d4fc395b33569,
                0x176392bd3375ff99e1a8d2bc0834b1b9e2a7bf369e2f76da1c082e38317d2be9,
                0x00000000000000000000000000000000073286ff4e3ed33e6924257ac9320529,
                0x810666d9355c5819d8afe0b763a8d08ea6216cab694ce2b3db01ac0b9e4ff0e8
            );
        }
        if (index == 33) {
            return (
                0x0000000000000000000000000000000011699f96a6aa923c46ab5218995200be,
                0x6169b8aa3ac8c307e260fecad9356f33cf4d4b82f946485d34208e20fe8d6682,
                0x00000000000000000000000000000000003c04848faddf14496422a779846df5,
                0xb8e58341ac744c0ff83f93254b4c2c98aa73c9a2514f66973a91998b2dd36300
            );
        }
        if (index == 34) {
            return (
                0x00000000000000000000000000000000132827f5c496477d6f2a446ee5e60484,
                0x912ad554b2e6940143bcdc884761c8b7f5b71b3cb9105afb147e1e04505131cd,
                0x000000000000000000000000000000000a730f934c6ce324f0c9bc5f6084d80a,
                0x2235d615cda0cae38731f657cf82a43b6b7b41faf747ff193a5ca8d6b84a80ca
            );
        }
        if (index == 35) {
            return (
                0x000000000000000000000000000000000c5c15ddae2e3bf9960e57651741dc43,
                0x8a0388eba97d96cb1cfbf86818e939c3c146e1734c01cd724107aa04b772de8b,
                0x0000000000000000000000000000000001f737f37e06d630f118b0249896db46,
                0x3cd0f69044223bf6b9858395a85115ec839abab38ea6862df01f94abe55c8d09
            );
        }
        if (index == 36) {
            return (
                0x0000000000000000000000000000000014a9a733f2940e5b289e2093afde6228,
                0xf1db7c88548af922f1250c94a79f8531c28ae5f3444d23d7cb3fc70b1f32f062,
                0x000000000000000000000000000000000f9a0eb0cf4650dd8c72347b4d3939a2,
                0x588e613568ada78e488895b7dece1e6cc414dbb5480612a6ae324d90e871d311
            );
        }
        if (index == 37) {
            return (
                0x00000000000000000000000000000000067b968ac257fe7d5048d6384f097322,
                0x55f67e18cfc4cf94f6af6c3e8da8390d006edf3ca10d0f39a14d03ce655e8e5f,
                0x0000000000000000000000000000000017520df05e0fa7cd64c612f78876ee02,
                0x95fc2d2406f1f6553950b4a8a1733ef257648ac8251a8db948d34af7887bafc4
            );
        }
        if (index == 38) {
            return (
                0x0000000000000000000000000000000016c64232a8fb6610a9a7003fe86bfa2a,
                0x6dc1f766fd5dd7039510f4d1df0bdbe462ad9dee92754bc7ef6339d605b4671b,
                0x0000000000000000000000000000000004a97675e57924a581001ea81511d550,
                0x64e5227d66c0c31d1131c5ae09225ed6709e9b2a182756c1a4ce8d5e7b56d258
            );
        }
        if (index == 39) {
            return (
                0x000000000000000000000000000000000be98ca6dfbcd648f459ba114e864043,
                0x571d3bd157a1dae4ad626da3b0d01999edf2f9ac57e27a66afabbf1ff51b5a39,
                0x0000000000000000000000000000000018465cc69211c53dd58666bf49b30ab4,
                0x10e81e48910a4c900a08ab1f180c07063ba74d6016307247b3909df432388a81
            );
        }
        if (index == 40) {
            return (
                0x00000000000000000000000000000000112ed5c7d434d33621e62c2c771ccc29,
                0x06f8f339fc6d07c9e51704bb2cc027f007241ab2a738274882dbc880c01e3cf6,
                0x0000000000000000000000000000000017443ee846416697d5d04115cf0ff143,
                0xee34e28a69560e3487067e9a0571195817a882170acfedd5b7a8b3a9c80b63eb
            );
        }
        if (index == 41) {
            return (
                0x000000000000000000000000000000001018b42097f13519236beabdf29c2d28,
                0xb5b70d509a1b9d43b349beae090bfc9a57a8a6f8b290086362cdc1c846bfd249,
                0x000000000000000000000000000000000bbe0974d909b1f1702d4a03d8a0158e,
                0x0342b7b0ffaa31ce5d25a0d8ddd11badf253c887db47c7ff3e14c93e1012d6e9
            );
        }
        if (index == 42) {
            return (
                0x0000000000000000000000000000000018466455654e892cb8bf94e5a600b704,
                0xdcfa6271fc3561d7350b00ead65ecaad878bc2ec6cd7a44c791275c6b6d445f7,
                0x000000000000000000000000000000001833356a6841ead9018833e364c41624,
                0x07a40c79de1342d80f876794d251f95e57c94eac48d915fb088eec50c44634f0
            );
        }
        if (index == 43) {
            return (
                0x000000000000000000000000000000000e040f07e7961042bbe634f5970e9a4b,
                0xd53af3d4bf0885e7190ca11273a3cbaba4fcf2aff6ae8a149fc47a1acb9fe5ec,
                0x000000000000000000000000000000000a77dac9a7905d9c5274721fb26ba2f5,
                0x27575e77d464ace9a0d597f1632b3e4ab5b95ccd8dbb885e78597c4b371a051e
            );
        }
        if (index == 44) {
            return (
                0x000000000000000000000000000000000938330998c6abdb96d78605278411a2,
                0x75533f55af334e2174485f06508bce5e042da47dda14e1e7c9a52723c21eda25,
                0x0000000000000000000000000000000007246de9da677965aabb30e62272f57a,
                0xd2633a146acf16702bc9b35864f96f2abdb8fb1da5edbcfec4c46be1de12d6bb
            );
        }
        if (index == 45) {
            return (
                0x0000000000000000000000000000000003fc662a8e29aebc16cd1b8294c5df2d,
                0x42246e341d441a82c04467f35a3717b36747424fb7ab1f5272190d586cd1dc0b,
                0x0000000000000000000000000000000006ebc3feeb37ce9d82f888025742bbae,
                0xcfb0f2fb8966760397bb5a1c7350c3133f7263a6d262b8b266835c36877e5289
            );
        }
        if (index == 46) {
            return (
                0x0000000000000000000000000000000007425c9b1f1364617611090db8ab6703,
                0x1c711356b096fb3328382f374cfb314e4f7a084b44acf59e0dc2854eb9a17ef2,
                0x0000000000000000000000000000000007b29af8e9e8991fbe4fd73a84995537,
                0x2bcec99b792fe4d31241d7bd590bda611254d95b840ddcc7e1a0ad0eb0e188d6
            );
        }
        if (index == 47) {
            return (
                0x000000000000000000000000000000000bc49d470c0134c5d4aeb953466a785a,
                0xe7c3687ec3c49548325e57b76cbdadbde1d44dd344ea83e891101419e6f138fa,
                0x0000000000000000000000000000000006d2928299c58e6f5ffafbb846e49aba,
                0xd40b79fcdcb57387208ef332d6f8bf94239ebed8bb87542d8c0958cab2a33cab
            );
        }
        if (index == 48) {
            return (
                0x000000000000000000000000000000000daa1d961573e668960b7f3dd2f73052,
                0x35b73949842d529bb56ef5f90916517804cf5b2e6837d3eb47b4b0e85d6d9fb9,
                0x0000000000000000000000000000000016044cfa9234d5d0a9aa716438b47e0b,
                0xb1a683052adc93bd18b29315b1e3821e41dc4db8600663688d6038612211056a
            );
        }
        if (index == 49) {
            return (
                0x000000000000000000000000000000000b3311a92a2c26e26ffe457d0f6bb385,
                0x91c26045d50a862184cfc1704c65b2f086dc3075e635d14dae6e81947edd667b,
                0x0000000000000000000000000000000001a9b0a1d9fa110c438bb340db2e7eec,
                0x756b0b9509b7bc14c0b70ea894c93ac3a6b45b57b9535c4f952c6acbb11c4824
            );
        }
        if (index == 50) {
            return (
                0x000000000000000000000000000000000cc3cf919055249314ad51c5b5a8d985,
                0x9aad63377ba579416f61bdb125724f3e221d153b7424c50c016380a59892bdec,
                0x000000000000000000000000000000000f5c91c64f3a8618ec12a61d46221b36,
                0x982ff241da4a2ceea15edec7dc9c936c098ad8d73673c6cf189017f5f24d1918
            );
        }
        if (index == 51) {
            return (
                0x00000000000000000000000000000000027916dd33af78d70235203653cabdd2,
                0xa7b021edacf7e574571230ea767ec238ac4926834132786bd7611309de1c59f1,
                0x000000000000000000000000000000000f688b93d9d2c80c9992c35accedda33,
                0xba453a3a3095965eca005e319d9a01686286dade65a848ab690fbc02a02cc233
            );
        }
        if (index == 52) {
            return (
                0x0000000000000000000000000000000000967cdec8dbbc8adfedd3080d3fe2be,
                0x0460e4b4270bd3f729c0101ec4f561118084b21ca49da7ed4f0b8e314860df0d,
                0x0000000000000000000000000000000016c2e62b9554ddb3b1b03ff9474ae780,
                0x286af22a85d4e1bd5c5d2b126eed36db934e99f26ced5da4455cd2997e7f7d07
            );
        }
        if (index == 53) {
            return (
                0x000000000000000000000000000000001863b3a8780bddb33c64edfe2585d9ad,
                0x6b2b6b4281b5df107df095da486bf24905da1bac02e0719ee3e16296203e65d7,
                0x00000000000000000000000000000000186bff796aa30d51cefcb7d60efc2df5,
                0x01eb0da0b576c4928f3270f01cfdefaf9910bbba0c6c1deba7d54aa29fb65676
            );
        }
        if (index == 54) {
            return (
                0x00000000000000000000000000000000043a18a2a4660ef1a69db0a6268bf2ef,
                0xef88a3dca4d3836a8d95757d3164d301cbab6cb57fd46ebe96c8de7980c3ed87,
                0x0000000000000000000000000000000013c72f8d29e5cb200c85bb64b3f052d5,
                0xcde4f833c956741f915bc3cdf216599915772d6fc13aa1f2480b12bd0b54bdec
            );
        }
        if (index == 55) {
            return (
                0x0000000000000000000000000000000015ce7ee05f40d3bd100ab5871749b159,
                0xca9fd228511c28b63d678f920280c0da1b05c1978ea859405b3d5aa6ffab7a6e,
                0x000000000000000000000000000000000706ca1b42e9e40da056f3655d0c1322,
                0x4016a23341fd3197733b869bd80fe5b788c39fb722dba8505ee3fe54424b1f31
            );
        }
        if (index == 56) {
            return (
                0x0000000000000000000000000000000001c4e15fdc7ce9a53e6e25456bda7815,
                0xbc320bad938042b762d0e78d371a9fba387db31aa42781106ccd80da9e29055e,
                0x000000000000000000000000000000000ace2dab002aa5d66c76d70b22cacead,
                0xf3ca5c3b47004b19a4381a6a1de566333ed225b2bf37151b503a950645273466
            );
        }
        if (index == 57) {
            return (
                0x0000000000000000000000000000000012c76d675ec150f91315c26267da018f,
                0x3ad4d311d53c842456ddc2a61c443719a7743dc777ae46b9e69b4482a07b81c0,
                0x0000000000000000000000000000000015e960e0cb9c83ba13e08ff37f152e27,
                0x63883502b644e1243f7a7a110d040037ad3cff3c343bda9cf72ff64fb5c009c1
            );
        }
        if (index == 58) {
            return (
                0x00000000000000000000000000000000121497f95a18fd139035c4dbc210c4bf,
                0xa81f4f4674686b990b3cb805b1e5d42601defb3ca19b7c9aafe0b3d9cb77ae2a,
                0x000000000000000000000000000000000fa943902c222889ea92ee160f6de642,
                0x3d74adf0940f7aa368d1a9f5b364ffe5ef150fdb9de8bb1ffc0a0242330938c5
            );
        }
        if (index == 59) {
            return (
                0x0000000000000000000000000000000017479f45d9428ea6124dea6fb7a9cea1,
                0x46ab60fe692775b2484c1de4825f5778069cb04de048f8406a705a47930fa846,
                0x0000000000000000000000000000000000697182867f873dca0008ce3af1b792,
                0xfeee03866e48daa827200cbb3336ed63ee458aedcccc08a553af1ba5903fcf97
            );
        }
        if (index == 60) {
            return (
                0x000000000000000000000000000000000537ac3de8da0748559be17ff9eb0ebd,
                0x6fd360e0123cf5ec5370de5487513c82eba2aa154165195a2e2f8d64537a03b2,
                0x0000000000000000000000000000000002e330cdcc1f9c29af798efcb8d55296,
                0xdc9f801232be2cc52c30db76f2bb46c6c9e071ba9ce0a328525adf6ff22fbb72
            );
        }
        if (index == 61) {
            return (
                0x000000000000000000000000000000000f861c07f28d656fc0fc26a95023b4fa,
                0xea0337baa5066caab4fd2e6206ab9443217042edcfaf241c940aa33081d38c6d,
                0x0000000000000000000000000000000010330fd5ba21ffe30ee46da08fddec81,
                0x1465d78c4b60ed48a119bed52c6aa17508ab490a7e29be16430d1c2d09cdee7f
            );
        }
        if (index == 62) {
            return (
                0x000000000000000000000000000000000d97ede4fbea73ad5f43dcdf3d6d4eb4,
                0x9ce57695adf6897f4e9f8b7a6945867869c790c4f61cf26f3d6c7eccafc900a6,
                0x000000000000000000000000000000000b3dc6d906da07fd0cc1bf54719df9a2,
                0xb59ef3d459043b6413050a3e8f385c3f6f8b2e7c225186871fe4287dd81afbbf
            );
        }
        if (index == 63) {
            return (
                0x0000000000000000000000000000000016b1bc1c0043f040657c15e1614c90b6,
                0x52826ad051835aab4aa6baee5aa078ef607d8d38476a71c6122f8651e79405e6,
                0x000000000000000000000000000000000259ed6e13344797a6f8313fe2322913,
                0xe1140c00fed3164d28deb8404050341f019b1418f666bbb4c98d2eb28af9ecc4
            );
        }
        if (index == 64) {
            return (
                0x0000000000000000000000000000000007941d19a987a0ddb9bfade2b773926a,
                0x411e1766eac447c69e6b1d22e92c1696d9b14c99920848d1b26a48b5959c801c,
                0x000000000000000000000000000000000bb2efea235d24a000b25377b1857a4d,
                0xde93ccfbc7ac99a15d0d8520c9c8a232b64829af6783b680014f88b021f1a7cd
            );
        }
        if (index == 65) {
            return (
                0x0000000000000000000000000000000012ed52329601dd164f0684ec46f877f9,
                0x93931d0635aa6fd57ac8aa8c03b13d51473a08778751cd85f825c2ece52fb717,
                0x0000000000000000000000000000000012bd8df2d3637322b025e51f2b1c00cc,
                0xdf060e4dfe403fd61ae5fcc7f60b5cddebcca9ccf431638ef1896b2db352f3e9
            );
        }
        if (index == 66) {
            return (
                0x00000000000000000000000000000000032ec963bc53c5a7dc6b868d0f57b032,
                0x11a1b55c07ac51b22ce0b11ee436b44c8882fc6b61c47c6c3c55adaa50daf3d4,
                0x000000000000000000000000000000000d79087a9ffe405ec572eb2e2760b7a4,
                0xf3558194b0fbd52dfc9856224430c97c3fce3bef587d69959edc84cbad452e95
            );
        }
        if (index == 67) {
            return (
                0x0000000000000000000000000000000006aa8eadc97af8757e8e6c2e5d9f85d0,
                0x5a1f7fdf6c9efa053c0b535251323504167e08d3ca339d0a48d2d61cac853b04,
                0x000000000000000000000000000000001576832e9f2270a0a945d1fe1c848e85,
                0xb5e9d06246b577acb45ba6d371ec29f206d21d816938625e69ea690be67f35eb
            );
        }
        if (index == 68) {
            return (
                0x00000000000000000000000000000000174b150656bcd93c1c9182c8b6fc5fdd,
                0xd708a82484eb4d7f2665116fc9740ee24a15dce516add448d48d96f06073dd17,
                0x000000000000000000000000000000000160bc6e7940e16147eee948369c79c6,
                0x47d8fbc55ef565ae8e5ead4784e68d43cf55b51a200066ac0d7ff92bb0671e35
            );
        }
        if (index == 69) {
            return (
                0x000000000000000000000000000000000c68038d0f6e5ab4c52bc01adf6f2809,
                0x50b1e5591b0ae5f15fdefe8b9abf88135cec38e33736e93d463035c560c6fdeb,
                0x000000000000000000000000000000000e5a48fdf2bd6d493455bf29027f2437,
                0xef1ec2332c246e6c6a4e42bf79995817dae3fcbf5937049045458bbdb1fd7144
            );
        }
        if (index == 70) {
            return (
                0x000000000000000000000000000000000b68557b05d916cecf0946806e4eda14,
                0xb0441a9773c9edc9bf5d5635f7f558f0c47125c52d68bc0286ce777442f2a6f7,
                0x00000000000000000000000000000000160f8824c7d6f039f4634fccd672ac92,
                0x04da00207c70cc93aa0d00df5bed670c11b4e7908fe799d156c3576beab56f32
            );
        }
        if (index == 71) {
            return (
                0x000000000000000000000000000000000f5b4a4d79df566712f1798e3626fc01,
                0x6b8e48d2ea89fd80de6b0d84c69540794f2b1dc64827c537811dad06c4365201,
                0x000000000000000000000000000000000418ef3c46c4ba4d98eedd00c953b9bb,
                0xbe55924f92f1aba798fef42d7ac1024074439dd401473b5b9698d95224377f9d
            );
        }
        if (index == 72) {
            return (
                0x0000000000000000000000000000000007811a506d9d9c91b0d9877a119579ed,
                0xc7f19707f94f82ae4eb766763005730f3b3cdefb9c1a8408f5b8200b5f19e9b1,
                0x0000000000000000000000000000000018c3b02a2b617f97a9506cbdfd91a356,
                0xef36e8648b2893d4dd4f3438f67aaa8efc9353224ee7509b2b1f863435f52e92
            );
        }
        if (index == 73) {
            return (
                0x000000000000000000000000000000000549d2c754659e18962906432e2d9499,
                0xdf094079e3bcd8156cbede98018a5bccafc35a1d0a6628b1a11616b5fa8b5812,
                0x000000000000000000000000000000000b8f3c618388431b187ad801064c2673,
                0x3626920caac4a0a40764a6cb4376f76d0944f7bfb832c4b4f1b1daea399af9bf
            );
        }
        if (index == 74) {
            return (
                0x00000000000000000000000000000000078528ee3fa2c51294fff752bc883c73,
                0x930bc52994b65e289b7298351fbc23ad5e3aff096baebd0ecaa719fd5ba52355,
                0x00000000000000000000000000000000186e7969a2ab9846016443417c732c8b,
                0x314a132e138df531f839a7e91714dbd31b151d5500e63c0fea6a596f6c39f7ff
            );
        }
        if (index == 75) {
            return (
                0x0000000000000000000000000000000004e5424c235e90015c5f336d08548ade,
                0x986db2e263420dd9d052b4fcd1fbaf3a5d008e7c4f29e6fca34d7bf9ded28ad5,
                0x0000000000000000000000000000000008ed2e7f394977385aa0c1121cfecab7,
                0x8d93d0d28eb6411fe67fe6daf69f6e1351ec5931484c240d611bfc58f260d786
            );
        }
        if (index == 76) {
            return (
                0x0000000000000000000000000000000013283ddc8994288a3ee4e853f14de236,
                0xcdd0a82915f36c211f456599d2c7368556567488c3044c8e0a8269fb086956e7,
                0x0000000000000000000000000000000006a42740a03e7dbadab7a0bc91d89cf3,
                0x7cb588f63615ecca55e88c54846652866fe7703bfa4646e29019f2d489cb3932
            );
        }
        if (index == 77) {
            return (
                0x00000000000000000000000000000000137eead21f30cba7d5b66c0d9f70c609,
                0xc7560def8b3de0174dbae924b6aeb25500d6a33d42fed2393192caf5107e4550,
                0x0000000000000000000000000000000000ff260af928877a715e5cfd03512c7d,
                0xbed10c51e6c25b66f24953221e8305a56af9f14227e26a9ed28f2b4ab47f5baf
            );
        }
        if (index == 78) {
            return (
                0x000000000000000000000000000000000fc057e97f6cfc55f8307c883e80701e,
                0x02a0c4434b05ac37172d2d180df5dd6a335ddbd2350a293e2ff75327e4ac69ae,
                0x000000000000000000000000000000000f5378744080725cb8f4b42bd72d6543,
                0x5de01419203aef22bf84015c7f01eb75e64a1cb763a62d862beb1df31b39150d
            );
        }
        if (index == 79) {
            return (
                0x0000000000000000000000000000000017613b23f946b7ac84f45f01a7f75ccd,
                0xfd9a46fd59e011c023a667e26de3f84f65ac1aab9a15c6b7dd226a98466f2a1d,
                0x0000000000000000000000000000000001d6acfb29656ed260e3428539f9c793,
                0xc8cc6b6dcbac652945b5749fb8d84156edef9e33ea914bb8fd677e657e1c5f3b
            );
        }
        if (index == 80) {
            return (
                0x0000000000000000000000000000000013406432d3b5a96a5460585bf76ff89b,
                0x684bc49d8389a339b9b9e8edead732ebcba1f89e36f94dec7a4e4b9bfb26492d,
                0x0000000000000000000000000000000017609133117c9afde0b92335ea38c8b1,
                0x9629d3f98a594911881fad24e8e6ae4d77be05acad04e94a9d98785cb113af78
            );
        }
        if (index == 81) {
            return (
                0x00000000000000000000000000000000105e432d6d76dcb2d728bd393909c4ad,
                0xd52cbb6f139a99b5604bb0f07b0b40179aa80b6d1821bb9e7209a8c04fc29a8d,
                0x0000000000000000000000000000000014555e181d63fb34619322c34a0400e7,
                0x025fa9e2d53eb31ddbede457e0465b482ac911db8ec667d4c668bb0635f73881
            );
        }
        if (index == 82) {
            return (
                0x0000000000000000000000000000000000c0bdf04aa961f707ce6c356999e454,
                0x591d6ab6cc8f7bb1a83b1df3950fcad17bb4e169c88a2767d2740426a479af47,
                0x000000000000000000000000000000000068fabafbd6b949c803284cb80dc819,
                0x6b8f16bfcdceabc059802d00acc1134949c9ad3919947f74f1b20549181241a9
            );
        }
        if (index == 83) {
            return (
                0x000000000000000000000000000000000d3f815de7dadedd0828e886ead1079f,
                0xd8ebe421ba4d072f52c6d94aba19b6a9900eab0b7e77b5175daf812ba01ed235,
                0x00000000000000000000000000000000009d855985c5ce122adf87c272c6c94e,
                0x234993741e1b2750865fb4ce3b2581f56896781a62c556e66ba19ac1f00a4f04
            );
        }
        if (index == 84) {
            return (
                0x0000000000000000000000000000000008662362688922f233e6c0757b438212,
                0x7d6c7dad97bd276962ca938d1e153bb03ba0c235142e5eaa945856dc4da6bf1c,
                0x000000000000000000000000000000000aa07116c315e53125256a1d6188a7a7,
                0x17f040c817dae2e7147499298e383380aedd5a65ad11f4a3adb9b3249e034ece
            );
        }
        if (index == 85) {
            return (
                0x0000000000000000000000000000000005535931eceaf39a2265e3f7d70386e7,
                0x656923b898308bf6af206a7aa66a55747d915efa028c1113a83416b5877f8a16,
                0x000000000000000000000000000000001050e1927c988b8c4c57c6949a1fd8bd,
                0x2acabf272959fecd80578c3a2809b3ee7606a41d92d350bf74880dd2f9f47d0c
            );
        }
        if (index == 86) {
            return (
                0x000000000000000000000000000000000bfe11a9a2b29fb18d0cf98e83c1b61f,
                0xd31088b0ef94a60bf41b2d7f1218d97a86deb649f984623bf713d5df3d5af01e,
                0x0000000000000000000000000000000006ab7db655a15cec0dd90554fc466185,
                0x3dbee7dd277ecfe490846c389668f8463ea40ddbc08c08b4c0666ec2f43d351f
            );
        }
        if (index == 87) {
            return (
                0x000000000000000000000000000000000e3dcb96cc7a9ec8fa8c2d42205c20a6,
                0x1fca44f69c4ecc33ea335c48b613e56f8d4f3e03f9bd3dcc4a184ce64b0fcc1b,
                0x0000000000000000000000000000000007ae2550f230999f4fe854703f5dcd04,
                0x91e0376954f774d19a1fc38598fc9f37289c6266bdea74b22cffbf930440d3c8
            );
        }
        if (index == 88) {
            return (
                0x00000000000000000000000000000000029b2407903835505fc3c12fc75f5eb5,
                0xeded1d1ca5cddc625dd3305c44e765d60b9609819641915a1c656019c9a2d467,
                0x000000000000000000000000000000000d83be1820c4eab888e44020c1dc9dd1,
                0x6bd86cfdf8cb017cc4ee8090db06703e0d4d531cba95439a617dafb257be570a
            );
        }
        if (index == 89) {
            return (
                0x0000000000000000000000000000000013ac26d3e5a569cfb6362a7eaf5f35c3,
                0x78a78680958e3a9e16978ebfa00ccc27c332fd46f10193f3a85bde2ae19a0248,
                0x000000000000000000000000000000000438e3cefaead0fdce538eeb07e37e30,
                0xa3f1849c710e521f2bb62cee35ffdb2e15da4f50371b3bdd9146d42b3ff29f22
            );
        }
        if (index == 90) {
            return (
                0x00000000000000000000000000000000046261f295f5bf2c1f116ad82e77b1c2,
                0xd7f4b8b49775f16713a0c02d186c60bb16123c070cfa5b548348349abb5ec6ca,
                0x000000000000000000000000000000000d875de9960acf81914c12c338c2d6ca,
                0xcc8362b6812d47ee0f15eded97d2630c77bc5ff77204d48cdc727a2e113edda0
            );
        }
        if (index == 91) {
            return (
                0x0000000000000000000000000000000006b876560c0434d3999e60030f7c58d4,
                0x716fa9c2c666067191da8cc86a9dcfa2c7cc510428d214762dd5bbb2fd79db37,
                0x000000000000000000000000000000000c3218db39a79dbe62feb4fcf3e57307,
                0x863ae4e2ac693f075675c8448107b66b8b915585cdeb25b1147d41dae03ca8db
            );
        }
        if (index == 92) {
            return (
                0x0000000000000000000000000000000008884a76eb7002c4934002ae3ee55e50,
                0x11c3ff0363ad591f9aee54bf3142d1d2e90ea7d1d81951fd400a757db185d722,
                0x0000000000000000000000000000000011d0bea049ee1f857e4769a56c4f26a1,
                0x1d35795fc72e581ba2ccf5a7acdb1d315314074d35ba8027013f54e6f47ace07
            );
        }
        if (index == 93) {
            return (
                0x00000000000000000000000000000000110ecd00d103f25e18fe607f42a1f1f6,
                0xc25d8f3538cccd063728210799aa3f476bf4c884e979445710eb840f02856a40,
                0x00000000000000000000000000000000072e07ba2a9089c0970cc38d7376bfcc,
                0x702ce921a06d95ace0b45904494e5b96a336d06a0ad8dbd5c7359e3f0110540d
            );
        }
        if (index == 94) {
            return (
                0x0000000000000000000000000000000008ac9563f7d754020cb6221eac2bfbbb,
                0x33c4cf52c59de92e920cff48cc713ab77b072915efd975589f998fc749cfc7a7,
                0x0000000000000000000000000000000002b8583307a45980a715bfeba48b5127,
                0xbb704d439e68a958cd30b5b9ce45c060a905e60030fa400a5138f60ad7941efc
            );
        }
        if (index == 95) {
            return (
                0x0000000000000000000000000000000013256bcb556ff300f179f10ff5b838da,
                0xab7ea80536f4e544179db21cab29916d1cde2ce4a03ed9d0445a95472c2e61f8,
                0x0000000000000000000000000000000014a9c9c80dfa1f6785fff2acd94354c7,
                0x04e3fec731319308649121ee74579828562ebb7d7805d333264fa99832f0c1b6
            );
        }
        if (index == 96) {
            return (
                0x000000000000000000000000000000000b7a087d48ad73057707c4bb2529caa2,
                0x0117d00e70adbc6ce05e9ff1e7406a4bf6ce49fe5aeef3bbf179ce372df237ec,
                0x0000000000000000000000000000000007d591246054947775a49ff2ba88247b,
                0xccb11d4a40a262163c7826b0205db67d75846e59d556a41d3e7975f42afbb292
            );
        }
        if (index == 97) {
            return (
                0x000000000000000000000000000000000361976030cf92d36bbe44b343f35aee,
                0x892cb90b2c7d78c75f05e16447de1c507e0beb90cc2ccaf78d55de38f9ae7ab3,
                0x000000000000000000000000000000000a956c7f37ae4d3992d339dfef2c72d6,
                0xfad23d86da472e51fe3c8887d3bac9e3b5b0be8ec0a6a2df9f231c15db54fda1
            );
        }
        if (index == 98) {
            return (
                0x000000000000000000000000000000000a84ad868fcd4fdf6b6b6ba4fe86e218,
                0x3762840e9dfbeff65beb9d447d97e7d5882b67f50b690e7b666bf365cab61293,
                0x00000000000000000000000000000000106d857209f9e001665059f569e35eb8,
                0x196804eb73a774cff7921866c1aa9d1c39f633315e1e879f714d79c14f69bb7f
            );
        }
        if (index == 99) {
            return (
                0x000000000000000000000000000000000bf115cc66f6cbbedbec9adc7aa4de7d,
                0xec3833d71bb9cf6db16dc3a7ef83a9aaa10c88e4014449cb37b1308b47744627,
                0x0000000000000000000000000000000016f22d4e424eb078cb4425ad2bd6398b,
                0xe15e7f8c5b62b110a2705690213964f0aba99d1a81ab4d08bb821cb9d5c9c174
            );
        }
        if (index == 100) {
            return (
                0x000000000000000000000000000000000d67c3562d9b206b1b11cc4df44aac8a,
                0x6c427c73ab52d54d0f839121f56f1309e68bcda2ba968fa0855e5d43deaf334d,
                0x0000000000000000000000000000000000a791e38aa37f8e95cd8c09f03cf08c,
                0x343bfe46a32fe471da56853be43ddb0d0a97e4dc5208aa6c33c62485d352a20b
            );
        }
        if (index == 101) {
            return (
                0x0000000000000000000000000000000018f4b463be87f879d6886dbaee130fcd,
                0xbab2f77a36b9e0065150bada357a31e489c1af4f57eb5b6d36d9f541121c0c83,
                0x000000000000000000000000000000000b8f3696dd466494d14d6f4464a9c661,
                0x1acc565fd33b489dd272240b7f87ceccc73a26424bd19719d223f0b026252646
            );
        }
        if (index == 102) {
            return (
                0x000000000000000000000000000000000a89d2904be53803d7dceb955cbf2547,
                0x9bedd7fd00e4bfb64aafb8c98a97b6800d5d02aed2e44e904c32ec03297b863c,
                0x00000000000000000000000000000000089254596602fbeba78e1da54408b403,
                0x9f168e19f26a2fb293beb11403a6d9a8bc902e704fcf8e9c009498e98006a91e
            );
        }
        if (index == 103) {
            return (
                0x000000000000000000000000000000000761cf306182469f85591667d45cb383,
                0x73ad906003ace7d83e773682e991b9d7ef23d83074e268280ad6b64f6b24c69f,
                0x00000000000000000000000000000000052b66448330a097a67c721459dc9670,
                0x19c37eeadd20192cb34ec862ddfe80bb968dcd9e08372054c4c1ffac524b2126
            );
        }
        if (index == 104) {
            return (
                0x0000000000000000000000000000000004bb5d5d5de16152d894602f3a169d62,
                0x7410adf8bfc0876b627788f59dd8db56589e48d6a9e36fb6ea0e74091149aab9,
                0x0000000000000000000000000000000018d5dea2408ce31d8cd39820fa1ca029,
                0xa308663cf8e0161abd11264caa8118918d16933dc0d06f51abd12bf8db17e909
            );
        }
        if (index == 105) {
            return (
                0x00000000000000000000000000000000198a7d2da0bf23c79dfebc21293e5fd6,
                0xadd9c4d2084e2918fd88e94d7319f5e449415e9f1da94ea2dd560ca8753bde66,
                0x0000000000000000000000000000000002c5e627132d3c8924b532239fc0672b,
                0xe84e62d069a38f14e71b404be74146067b186c03510920ab486377fd802b526a
            );
        }
        if (index == 106) {
            return (
                0x000000000000000000000000000000000dd04f940720ee071eeef635def11fcb,
                0x1ffa2e14e00ba5915e9234e73ae06f4a02626193a1ea8b94a23dc54eac4b1f54,
                0x000000000000000000000000000000000d9f8001daac1d919c22b2d7834cdb23,
                0x5db934e5aedef83beca522eaff7d1270e3411f379677556d34283b22731bf27f
            );
        }
        if (index == 107) {
            return (
                0x0000000000000000000000000000000016a009e3784eb5f2421ad18efb79f913,
                0x9adbd655c4719af0f2d1945ddb5e74abc9eea55181da5e1475f332713dfb6b0e,
                0x000000000000000000000000000000000cc1bb18923b58172636274445a16bd6,
                0x7c4decef301fa6a93dc28948cbc6de210491603ee8b986106b856ba35cd02c1b
            );
        }
        if (index == 108) {
            return (
                0x000000000000000000000000000000000043726c4f568ac93c0cfa863d50793f,
                0x93c73736d83ba77525ee6d0d90db074e17b454fca3612959d401769debd2c825,
                0x00000000000000000000000000000000186aea2dc56fcd3de061fd8387c74383,
                0xe5f937386cb62288f139299af8f0f2d0b05bab93bc1b0b7cbd25aa06728cd688
            );
        }
        if (index == 109) {
            return (
                0x00000000000000000000000000000000047dd7747f543632368a1e88e49a4da5,
                0xaf5907f568ffea39670dff8a6e7d0651f610d82c90a2617c7e27da01b85dd30e,
                0x00000000000000000000000000000000155b19db209c8ff16e57dcc2109de511,
                0xb97abfc2f67e4efdfc87dd23f7c199cba98d582bb63a60ed1e2f39c8f32fc8e9
            );
        }
        if (index == 110) {
            return (
                0x0000000000000000000000000000000006d5d3277af6b479725e675d789efff3,
                0x67196d1b56536ef54b8a20b7236ddb1d6761b83b239811f4d0ae623c51edbff1,
                0x0000000000000000000000000000000007a1209665be867bc3fa83ad4da876ec,
                0x4a6beb12e50d00a4be0966f50567be560e543bb3e8e0b1344ccc8345b9458c67
            );
        }
        if (index == 111) {
            return (
                0x0000000000000000000000000000000010f5c6848b71d0be60a870eb4f97bb57,
                0xcd34eac38a6b369d802ee30019411635e7e6ebcdd20d7aff4f6ce4d732fac3b7,
                0x000000000000000000000000000000000a6a11636d2555f4c8bf2bf73c1fc4e5,
                0x1634003acf2062fb3a308b35c8029dcf5695423973390fa426f8ec4c8a4b9e40
            );
        }
        if (index == 112) {
            return (
                0x0000000000000000000000000000000014e19702a92dee2e66f1f7945e3821c8,
                0x909bab8cb6361b0ce4b12acf210fa88baa5464bca9bed3f632779e216cfb318c,
                0x000000000000000000000000000000000893bac040d3ecb4294297c99fa25990,
                0x225fc99010d438ab920e575a944c506384fdaf6bdffb724d7412a433ad759b16
            );
        }
        if (index == 113) {
            return (
                0x0000000000000000000000000000000001eb19a090c1ebc2585571e58a32be11,
                0x34e75400c1ad740b9b33303fcec1b488d3e8fc1aa8c7694346502ffb2c8d4553,
                0x000000000000000000000000000000000748210361fdfc4156aa995d61288319,
                0x7789b48d4107aa02fb809eca520c99306810ebaa322437a031048fd269de82e6
            );
        }
        if (index == 114) {
            return (
                0x0000000000000000000000000000000019aaec69703149ab7b060b1035559995,
                0xee7b76290155d434f562c26c779ea2c7c8f00e92f16a25a9b4ed173c40597176,
                0x0000000000000000000000000000000010400ae36c58f3c10442fb6e4f1d6d24,
                0xe4bd76a32125a501dc9628ceb44a8390ff93a293ec4ec4ebe0e142e04855b34f
            );
        }
        if (index == 115) {
            return (
                0x000000000000000000000000000000001814378a3e88e422bbffce0fe60a83bd,
                0x75e482ea3400fd795d286de98409a7d0f18ed0199043f6c6e8374239c1554e21,
                0x0000000000000000000000000000000003ed2bcd455bea7f25785062272a9fd1,
                0xbe7353c3af347a3bda1010d87668761a0ba5394b4732a4656a059abc55727e2b
            );
        }
        if (index == 116) {
            return (
                0x0000000000000000000000000000000005bef94a0068d23d4b9126e628788bc3,
                0xf840ac4b56ce7809a55f446a68326c1db879f879a03868ae000b1bf645cf84ad,
                0x0000000000000000000000000000000003eb58adfa20bf70ac521d2e7e69f644,
                0x2cf86553c3f69e0ab65f385f27e7c1cc75adb107b8b3eaefc3ca845ce840a145
            );
        }
        if (index == 117) {
            return (
                0x0000000000000000000000000000000000d8232801cca18983d0705ff87c294a,
                0x9766693f971f108b10a56085d6b74fa5ee4d6065c53f995e3aeb485b8b4a1cee,
                0x00000000000000000000000000000000075ddcdb7fba44250d8ad77e906464f3,
                0xe4a22e9cb42595d21d7bc43a53040e67d25bc8bf00dd944da2011a8245609bba
            );
        }
        if (index == 118) {
            return (
                0x000000000000000000000000000000001772644f6ee2e378eea8f942fdd62389,
                0xa42d39f0d542fc7f6e3fb9541b3e81a36818b29d7c9b1157e8bb1c75c46ff2a9,
                0x000000000000000000000000000000000a8156574fa45e991381fda3d25e707d,
                0xfcabb0841656b1fe3411a9a86e4e16d7e0a8dd5936117270a83fb9c022364dff
            );
        }
        if (index == 119) {
            return (
                0x000000000000000000000000000000000422bfc1a40690430d8ffb5405ad0b29,
                0x2912b08d79af249742ca9c6bee3de5226c8c448e1e873dd2ab354328aed1dfaa,
                0x0000000000000000000000000000000017dec1c3bcd49732588c231c1c8369ab,
                0x3140f35876b838b2ec3a41c26f5328b02caa90ed6451ffe9a81ee59ae35e46a0
            );
        }
        if (index == 120) {
            return (
                0x00000000000000000000000000000000030335025ced4f0698d947dca3835be7,
                0x766a2672936f24e7c586bc1ac45f5ca72abce2ddbb8abaf32237d61afe852bc2,
                0x00000000000000000000000000000000125737984a11b14cb78b53ef631c7fe1,
                0xa07761fefeebe47316f28a1f9ee71ae3cf2cda615afc206d9ea3b2b2ba75e995
            );
        }
        if (index == 121) {
            return (
                0x000000000000000000000000000000000bef049e5ac7a82f2e591931b01c60a9,
                0x5889f484513715f91c99272cc84f7c652f89b503663a69c8f6fc37289b9aaedc,
                0x0000000000000000000000000000000001ce74b56a0b02fb6188a999b843f88e,
                0x693724f1125eedfcb2186866c4e185219e221e324aacd98f3a1471cdbed11af8
            );
        }
        if (index == 122) {
            return (
                0x0000000000000000000000000000000011136c2c85793e98b96b96cbc8411874,
                0x837db3a24232461614020d2985e48ed2ed74c430770425857631607ed1edb6f6,
                0x00000000000000000000000000000000171c95c174f74d1d6c8771b401f0db0d,
                0xbe3a336111f0829aa38e6861083d1379be42c68eef2b5a6eebe627788724ddd8
            );
        }
        if (index == 123) {
            return (
                0x0000000000000000000000000000000014edde958a19a4af52d0ca7abd1e7cc2,
                0x0de38cb5f2b37cb33cf05e81dca5c3ca888fd34c413c5b2a32357be96fadbf76,
                0x0000000000000000000000000000000005396efe6f0199d1231cb7db7cea3654,
                0x1e244c7c10910063ec5be28974e4542b6b50fe0482c79655f222e0d55b8127e3
            );
        }
        if (index == 124) {
            return (
                0x00000000000000000000000000000000131808f2c43c27e7167e584ef4f67213,
                0x6daea50372c4bee1703452e2757ce0eb931b1d3c71478f71917ef4327af24912,
                0x000000000000000000000000000000001405f81460dd1e838a73944821fe7e2b,
                0x685f6b000df53e07c6088d9dc0189d4656a94b45602a85c3981f1879440bf7a2
            );
        }
        if (index == 125) {
            return (
                0x000000000000000000000000000000000808c4c38157343d6545ceecdd0cebb6,
                0xf632215fd45faa7be57d1a1cd0844e8d26bc15a7d0f528fcdabdf7d066fcab38,
                0x000000000000000000000000000000000fad991096df7904bbf5c3b723f8d652,
                0xd424c65a58bf1e4d4750e6938c0e9182af124b208c8263ce0ac5bd7ed5ccfd6d
            );
        }
        if (index == 126) {
            return (
                0x00000000000000000000000000000000061dcabcf36a4b22a5029bc79c9f9047,
                0x1e1dd3803f32139dea2d649bc764b58a5b5e4a76170860c5b87ca6db48717126,
                0x0000000000000000000000000000000000f25e20a52d12dbf4e0f8ed69595933,
                0xdd4ee1a8e5af8ee012af9c2161d38777722888ec859804d1a6fc5c63f962048f
            );
        }
        if (index == 127) {
            return (
                0x0000000000000000000000000000000005279f74114d274fb2431f2696f20846,
                0x88da89abf1dbf1aad132d967c907e82885842cd812d6318df992036c24ec019c,
                0x000000000000000000000000000000000f12af3c53baf3d0e296ec6818b2b953,
                0xcf46c442414e31e9699eceeadf47529b12798708428277167c7dc532db38c7dc
            );
        }
        if (index == 128) {
            return (
                0x000000000000000000000000000000000e6b816515c833beb9260740b28d4580,
                0x0779501d9b14f936ad4df00389b1203005c6f528ebd17d4aa529b328d8dac73c,
                0x000000000000000000000000000000001723c816999819e264975c4304bbaa29,
                0x970c2608b3d5d06a720ecee65d3132cfe68ef1a84483640cc6d7c174fa9ce0a8
            );
        }
        revert("Invalid IC index for IC2");
    }
}



================================================
FILE: src/verifier/Groth16Verifier16Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/

pragma solidity >=0.7.0 <0.9.0;

contract Groth16Verifier16Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 constant alphax_PART1 = 0x0000000000000000000000000000000019df117428d6209b35175c2f17efafe4;
    uint256 constant alphax_PART2 = 0xe450152a225c773f71256fd0b6cb00b6361afac3ca588df0ca43d1c523062d63;
    uint256 constant alphay_PART1 = 0x00000000000000000000000000000000014abb7d34799248932222e650bfa336;
    uint256 constant alphay_PART2 = 0xee7524a6cbf0e52efbd93a779c4374d80a6339c6f97c4d2c0bda733daa549838;
    uint256 constant betax1_PART1 = 0x00000000000000000000000000000000061eef3f522852aa16a76287334ac1b7;
    uint256 constant betax1_PART2 = 0xb692587a5f5e0077e861626084a351f7ec76e25f330cbf53d8c6cfef10dacd0c;
    uint256 constant betax2_PART1 = 0x0000000000000000000000000000000012646561fabc56a886f1d90cef4038d1;
    uint256 constant betax2_PART2 = 0x30051a9549614a0b507f7669679658ce59ef2ebbf1bcb348f63205ad7f3aaf0e;
    uint256 constant betay1_PART1 = 0x000000000000000000000000000000000a767683c4e1592eaa00783291289fa4;
    uint256 constant betay1_PART2 = 0x3371ea0d895d18364a737c5559a7a82734a1913c12f9d92295dd246976996818;
    uint256 constant betay2_PART1 = 0x0000000000000000000000000000000018724e57498c87b761e361e5df060703;
    uint256 constant betay2_PART2 = 0xe4147c3cba9fd694a29c8ffe02712eb9db274fd1d847c867cd5e071a8e36c6a3;
    uint256 constant gammax1_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax1_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammax2_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax2_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay1_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay2_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;

    uint256 constant deltax2_PART1 = 0x000000000000000000000000000000000f8246e2eccfec5107a0f97f283c14c3;
    uint256 constant deltax2_PART2 = 0x03c156e2e64762f5999c9b2f993cda30074210ed3fdd4d83b19ff73b778f1ab1;
    uint256 constant deltax1_PART1 = 0x00000000000000000000000000000000076b83521c22c5c1eccfa45fc937706f;
    uint256 constant deltax1_PART2 = 0xe56cb2b28c274245d095708fa5649f5603eac9709d0e9832137aa613d449c554;
    uint256 constant deltay2_PART1 = 0x0000000000000000000000000000000004d4a7b51836c3e6c6059d14e4e31407;
    uint256 constant deltay2_PART2 = 0x68da50d21376e7e694326ef49b2c4e1c100c1417266a57630ed538dde59c4eb4;
    uint256 constant deltay1_PART1 = 0x00000000000000000000000000000000119505409361b61f323517b12110a106;
    uint256 constant deltay1_PART2 = 0xe00caf18d32ccd57fadae626175b92b87811f71c40d14247250db11a31ff30e9;

    // IC Points - split into PART1/PART2 for BLS12-381 format

    uint256 constant IC0x_PART1 = 0x00000000000000000000000000000000024f14f48fa89f229bd3367f505156a3;
    uint256 constant IC0x_PART2 = 0x04f35db9df3896733ff80ccf72809469a5774a3a03290bfbbfb6f4cae23c0a4d;
    uint256 constant IC0y_PART1 = 0x0000000000000000000000000000000014e269ad92909ade7e1daac203a68947;
    uint256 constant IC0y_PART2 = 0x2381f860c7dd47516a159f8873ef9500f176b09ee8982fdaacb60e4d034c2396;
    //
    uint256 constant IC1x_PART1 = 0x0000000000000000000000000000000014313a5c6ce6824bd383b2c11a5d5787;
    uint256 constant IC1x_PART2 = 0xd2909a7e9f487df14afe620e84384dbf4008ad1569182fe0697aff238aa209aa;
    uint256 constant IC1y_PART1 = 0x0000000000000000000000000000000017caa2e3b8680e37c71bf9622ae7f77a;
    uint256 constant IC1y_PART2 = 0x384aa4ea7cb3d91cdb07f1cdae3318f7f4de6c668efbf2ffea3b5172297ee544;

    uint256 constant IC2x_PART1 = 0x0000000000000000000000000000000019c3a49118b328f157187ec8b04b65e6;
    uint256 constant IC2x_PART2 = 0xda0495756b218d5db22bf89961fae2f95e68eba0647a4d79ae36c35a7d61f637;
    uint256 constant IC2y_PART1 = 0x00000000000000000000000000000000157ed427f9866575a2d8c82316d82898;
    uint256 constant IC2y_PART2 = 0x5fd8b02f66f08ca30872095c77f7ce85627d28912632bd915eecf6421b8642af;

    uint256 constant IC3x_PART1 = 0x000000000000000000000000000000000538669a5f32b6c504b0507573ac3313;
    uint256 constant IC3x_PART2 = 0x998e0d7c42b83697bb1361eba03c3f2988a0261384dd0984960bdf952a1e79f3;
    uint256 constant IC3y_PART1 = 0x000000000000000000000000000000000f8de2c532f88e2dbc5036bc6265ce66;
    uint256 constant IC3y_PART2 = 0x7fe7713e827d82fc3292a16c4f772e0caf635640dd57823369d990ab6080c6fb;

    uint256 constant IC4x_PART1 = 0x000000000000000000000000000000000563236f49275428cc7656de42ce0aa9;
    uint256 constant IC4x_PART2 = 0x94ed9d2b8df17490593a1080d43668df4b8cc5e7a9da1ae9fb9339dc348039b5;
    uint256 constant IC4y_PART1 = 0x00000000000000000000000000000000055c17dff9cacb39455bbba953d2338f;
    uint256 constant IC4y_PART2 = 0x0b03983b77275f3a9f79f8e9671816ed69125489911429dd2b0e0ceb3abb59e9;

    uint256 constant IC5x_PART1 = 0x0000000000000000000000000000000010cdcb938e13f4caedc73336e7210106;
    uint256 constant IC5x_PART2 = 0x89e02e47c9cde91914d8a0c04150c030c7a0bfa565ae4981c5e24a95ffb276ff;
    uint256 constant IC5y_PART1 = 0x00000000000000000000000000000000017c82764203bbb533b6ca9faa6ba551;
    uint256 constant IC5y_PART2 = 0x95e2cf30f9664aec4d73f181716828bb1d5c3459ed75ae7b82c67ee231784359;

    uint256 constant IC6x_PART1 = 0x00000000000000000000000000000000054dd76e2fba0c49c6b2df37827d2fbb;
    uint256 constant IC6x_PART2 = 0xddcd78798b8ec0831718be5aa709c01423cf11edce4eef733db0936d841defe4;
    uint256 constant IC6y_PART1 = 0x00000000000000000000000000000000155b3380d4fe5503220d2de6cca86c3b;
    uint256 constant IC6y_PART2 = 0x1cce5752c137f95f3440be960641abfafe11c91c82b84e1bece60bcfd7696e4c;

    uint256 constant IC7x_PART1 = 0x000000000000000000000000000000000f1fd9ff7e2f90a296fde9985864ccf1;
    uint256 constant IC7x_PART2 = 0xa6d6477c7698c15c41a807c56481843da422b0f8860aef0737071fecdb13fab9;
    uint256 constant IC7y_PART1 = 0x0000000000000000000000000000000017c2ebf05f78d3ef47e4abcc4f5614fd;
    uint256 constant IC7y_PART2 = 0x431a4b11c15e8b84ff16e734e46cbf81657290f7d26d8e7fb096230a1281c50c;

    uint256 constant IC8x_PART1 = 0x0000000000000000000000000000000013652b79af51b630ef867b1c7aef6a79;
    uint256 constant IC8x_PART2 = 0x9052f7d83d75996e6a89d936a3dcbfbcd56c80826ef3587269b3443270f7fbc9;
    uint256 constant IC8y_PART1 = 0x00000000000000000000000000000000174935e5a39bcb66928454abe49a8d53;
    uint256 constant IC8y_PART2 = 0x5793d5fd7707913a71dc70f8f878deb904dba13effc1ca65952f5f9dad6eb3ba;

    uint256 constant IC9x_PART1 = 0x000000000000000000000000000000001952afe67c7774e3ddb06c018342c9d3;
    uint256 constant IC9x_PART2 = 0x3753a2d736e6f2be4350d0f28220d6138e2fb268a4c19cceca488e6f28b8f357;
    uint256 constant IC9y_PART1 = 0x00000000000000000000000000000000027f81f7bac89d0b5f26aa4d4183526a;
    uint256 constant IC9y_PART2 = 0x1ad56dde825f6504c377f1f3e8bdf05ab501a3a06963dfa3dca20b7ce7f502d4;

    uint256 constant IC10x_PART1 = 0x00000000000000000000000000000000064150e2ba5b56cad89f127f071264c1;
    uint256 constant IC10x_PART2 = 0xa001733abe1b618c8de0bb8c7c8320038352aae7c817c4204742eb11237b45fd;
    uint256 constant IC10y_PART1 = 0x0000000000000000000000000000000012c4111f0e8e30529ab07a3037f83b21;
    uint256 constant IC10y_PART2 = 0x50dfd408a0e51adb098f6f02546e1d42807f91acb573d8601326d9b7504cc2f7;

    uint256 constant IC11x_PART1 = 0x0000000000000000000000000000000016c26ada9a22689d3ff149615884c7a9;
    uint256 constant IC11x_PART2 = 0x6356ed83935c30b5047f506dc1c76c39188e0140341ab7db68f3b381f6ea9341;
    uint256 constant IC11y_PART1 = 0x000000000000000000000000000000000362d96c974b38e28703351973c00440;
    uint256 constant IC11y_PART2 = 0x3c498fb38fa23a66b7bfe92706d8731f54049933107e41ecaae9eaf14378abf8;

    uint256 constant IC12x_PART1 = 0x000000000000000000000000000000000cfa7c2d12c7069051be9202b9550f40;
    uint256 constant IC12x_PART2 = 0xda267e74d80a146366ba98fa57586d7f8334811c5ab4cadaf1d2f0b83c76dbe0;
    uint256 constant IC12y_PART1 = 0x0000000000000000000000000000000016125545fc5bdc6c20384f33fbc934cd;
    uint256 constant IC12y_PART2 = 0x21b290230f900de1dcb62b158fb865d0044fb23be28ef0cbb2468fc7562a35ca;

    uint256 constant IC13x_PART1 = 0x000000000000000000000000000000000ae416ab9a30953033f1ed4e4baa1d70;
    uint256 constant IC13x_PART2 = 0xda4641c8c5554a390a35a38e29941b77367fca3325ab6422208bb25bcdc5b425;
    uint256 constant IC13y_PART1 = 0x0000000000000000000000000000000007f0572e30c457b5d1ee5cbe195def99;
    uint256 constant IC13y_PART2 = 0x7376c8ca308229316c93ce9bb0ce4f8642a48a942146134fc6c7c8283e7d76fe;

    uint256 constant IC14x_PART1 = 0x000000000000000000000000000000001679e225e04bc7a6f2167f3b8655889c;
    uint256 constant IC14x_PART2 = 0xcf9211be3c650783cb30d7bce8c08e20009bbe0487f61bfe38b13422b29b8b02;
    uint256 constant IC14y_PART1 = 0x000000000000000000000000000000000e907c0829d0c70c24a10b73db46f7fa;
    uint256 constant IC14y_PART2 = 0x6916eac87b2d0c459fc4af926aadb7f083d587a382e7ccfb6c93d8a0caefe6bb;

    uint256 constant IC15x_PART1 = 0x000000000000000000000000000000000342eb71091bc7ad93404abc34f861fd;
    uint256 constant IC15x_PART2 = 0x3da109b35140a6d101d730c8cb5127e889234baeff59bc23a1ea19f232003ae6;
    uint256 constant IC15y_PART1 = 0x0000000000000000000000000000000001d73812880340295fb0870723c45d5a;
    uint256 constant IC15y_PART2 = 0xdd1fc3768f2b5beb72ebc0d99340adda161793fd0711344b40d268e6835c21cd;

    uint256 constant IC16x_PART1 = 0x000000000000000000000000000000000157d9a307cfc045dcc031f5495d6425;
    uint256 constant IC16x_PART2 = 0x0c24752c5afbab51893e0bd9ee8762ea59aa479483718e345c2fcbb31da12301;
    uint256 constant IC16y_PART1 = 0x0000000000000000000000000000000018b8846660c295f3665fddc628ffd5b2;
    uint256 constant IC16y_PART2 = 0x2271075f928c31452ca5cf13774e32d42b463d4be62179828a8f6419aba11432;

    uint256 constant IC17x_PART1 = 0x00000000000000000000000000000000168dcc73726b9659eca91813cb0d18a4;
    uint256 constant IC17x_PART2 = 0xdb2b6be6d182551084c4b79813648ada67da56382be1006f0bf9433714b81025;
    uint256 constant IC17y_PART1 = 0x0000000000000000000000000000000008ad24eca43e587e8350ef5d5ffea445;
    uint256 constant IC17y_PART2 = 0xacbd32db670f3a2d8c59fb88c2bfb882eb15d031ddb8400f7d7f24efd235d75b;

    uint256 constant IC18x_PART1 = 0x000000000000000000000000000000000b51944f04112933687a53edd23b44c2;
    uint256 constant IC18x_PART2 = 0x6897bcae8073dc81d8132cb9a95b44fa3eb94406823f6ec93b399d9539718d4c;
    uint256 constant IC18y_PART1 = 0x0000000000000000000000000000000019abcec91fdb77a1ba7af32d98910b2f;
    uint256 constant IC18y_PART2 = 0xbe933ec0bc15ea3adf3ad2484a67406700ef45e860b511b0f21feb763878a894;

    uint256 constant IC19x_PART1 = 0x0000000000000000000000000000000011b1988beed226dceb22b4a4c4aec02b;
    uint256 constant IC19x_PART2 = 0x4b1e0630437a16c6390c26cd6432a08be86cedc698d873d1f2b3e3cc99fe4c28;
    uint256 constant IC19y_PART1 = 0x0000000000000000000000000000000008e70e33eb84c08e950df83229175fac;
    uint256 constant IC19y_PART2 = 0x0a33deb8be2201869db95d45c75fcc3a0b1dbe423d8f9c6553c5890da4fd881f;

    uint256 constant IC20x_PART1 = 0x000000000000000000000000000000001911f17ca04784029c1c89d9e31c2584;
    uint256 constant IC20x_PART2 = 0xc14951d86d32f3fb03db0be1c3d2092a78d78820db9c20da232205befef43f44;
    uint256 constant IC20y_PART1 = 0x000000000000000000000000000000000e935e86a81303c262c79ea1c2d68f88;
    uint256 constant IC20y_PART2 = 0x2f8f0194cf064d4bf6433aa1d7207b3d75114baf99b871b515fbd3c85a67b0dc;

    uint256 constant IC21x_PART1 = 0x0000000000000000000000000000000006a517c6460016fc47f10dce5f3faf73;
    uint256 constant IC21x_PART2 = 0x44d863559c258ebdf55efd0a8797b98a7ad388d243237a4d6d9887b7638f7356;
    uint256 constant IC21y_PART1 = 0x00000000000000000000000000000000047d6bc591e9dbf10f7ce189cd9a2799;
    uint256 constant IC21y_PART2 = 0x56ee67af4eacb89d70ce29a4162bf3587234e40e03e81a996527b88f7f240518;

    uint256 constant IC22x_PART1 = 0x0000000000000000000000000000000012c44ccdee38d4e44141efd8ff02f3c6;
    uint256 constant IC22x_PART2 = 0x8ba22039e09e0a8e4a9ed615cc2458adace94feed1785484710d33900007ff22;
    uint256 constant IC22y_PART1 = 0x00000000000000000000000000000000170294dd3c57c242183e5efaa76f9468;
    uint256 constant IC22y_PART2 = 0x0cfa6e997a62a489344b76681dd04fe0d8d8a5d040366915ad09d404d6894303;

    uint256 constant IC23x_PART1 = 0x000000000000000000000000000000000f0cfa068d571edcc32d4c5cac71e6e1;
    uint256 constant IC23x_PART2 = 0x14edd255f7ab3f17b237014e2e2758025ab3be1cd5bf11aeafdc56ee35a9d22d;
    uint256 constant IC23y_PART1 = 0x0000000000000000000000000000000002af8dc83d507e10e187eaf3c6f28c56;
    uint256 constant IC23y_PART2 = 0x67fe281e0a3ca79863426625a5235fb45be4fb56f8ff34fbed4cc132e404a78f;

    uint256 constant IC24x_PART1 = 0x0000000000000000000000000000000017d65a6a6015e6d79078c3e87230b5b5;
    uint256 constant IC24x_PART2 = 0x0fb051c8296e7f2255f333621b5832a6ce20700ca84b3770abff2ca60897bc86;
    uint256 constant IC24y_PART1 = 0x000000000000000000000000000000000497bcd02a3258bc4b1fb5abe925a694;
    uint256 constant IC24y_PART2 = 0x775b0c77f0d351feba0661a84a6f984e9085ddaedcc8897d92457b05a802cd34;

    uint256 constant IC25x_PART1 = 0x000000000000000000000000000000000d2c105a8eac5536bf5668c167ddacf2;
    uint256 constant IC25x_PART2 = 0xf4bcf9a79fd1b6bc502dc53bc8fd61df698017cb7114e536cb01e8727b2d2471;
    uint256 constant IC25y_PART1 = 0x000000000000000000000000000000000f153a564fd797ad1d177dafd09e5bd0;
    uint256 constant IC25y_PART2 = 0xcec250b79b29d33f75273b141d555e490391c683ad878aa00304111278f79143;

    uint256 constant IC26x_PART1 = 0x00000000000000000000000000000000006800261cab257632f66b60397acef1;
    uint256 constant IC26x_PART2 = 0x1b36084e4ef6a5bf591715df1e136b0c6b348a2f30aece2c90580d299a452a85;
    uint256 constant IC26y_PART1 = 0x0000000000000000000000000000000008454bcaa706ce6e9537a2f5c3d01884;
    uint256 constant IC26y_PART2 = 0xfbba9e111c123faf2eef14bcf06da87cf0bdb04b69077318d18bee2694eed985;

    uint256 constant IC27x_PART1 = 0x0000000000000000000000000000000003af8c8c7813941f5741b4881cc7bf71;
    uint256 constant IC27x_PART2 = 0xe78cd0e76d8fe2dae1c5fe8161b7fdf5f60f32247985aa7ba0ea9adf209edc36;
    uint256 constant IC27y_PART1 = 0x0000000000000000000000000000000002194098d3286ef73ce52b79502df9c7;
    uint256 constant IC27y_PART2 = 0x2a9315de72a03a0dc9d00adf26495354d6ea6135798b1073247df61a404d670b;

    uint256 constant IC28x_PART1 = 0x000000000000000000000000000000000ab31d6b4745997fc9bea28fa0aab105;
    uint256 constant IC28x_PART2 = 0x0e7da8d5a52c7acc46a34419b2a071fd4960eb46a9bd29b3ecae615dca0262eb;
    uint256 constant IC28y_PART1 = 0x00000000000000000000000000000000081699ef7202d86ab3852e865861133a;
    uint256 constant IC28y_PART2 = 0xa7a03882bd58853cf4c427a681933975ec90489d31839748f3fa489db4c54e53;

    uint256 constant IC29x_PART1 = 0x0000000000000000000000000000000001159b8389e0800f598b03139e7402c8;
    uint256 constant IC29x_PART2 = 0x506b5ed2c0fb987b711ed827008bcaad1176e0360e888c8b6ee049fc2f7277e3;
    uint256 constant IC29y_PART1 = 0x000000000000000000000000000000000e4ce7ce48d62a7f8925d4a148725941;
    uint256 constant IC29y_PART2 = 0x6b3b1b5ef61a92f1a713c9591b0e7b1880cf35ef14eb2168cf539371411bc822;

    uint256 constant IC30x_PART1 = 0x000000000000000000000000000000000426132da38cfae8bedeb02545738dee;
    uint256 constant IC30x_PART2 = 0x5f7dcba696dc59797e6fe44fe0e5a24543ba4eba886ca1327e98cc866b45b610;
    uint256 constant IC30y_PART1 = 0x0000000000000000000000000000000011a246596e246607dca2903423c39ecc;
    uint256 constant IC30y_PART2 = 0x8709412bcb300f4e02119279fcb847721aa27557df1cd233af6c2c1b718ff436;

    uint256 constant IC31x_PART1 = 0x000000000000000000000000000000000f29281eb5d7df7e11e0fdab3d90b762;
    uint256 constant IC31x_PART2 = 0xcb5c473b554b1cc8f32c0976bc571438d39f2afedc2a89bec69db0636e686ce1;
    uint256 constant IC31y_PART1 = 0x000000000000000000000000000000000b220acc7ba6b744e42ed958a4e478eb;
    uint256 constant IC31y_PART2 = 0x13ee2e3063c626a3994d188cc22642fe0bbb3c62cdb48a5759e3fcd3c148aab3;

    uint256 constant IC32x_PART1 = 0x0000000000000000000000000000000005146c19527ad1ad66bca4bf32b5f24f;
    uint256 constant IC32x_PART2 = 0x1a181cb8bdc6e84eef2e281a883ef8358396c9378acb29a9b37a15571aa2814e;
    uint256 constant IC32y_PART1 = 0x000000000000000000000000000000000450d4c04811b67318d2e20e66d3714a;
    uint256 constant IC32y_PART2 = 0x2f3120718e89a2693a31973140e78de93ce8585ad0073368a0a2d3612f5e1f49;

    uint256 constant IC33x_PART1 = 0x0000000000000000000000000000000008254f9deee9880c816c855d080335b6;
    uint256 constant IC33x_PART2 = 0xf708348ed5fa78340d0d6f409bb2644cb1fe5c74b9c55bd86a9845a8c58e4194;
    uint256 constant IC33y_PART1 = 0x0000000000000000000000000000000011c1da2d6513a8e71b8b12aecaf728e1;
    uint256 constant IC33y_PART2 = 0xbf02cf2b521d1f64751ca4156f238d4b77c94ec1a4e83aae15b860a259ffd304;

    // Memory data
    uint16 constant pVk = 0;
    uint16 constant pPairing = 128;

    uint16 constant pLastMem = 1664;

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[33] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            function checkField(v) {
                if iszero(lt(v, R_MOD)) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Initialize vk_x with IC0 (the constant term)
                mstore(_pVk, IC0x_PART1)
                mstore(add(_pVk, 32), IC0x_PART2)
                mstore(add(_pVk, 64), IC0y_PART1)
                mstore(add(_pVk, 96), IC0y_PART2)

                // Compute the linear combination vk_x = IC0 + IC1*pubSignals[0] + IC2*pubSignals[1] + ...

                g1_mulAccC(_pVk, IC1x_PART1, IC1x_PART2, IC1y_PART1, IC1y_PART2, calldataload(add(pubSignals, 0)))

                g1_mulAccC(_pVk, IC2x_PART1, IC2x_PART2, IC2y_PART1, IC2y_PART2, calldataload(add(pubSignals, 32)))

                g1_mulAccC(_pVk, IC3x_PART1, IC3x_PART2, IC3y_PART1, IC3y_PART2, calldataload(add(pubSignals, 64)))

                g1_mulAccC(_pVk, IC4x_PART1, IC4x_PART2, IC4y_PART1, IC4y_PART2, calldataload(add(pubSignals, 96)))

                g1_mulAccC(_pVk, IC5x_PART1, IC5x_PART2, IC5y_PART1, IC5y_PART2, calldataload(add(pubSignals, 128)))

                g1_mulAccC(_pVk, IC6x_PART1, IC6x_PART2, IC6y_PART1, IC6y_PART2, calldataload(add(pubSignals, 160)))

                g1_mulAccC(_pVk, IC7x_PART1, IC7x_PART2, IC7y_PART1, IC7y_PART2, calldataload(add(pubSignals, 192)))

                g1_mulAccC(_pVk, IC8x_PART1, IC8x_PART2, IC8y_PART1, IC8y_PART2, calldataload(add(pubSignals, 224)))

                g1_mulAccC(_pVk, IC9x_PART1, IC9x_PART2, IC9y_PART1, IC9y_PART2, calldataload(add(pubSignals, 256)))

                g1_mulAccC(_pVk, IC10x_PART1, IC10x_PART2, IC10y_PART1, IC10y_PART2, calldataload(add(pubSignals, 288)))

                g1_mulAccC(_pVk, IC11x_PART1, IC11x_PART2, IC11y_PART1, IC11y_PART2, calldataload(add(pubSignals, 320)))

                g1_mulAccC(_pVk, IC12x_PART1, IC12x_PART2, IC12y_PART1, IC12y_PART2, calldataload(add(pubSignals, 352)))

                g1_mulAccC(_pVk, IC13x_PART1, IC13x_PART2, IC13y_PART1, IC13y_PART2, calldataload(add(pubSignals, 384)))

                g1_mulAccC(_pVk, IC14x_PART1, IC14x_PART2, IC14y_PART1, IC14y_PART2, calldataload(add(pubSignals, 416)))

                g1_mulAccC(_pVk, IC15x_PART1, IC15x_PART2, IC15y_PART1, IC15y_PART2, calldataload(add(pubSignals, 448)))

                g1_mulAccC(_pVk, IC16x_PART1, IC16x_PART2, IC16y_PART1, IC16y_PART2, calldataload(add(pubSignals, 480)))

                g1_mulAccC(_pVk, IC17x_PART1, IC17x_PART2, IC17y_PART1, IC17y_PART2, calldataload(add(pubSignals, 512)))

                g1_mulAccC(_pVk, IC18x_PART1, IC18x_PART2, IC18y_PART1, IC18y_PART2, calldataload(add(pubSignals, 544)))

                g1_mulAccC(_pVk, IC19x_PART1, IC19x_PART2, IC19y_PART1, IC19y_PART2, calldataload(add(pubSignals, 576)))

                g1_mulAccC(_pVk, IC20x_PART1, IC20x_PART2, IC20y_PART1, IC20y_PART2, calldataload(add(pubSignals, 608)))

                g1_mulAccC(_pVk, IC21x_PART1, IC21x_PART2, IC21y_PART1, IC21y_PART2, calldataload(add(pubSignals, 640)))

                g1_mulAccC(_pVk, IC22x_PART1, IC22x_PART2, IC22y_PART1, IC22y_PART2, calldataload(add(pubSignals, 672)))

                g1_mulAccC(_pVk, IC23x_PART1, IC23x_PART2, IC23y_PART1, IC23y_PART2, calldataload(add(pubSignals, 704)))

                g1_mulAccC(_pVk, IC24x_PART1, IC24x_PART2, IC24y_PART1, IC24y_PART2, calldataload(add(pubSignals, 736)))

                g1_mulAccC(_pVk, IC25x_PART1, IC25x_PART2, IC25y_PART1, IC25y_PART2, calldataload(add(pubSignals, 768)))

                g1_mulAccC(_pVk, IC26x_PART1, IC26x_PART2, IC26y_PART1, IC26y_PART2, calldataload(add(pubSignals, 800)))

                g1_mulAccC(_pVk, IC27x_PART1, IC27x_PART2, IC27y_PART1, IC27y_PART2, calldataload(add(pubSignals, 832)))

                g1_mulAccC(_pVk, IC28x_PART1, IC28x_PART2, IC28y_PART1, IC28y_PART2, calldataload(add(pubSignals, 864)))

                g1_mulAccC(_pVk, IC29x_PART1, IC29x_PART2, IC29y_PART1, IC29y_PART2, calldataload(add(pubSignals, 896)))

                g1_mulAccC(_pVk, IC30x_PART1, IC30x_PART2, IC30y_PART1, IC30y_PART2, calldataload(add(pubSignals, 928)))

                g1_mulAccC(_pVk, IC31x_PART1, IC31x_PART2, IC31y_PART1, IC31y_PART2, calldataload(add(pubSignals, 960)))

                g1_mulAccC(_pVk, IC32x_PART1, IC32x_PART2, IC32y_PART1, IC32y_PART2, calldataload(add(pubSignals, 992)))

                g1_mulAccC(
                    _pVk, IC33x_PART1, IC33x_PART2, IC33y_PART1, IC33y_PART2, calldataload(add(pubSignals, 1024))
                )

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default {
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate that all evaluations âˆˆ F

            checkField(calldataload(add(_pubSignals, 0)))

            checkField(calldataload(add(_pubSignals, 32)))

            checkField(calldataload(add(_pubSignals, 64)))

            checkField(calldataload(add(_pubSignals, 96)))

            checkField(calldataload(add(_pubSignals, 128)))

            checkField(calldataload(add(_pubSignals, 160)))

            checkField(calldataload(add(_pubSignals, 192)))

            checkField(calldataload(add(_pubSignals, 224)))

            checkField(calldataload(add(_pubSignals, 256)))

            checkField(calldataload(add(_pubSignals, 288)))

            checkField(calldataload(add(_pubSignals, 320)))

            checkField(calldataload(add(_pubSignals, 352)))

            checkField(calldataload(add(_pubSignals, 384)))

            checkField(calldataload(add(_pubSignals, 416)))

            checkField(calldataload(add(_pubSignals, 448)))

            checkField(calldataload(add(_pubSignals, 480)))

            checkField(calldataload(add(_pubSignals, 512)))

            checkField(calldataload(add(_pubSignals, 544)))

            checkField(calldataload(add(_pubSignals, 576)))

            checkField(calldataload(add(_pubSignals, 608)))

            checkField(calldataload(add(_pubSignals, 640)))

            checkField(calldataload(add(_pubSignals, 672)))

            checkField(calldataload(add(_pubSignals, 704)))

            checkField(calldataload(add(_pubSignals, 736)))

            checkField(calldataload(add(_pubSignals, 768)))

            checkField(calldataload(add(_pubSignals, 800)))

            checkField(calldataload(add(_pubSignals, 832)))

            checkField(calldataload(add(_pubSignals, 864)))

            checkField(calldataload(add(_pubSignals, 896)))

            checkField(calldataload(add(_pubSignals, 928)))

            checkField(calldataload(add(_pubSignals, 960)))

            checkField(calldataload(add(_pubSignals, 992)))

            checkField(calldataload(add(_pubSignals, 1024)))

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}



================================================
FILE: src/verifier/Groth16Verifier32Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
/*
    Copyright 2021 0KIMS association.

    This file is generated with [snarkJS](https://github.com/iden3/snarkjs).

    snarkJS is a free software: you can redistribute it and/or modify it
    under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    snarkJS is distributed in the hope that it will be useful, but WITHOUT
    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
    or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public
    License for more details.

    You should have received a copy of the GNU General Public License
    along with snarkJS. If not, see <https://www.gnu.org/licenses/>.
*/

pragma solidity >=0.7.0 <0.9.0;

contract Groth16Verifier32Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 constant alphax_PART1 = 0x000000000000000000000000000000000041aec82900960a8f89d297b8361c46;
    uint256 constant alphax_PART2 = 0x965d3d9b8a5d0f58c2cf30e3e76777f7ecc18a58789ae4e61a959f9ce352f11b;
    uint256 constant alphay_PART1 = 0x0000000000000000000000000000000011b89c42e2c64df0886f20ef133a73b7;
    uint256 constant alphay_PART2 = 0xe7f1324a8309139ca841b5895b838f73ed2275d7661b68a75f58377551a8b913;
    uint256 constant betax1_PART1 = 0x00000000000000000000000000000000170d37a68234c1a86d9567dc33b985fe;
    uint256 constant betax1_PART2 = 0xd262eb743f24162f9d4c72058789589b6983bdf056ae1a083c16169432941283;
    uint256 constant betax2_PART1 = 0x00000000000000000000000000000000159077a549d9092da3d9085f0e86a6f7;
    uint256 constant betax2_PART2 = 0xdbeee4986e8428ca1d1455518651c51ee171af97852f6c4c43f22fb748fac3c2;
    uint256 constant betay1_PART1 = 0x000000000000000000000000000000001009966cbaef70dda75304685c942598;
    uint256 constant betay1_PART2 = 0x80f492b2b0b0dc28a137b6bf184456054053bb9bac889103d80858f764eccfde;
    uint256 constant betay2_PART1 = 0x000000000000000000000000000000000de4adbd44f0bfd56fb04dfd0cdcccb7;
    uint256 constant betay2_PART2 = 0x54fd77c317e4a78c742f2ef2773633b9072e8d00615d014f2b99fd8e7376a201;
    uint256 constant gammax1_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax1_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammax2_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax2_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay1_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay2_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;
    uint256 constant deltax1_PART1 = 0x000000000000000000000000000000000511f5a6791a477a939b2af36e835c5f;
    uint256 constant deltax1_PART2 = 0x74d20fc06d9a617e37a20dcdd4f2b60d2cafb169af6894705c359be21e0c2eb1;
    uint256 constant deltax2_PART1 = 0x00000000000000000000000000000000086b1680ff0205e4acacc7e03aa6451b;
    uint256 constant deltax2_PART2 = 0xa8a7f65aec3787d4bd55da657e32ed4708c0c9bb2f374d3d6639eb20187d7b42;
    uint256 constant deltay1_PART1 = 0x000000000000000000000000000000000b01e2196083be927ac8aaaaec0ca4f9;
    uint256 constant deltay1_PART2 = 0x97ea6939d0cddb54d83bae25755ce345f41b031901022ef6ab2650fbcf2564dd;
    uint256 constant deltay2_PART1 = 0x000000000000000000000000000000001903afc9d61bebbecb342ecd44bec844;
    uint256 constant deltay2_PART2 = 0x361dd7f89ce94a0b591f6b770814a24b02e9f9ef3d0402b00f9a0c9d88227e9e;

    // IC Points - split into PART1/PART2 for BLS12-381 format

    uint256 constant IC0x_PART1 = 0x000000000000000000000000000000000bd84410c1d1485e54dfcca454fb2f48;
    uint256 constant IC0x_PART2 = 0xb3050e51f52b5fd9354f51aeabc371ccaa2e890cce6ff0567bc744d8ea42cb7f;
    uint256 constant IC0y_PART1 = 0x00000000000000000000000000000000080510abea78ce71703ed5b4be7cfb5f;
    uint256 constant IC0y_PART2 = 0x59501c14091301622c0d990ca5b2e0fcd8bb2cf3c94c37f36e3ade6d359bde63;
    //
    uint256 constant IC1x_PART1 = 0x00000000000000000000000000000000075f28c68c7f422bc75f8521bb5b8659;
    uint256 constant IC1x_PART2 = 0x09a8e471684d564c65d8a1acbb6183b3b580833263b79b8c44dd2e3d8d6963b8;
    uint256 constant IC1y_PART1 = 0x000000000000000000000000000000000c58d97a360879c71000e2388a764e2c;
    uint256 constant IC1y_PART2 = 0x622450b6bf00480ff71a8ef756929ffb3c415bbe712b0e2f81e89735bb850682;
    uint256 constant IC2x_PART1 = 0x000000000000000000000000000000000aa6b99a5170df6106a974a8726ef8ae;
    uint256 constant IC2x_PART2 = 0x94f2b2b3ce27d95ab2a2dfdf8edf4d8df5dbb15edfbe498f19671747268abaa0;
    uint256 constant IC2y_PART1 = 0x000000000000000000000000000000000c07a973cf8ac1cfdd4372ab40998807;
    uint256 constant IC2y_PART2 = 0x81e9976a0a04171a1f19171f41a52c5b38aec518db8ddd0255ea7395b9e72f52;
    uint256 constant IC3x_PART1 = 0x000000000000000000000000000000000ff1d88461c7f3752e0d73d41224d5c9;
    uint256 constant IC3x_PART2 = 0xe8cdae0e2120d3c41f6d0119054bba015669480bc38fe5a759fe7b91d665981e;
    uint256 constant IC3y_PART1 = 0x0000000000000000000000000000000003df3112b643b38de506c9877c62c38d;
    uint256 constant IC3y_PART2 = 0x6ee98be0976d55810eb58e1a0ca32f56a73e155017245d66fe1bfa2bf27275a4;
    uint256 constant IC4x_PART1 = 0x0000000000000000000000000000000013b3b531f1b1a6c349e765e5d987afe4;
    uint256 constant IC4x_PART2 = 0x5e4f327c9ccfc1a90c13d301f90b0a6592c0c37767cb7a1bac26947019c10cc7;
    uint256 constant IC4y_PART1 = 0x000000000000000000000000000000000f3d0f4fee0bcc82dd7c3961748acaf4;
    uint256 constant IC4y_PART2 = 0x6c14f51bd8dda020dd36f6590fae4b3f029b6a0491d49c035b75f85bc2aab810;
    uint256 constant IC5x_PART1 = 0x00000000000000000000000000000000006ab4de26aa2a8d47c2e26c5d3bad49;
    uint256 constant IC5x_PART2 = 0x64674a907d5fbdf4b4dac63fe6072f083eaf6d5a5b428ffa229f7b455c2752fc;
    uint256 constant IC5y_PART1 = 0x000000000000000000000000000000000689c5b3807608e834b3e82e8897d74d;
    uint256 constant IC5y_PART2 = 0xb222c07df5036932de535744856c5407b352b820d60d673ecaddac53f891d189;
    uint256 constant IC6x_PART1 = 0x00000000000000000000000000000000013321abc572a8fc3993dae7f1547799;
    uint256 constant IC6x_PART2 = 0x64997e7ac569e48c4ef0f0e5d7a03f33d2cf2a150c86013721af0ac821af50f4;
    uint256 constant IC6y_PART1 = 0x000000000000000000000000000000000ee25dc0d1cbaf330d0daa9fc5c0f160;
    uint256 constant IC6y_PART2 = 0x0782237630b4af1e28b077b6195f8a91c3d3a52d6813edbe930df9155acf0b9d;
    uint256 constant IC7x_PART1 = 0x00000000000000000000000000000000110c112981ac6625b428c5175ae32930;
    uint256 constant IC7x_PART2 = 0x248c289cb375ae19af9fec8e57076283f55d31d37144cbefdd3592d43ed3d58d;
    uint256 constant IC7y_PART1 = 0x000000000000000000000000000000000e0d4a3e5cc7d4dc843878010c5f5944;
    uint256 constant IC7y_PART2 = 0x848ce3d3fd427796734d57653b853ed81678d1bc9b578d7d85f6135a7c9240db;
    uint256 constant IC8x_PART1 = 0x000000000000000000000000000000000eb1524f99abf6867d907ef62da6b978;
    uint256 constant IC8x_PART2 = 0x10a619901faf24ee872aa8c280fa8af876942e4cd34357b7fcc6732c9dd1963a;
    uint256 constant IC8y_PART1 = 0x0000000000000000000000000000000002926eeb748571f8ad6e9f459128e196;
    uint256 constant IC8y_PART2 = 0x60d7a76055118eb559aeb22c6cc2a5752e2f95606d0b0d1848ec32313ea52066;
    uint256 constant IC9x_PART1 = 0x000000000000000000000000000000000b53e4b3df17bc4677854a38cf96fd2c;
    uint256 constant IC9x_PART2 = 0x8b2627e933ce8bebfbf9a116b91c377399353f38a4fa827f377aa5b300a3dabd;
    uint256 constant IC9y_PART1 = 0x000000000000000000000000000000000c484a99c47103e7ff88edafde3adfb8;
    uint256 constant IC9y_PART2 = 0x5ca3f1bd847104db4bcc15724bccdc7b44b1a0c7197b6abc4c9b3b27aa43b107;
    uint256 constant IC10x_PART1 = 0x00000000000000000000000000000000129319c19eafaae9d439e0666bf1d3fd;
    uint256 constant IC10x_PART2 = 0xccefb7e241c5cf1a23dfada65deb708d0d80761ebcbf5a04f860aff0dadc4625;
    uint256 constant IC10y_PART1 = 0x0000000000000000000000000000000010d69a9debc87df726f42f3452ae8694;
    uint256 constant IC10y_PART2 = 0x8ccfa35ac4671cd21a5fe3761c9038b0386c5f5485983f028b79b83fd9149cb1;
    uint256 constant IC11x_PART1 = 0x00000000000000000000000000000000079168665edeb7bac558417545d19d0f;
    uint256 constant IC11x_PART2 = 0x5413678ede15e4573add95fab6b131d20a6ed5de02a0cbc2502136bc6e2cab4d;
    uint256 constant IC11y_PART1 = 0x000000000000000000000000000000000789507749c593e4ce2cf0e8d79f03e3;
    uint256 constant IC11y_PART2 = 0x6225a0b15cb9bccbabc71393a25e910f76663c824cb2d1c490d065ae312171db;
    uint256 constant IC12x_PART1 = 0x0000000000000000000000000000000013dda62cf1ee5ea03a47b953dbd852d8;
    uint256 constant IC12x_PART2 = 0x32bfefa6b32bab97ff6f50b9169077162d3bb31480722fa79d45aefd070a3d89;
    uint256 constant IC12y_PART1 = 0x0000000000000000000000000000000016c3b964adf4c372a54f076ee7d652d5;
    uint256 constant IC12y_PART2 = 0xe7adafc3b31ca71b2c905fd9c410941d89e7af93dff0d9227e6ebd53f97baf8c;
    uint256 constant IC13x_PART1 = 0x00000000000000000000000000000000178eb0eb2186b896cb2a4c4dd3603f61;
    uint256 constant IC13x_PART2 = 0x7fb4a581ac79a43aed0cd074c5f5053924e6bfc39335520236d6ecd8e5bd6c27;
    uint256 constant IC13y_PART1 = 0x00000000000000000000000000000000078b6c81048304a312058e88ab7d5d91;
    uint256 constant IC13y_PART2 = 0xf57b0e0464cc3d7591f8181d818e32e30d5606b5ef3cb9e3c481beb0d247d503;
    uint256 constant IC14x_PART1 = 0x000000000000000000000000000000000576ccb83c469370b97d241de66e6e19;
    uint256 constant IC14x_PART2 = 0xf0a1c4dc8ee6ecba574e7ecb23ea3454dc964ae36d9b232408023b8411791a10;
    uint256 constant IC14y_PART1 = 0x000000000000000000000000000000000f865c8c718ce2825b4fe348b26aca59;
    uint256 constant IC14y_PART2 = 0x2ccd6fa431619517cb5f6e9f3ff26a4f3c67ca05c335fcb76d82d3b765ab41da;
    uint256 constant IC15x_PART1 = 0x00000000000000000000000000000000021adf3466c49a5fb42209c4d50ac1ea;
    uint256 constant IC15x_PART2 = 0xd3bb6dc0cce40f18a55535bce540dd75044b2fd335f7661e4c926b629f682e28;
    uint256 constant IC15y_PART1 = 0x000000000000000000000000000000000e43b42be4d124b2050ef0f71efdccd0;
    uint256 constant IC15y_PART2 = 0xf6a6326467055ca0ca5f35cba5deb75fd8650ec58d36381fed9de8c86a00fc15;
    uint256 constant IC16x_PART1 = 0x000000000000000000000000000000000542bc13e9236b8b57ab044271e1a300;
    uint256 constant IC16x_PART2 = 0x7f8ac1c3e6747acc59b1f56c9352cb06df91803fdbc347cc5fe1a64b77625d29;
    uint256 constant IC16y_PART1 = 0x0000000000000000000000000000000008d91b4859336162577479ca26e01040;
    uint256 constant IC16y_PART2 = 0xcd8e49d2007bc5a5832fed6409e451c2adc95cb633e4fcc45a5427684ed0ad66;
    uint256 constant IC17x_PART1 = 0x0000000000000000000000000000000015cd7e227ce819a56cf66cdcf9c34bb6;
    uint256 constant IC17x_PART2 = 0xcff9720ffaa656909a7565e2bb6293dae4a422922d64e49a824f9488f820d045;
    uint256 constant IC17y_PART1 = 0x0000000000000000000000000000000013ce89ce8dddbc0e1f8dcf206f40bc21;
    uint256 constant IC17y_PART2 = 0x9e07977ad5b3ac56a18165c1b8f53ec6a8e1dff4443e941ec80bc4fdd3b65356;
    uint256 constant IC18x_PART1 = 0x000000000000000000000000000000000a9b0150f8e31e5cb2389b7e8edb1d7b;
    uint256 constant IC18x_PART2 = 0x0250f04a731b881f911cf3e0be752984178db6f37c681f786df780f7db9d0a69;
    uint256 constant IC18y_PART1 = 0x0000000000000000000000000000000011a50be4e7b1947071ac33565f0e482e;
    uint256 constant IC18y_PART2 = 0xfeb21211ebe044422ac837592c9e54caa7b444a8751e6f85627607fa52bb790a;
    uint256 constant IC19x_PART1 = 0x00000000000000000000000000000000085435df9e7d053897021ccc086b141f;
    uint256 constant IC19x_PART2 = 0xc0cc6aa84ffa4668ad8cdbe791e00a5d521336699a42000519ecce100c4b9931;
    uint256 constant IC19y_PART1 = 0x00000000000000000000000000000000091f082c9cf0d2c682828d7e888dad6f;
    uint256 constant IC19y_PART2 = 0xe9bc272d23f0ace69dfcf7c2c97010be6d37127c0abca0939687f943a2a61bbc;
    uint256 constant IC20x_PART1 = 0x0000000000000000000000000000000001f7032a834131ece135916451d27f1a;
    uint256 constant IC20x_PART2 = 0xea77b750a2c7fcfd6de7a8a23eb1d0bdcc5131ed8333731fa56289b404ab9c7c;
    uint256 constant IC20y_PART1 = 0x0000000000000000000000000000000000c1e82f7b5570d71ddefbe7be40b8b4;
    uint256 constant IC20y_PART2 = 0x7e7850e55c65407d55ffb88bfb542af26c0becd641419f3bd76a63391db707d8;
    uint256 constant IC21x_PART1 = 0x000000000000000000000000000000001452183e3a2d308c64b6b79676ba5893;
    uint256 constant IC21x_PART2 = 0x55567574e031b08fd57a95bda8b833f3eb4bd65bfd8ecb2ea1cbaa3dd058a61d;
    uint256 constant IC21y_PART1 = 0x0000000000000000000000000000000005dd75a192537058864595fa114b3840;
    uint256 constant IC21y_PART2 = 0x6bf2c7492df2c3cbc3f2105bc21aff62a8e6db70c4a18e3f7816af6d6de7eead;
    uint256 constant IC22x_PART1 = 0x0000000000000000000000000000000005f7e9fff8ad2715f0e01cefd44fa658;
    uint256 constant IC22x_PART2 = 0x29eaf19d4022b110cd60b833a79d632eb5041c69d20cda4ddbf6fdff73b12edb;
    uint256 constant IC22y_PART1 = 0x0000000000000000000000000000000007d72ca6673bab185d8bc9c26efe62a8;
    uint256 constant IC22y_PART2 = 0xc389e662bbe7266d339b44c88de1dae771e5c6aa17f4f3c64a03392c0fa0e3f7;
    uint256 constant IC23x_PART1 = 0x0000000000000000000000000000000011548bc9571ce240cb9861ccba072067;
    uint256 constant IC23x_PART2 = 0x27ba91c689156f6ffc8bae85a1b18ad50c9a1dfa6a10a83ee25f77d8a2cf8c4c;
    uint256 constant IC23y_PART1 = 0x00000000000000000000000000000000166bd420210e05f0064467e31c55fda7;
    uint256 constant IC23y_PART2 = 0xf06a7c92cb356866432ed4d36aa1030d8e788e2750e6da311e4bfb0b923cc297;
    uint256 constant IC24x_PART1 = 0x0000000000000000000000000000000004b4b6ee77a11a4cfa070d7bb7a2c9a7;
    uint256 constant IC24x_PART2 = 0x4e0064dead374eb89cb85f186dfb7c2f8de054ede15498a83d07b4884166a444;
    uint256 constant IC24y_PART1 = 0x0000000000000000000000000000000016a5d332ffc8e41868964a5a417148d3;
    uint256 constant IC24y_PART2 = 0xcc5c13b6a9c38c5822c2b1ff88b8d0db45bf81ef87114f5cedc9a31916e56b31;
    uint256 constant IC25x_PART1 = 0x000000000000000000000000000000000e6201a0896d41bf321a9e9a59bd6b30;
    uint256 constant IC25x_PART2 = 0xb462a3642667eb2fa1e53e5e821ac9ebe5010373a1b54ace3d6be617cdb44b38;
    uint256 constant IC25y_PART1 = 0x000000000000000000000000000000000867c8bc707ad6727acc88c217f71798;
    uint256 constant IC25y_PART2 = 0x7393374c6c6b2f529353128f47b1865c8f3220dfad206c0678ebe82ff5f5638d;
    uint256 constant IC26x_PART1 = 0x0000000000000000000000000000000003f672a894199fb6f11d2981718825d2;
    uint256 constant IC26x_PART2 = 0x86b1b22d68feba3426b25ed4518983f01bdfe6913700d67cfadd78bfbc985a71;
    uint256 constant IC26y_PART1 = 0x0000000000000000000000000000000007777b01b3f5e97a56f9043442967daa;
    uint256 constant IC26y_PART2 = 0xa71127d36b81e9681edd6fab470a787f1019a1137c115036e6f08ea24988b746;
    uint256 constant IC27x_PART1 = 0x00000000000000000000000000000000189d6728a5f4f8416893b154feb7d6d0;
    uint256 constant IC27x_PART2 = 0x27497aa33711472584f6378305a7b7be4468f2a9b0354a289c0feb40226607e4;
    uint256 constant IC27y_PART1 = 0x0000000000000000000000000000000010f2565193b439dfa43a8c98186d95ce;
    uint256 constant IC27y_PART2 = 0xaeb73ab119fd45618214e64d4a16ba72162d13ef27adfbfd026f077fd506897d;
    uint256 constant IC28x_PART1 = 0x000000000000000000000000000000000e4fc0d86f4f0a6d49c6e14711c8527f;
    uint256 constant IC28x_PART2 = 0x42287134f9c7daf26d2ca1fc780ea6225ca54b8b3f4510fe17ca802c3284c4a2;
    uint256 constant IC28y_PART1 = 0x000000000000000000000000000000000141a405a1ba31a2d68f7d28f3245d29;
    uint256 constant IC28y_PART2 = 0x05221b6c61d2bb720748be8412b5385f16ba062210904a202aabe89d440ced48;
    uint256 constant IC29x_PART1 = 0x00000000000000000000000000000000136b663968b9006504dc4c74f0fa29bf;
    uint256 constant IC29x_PART2 = 0x2bc791af0eac966016ae10dd9c2cf924dd2f09ff2b3498fede1e9085160252c6;
    uint256 constant IC29y_PART1 = 0x0000000000000000000000000000000017ebe2ad51c5aad8fab603706f5afd66;
    uint256 constant IC29y_PART2 = 0x839b8c741f45d42bd0c4a112e469107d5168663c9b1cdca055ccc6a1b0b97a32;
    uint256 constant IC30x_PART1 = 0x000000000000000000000000000000001881d67ac3833a2eeeae00e049cdffc9;
    uint256 constant IC30x_PART2 = 0x00bc94e51e710e3837bdb00efd640150dbf09796ba0685e03934cda044c01f72;
    uint256 constant IC30y_PART1 = 0x00000000000000000000000000000000010b7a61a2e710aa105736ffb29668ae;
    uint256 constant IC30y_PART2 = 0x8e1af6d94689dd465b607b95a84091b4215ecde1db845206b606ed0582dc4009;
    uint256 constant IC31x_PART1 = 0x00000000000000000000000000000000077daa7b6158fd58e087c502945722ef;
    uint256 constant IC31x_PART2 = 0xd6d862afc747b00544756d0ab1070835d845471a08081f04f5cdec9d1d6f1a22;
    uint256 constant IC31y_PART1 = 0x0000000000000000000000000000000000788c24fcec08461335e7872d5be015;
    uint256 constant IC31y_PART2 = 0x714921b028804173642069cd2ebb3a80c1ed1f046967fd8d6e02a111cb053480;
    uint256 constant IC32x_PART1 = 0x00000000000000000000000000000000172a276be06ade14bb650e9a670cecc3;
    uint256 constant IC32x_PART2 = 0x577cf56ccc0986cd4c89a23f27f23c32528a40ed14aced1c10b72c594bbc3f74;
    uint256 constant IC32y_PART1 = 0x000000000000000000000000000000000407c21089441140a2bd77d399a6193f;
    uint256 constant IC32y_PART2 = 0xa0d7d52a397c5916d9a768930d04b3b1786396ef2365c888d4cf1e31b93fd085;
    uint256 constant IC33x_PART1 = 0x0000000000000000000000000000000006cacf8ac3df7d1f4a318447e8889d72;
    uint256 constant IC33x_PART2 = 0x6a97a0606d029eccc5f5d8273c549cc323cd2bcd185b22b6c61474cd1519218f;
    uint256 constant IC33y_PART1 = 0x00000000000000000000000000000000018689847a84813019e9dc0055f0c4f9;
    uint256 constant IC33y_PART2 = 0x821d01e556a05fa97e0fa7c7ff6df3dde6095c8f2af0c3f02b59e40b15027478;
    uint256 constant IC34x_PART1 = 0x00000000000000000000000000000000058c52fcbde7d6a0baba344ab4d56771;
    uint256 constant IC34x_PART2 = 0x39fa7634c4c30ba9f1201dbd8291f57860cd47da7bb34982c5d65042fd3d9f72;
    uint256 constant IC34y_PART1 = 0x000000000000000000000000000000000ba3d203baadf16daebd923ee1b7d8b8;
    uint256 constant IC34y_PART2 = 0xf2e2716c2c7925e7f43288382fceafa6f3877b58384cdc5c7d37dee3f0bd5848;
    uint256 constant IC35x_PART1 = 0x00000000000000000000000000000000058420845a10040df0a09531a01c5ed0;
    uint256 constant IC35x_PART2 = 0x7bc1600ef6ba4ed08f613dd9df376e5df9c6208472e6ea4ec1c923fd7c6d929d;
    uint256 constant IC35y_PART1 = 0x00000000000000000000000000000000003e5260ec619d9a1f0ae6183fbb7a01;
    uint256 constant IC35y_PART2 = 0x4b99280f83d82b5ea680c0a49af69812d7abce5eeba9943526953cc4b5a7ebfb;
    uint256 constant IC36x_PART1 = 0x000000000000000000000000000000000b3ebacb914c2fcc56fc5badac494dfc;
    uint256 constant IC36x_PART2 = 0x2a25b31e715d694bf947fce3dc0bd9286ed184e8962aca846ede653f830c7f51;
    uint256 constant IC36y_PART1 = 0x0000000000000000000000000000000012e34cfc1dd0c04c243f85bbe414b75e;
    uint256 constant IC36y_PART2 = 0x01b98e3cf458563510965c7def3a206617a25916138fb0a71c3c11bd4860e7f3;
    uint256 constant IC37x_PART1 = 0x0000000000000000000000000000000015f03dab8fc2f4c44bc492f33ba23861;
    uint256 constant IC37x_PART2 = 0x78502380d14e1114c1fc503fdc235ed80ffb8f9feb994e0bd89e74755435ce96;
    uint256 constant IC37y_PART1 = 0x0000000000000000000000000000000015c2f63fcffb102ee737f9829d0200a7;
    uint256 constant IC37y_PART2 = 0x834016421431dfd3fbf960edecc267b2087eccb330381e12d2cd6a33ce856286;
    uint256 constant IC38x_PART1 = 0x00000000000000000000000000000000042849dccf3f5538d041486d26af660c;
    uint256 constant IC38x_PART2 = 0x3f5a04b29394ad96d59949d1bb8582c8275c7432657695c1785f83e86dd8dfb7;
    uint256 constant IC38y_PART1 = 0x000000000000000000000000000000000c0cd85a0dbd5f5d78d3a54b4db7f57c;
    uint256 constant IC38y_PART2 = 0xc5d443fb620681a25afd41289e367b15226b63c7a6b96fd386cff5d3f4a4962f;
    uint256 constant IC39x_PART1 = 0x0000000000000000000000000000000013a9ea68b4e29413f10bdf69927dedf9;
    uint256 constant IC39x_PART2 = 0x6253610e0af0adf8571fff0d3f6ebb2c17ddc32e948b23721dc3f0ec310fac9b;
    uint256 constant IC39y_PART1 = 0x000000000000000000000000000000000a31dcb6688a78b9eeb9adbaf57c9726;
    uint256 constant IC39y_PART2 = 0x50214f56f19f7e5b7362cd318bc8194a32983ecb957154faecde0884bcd06534;
    uint256 constant IC40x_PART1 = 0x0000000000000000000000000000000017466584508f24f0e8728e073523ead1;
    uint256 constant IC40x_PART2 = 0x371eefe09dbd0270f4708d4e38381c7b8563d358eda3b1b40e19bd9a622ee5ee;
    uint256 constant IC40y_PART1 = 0x000000000000000000000000000000000e27d887b44ca3c41e65ac10e0f6aff4;
    uint256 constant IC40y_PART2 = 0x1d880a9c8b23691c5781417fcfb5a7d0b936ceecc543241f8727ea6c6d8ad166;
    uint256 constant IC41x_PART1 = 0x0000000000000000000000000000000001a79b9cdb32c0b5efcb0c51053d8325;
    uint256 constant IC41x_PART2 = 0xdf5f1ddfcb87e7c00861eea7cd9289ab8919b55cef9694ef31ed454509f65a54;
    uint256 constant IC41y_PART1 = 0x000000000000000000000000000000000e8b21d255fc713a29ed189adeaddaad;
    uint256 constant IC41y_PART2 = 0x5745d4ae501d67efa83fc20e49ac3ac0aee2b6fec865fd82e779f126e2a8b11f;
    uint256 constant IC42x_PART1 = 0x000000000000000000000000000000000b1a71cfcbdc67f76ab0d9464a0af650;
    uint256 constant IC42x_PART2 = 0x47e338ca80f7150c8fa92fc3f829cd3b8ad24d28ae916ffb4be8611fda59fdb7;
    uint256 constant IC42y_PART1 = 0x00000000000000000000000000000000171600800a86a771ca420bb88e7b83f3;
    uint256 constant IC42y_PART2 = 0x811e5ad5964cbd98cb4098292b67a2c0b9a6b3a9e680b24f71f9b0ea9b32de1b;
    uint256 constant IC43x_PART1 = 0x00000000000000000000000000000000161e4237e71c39e2c93a6e0a1613ff61;
    uint256 constant IC43x_PART2 = 0x9f7bc2cb8b13cf5353f75eb98dd4568ee508bf6e1ed4dd1852bf9941be99ddc9;
    uint256 constant IC43y_PART1 = 0x000000000000000000000000000000000b1b910f8be5ce5ba57a255f5bd41b60;
    uint256 constant IC43y_PART2 = 0xf4eead82b718162f6dcd54cb2a960a87fb6baf5488a3b57752c0ea59068dcd90;
    uint256 constant IC44x_PART1 = 0x0000000000000000000000000000000012af89851533f07b331d223f745e412c;
    uint256 constant IC44x_PART2 = 0xa9ac4e523c7a5b0eb6bacfb10a1617efaf25fbd75e3db07430b6b6a551b7d590;
    uint256 constant IC44y_PART1 = 0x0000000000000000000000000000000014e220ab1c2442d8314c0e845affb403;
    uint256 constant IC44y_PART2 = 0xcd4acb6a7fddec01e49041a914eb5bc7c5a6785f0d507bf9097f7fc9b01f92bc;
    uint256 constant IC45x_PART1 = 0x000000000000000000000000000000000e90102b995acf171c15e25034ce3051;
    uint256 constant IC45x_PART2 = 0xf01418432a92bd64d39000717c6800d1ff3cfeb0537a8ab3d189e8df1927a22b;
    uint256 constant IC45y_PART1 = 0x00000000000000000000000000000000177a48a00e70602122f25fa2bfd04495;
    uint256 constant IC45y_PART2 = 0x2cb52469557b5083355697975bab7098b2e25d48492144b76fc1cec08cb6504c;
    uint256 constant IC46x_PART1 = 0x0000000000000000000000000000000008c356a384b8016953358f52122618d5;
    uint256 constant IC46x_PART2 = 0xcf05d7e6cf3ac00db441eb81bdd69da9825498ea44659782c583e34626f46f5e;
    uint256 constant IC46y_PART1 = 0x0000000000000000000000000000000011e70b94f0e313c688910913220f977a;
    uint256 constant IC46y_PART2 = 0x9120f97015aa675a2f256bfff9bf5fb4e6ee3a9a720f54d5e95ea40830dcb4e6;
    uint256 constant IC47x_PART1 = 0x000000000000000000000000000000000c3b6c2330f174024b66d664736c9c8f;
    uint256 constant IC47x_PART2 = 0xbb25678a525c6974bd4bdc5e8a092d9f6845a468aa5ade122d153f7c393ec830;
    uint256 constant IC47y_PART1 = 0x00000000000000000000000000000000076f8227c442cc52b9df65d85b1b6538;
    uint256 constant IC47y_PART2 = 0x2a29f62cea5b08836766afa9834aa2431ac596a36e7970bd6e723e7a395ef4d4;
    uint256 constant IC48x_PART1 = 0x00000000000000000000000000000000076b9336642f8978f9dd33094acfb435;
    uint256 constant IC48x_PART2 = 0xb1255bd953919baf2e398dad7ae46ecd0191c5d361d5bd0cb212b83d4d076c3d;
    uint256 constant IC48y_PART1 = 0x000000000000000000000000000000000c4ffc79a099f36170116d083f17552e;
    uint256 constant IC48y_PART2 = 0x907734cf578dc4ea1cee0b0bba5ede7e97038ef6f18277901aa1970129890fc2;
    uint256 constant IC49x_PART1 = 0x000000000000000000000000000000000c9d02cece5f89519e3b7e33cc3357fe;
    uint256 constant IC49x_PART2 = 0xf8583505cc5fb5f2fdc29a6402b89ad79f1751c82e06e97848459768f85f7e5f;
    uint256 constant IC49y_PART1 = 0x0000000000000000000000000000000017fbb1296917b916f5ecf128f7a135e9;
    uint256 constant IC49y_PART2 = 0x743b76570bd3aece18d1a21798e82d56af80c513dd390bee4d75279e51e898c4;
    uint256 constant IC50x_PART1 = 0x000000000000000000000000000000000b355aacdce950d32441d303df00ada9;
    uint256 constant IC50x_PART2 = 0x9855d96dd55c4feb1ef3727414996d6e7e3b1dedeb59af8283b759fd44813441;
    uint256 constant IC50y_PART1 = 0x000000000000000000000000000000000dd52cf3fb60b66e7f8dc426f84c6efa;
    uint256 constant IC50y_PART2 = 0x970022c49c75acfeeaa902518ca5abe8a095c9c7ec952bc3129c32ff53815534;
    uint256 constant IC51x_PART1 = 0x0000000000000000000000000000000017dd9966b46c2f5bca7f6bba1931fd0e;
    uint256 constant IC51x_PART2 = 0x42b8ef567fc35c886707d825c966e73c761e3ffebd01125ae82827d314c61ec4;
    uint256 constant IC51y_PART1 = 0x00000000000000000000000000000000168a6664a7ac9bac39d8e28624105e81;
    uint256 constant IC51y_PART2 = 0x407ccedccad76059d1f15e9126bcd75c97fa1e701fcea1fd1937cb65c7d02032;
    uint256 constant IC52x_PART1 = 0x000000000000000000000000000000000f75f1e0df985d6885fa0ecf1151db69;
    uint256 constant IC52x_PART2 = 0xab5ececbf3eadcbb000d25b5814e198deae157a9badf9fb7860258c4b6b43d46;
    uint256 constant IC52y_PART1 = 0x0000000000000000000000000000000015904b1af7171cae3494787ea4a2eb8c;
    uint256 constant IC52y_PART2 = 0xb34d729f3a6e356f0b182fc21874cede2fc1510c94005b9c3e09182f830aee05;
    uint256 constant IC53x_PART1 = 0x000000000000000000000000000000000faf229df0a8cfe3357741513800211f;
    uint256 constant IC53x_PART2 = 0xe60543474fd3bdf1c0efc4d6c2497914465005afcee98e8937f01b369921e4ba;
    uint256 constant IC53y_PART1 = 0x000000000000000000000000000000001662876a3d45fb06f0fec7aa3a5f1459;
    uint256 constant IC53y_PART2 = 0x2b50bf3a8cb237eacdc857537ced2e129ee7f6b7a26c2b2ead50b9a6e3722d91;
    uint256 constant IC54x_PART1 = 0x000000000000000000000000000000000089fc0aa19967aef33657b0f528ece4;
    uint256 constant IC54x_PART2 = 0xfdf51473e94be2cc61b00d64a47e27387664b8925ec108973530870bf9e0646f;
    uint256 constant IC54y_PART1 = 0x000000000000000000000000000000001690e548a0e450e9d565662883756762;
    uint256 constant IC54y_PART2 = 0x80c1eb64d80e4d9b71da46a79da7d4ff65e7d89806afd1aee6e1279b8f06cad1;
    uint256 constant IC55x_PART1 = 0x000000000000000000000000000000000c4e70178b6111ba139f57aa232da5d5;
    uint256 constant IC55x_PART2 = 0x14a23de10f7817bfea33066878f3c45beb9cc137330ffda0cde1146268546275;
    uint256 constant IC55y_PART1 = 0x0000000000000000000000000000000002fb6d8369f46776b26cd540ebb14fa7;
    uint256 constant IC55y_PART2 = 0x0545f5694ec03f6ded4384ec0278648f42a68b395119e41c6552d8301b8a005b;
    uint256 constant IC56x_PART1 = 0x000000000000000000000000000000000642b618a83a7b82bbd177c5e56ed3a3;
    uint256 constant IC56x_PART2 = 0x3037291fb6e7af16079afb6b564c25f2b361a968e57846aa1e6b0afc233b451e;
    uint256 constant IC56y_PART1 = 0x0000000000000000000000000000000019bb04a1a3d905c904a9eb99ecf5b238;
    uint256 constant IC56y_PART2 = 0x791b4477bc7b0f4bf9135c50b67eff06682a0d1b9f645603839660f2b4c4beb3;
    uint256 constant IC57x_PART1 = 0x0000000000000000000000000000000012d7e34308140e5f6ffeeb75d15e38dd;
    uint256 constant IC57x_PART2 = 0x6a4074e3ce5c5a72013153352d7c56acb0d1ad5744b4db65787ece85e9117173;
    uint256 constant IC57y_PART1 = 0x000000000000000000000000000000000a04d1f4a609ed407919ecf30596819b;
    uint256 constant IC57y_PART2 = 0x704c7195ec89431ca72214896a06b64bf0c6d0297e1f5929517ac3a5f376ea00;
    uint256 constant IC58x_PART1 = 0x0000000000000000000000000000000011dbf45fc8d7e5ba43343fa07b267373;
    uint256 constant IC58x_PART2 = 0x87dd7aee816f9a501af5ec84286f795879ae2ede745c11dd394f8d363b35bfec;
    uint256 constant IC58y_PART1 = 0x000000000000000000000000000000000bba584633be294ad2b3cd3f18d36e00;
    uint256 constant IC58y_PART2 = 0xc17ce26618ebf50ed56d462fe68bed89894f4d26698130243b860deb80d8c8a5;
    uint256 constant IC59x_PART1 = 0x00000000000000000000000000000000026bec7013286f3e7d731500b182d324;
    uint256 constant IC59x_PART2 = 0x600a7b1ec9c9980e96c8f9678a6bd1a836183279d4483463734b146eed068b44;
    uint256 constant IC59y_PART1 = 0x0000000000000000000000000000000009edcd405fb7515acf4c7f8d37a0d03c;
    uint256 constant IC59y_PART2 = 0xad06849556933a80c30cfde82487341622a473db0c3e6fd926e8f67ae65e14ea;
    uint256 constant IC60x_PART1 = 0x000000000000000000000000000000000b169f7540e7781412c3c68f21d149ae;
    uint256 constant IC60x_PART2 = 0x4d9713a12230c2186c8466c654cf2136b75f8232a018e8c521751e049b059865;
    uint256 constant IC60y_PART1 = 0x000000000000000000000000000000001247a6de929324eb0231acf1a8f2bda1;
    uint256 constant IC60y_PART2 = 0xf37e395849dd543ddb03bf4ae661110808c41e09d53d6db91baf3dd0b58512a3;
    uint256 constant IC61x_PART1 = 0x000000000000000000000000000000000874808a45246a988741e0a711022df3;
    uint256 constant IC61x_PART2 = 0xd5683b55034e75519c12a3c0ff2b51cfefa08de2f6a70207ed1805b78afa136d;
    uint256 constant IC61y_PART1 = 0x000000000000000000000000000000000b3acab1e9cb128369215a09569b3481;
    uint256 constant IC61y_PART2 = 0xfae60e58eebd2e501f6477ec4729768ff2339c2e6f2e943470c35e6e29995b8c;
    uint256 constant IC62x_PART1 = 0x000000000000000000000000000000000b2f729c902fe4f37349fb8a8cff62b8;
    uint256 constant IC62x_PART2 = 0x4cabdd7c1f695250138580815161c61095d34d623adf584b8a0891a7a4d3785b;
    uint256 constant IC62y_PART1 = 0x0000000000000000000000000000000010a0ed8474f317aa1d1bbd484e11f6a0;
    uint256 constant IC62y_PART2 = 0xc53b9381b5e076bd1c5f8ff7667213733c277a2e761aa41d09c6ef4bcd424c5e;
    uint256 constant IC63x_PART1 = 0x00000000000000000000000000000000086538bab9b441274acbd8a2d02b5b3e;
    uint256 constant IC63x_PART2 = 0x2b675e1b8efb7704792f3aa62a4fb8332063f609948c7f5e0aa6c79d10e1fabf;
    uint256 constant IC63y_PART1 = 0x0000000000000000000000000000000003e6f04d844c551d18c5d1234a7d8e79;
    uint256 constant IC63y_PART2 = 0xe4eca8fc11de6a82ff8e2243f6d248c93b7dd0da91ecc60045d7847d93a8976b;
    uint256 constant IC64x_PART1 = 0x0000000000000000000000000000000014d3faa8ae2de74b09b5071eb8d48699;
    uint256 constant IC64x_PART2 = 0x16420128fb0d1c33b1f300ef907b2252a71b3cc8e7e7e974f4ed5eb9bff7605f;
    uint256 constant IC64y_PART1 = 0x0000000000000000000000000000000000ac3fe4186da22f242fa4938227483e;
    uint256 constant IC64y_PART2 = 0xda3af40708a9763b46e740c7e7ae7e677c08c5d577e70c113b118f3ab11ed636;
    uint256 constant IC65x_PART1 = 0x00000000000000000000000000000000024facd1bffc60606a04796809e62b31;
    uint256 constant IC65x_PART2 = 0xf09a4601fd7d994f567d5fde5016c7618be7cc0644995fc28ebe3ae5bbfa71e5;
    uint256 constant IC65y_PART1 = 0x0000000000000000000000000000000009db94144fd8d7298ca7c4f462720bcd;
    uint256 constant IC65y_PART2 = 0x4c8f9a8985de0c430de39511d492993805b9820a7abe0574c12a2411cfcaa0a7;

    // Memory data
    uint16 constant pVk = 0;
    uint16 constant pPairing = 512;

    uint16 constant pLastMem = 1664;

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[65] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            function checkField(v) {
                if iszero(lt(v, R_MOD)) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Initialize vk_x with IC0 (the constant term)
                mstore(_pVk, IC0x_PART1)
                mstore(add(_pVk, 32), IC0x_PART2)
                mstore(add(_pVk, 64), IC0y_PART1)
                mstore(add(_pVk, 96), IC0y_PART2)

                // Compute the linear combination vk_x = IC0 + IC1*pubSignals[0] + IC2*pubSignals[1] + ...

                g1_mulAccC(_pVk, IC1x_PART1, IC1x_PART2, IC1y_PART1, IC1y_PART2, calldataload(add(pubSignals, 0)))

                g1_mulAccC(_pVk, IC2x_PART1, IC2x_PART2, IC2y_PART1, IC2y_PART2, calldataload(add(pubSignals, 32)))

                g1_mulAccC(_pVk, IC3x_PART1, IC3x_PART2, IC3y_PART1, IC3y_PART2, calldataload(add(pubSignals, 64)))

                g1_mulAccC(_pVk, IC4x_PART1, IC4x_PART2, IC4y_PART1, IC4y_PART2, calldataload(add(pubSignals, 96)))

                g1_mulAccC(_pVk, IC5x_PART1, IC5x_PART2, IC5y_PART1, IC5y_PART2, calldataload(add(pubSignals, 128)))

                g1_mulAccC(_pVk, IC6x_PART1, IC6x_PART2, IC6y_PART1, IC6y_PART2, calldataload(add(pubSignals, 160)))

                g1_mulAccC(_pVk, IC7x_PART1, IC7x_PART2, IC7y_PART1, IC7y_PART2, calldataload(add(pubSignals, 192)))

                g1_mulAccC(_pVk, IC8x_PART1, IC8x_PART2, IC8y_PART1, IC8y_PART2, calldataload(add(pubSignals, 224)))

                g1_mulAccC(_pVk, IC9x_PART1, IC9x_PART2, IC9y_PART1, IC9y_PART2, calldataload(add(pubSignals, 256)))

                g1_mulAccC(_pVk, IC10x_PART1, IC10x_PART2, IC10y_PART1, IC10y_PART2, calldataload(add(pubSignals, 288)))

                g1_mulAccC(_pVk, IC11x_PART1, IC11x_PART2, IC11y_PART1, IC11y_PART2, calldataload(add(pubSignals, 320)))

                g1_mulAccC(_pVk, IC12x_PART1, IC12x_PART2, IC12y_PART1, IC12y_PART2, calldataload(add(pubSignals, 352)))

                g1_mulAccC(_pVk, IC13x_PART1, IC13x_PART2, IC13y_PART1, IC13y_PART2, calldataload(add(pubSignals, 384)))

                g1_mulAccC(_pVk, IC14x_PART1, IC14x_PART2, IC14y_PART1, IC14y_PART2, calldataload(add(pubSignals, 416)))

                g1_mulAccC(_pVk, IC15x_PART1, IC15x_PART2, IC15y_PART1, IC15y_PART2, calldataload(add(pubSignals, 448)))

                g1_mulAccC(_pVk, IC16x_PART1, IC16x_PART2, IC16y_PART1, IC16y_PART2, calldataload(add(pubSignals, 480)))

                g1_mulAccC(_pVk, IC17x_PART1, IC17x_PART2, IC17y_PART1, IC17y_PART2, calldataload(add(pubSignals, 512)))

                g1_mulAccC(_pVk, IC18x_PART1, IC18x_PART2, IC18y_PART1, IC18y_PART2, calldataload(add(pubSignals, 544)))

                g1_mulAccC(_pVk, IC19x_PART1, IC19x_PART2, IC19y_PART1, IC19y_PART2, calldataload(add(pubSignals, 576)))

                g1_mulAccC(_pVk, IC20x_PART1, IC20x_PART2, IC20y_PART1, IC20y_PART2, calldataload(add(pubSignals, 608)))

                g1_mulAccC(_pVk, IC21x_PART1, IC21x_PART2, IC21y_PART1, IC21y_PART2, calldataload(add(pubSignals, 640)))

                g1_mulAccC(_pVk, IC22x_PART1, IC22x_PART2, IC22y_PART1, IC22y_PART2, calldataload(add(pubSignals, 672)))

                g1_mulAccC(_pVk, IC23x_PART1, IC23x_PART2, IC23y_PART1, IC23y_PART2, calldataload(add(pubSignals, 704)))

                g1_mulAccC(_pVk, IC24x_PART1, IC24x_PART2, IC24y_PART1, IC24y_PART2, calldataload(add(pubSignals, 736)))

                g1_mulAccC(_pVk, IC25x_PART1, IC25x_PART2, IC25y_PART1, IC25y_PART2, calldataload(add(pubSignals, 768)))

                g1_mulAccC(_pVk, IC26x_PART1, IC26x_PART2, IC26y_PART1, IC26y_PART2, calldataload(add(pubSignals, 800)))

                g1_mulAccC(_pVk, IC27x_PART1, IC27x_PART2, IC27y_PART1, IC27y_PART2, calldataload(add(pubSignals, 832)))

                g1_mulAccC(_pVk, IC28x_PART1, IC28x_PART2, IC28y_PART1, IC28y_PART2, calldataload(add(pubSignals, 864)))

                g1_mulAccC(_pVk, IC29x_PART1, IC29x_PART2, IC29y_PART1, IC29y_PART2, calldataload(add(pubSignals, 896)))

                g1_mulAccC(_pVk, IC30x_PART1, IC30x_PART2, IC30y_PART1, IC30y_PART2, calldataload(add(pubSignals, 928)))

                g1_mulAccC(_pVk, IC31x_PART1, IC31x_PART2, IC31y_PART1, IC31y_PART2, calldataload(add(pubSignals, 960)))

                g1_mulAccC(_pVk, IC32x_PART1, IC32x_PART2, IC32y_PART1, IC32y_PART2, calldataload(add(pubSignals, 992)))

                g1_mulAccC(
                    _pVk, IC33x_PART1, IC33x_PART2, IC33y_PART1, IC33y_PART2, calldataload(add(pubSignals, 1024))
                )

                g1_mulAccC(
                    _pVk, IC34x_PART1, IC34x_PART2, IC34y_PART1, IC34y_PART2, calldataload(add(pubSignals, 1056))
                )

                g1_mulAccC(
                    _pVk, IC35x_PART1, IC35x_PART2, IC35y_PART1, IC35y_PART2, calldataload(add(pubSignals, 1088))
                )

                g1_mulAccC(
                    _pVk, IC36x_PART1, IC36x_PART2, IC36y_PART1, IC36y_PART2, calldataload(add(pubSignals, 1120))
                )

                g1_mulAccC(
                    _pVk, IC37x_PART1, IC37x_PART2, IC37y_PART1, IC37y_PART2, calldataload(add(pubSignals, 1152))
                )

                g1_mulAccC(
                    _pVk, IC38x_PART1, IC38x_PART2, IC38y_PART1, IC38y_PART2, calldataload(add(pubSignals, 1184))
                )

                g1_mulAccC(
                    _pVk, IC39x_PART1, IC39x_PART2, IC39y_PART1, IC39y_PART2, calldataload(add(pubSignals, 1216))
                )

                g1_mulAccC(
                    _pVk, IC40x_PART1, IC40x_PART2, IC40y_PART1, IC40y_PART2, calldataload(add(pubSignals, 1248))
                )

                g1_mulAccC(
                    _pVk, IC41x_PART1, IC41x_PART2, IC41y_PART1, IC41y_PART2, calldataload(add(pubSignals, 1280))
                )

                g1_mulAccC(
                    _pVk, IC42x_PART1, IC42x_PART2, IC42y_PART1, IC42y_PART2, calldataload(add(pubSignals, 1312))
                )

                g1_mulAccC(
                    _pVk, IC43x_PART1, IC43x_PART2, IC43y_PART1, IC43y_PART2, calldataload(add(pubSignals, 1344))
                )

                g1_mulAccC(
                    _pVk, IC44x_PART1, IC44x_PART2, IC44y_PART1, IC44y_PART2, calldataload(add(pubSignals, 1376))
                )

                g1_mulAccC(
                    _pVk, IC45x_PART1, IC45x_PART2, IC45y_PART1, IC45y_PART2, calldataload(add(pubSignals, 1408))
                )

                g1_mulAccC(
                    _pVk, IC46x_PART1, IC46x_PART2, IC46y_PART1, IC46y_PART2, calldataload(add(pubSignals, 1440))
                )

                g1_mulAccC(
                    _pVk, IC47x_PART1, IC47x_PART2, IC47y_PART1, IC47y_PART2, calldataload(add(pubSignals, 1472))
                )

                g1_mulAccC(
                    _pVk, IC48x_PART1, IC48x_PART2, IC48y_PART1, IC48y_PART2, calldataload(add(pubSignals, 1504))
                )

                g1_mulAccC(
                    _pVk, IC49x_PART1, IC49x_PART2, IC49y_PART1, IC49y_PART2, calldataload(add(pubSignals, 1536))
                )

                g1_mulAccC(
                    _pVk, IC50x_PART1, IC50x_PART2, IC50y_PART1, IC50y_PART2, calldataload(add(pubSignals, 1568))
                )

                g1_mulAccC(
                    _pVk, IC51x_PART1, IC51x_PART2, IC51y_PART1, IC51y_PART2, calldataload(add(pubSignals, 1600))
                )

                g1_mulAccC(
                    _pVk, IC52x_PART1, IC52x_PART2, IC52y_PART1, IC52y_PART2, calldataload(add(pubSignals, 1632))
                )

                g1_mulAccC(
                    _pVk, IC53x_PART1, IC53x_PART2, IC53y_PART1, IC53y_PART2, calldataload(add(pubSignals, 1664))
                )

                g1_mulAccC(
                    _pVk, IC54x_PART1, IC54x_PART2, IC54y_PART1, IC54y_PART2, calldataload(add(pubSignals, 1696))
                )

                g1_mulAccC(
                    _pVk, IC55x_PART1, IC55x_PART2, IC55y_PART1, IC55y_PART2, calldataload(add(pubSignals, 1728))
                )

                g1_mulAccC(
                    _pVk, IC56x_PART1, IC56x_PART2, IC56y_PART1, IC56y_PART2, calldataload(add(pubSignals, 1760))
                )

                g1_mulAccC(
                    _pVk, IC57x_PART1, IC57x_PART2, IC57y_PART1, IC57y_PART2, calldataload(add(pubSignals, 1792))
                )

                g1_mulAccC(
                    _pVk, IC58x_PART1, IC58x_PART2, IC58y_PART1, IC58y_PART2, calldataload(add(pubSignals, 1824))
                )

                g1_mulAccC(
                    _pVk, IC59x_PART1, IC59x_PART2, IC59y_PART1, IC59y_PART2, calldataload(add(pubSignals, 1856))
                )

                g1_mulAccC(
                    _pVk, IC60x_PART1, IC60x_PART2, IC60y_PART1, IC60y_PART2, calldataload(add(pubSignals, 1888))
                )

                g1_mulAccC(
                    _pVk, IC61x_PART1, IC61x_PART2, IC61y_PART1, IC61y_PART2, calldataload(add(pubSignals, 1920))
                )

                g1_mulAccC(
                    _pVk, IC62x_PART1, IC62x_PART2, IC62y_PART1, IC62y_PART2, calldataload(add(pubSignals, 1952))
                )

                g1_mulAccC(
                    _pVk, IC63x_PART1, IC63x_PART2, IC63y_PART1, IC63y_PART2, calldataload(add(pubSignals, 1984))
                )

                g1_mulAccC(
                    _pVk, IC64x_PART1, IC64x_PART2, IC64y_PART1, IC64y_PART2, calldataload(add(pubSignals, 2016))
                )

                g1_mulAccC(
                    _pVk, IC65x_PART1, IC65x_PART2, IC65y_PART1, IC65y_PART2, calldataload(add(pubSignals, 2048))
                )

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default {
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 4 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 2 G1
                mstore(add(_pPairing, 768), mload(add(pMem, pVk))) // x_PART1
                mstore(add(_pPairing, 800), mload(add(pMem, add(pVk, 32)))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(pMem, add(pVk, 64)))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(pMem, add(pVk, 96)))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 3 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            // Validate all evaluations
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem)

            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}



================================================
FILE: src/verifier/Groth16Verifier64Leaves.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

import "./Groth16Verifier64LeavesIC.sol";

contract Groth16Verifier64Leaves {
    // BLS12-381 Scalar field modulus (r)
    uint256 constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;
    // BLS12-381 Base field modulus (q) - split into two parts for 48-byte representation
    uint256 constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;

    // Verification Key data - split into PART1/PART2 for BLS12-381 format
    uint256 internal constant alphax_PART1 = 0x000000000000000000000000000000000b64c080c737ba7a22eb10bdd910a8dd;
    uint256 internal constant alphax_PART2 = 0xeaf6fee44136b7f01137411d704ce9834d1206f96c1e5b0d85331112474e00fd;
    uint256 internal constant alphay_PART1 = 0x0000000000000000000000000000000009b199d1d14d750ab035b0f175586479;
    uint256 internal constant alphay_PART2 = 0x6f17a9a71f42a94e5bc1cb31785503a35a264c9170aa22170403ace2330d9b46;

    uint256 constant betax1_PART1 = 0x000000000000000000000000000000000048ff455eaf220d0cfa22014ef3aaf2;
    uint256 constant betax1_PART2 = 0xc5209615cf3a98e2545004b3d43a3591c1acbeefe16e3cf81155bc3aad5e3fe9;
    uint256 constant betax2_PART1 = 0x0000000000000000000000000000000007708cfcadb0c0530028dcd0e1f21c08;
    uint256 constant betax2_PART2 = 0x7b7e3f36d98ff6be8ca8eb662fe3d824790d3570616010f104e99848f87d0c83;
    uint256 constant betay1_PART1 = 0x000000000000000000000000000000000adb0437246524e1737815ce833f795f;
    uint256 constant betay1_PART2 = 0x910b4c67537881a1a9901e5c9b2b3f43fbe23043e117d11be4b69f03e24f2a20;
    uint256 constant betay2_PART1 = 0x000000000000000000000000000000000349bdb043c0d6f663b59fb2ac8f80e1;
    uint256 constant betay2_PART2 = 0xb90ec6fcb9b51c11e201999fd2948b90db942941ee71a7ce24fac1a6b233da26;
    uint256 constant gammax1_PART1 = 0x0000000000000000000000000000000013e02b6052719f607dacd3a088274f65;
    uint256 constant gammax1_PART2 = 0x596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e;
    uint256 constant gammax2_PART1 = 0x00000000000000000000000000000000024aa2b2f08f0a91260805272dc51051;
    uint256 constant gammax2_PART2 = 0xc6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8;
    uint256 constant gammay1_PART1 = 0x000000000000000000000000000000000606c4a02ea734cc32acd2b02bc28b99;
    uint256 constant gammay1_PART2 = 0xcb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be;
    uint256 constant gammay2_PART1 = 0x000000000000000000000000000000000ce5d527727d6e118cc9cdc6da2e351a;
    uint256 constant gammay2_PART2 = 0xadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801;
    uint256 constant deltax1_PART1 = 0x0000000000000000000000000000000004870da4896308c3033956110c3c50a5;
    uint256 constant deltax1_PART2 = 0x2be7ebbb9314cdb11873d078d9bf7ac3dfeb57225a0938deb113bb7795540062;
    uint256 constant deltax2_PART1 = 0x000000000000000000000000000000000bbac9df3bbc790093b6f76e030a9749;
    uint256 constant deltax2_PART2 = 0x59279308ec758e4783aeaf8aa109377134af83701036d707a03eb7c1faca0f5a;
    uint256 constant deltay1_PART1 = 0x000000000000000000000000000000000a70357b2f9bc03625f2bdee6d0a686a;
    uint256 constant deltay1_PART2 = 0x8a050ae3ad1daf7157995ae9800780c378c087647afc971bc683a7d058bb0c45;
    uint256 constant deltay2_PART1 = 0x000000000000000000000000000000000418d7dfde632e4743b3deafce5ccdae;
    uint256 constant deltay2_PART2 = 0x00648758da6d4b264819da6585dc3699d80d19e7f5c905fd5fe9949ee9bbc74c;

    // Reference to the IC constants contract
    Groth16Verifier64LeavesIC public icContract;

    // Memory layout for pairing check
    uint16 constant pPairing = 1408;
    uint16 constant pVk = 0;
    uint16 constant pLastMem = 1664;

    constructor(address _icContract) {
        icContract = Groth16Verifier64LeavesIC(_icContract);
    }

    function verifyProof(
        uint256[4] calldata _pA,
        uint256[8] calldata _pB,
        uint256[4] calldata _pC,
        uint256[129] calldata _pubSignals
    ) public view returns (bool) {
        assembly {
            // G1 function to multiply a G1 value(x,y) to value in an address
            function g1_mulAccC(pR, x0, x1, y0, y1, s) {
                let success
                let mIn := mload(0x40)
                mstore(mIn, x0)
                mstore(add(mIn, 32), x1)
                mstore(add(mIn, 64), y0)
                mstore(add(mIn, 96), y1)
                mstore(add(mIn, 128), s)

                success := staticcall(sub(gas(), 2000), 0x0c, mIn, 160, mIn, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                mstore(add(mIn, 128), mload(pR))
                mstore(add(mIn, 160), mload(add(pR, 32)))
                mstore(add(mIn, 192), mload(add(pR, 64)))
                mstore(add(mIn, 224), mload(add(pR, 96)))

                success := staticcall(sub(gas(), 2000), 0x0b, mIn, 256, pR, 128)

                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }
            }

            function getICValues(index, ic_contract_addr) -> x0, x1, y0, y1 {
                let mIn := mload(0x40)

                // Prepare call data for getIC(index)
                mstore(mIn, 0x3fd741b500000000000000000000000000000000000000000000000000000000) // getIC function selector
                mstore(add(mIn, 4), index)

                let success := staticcall(gas(), ic_contract_addr, mIn, 36, mIn, 128)
                if iszero(success) {
                    mstore(0, 0)
                    return(0, 0x20)
                }

                x0 := mload(mIn)
                x1 := mload(add(mIn, 32))
                y0 := mload(add(mIn, 64))
                y1 := mload(add(mIn, 96))
            }

            function checkPairing(pA, pB, pC, pubSignals, pMem, ic_contract_addr) -> isOk {
                let _pPairing := add(pMem, pPairing)
                let _pVk := add(pMem, pVk)

                // Get IC0 values and store
                let ic0_x0, ic0_x1, ic0_y0, ic0_y1 := getICValues(0, ic_contract_addr)
                mstore(_pVk, ic0_x0)
                mstore(add(_pVk, 32), ic0_x1)
                mstore(add(_pVk, 64), ic0_y0)
                mstore(add(_pVk, 96), ic0_y1)

                // Compute the linear combination vk_x using external IC values
                for { let i := 1 } lt(i, 130) { i := add(i, 1) } {
                    let ic_x0, ic_x1, ic_y0, ic_y1 := getICValues(i, ic_contract_addr)
                    let pubSignalOffset := mul(sub(i, 1), 32)
                    g1_mulAccC(_pVk, ic_x0, ic_x1, ic_y0, ic_y1, calldataload(add(pubSignals, pubSignalOffset)))
                }

                // -A (48-byte BLS12-381 format with proper base field negation)
                mstore(_pPairing, calldataload(pA)) // _pA[0][0] (x_PART1)
                mstore(add(_pPairing, 32), calldataload(add(pA, 32))) // _pA[0][1] (x_PART2)

                // Negate y-coordinate using proper BLS12-381 base field arithmetic: q - y
                let y_high := calldataload(add(pA, 64)) // y_PART1 (high part)
                let y_low := calldataload(add(pA, 96)) // y_PART2 (low part)

                let neg_y_high, neg_y_low
                let borrow := 0

                // Correct BLS12-381 field negation: q - y where q = Q_MOD_PART1 || Q_MOD_PART2
                // Handle the subtraction properly with borrowing
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default {
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    borrow := 0
                }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(add(_pPairing, 64), neg_y_high) // _pA[1][0] (-y_PART1)
                mstore(add(_pPairing, 96), neg_y_low) // _pA[1][1] (-y_PART2)

                // B (48-byte BLS12-381 format)
                // B G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 128), calldataload(add(pB, 64))) // x1_PART1
                mstore(add(_pPairing, 160), calldataload(add(pB, 96))) // x1_PART2
                mstore(add(_pPairing, 192), calldataload(pB)) // x0_PART1
                mstore(add(_pPairing, 224), calldataload(add(pB, 32))) // x0_PART2
                mstore(add(_pPairing, 256), calldataload(add(pB, 192))) // y1_PART1
                mstore(add(_pPairing, 288), calldataload(add(pB, 224))) // y1_PART2
                mstore(add(_pPairing, 320), calldataload(add(pB, 128))) // y0_PART1
                mstore(add(_pPairing, 352), calldataload(add(pB, 160))) // y0_PART2

                // alpha1 (48-byte format) - PAIR 2 G1
                mstore(add(_pPairing, 384), alphax_PART1)
                mstore(add(_pPairing, 416), alphax_PART2)
                mstore(add(_pPairing, 448), alphay_PART1)
                mstore(add(_pPairing, 480), alphay_PART2)

                // beta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 512), betax2_PART1) // x1_PART1
                mstore(add(_pPairing, 544), betax2_PART2) // x1_PART2
                mstore(add(_pPairing, 576), betax1_PART1) // x0_PART1
                mstore(add(_pPairing, 608), betax1_PART2) // x0_PART2
                mstore(add(_pPairing, 640), betay2_PART1) // y1_PART1
                mstore(add(_pPairing, 672), betay2_PART2) // y1_PART2
                mstore(add(_pPairing, 704), betay1_PART1) // y0_PART1
                mstore(add(_pPairing, 736), betay1_PART2) // y0_PART2

                // vk_x (48-byte format from G1 point) - PAIR 3 G1
                mstore(add(_pPairing, 768), mload(_pVk)) // x_PART1
                mstore(add(_pPairing, 800), mload(add(_pVk, 32))) // x_PART2
                mstore(add(_pPairing, 832), mload(add(_pVk, 64))) // y_PART1
                mstore(add(_pPairing, 864), mload(add(_pVk, 96))) // y_PART2

                // gamma2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 896), gammax2_PART1) // x1_PART1
                mstore(add(_pPairing, 928), gammax2_PART2) // x1_PART2
                mstore(add(_pPairing, 960), gammax1_PART1) // x0_PART1
                mstore(add(_pPairing, 992), gammax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1024), gammay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1056), gammay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1088), gammay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1120), gammay1_PART2) // y0_PART2

                // C (48-byte BLS12-381 format) - PAIR 4 G1
                mstore(add(_pPairing, 1152), calldataload(pC)) // _pC[0][0] (x_PART1)
                mstore(add(_pPairing, 1184), calldataload(add(pC, 32))) // _pC[0][1] (x_PART2)
                mstore(add(_pPairing, 1216), calldataload(add(pC, 64))) // _pC[1][0] (y_PART1)
                mstore(add(_pPairing, 1248), calldataload(add(pC, 96))) // _pC[1][1] (y_PART2)

                // delta2 G2 point order: x1, x0, y1, y0
                mstore(add(_pPairing, 1280), deltax2_PART1) // x1_PART1
                mstore(add(_pPairing, 1312), deltax2_PART2) // x1_PART2
                mstore(add(_pPairing, 1344), deltax1_PART1) // x0_PART1
                mstore(add(_pPairing, 1376), deltax1_PART2) // x0_PART2
                mstore(add(_pPairing, 1408), deltay2_PART1) // y1_PART1
                mstore(add(_pPairing, 1440), deltay2_PART2) // y1_PART2
                mstore(add(_pPairing, 1472), deltay1_PART1) // y0_PART1
                mstore(add(_pPairing, 1504), deltay1_PART2) // y0_PART2

                // Call pairing check
                let success := staticcall(sub(gas(), 2000), 0x0f, _pPairing, 1536, _pPairing, 0x20)

                isOk := and(success, mload(_pPairing))
            }

            let pMem := mload(0x40)
            mstore(0x40, add(pMem, pLastMem))

            let ic_contract_addr := sload(icContract.slot)
            let isValid := checkPairing(_pA, _pB, _pC, _pubSignals, pMem, ic_contract_addr)

            mstore(0, isValid)
            return(0, 0x20)
        }
    }
}



================================================
FILE: src/verifier/Groth16Verifier64LeavesIC.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity >=0.7.0 <0.9.0;

// IC Constants contract for 64-leaves verifier - Updated verification key
contract Groth16Verifier64LeavesIC {
    function getIC(uint256 index) external pure returns (uint256, uint256, uint256, uint256) {
        if (index == 0) {
            return (
                0x00000000000000000000000000000000139c793f2cf5ccab79b84c4fbca1a3af,
                0x5c07797a53c8c2ebb1281fceb0223c8569140e8703d46012da8a588a87197c58,
                0x000000000000000000000000000000000aa2b01984854aab2a37dd0859d122a8,
                0x61b0ad54c0b2e781ece0d14350c14fad85cbf9f2576af1d8100d268e41dd5826
            );
        }
        if (index == 1) {
            return (
                0x0000000000000000000000000000000000a769745f5fc03fa370a5c59e35af6b,
                0xb1f2425c8b6b441a964a7f545e2d2f5c17ca00445131b8b8220763a374db1e2c,
                0x0000000000000000000000000000000014edb670e23766c56856d81a0623b4a7,
                0xcda0aeb67b5dc909520c75081a3a09cd54c7828e7ce58e120294e9ba77f66f8e
            );
        }
        if (index == 2) {
            return (
                0x000000000000000000000000000000001915ad1ed820f03706d7861b5a1602de,
                0x7398aa560e7b9a33087cddcc6be3d979f55503fec4f9fd83402484caa52fea4a,
                0x00000000000000000000000000000000056043edceb4c0b6586d7187585c455d,
                0xae0796741031f2db54c6764824b91cac43d6aa77ee2f0bcdec436d7bb10cfbd5
            );
        }
        if (index == 3) {
            return (
                0x0000000000000000000000000000000000ab8844aaf550be088158187eec61ed,
                0xcdaa520c58a2790c13b7648e63403a6ee60714e479562098c5c7d0b246468c99,
                0x00000000000000000000000000000000175439aa853126742bc7cdb0d7dfd126,
                0x02289330275cbcafa8346c1200972ca86f7d6797b111faa4ba8f22000f401750
            );
        }
        if (index == 4) {
            return (
                0x0000000000000000000000000000000006bdb870127d7f852fe1e023c7beef7b,
                0xa02d4ab94d0866709e34e646d8d9afb7358d8abc386677a4ad7d1043786b2c1c,
                0x00000000000000000000000000000000095c3764233fda4ed4c980345efce161,
                0x10828611362b8d437ccfa8ec8a5cce3571740541316857c50903208bcd897fe8
            );
        }
        if (index == 5) {
            return (
                0x000000000000000000000000000000001398dc2e5d591ba1ec929567f384b633,
                0xe74e0705a363b4f1c4c3fe89a672e9285bb1efcccf43e2dffee4193f073fbab4,
                0x000000000000000000000000000000000b829cf6fe4882ddff42c34f24233e64,
                0xd26d7178d0f94ef68b3e9d3345da3c5dcc0ceccff9d72114b466c561fe5cd845
            );
        }
        if (index == 6) {
            return (
                0x000000000000000000000000000000000250f0b3368dceb7f44e761c2bdc38ca,
                0x539dd4865b23de588f505c2acfcf3a2923272b2d18ab157b2a9c54d6814fca35,
                0x00000000000000000000000000000000097597e387b79a43ea7d6fd5245746c3,
                0xb5a43b48756bc1b74ca7826301c073a667521622463f937149123831925f100a
            );
        }
        if (index == 7) {
            return (
                0x000000000000000000000000000000000d1982cc83f3605776c1511b54ccd302,
                0x976bcfd2517a28f2b102f674443ba77b30631e892d20b9e4900c6236cc91cc21,
                0x0000000000000000000000000000000017e59977881bb9c85049e6362fcfce8f,
                0xb6b5020a1ffa53a062faf7c68464e96566093e24637a171e8533f685391a5bb5
            );
        }
        if (index == 8) {
            return (
                0x000000000000000000000000000000000355bbc09c12866299a75b1d8b29e753,
                0xc5e62a30dc5f186a0ed9b5ffc64b2110369249cae7c222d0f97b810af406c0e4,
                0x000000000000000000000000000000000dba4504ed9d6a742335770fbb3db1e3,
                0x500bb938cb6011dd005b7e5317416ab9579b86f71645147a5a917baa7e7348cb
            );
        }
        if (index == 9) {
            return (
                0x00000000000000000000000000000000016a5b01f8cc3ade406b7dd0829d481c,
                0x65101283700dd92eca2e412c417456bf186eb0aedc04986bda836932c1244988,
                0x00000000000000000000000000000000142c5b96c95249b6ef70acd64b3fdb4e,
                0xc104f39a31bacbea057e81a72e4384e469a1ed09ad8477ef3fc56305c4ce58d3
            );
        }
        if (index == 10) {
            return (
                0x00000000000000000000000000000000181ecace498dc20679ded7f11f190c69,
                0xa82e278b8d552d4b78eb09c1013dc30b00d62e17f7ca49713b7af1022be6797a,
                0x00000000000000000000000000000000027eea23303f71ee440fa8b036cf3aba,
                0x5451f5c18be36353e8fb47284808c18c0d31e8e98206351d6af1f9d9bd198fd8
            );
        }
        if (index == 11) {
            return (
                0x000000000000000000000000000000000a9a3df07c1bcec219205000eba6652a,
                0xb5f04316a8c2eafde698946920a60ce9b90af843a0ae9075b34d4ff2426c67b2,
                0x000000000000000000000000000000000c56d1c9eaf274121cd0e75744c5530f,
                0x93cb4fc38dfcf19b8e74529e42d6b2c3244fedc0de3dcff5e6784116c724c3f5
            );
        }
        if (index == 12) {
            return (
                0x00000000000000000000000000000000114b92e328d53cdbeffd3f9347b6a8aa,
                0xcef154e7bb5b9e8efb92dfa0ac36d0da1bef15ac6b8f2379b4fdb45c0f68cbd5,
                0x000000000000000000000000000000000486fa84355e1ba96263fc24e8c1d24c,
                0x04ff29a754a2fec0102b39dc53feef954bce4ff33493703dcacc7cfdb61980f0
            );
        }
        if (index == 13) {
            return (
                0x00000000000000000000000000000000061c88c4bbd1853e0056e7b802843963,
                0x40fdc2af2b97d82280e9a7a73c6a3e7f70f0f70941bccde9b819599b97d1a5ff,
                0x000000000000000000000000000000000b247920d739f8a82587690f39a24520,
                0x1afdaaeee5a8e09ecd30b0f3f299bc65d6f35b8d0c58b453c5a0204e5c51e7a3
            );
        }
        if (index == 14) {
            return (
                0x0000000000000000000000000000000015a9df2035f1518c554f7fa238aa8535,
                0xbef0ad3dcde7d72d08fbec05d2e5b83c538d8aa530585e26e576d6787ef9d408,
                0x0000000000000000000000000000000017c55d9d506ada2e5c8021be263aa3d0,
                0xab75672c686375d3477d1acd0fec35dbc104ff24ae0da96ada0047cd88ba4cb0
            );
        }
        if (index == 15) {
            return (
                0x00000000000000000000000000000000142d60f6589fbd8d7d3a8f795898d60c,
                0x9e20402f21f9517ce35ada0eec91c3397fed97d00fd5adcc6cf8a4d92cd6272d,
                0x0000000000000000000000000000000002b9e49fd977f64e983bd4fcc206cfa0,
                0xc55d500c2117f9da572650a7d3d758595394e0008b83cfed5547fcdf4d775370
            );
        }
        if (index == 16) {
            return (
                0x000000000000000000000000000000001430eed3980fa9fc4f262dee76194f54,
                0xff9e906bb0a0faf15dac29f0be38adcd02e8fff68855e726bc33bd5190420bac,
                0x0000000000000000000000000000000010021b8d541636023ded70ea361aece0,
                0x13d796680ca3d86b4d26b77839ee0deb570e5a62e4185410d2909e6e102e8802
            );
        }
        if (index == 17) {
            return (
                0x000000000000000000000000000000000c1a757903e0f140d4144cad2b2c6e26,
                0x497354dd4e1009270a7980bea7dbfc0fbfe9d978ec31a48bce1a1a301958789e,
                0x000000000000000000000000000000000d9b29281a7830628e3ffcb9b8233241,
                0x79bc7cb9cd5fb53a69de1989d4dbd123c749b6a8843709d7c4e5b700fb6f3daf
            );
        }
        if (index == 18) {
            return (
                0x000000000000000000000000000000000a9051eb80acae6034810b65e4baa326,
                0x04af59a02f5eee2e8de2c84c58015928343f0bfeaa92ba177e4741914dfbca9e,
                0x0000000000000000000000000000000005f1aa64a75879f55bd48fa307b4f1ff,
                0xb495114a3911657b16cfd60ea87ff108ef18ee9e4fadb093b39b73f7e4e0a554
            );
        }
        if (index == 19) {
            return (
                0x0000000000000000000000000000000004b066ffd3d513bd54ad1b0dcbc77e82,
                0x795a92905002f38b39b108d83c60249233e29e44738135afc0a894276c4b29de,
                0x00000000000000000000000000000000131079f27b81fb46295c16a59a6ba6b5,
                0x5639887241d14608ed73f1f977ea0372df3b01492cf715610b8ae466b97d156d
            );
        }
        if (index == 20) {
            return (
                0x000000000000000000000000000000000b72aa0c23a33b1ce6d018ac44ed8720,
                0x7c67af06c73f9a32ddca49849a1bc693dde22b3ceb28bf410f98db62e4f026c4,
                0x0000000000000000000000000000000010ceca18fd388db2d7a51e8e0f8dde88,
                0x808e1c4e1b6f0e91f0770c5b3e335df635c363684c0aab8b1b0cb92453232f84
            );
        }
        if (index == 21) {
            return (
                0x0000000000000000000000000000000017731a0f1188bdbc5c74153aac8e828e,
                0x8bb80d8d0a8f64c8bd711412e3be1664ff18e37098ce4994c79f9d75658b0fd6,
                0x0000000000000000000000000000000002547ce3822d340dcd810560baffc5b4,
                0xe1604053ff5eec5d88282cc95b1fbe95763c95dfc7089becd9f8f4efc3903c59
            );
        }
        if (index == 22) {
            return (
                0x000000000000000000000000000000000504024dcf3b609abe17d49a4a7e93be,
                0x9dfa1bb652758ea9850a6290ebd16d0914c7df590662a3e235439c0255311916,
                0x00000000000000000000000000000000027d225c134141ec76bf671f66392c95,
                0x3c321998614d03f5ae6c0afbd6f27ad2ad9e4fc1a08fddc80465da20cad84309
            );
        }
        if (index == 23) {
            return (
                0x00000000000000000000000000000000196bdf9877db7979e97e8fe8c0eeccd6,
                0x80ac3242c49903cea6fc95eccd44305167243641b74c47b9101b3ad9b47f9e7c,
                0x00000000000000000000000000000000116baf4bd190981ab5e158364292dd3b,
                0xa336a0e4fef6f733b47b8a1e2bc25b67dc41e37aeab300b7dbcb3f3203af53c1
            );
        }
        if (index == 24) {
            return (
                0x000000000000000000000000000000000eb4f507188b7dc01230c8c77f37c0b3,
                0x8f8b8568d1ef8a13d998e88334aaf41b74b61fe3b2bd4cf1fa614979038c025d,
                0x000000000000000000000000000000001499bec0f280da3b43e04e3b232a3bf5,
                0x3560b2502bd858496e26e626625dafb8c336886d119c6e949a406e5f831bf717
            );
        }
        if (index == 25) {
            return (
                0x000000000000000000000000000000000cc99780c409d29129c8dbf76401797d,
                0xbb83f4da4a6cff82fcd0b67a18e511d96fb897222a93102cc4472305bc58089f,
                0x000000000000000000000000000000000bbc09c4c32e838cb612d7753358621d,
                0x8ede9fbaac7f426ec26174d3faab21e6c3682be8d35ccd800ce026a14b83b774
            );
        }
        if (index == 26) {
            return (
                0x0000000000000000000000000000000018f70a7fbffbc9f17e967683226fe5bc,
                0x9f77b14a04793fc50b8c157e8bc9ae457692261b1ccad5fcff7f29a34f3946c5,
                0x000000000000000000000000000000000620458aa0d6af241839d7384f853495,
                0x4c68a37d7ab561d2a6a7cbda93745f91376de4349e0fa72a61133d4236876fa7
            );
        }
        if (index == 27) {
            return (
                0x00000000000000000000000000000000045744f162711a5bb6d9c252775a65df,
                0x22c1b00670cc6d4c47b379221ee329494c5b69ba14bd88074e29629eb866ba5e,
                0x00000000000000000000000000000000072973a6d60923f90930e832589670ed,
                0xf8fc7953eeb55420d0af7a6c666e5ff1359a0bf5d993bea095f45515af517dbb
            );
        }
        if (index == 28) {
            return (
                0x0000000000000000000000000000000012dc1914c43ea15b611d3c1929dd0fbd,
                0x43a4283c5ecf9141df6d3e9ed791b1e9501c86ecb09a78198faa05e063f521f8,
                0x0000000000000000000000000000000012dbc122524b3f611f7ff060d665c0c9,
                0xee0518c7b007cbe52a7c52ba7cedae3cf4af4ab6f644c125c04b7b336f9dda7e
            );
        }
        if (index == 29) {
            return (
                0x000000000000000000000000000000000c80417ea3821d2c51f4dde57dd563d0,
                0x94af78c9adde8113d2fac7c1a567dce3dc7180888ac80db806a4fbec36718214,
                0x00000000000000000000000000000000177f4bed3c761ae787b5ae6dd2864b31,
                0xd9b79e10e8302c28cfb59f3bb0cab9b77ade671c3f3f7b55832e12faab92ea74
            );
        }
        if (index == 30) {
            return (
                0x000000000000000000000000000000000cb139d2717e06119897466bb2a0597b,
                0x68c02e601a76cea0afeace78ef18690d0b455833b8071c619363c4a73cdb5d28,
                0x0000000000000000000000000000000006f7474464aaee66ba95d8a1a727c2d0,
                0xa2aeebc1fc43ff6b2c86dd3b431f875cc80a9359c3aeb9b85a8307e779d86a32
            );
        }
        if (index == 31) {
            return (
                0x00000000000000000000000000000000156b08b0115ae25ff744bb26e8d39cac,
                0xb0356ff98a5edb06a74ffcca38b9a43d05dc8824178b172116839f482a303a1a,
                0x0000000000000000000000000000000009bbce5423838be4ec0f5fdef617d106,
                0x1278e32ea18870703a58ade49e3c9cf7c9160cac72ae06f92ef4e66b81145692
            );
        }
        if (index == 32) {
            return (
                0x0000000000000000000000000000000014258a6a367ee3db99900de50f9db5fc,
                0xe730fa459fd4f12f80370a9b40f349275dde5a9fb09c72a76c40d1e26e676a78,
                0x000000000000000000000000000000000826527646569140e9cc0679479d7314,
                0x9e34222ad8910969cdce1d7f14cdb556bd20f038e3213b43c4f6036a49fc3995
            );
        }
        if (index == 33) {
            return (
                0x000000000000000000000000000000000bad899c760eecec84ed7df16a90ff0b,
                0x0be4dc0257916a23ad2c73938a5cbfd798fefbff9daae0e859345202dd5b41b5,
                0x00000000000000000000000000000000048bb247c78487a262ec4f672ac150c4,
                0xf573b76f27d3fdf69ac1cdfd743ef7ca005a7918845627944e46303c87bcfd26
            );
        }
        if (index == 34) {
            return (
                0x0000000000000000000000000000000018063a5f0f585fa3415609edfb975ed1,
                0x4e37c288b343649c8660f064d8e081020cb4e311e6eddbeaa2cc11c1fab47f7f,
                0x000000000000000000000000000000000fc4fd33f1c8d14f8191e06e2ab15963,
                0x8e1f83d6d754aa79623cf494f11374fcecab5aaf40a5fac182b92ea683d57f06
            );
        }
        if (index == 35) {
            return (
                0x0000000000000000000000000000000014ba69b11c97a3023a9fb7d1e9b4996c,
                0x4cef720dcde1079589711a6816df626909e8d46a7a7f19b5a4acb2d37097b24c,
                0x0000000000000000000000000000000007c141592ce429d69b050bf7d390eb66,
                0xbfc672080c465bb1c275af5e815ec33ff7ef4d5438d020f07a99fa8e06da87e8
            );
        }
        if (index == 36) {
            return (
                0x000000000000000000000000000000000dcd9549f5ff2729f3ba1c46df223776,
                0x6ff63d81d76d1ee53f1f197f49c3b0f5ca7aa1cf64f01dfd103db9df941c02b6,
                0x00000000000000000000000000000000024be9398e3b7f7269961aec246d98dd,
                0x1da4b8e05a3e58ae83e368de06adaa85fb5b41c78e831d53fe7169d7f8edebda
            );
        }
        if (index == 37) {
            return (
                0x00000000000000000000000000000000105619c5fc565a4575867bc723b18175,
                0xf5ac1da214d03a7e291f73598f24e2a16069dd233b24272b5f7aa4456028d546,
                0x00000000000000000000000000000000012e4a097de316e4107bf65f48a270c8,
                0x3d9e2c932ea51dec8f4f64aeb74b0e258089a0e4d07dd1408bc62ef33944f808
            );
        }
        if (index == 38) {
            return (
                0x000000000000000000000000000000000d52b3c715c9db27f0a28697ed47f090,
                0xcf487b3428e73559ceeb85f293e4609f64cf09baa4c0d5063ad0bdb418e6b13a,
                0x000000000000000000000000000000001573e9764113e65c409638aadfbcd7f9,
                0x09b35c9e9b824d40620c5e4f55f11fd64aed8dbf555090181e788375257111ea
            );
        }
        if (index == 39) {
            return (
                0x00000000000000000000000000000000039b581f3908f1708d28c0243755253a,
                0x6ad5b980477e93f252297b2f192635012a2b1b04924ba48f06b0f2686e585df9,
                0x00000000000000000000000000000000032fab4caddbb5990b359437da354e3f,
                0xf9a75a6deaded563b696b2d2d95f0503e0eb89e2af18dd152c43ee6cfb814148
            );
        }
        if (index == 40) {
            return (
                0x000000000000000000000000000000000f446ba6f8591310a26e73a5d5d7c302,
                0x6409a02a5b11217e629d0e3371c4fcf204593048a301d43e181d648509f6e071,
                0x00000000000000000000000000000000181ac53b476b9574bdac38bcb044c87c,
                0xda67272476e4d7bd3b26881225e5a202fd1a59ca71ac650d30af5b701297894a
            );
        }
        if (index == 41) {
            return (
                0x00000000000000000000000000000000173b6594ed933ad9cbcf998ef52e1335,
                0x2324a2a35ef109ae48310a20e3bf590c0cd32c627bddd7c571500d9ff3e00442,
                0x0000000000000000000000000000000018ed61d342c653969bcd1d1c73a927eb,
                0x17d1ad6bca8d0a008ff8729828634236744dd4ef4ecf05718369c01b30197b4d
            );
        }
        if (index == 42) {
            return (
                0x000000000000000000000000000000000b507317c7e2bff81c55ba60f6b6f6fc,
                0x145fdbf780ebcf3b7357c981518fdc62df4e9e446df90e22b5b61a8a3763a5bf,
                0x000000000000000000000000000000001030ae419574dba9988efee39e4ac498,
                0xf2a2f950a3e8efb0ac422d558bfe2001e94bdcd0cadd25c10a798d80dbd29048
            );
        }
        if (index == 43) {
            return (
                0x000000000000000000000000000000000338897012da384f6d9f5b664eb11228,
                0xff5be26adcc6c1e1b4ea4aaf6b8ea11863df5fdbb5c6307bbd995e6e663023c5,
                0x000000000000000000000000000000000bb0e4247f82cc1cde237cb7dab90b74,
                0x6b449efaaa21c57c803f7ef2c2e70a4a13c8b2fdd5b0132f555d94459474df39
            );
        }
        if (index == 44) {
            return (
                0x0000000000000000000000000000000017cddc419013fd7b44e20e3d307a8e6e,
                0xe5ddc58290755cabf5423c82ff4fbb045f6b772d3f47f0e8fd6fe352e0625fcb,
                0x0000000000000000000000000000000007ce236ef8973d41d3d2bc33c6d37054,
                0x32ea8f6a442441a1bea090a9ade6bd9d46e570b1298696c660ff048bb834499a
            );
        }
        if (index == 45) {
            return (
                0x000000000000000000000000000000000ec36c58d30bf363bdf1d4ed8d122d60,
                0xe9f72ceda719bb8dd25f6fa79fbcc085c3323a2b052fec9705ffa7d69208eacd,
                0x0000000000000000000000000000000007540a79670e0e22ef4dbbfdd3aa9b0f,
                0x08dad0c9161d82d16a68cf6b3623822136ebeef4b9243f62e96f25501c01747d
            );
        }
        if (index == 46) {
            return (
                0x00000000000000000000000000000000108701edd5d1eea39b090d7499cee0b2,
                0x0e990152c6dfd33acf489eedbafcd3df8e60a1522c501a4650221ad2fb1bfaad,
                0x000000000000000000000000000000001067578404105dab53d2b404f7156610,
                0x791ce8f121ad6290f94b806524e98f4043a745832b2e0e6d6380c6cdf44db08a
            );
        }
        if (index == 47) {
            return (
                0x0000000000000000000000000000000002b26850a72e6b1e1aa2ae9d09c5e7a3,
                0xd183e119035382b11f14f40aad458dc8cc21d73cc9fb7390a3531ea83882f205,
                0x00000000000000000000000000000000112141b2ef3156ba58dda894058ce6dd,
                0x4a7e9ddcf64338f6849da1ab660f980104ea8524f45f9f706d743dc10432b34c
            );
        }
        if (index == 48) {
            return (
                0x000000000000000000000000000000001502236dcb9576209e1d196388fb082b,
                0x2076fc2543b01387a9aef8405a89af8894bb60f4c7fec04301ac145b6e1cd813,
                0x0000000000000000000000000000000015527ab50b85e7dfcc8c5b47c0334090,
                0x4a3bbc75b66fd089640bae7b63bcb0aea319620245436e2070e4b9316ba90b72
            );
        }
        if (index == 49) {
            return (
                0x00000000000000000000000000000000108f117793a539e87a3764c7889462b5,
                0x687fed4b3c322ea6603ab307a6cbf6428d4afc51a065236a90d5379eaf71616b,
                0x0000000000000000000000000000000017dd5e01c822fba10968a279202ab23f,
                0x8778d8ab26662fe7bb6f4c338cd42df7e4c754eb758e7924ae11fc80341c18ec
            );
        }
        if (index == 50) {
            return (
                0x0000000000000000000000000000000002fa0f7e4b94d0f0a5f4b58317ed29ee,
                0xf746e9543398d9f5f481fbad8f2106fe657b066bec1eff78d559fb9eb979634f,
                0x0000000000000000000000000000000014ee197c03602eae689c9c1d901586d2,
                0x0002f7d505351c71a2612b7b3d2c8564a0e93f07aa808ba50a12de7594b4043a
            );
        }
        if (index == 51) {
            return (
                0x00000000000000000000000000000000177dad6c778bf82f8cdc34502cffc9f6,
                0x0165fecaac0359adfa3575f0585aa8c1df2d44640056cd19f88a0391e319da8b,
                0x000000000000000000000000000000000d66141883b759ed5ae47978fc98ed56,
                0x3af593b6ef05be0c95609d8c6bf82689590fd6736c1dbc494ce2a7f3fa584535
            );
        }
        if (index == 52) {
            return (
                0x00000000000000000000000000000000052591f22278ccacf0c310300cabe362,
                0x64abea80c425e226b44b51afa227705787ff15f148ccd188c2be2ec310f8a54d,
                0x000000000000000000000000000000000646ced4048b7cedeb121950701fb7ce,
                0x98960b2cef2126ea9c2e528033178e9c69e271984f6afe08885e96654a2a03a8
            );
        }
        if (index == 53) {
            return (
                0x0000000000000000000000000000000005dedd5f7ff7eda35b0d2cf748a6250e,
                0x250cf6d8ff5e6f5012426afb9701b0b8010ed2a3244a1b5c926c8d24a5eb38b8,
                0x00000000000000000000000000000000074001c147dc1c10144b8479994e2597,
                0x50ab70208ae9195060bea7085607b5f8dc0ef05fdf80c5b57b91480e6cc11fae
            );
        }
        if (index == 54) {
            return (
                0x00000000000000000000000000000000029ccdd3e887aefe8b6a7ee041e36da4,
                0xf6bb1658bd4c966794e03388b5faaf3683a640465ab4c8429738ac748bdea255,
                0x0000000000000000000000000000000010c092aead3df1cc2936d880418d4e68,
                0x9f0f871521a84086ef78d75f136b689e1a032c72678c62b9d00e35fd8062c26a
            );
        }
        if (index == 55) {
            return (
                0x000000000000000000000000000000001502d7241a9a61e92c00a217f5651412,
                0x741d8010d085b3d37c2b03c801f31487f44ff15f2478e844a113e8be4cb9295e,
                0x00000000000000000000000000000000085172546b9c310e1e695250c2250825,
                0x70c2a9b9c7962e4927788e52839644d3360f96642af277ab4f8ab3bd642ed1fd
            );
        }
        if (index == 56) {
            return (
                0x000000000000000000000000000000001400913d369051bec3036cecc459edcc,
                0xd4164e69b358bf57b44244b97050e6fbaeba7c9e23d84d9fb78eb2cf88890193,
                0x000000000000000000000000000000000a884f5f6f2c2ddd152d05a5a0f78aab,
                0x3d53d173d66a0809831447bd448f4fedab111e037412143e02c3a2a19d14b3df
            );
        }
        if (index == 57) {
            return (
                0x000000000000000000000000000000001015586e8a8fd8f5774d1830b731de70,
                0xc44d0d54beeaf0f1eeea218b18ee29cc57b9d0957d678aa336c624a798df4a41,
                0x0000000000000000000000000000000015ae333894897559034e9c25dc0cc12d,
                0x88fb85f94afefb89a9ee4ec73b07ddf47b8df3473f1540736ce02f3038e28911
            );
        }
        if (index == 58) {
            return (
                0x000000000000000000000000000000000e6a1b6577a8f51b8f6ee11d498940be,
                0x94b9aa2809ad9454fcf916c4353617bb0233280451e6d65b5b6056532e89d5dd,
                0x00000000000000000000000000000000099d2f52b40b3ac9c3854de9fdf78e65,
                0x06b68894833463f8eb75fc4838db742da08c3584738aeb02bff9c527866a5c0d
            );
        }
        if (index == 59) {
            return (
                0x0000000000000000000000000000000007ae599ad262ba2a76b00e28a5c3223a,
                0xe59c6fb2f307f49a3e406dddbaeee7da9701412effe745577e09cacb01e76fc5,
                0x00000000000000000000000000000000168bdd48681251cda3e29ab384d3f309,
                0xf62a2238f60344746f5cb14665a9a4858084d6f17d0f9ecb536f6c9e5b62308c
            );
        }
        if (index == 60) {
            return (
                0x00000000000000000000000000000000127395f53db1bbf316f5bbd2b57593c9,
                0x4a25ec6abddea7321edbf229610c795c1fe305b457d57c92829b703b67d43e30,
                0x0000000000000000000000000000000013762e1d9e4dbbe596a001a4695062e1,
                0x0f51d0d97fe1d2a518b27b270a719a7bcf9ab1216d5f2414fd49668b74fb10f5
            );
        }
        if (index == 61) {
            return (
                0x000000000000000000000000000000000a028170ba64b3d484e99e9b8a20b034,
                0xfaab53e59e4bdc320d55589adbf9dd5854a0470192decbd19a8efef350de45d7,
                0x0000000000000000000000000000000001123910a376542e38ea0fb8a668065f,
                0x054f13d8392aec41e60f94e352021c81f3029c4d3d7afbc6a5c77fc28d219610
            );
        }
        if (index == 62) {
            return (
                0x000000000000000000000000000000001634e32ac1b6dd24cc88a18090290f67,
                0x6295754d1120be733929bb2f95262f67737d35e6ddda823138bcac7861489a2f,
                0x0000000000000000000000000000000005cf99d3893e8076a2e1b87dfce2f5f4,
                0x8c4c5b3329885518eb7676bc7a0973ac66932145f18b581cbbdefcb98fd1c91b
            );
        }
        if (index == 63) {
            return (
                0x0000000000000000000000000000000017efca3fca3ed724f99c5af152401069,
                0x47c3ed0c470566976c0d587d6a667880adabc213d89c52db54e2262baf147694,
                0x000000000000000000000000000000000e9c05e0f3ec33af766acf3a93a45cd4,
                0x9a9fedcfa7e493d4896983af76529fd8f70e2d2508d5c39681de7332f4415a70
            );
        }
        if (index == 64) {
            return (
                0x0000000000000000000000000000000001841a68bd708d5f597762ae1ceb1729,
                0x839a718dd0297c0b438b71208807c54785e543153e3ff63229f1cfb1159d16bc,
                0x000000000000000000000000000000000e57fa5f5ae722cd38d7250690bd3d48,
                0xb53aa2713dbe8f7d685682eccdb66fb3e043a1fe4f42192925d6bc4f6d64991d
            );
        }
        if (index == 65) {
            return (
                0x00000000000000000000000000000000093d57f7c4a236fdca154778ac590545,
                0x740ae44efb6d57e39195e2731c300d6ad92719db7d27067b1de98353d25d4e31,
                0x0000000000000000000000000000000012618c739cd755e09ee19eeca09a7288,
                0xe4bd2772b5c38e20aaa0159aea26fc038cb94f38d6c97b956e82eac02c9c0ded
            );
        }
        if (index == 66) {
            return (
                0x000000000000000000000000000000000429296ee09ad1b9e60e2aea97ac36da,
                0x8efe9d1eb2a3593e981b3c6ff8e465eb96a8d26a1053c1e82a5e985683529e9d,
                0x000000000000000000000000000000001932e9bc3354f0f9803c365f3e8984a1,
                0xe678e0f06fb20f0ee3e25d902a483e9c2f6f489efe7c922af767e24c1b764a7d
            );
        }
        if (index == 67) {
            return (
                0x000000000000000000000000000000000b83c673cfde1675b456d7fdd78a24cd,
                0xe6a9a7211d47256b7e051430f5f1e7a030a5e071e7ef697cd76461f1c15eca1c,
                0x00000000000000000000000000000000073aa7599bc3fa29daf96dec9d47619b,
                0x4a63c895290f9b82ffee9dabddf84e6936a26c6d7cb29639aa9b33e80a735a5e
            );
        }
        if (index == 68) {
            return (
                0x000000000000000000000000000000001096adde98f48c55ce0dd383e156be84,
                0x354aa5e9ab994ce0b6dc3a8483c85d2df9e550c19b5f14663f2cdc0967baf57a,
                0x0000000000000000000000000000000000c595b1c754d10eec9c8554ff1ff015,
                0xe0d7f1d019781283399901662f2d06d4073d7806a976b65163b6d948eb811bfb
            );
        }
        if (index == 69) {
            return (
                0x0000000000000000000000000000000005d3cec6b423043c53fd7d578270c02b,
                0xeb701bbcd4ed538f1df38cc2eadc14c234f165bd7c3f341df09f4ba3e5dae17e,
                0x00000000000000000000000000000000116181cbcaaf02f41d4455dcbc02a1e7,
                0xb81623d46e508180f47e38ece0e0296836acbff26c4ea0b8b973931ddc8ef1cf
            );
        }
        if (index == 70) {
            return (
                0x0000000000000000000000000000000019efaf6307ac676a641fd758209a50e6,
                0x0bdebe6bfccc65fbcef3aa0ca93c955282bee18e5759665317305e6ff1d1c651,
                0x000000000000000000000000000000000a9533fca18d18f3b14ca64c0fc37141,
                0x5edc1ffa3b6b15b3d3b1609e61d6faac2d6eeab3ab935f926387506404e9790a
            );
        }
        if (index == 71) {
            return (
                0x000000000000000000000000000000000431a5244c531a1e92e86d521aa84619,
                0x53d950b7311519916c740b3f1e524c4a4c860622839c2ea332399e746a911e79,
                0x000000000000000000000000000000000c8e77186b5e4479aeddcc9c4f6efbc8,
                0x056957426e5b30a4d6942749278702d830e65f5117b233346852ecf184b31ad6
            );
        }
        if (index == 72) {
            return (
                0x0000000000000000000000000000000019b580f49194ed822109f7ebec421755,
                0xa990910ed0ee22469f5d97b4ff2a2c7f807314472da597744c594bd04cfb2f27,
                0x0000000000000000000000000000000000e1231ff7f98d7eaa788b14cc6131d7,
                0x0b018842194e636b5e45982236790bfe76714d44ed36e551c9ed8dde048ed108
            );
        }
        if (index == 73) {
            return (
                0x00000000000000000000000000000000027aa7107311fb0332c0da1e49d0219c,
                0xfe13e411610fa84582a52d038aebc3ea7e504fece53003b918dd4da7cabba82c,
                0x0000000000000000000000000000000016929140b9859d1e4bb0a2e328212406,
                0x51e2f484cc311f2842b4440d3faeca1a7f2676e647ed6977fc6af0e901d85f71
            );
        }
        if (index == 74) {
            return (
                0x00000000000000000000000000000000192beb2757885a9e8aa8728beb2b5218,
                0xf3d7b907108856a6affc4d2241556435f6652bc3a2e3b72ac5d56e2fd69d64b7,
                0x00000000000000000000000000000000135cca32c5cd4a359a1ba951bffcdcfa,
                0x608db1f76be2793b6bbaeb2d0345006852b7a4ad7e64d867ac1d80fd2434c34b
            );
        }
        if (index == 75) {
            return (
                0x000000000000000000000000000000000f8d5186068dc6c13c6919929728353b,
                0x8ac47375d58d75f32b587ec6491df6ad71a3895986eb6d0f71fdfa9cc1f0cb85,
                0x000000000000000000000000000000000963dd8918ea94cc1a386a895778184a,
                0x46770601ea43ca228c46e96a484cb508314f02a1f906ee9a559a52939b52a25f
            );
        }
        if (index == 76) {
            return (
                0x0000000000000000000000000000000016229626d96246301eb2e771c03ebb13,
                0x8afc102da01f2521547e1151445adb398df6b436bef8e09642da52a98a4b7a92,
                0x000000000000000000000000000000001151fa92f582d457331c083641b1abbe,
                0x32edbc6280d22ee22b514952c2d0d59e40981b8d4ca9f1aef3c09bd80e2a3e49
            );
        }
        if (index == 77) {
            return (
                0x00000000000000000000000000000000052f72be2a57328cfcb76940227ad8e4,
                0x4e1a0f7de9005594a35362777a3120205989764f90f695b14019c8f95e1f1ba2,
                0x0000000000000000000000000000000016b8a95ac79d1dc9a6079c6de3d5857e,
                0x6ff6e43e462f8192b39f33ac27ef2415f188f17a64c4ff4a4128e8aa6484855a
            );
        }
        if (index == 78) {
            return (
                0x00000000000000000000000000000000173c17b4b8cca6ab669ac13fe76d7642,
                0xf5241ca3f66b40caf2622d4718bbe52b1084a5591d60adcd1b8f2c04465c178f,
                0x00000000000000000000000000000000159bc44b0f879dc545be760a554ee641,
                0x690c61703fb692ae1e446ffb8197852e4ab63739e8dd0fa1faf1b5927378f99c
            );
        }
        if (index == 79) {
            return (
                0x000000000000000000000000000000001845b38160310d0caa6793889a806119,
                0x85c224563c9bef03f3d1fbb2ea7cf465ba0a8fef5135a5cc5cc6f01f95c1cc06,
                0x0000000000000000000000000000000014d4b7db72d369c934ca362c1dc64a71,
                0xe01ab4ef21ba0ed03910eecbef50bb5df1a170912cc3247f2c2315f1abec9007
            );
        }
        if (index == 80) {
            return (
                0x000000000000000000000000000000001830d4bd315f81d86a7869bb62ce3c35,
                0x9d8e13e35dcb56b3cc846975181759ca64f7c634a0147160f90cf544b98a6a40,
                0x0000000000000000000000000000000010d6f8800e596d278ab9abf3fde2b8eb,
                0x7016b44a2b733d9038fb699f3db6f7f8abc4549cc0286d4ff55bf3beffd561ee
            );
        }
        if (index == 81) {
            return (
                0x000000000000000000000000000000000c045c7518b66b52c924dc58b564dc59,
                0xbe250a05596b30727a2b0c4b51aca5adaa53334b201ddfdf96cff39301fddf6c,
                0x000000000000000000000000000000000dfeeaaad29ada2acac390331d8acd26,
                0x96666b37218446fec60e327b582c2ff0dfcf8e51b8f4e45bdaefca4e91c1f4da
            );
        }
        if (index == 82) {
            return (
                0x0000000000000000000000000000000006e3d54561a7ce3fae0b2408302d332b,
                0x6210ca6fe8d674b13ce86da4189afded4a87bae8da62a27f5cdcc89a8a1bdc01,
                0x000000000000000000000000000000000dda46100aaa8b2ef1275ff1d690f638,
                0xa2bea1dbe07d184fe22fb505bddae1d294963a69272ab94928bd456d5386ad16
            );
        }
        if (index == 83) {
            return (
                0x000000000000000000000000000000000ec074a8562fbb00286b21257e7b58e3,
                0xf42781f140fb0b637ae499d533dfc96478b1dd3f26c1098bed1822f7f47f28ac,
                0x0000000000000000000000000000000014868eb0e9d7897af14b3a220067dd6c,
                0xe836a3d4b874071b91558cf1b25f51dffae28baf337bc3ce877b5d3cfa8f2102
            );
        }
        if (index == 84) {
            return (
                0x00000000000000000000000000000000175f004d34e224722e70c08b4d237eb4,
                0xc5bd9c217bc1002412e04d497a2414c8100bc3c1c40b1f2fcc0642308a3981fa,
                0x000000000000000000000000000000001722bd8313d9091cd780a57abb8e23ee,
                0x44530a66a66248c530a9be90b08f421e9946a341cb8a5e8e8bfb267fbe59a1ac
            );
        }
        if (index == 85) {
            return (
                0x000000000000000000000000000000000efd386ef6b3341a9ddf94cb362b2079,
                0x69a90f165e6a9fab4ba801e3ebaca81d815d8954faf425bd3d3f9dbe0a35896d,
                0x0000000000000000000000000000000014b170a16b2d3a74cb9015012cb02a58,
                0x4bb105c91bf0f11d3eb25ccf3a24896f9cc9536a9a38247cb2068655245a57c1
            );
        }
        if (index == 86) {
            return (
                0x000000000000000000000000000000000bb45c8a6f1b6261627069710d34e59e,
                0x0e9c9ece2026a26decf38bae9593590bee9961380d0cf01dbf0afac6eb6f36a8,
                0x0000000000000000000000000000000010efff972e426c5eae0a11f127e741e0,
                0x86bd92e28e000c5cfd6a98affaf3188650f35fd72a0cef540b521a1f23381d1d
            );
        }
        if (index == 87) {
            return (
                0x00000000000000000000000000000000025cc959d9a2aad8d3669aa386681a76,
                0xcc80b144ab75fb8a043a84f08bb8e684d9a0b37d30bb36e771d813e2cee8332e,
                0x000000000000000000000000000000000d13a190b8050c7b7f7367a664aa894a,
                0x7867b88489732f2b88d98bcf58388e024bbf841eabcf6e1f8ce967673a684cb6
            );
        }
        if (index == 88) {
            return (
                0x0000000000000000000000000000000013cb4ee532e99e4fd5e1b4a5a9a585be,
                0x72f000db800480e64f88ebc381b7a2321917f47626f3a5f58c3415cf7cf69205,
                0x00000000000000000000000000000000159506e98cfeaee3410a32908415c79b,
                0x904af3a412e073a306ceae2d299acd8b792d45678b5459f011208e4250effc6f
            );
        }
        if (index == 89) {
            return (
                0x000000000000000000000000000000000711cf4e8d496d95fbbf36722960f6e0,
                0xa783179163163928dbb5fcb896d603450a90639b46355d33c418da0571b0c586,
                0x00000000000000000000000000000000006304b5c301593cc72af9583eda1add,
                0xd370a51797308a6b8a94b83bca3efc380e0b6a05a38e5c52ff5cfa882a4cfa7a
            );
        }
        if (index == 90) {
            return (
                0x0000000000000000000000000000000009114a4310cd359e7bf07d304ccbce69,
                0xe0b9491b48cfb34a4f41048dba0856cc3a09b68a93ce898e5208a41ebc4219b4,
                0x00000000000000000000000000000000007bf3e16c18f7c2ce2486a6554e9876,
                0x279316a2715cc4aec140614e3fd0a0c43d3a6122c4ebb959a5eea9e1f3f899a1
            );
        }
        if (index == 91) {
            return (
                0x0000000000000000000000000000000002722e65e41a9ef98f365df769dbceed,
                0xd25c81dbdbc547f8e7f284c054e5584cb6f63051fc5ac3a9cc089ee30260e930,
                0x000000000000000000000000000000000da243e049105b9f7bbfea777081e187,
                0x44daac74abcc6a2074acc3ff54c149700e1d577e9fc4a1a4dc3049ddb1672e19
            );
        }
        if (index == 92) {
            return (
                0x0000000000000000000000000000000011861128f68dfaf34e902b9c9ef0abeb,
                0xe6ea81fc72e69211e077c4dcf62ebbbf6ebaff0e17a35ca1df36afa7beb5e6b2,
                0x00000000000000000000000000000000065b061ece8581814daada4442638e0a,
                0xe1e82ce9bbed823da06848fadd42e33cbd2823a55aa0bd851a3ce0048f3df802
            );
        }
        if (index == 93) {
            return (
                0x000000000000000000000000000000000742f0313e05c19b2ed7105fa8fb3c36,
                0xdf2c314331ab10b32c4edf7373b98a09b276cb426d85f36fcd826eafe955dd52,
                0x0000000000000000000000000000000019628af33676557f1b67f57dc4a88ff1,
                0x38c116a27bd92b6efbbe9a3f38e0107ad19bce4ee157bbff0999fdacda208e4a
            );
        }
        if (index == 94) {
            return (
                0x0000000000000000000000000000000005694b216510adde0b34c924d4cd9b90,
                0x325dc568cbce013c20a0affad882ba94adbc14e9827b003f3a719986b71f1bea,
                0x0000000000000000000000000000000000774c1762a6814370ee077de654aa1d,
                0x8eaf01294031b1d91d4a9e8fada4ffdc9465af6053ad64474e2a21d43dfdce2b
            );
        }
        if (index == 95) {
            return (
                0x000000000000000000000000000000000d2297125d4d4f2d475b0f76d245f9ab,
                0x9f45108938404ba286eb9c0a9084b801c22dbc126b21b265605e166895d0592b,
                0x0000000000000000000000000000000018a9d8695127d41dc3da286f3a699d53,
                0x5cfe5f17c77132d061f12c707ac567053e8da7afc66b70df1a66c31bc9d3aa82
            );
        }
        if (index == 96) {
            return (
                0x0000000000000000000000000000000000d5c2e4d7da99319ff06500db98782c,
                0x62231fb3a847403b93050680e15a781f61a4feb3075b0ae09211c073e4446436,
                0x000000000000000000000000000000000361a0b8d59767cd890312a89e4f4d88,
                0x4014c4f0e1ec05a4a536c508a3c72b50450599b60aafcdcd5fc2f8adb48c1634
            );
        }
        if (index == 97) {
            return (
                0x000000000000000000000000000000000dc10a858069f552e575f097936933db,
                0x8abba7751f2fa22a4e521d15bcbba6721f09fcca384f10d40641b0ffd9166656,
                0x0000000000000000000000000000000015f5331f3759100275060b0f66a4d3c5,
                0x4399e0b400d3e6ce69fbe7d27bf60d215192552e676c6afee4fd32d37ab3db25
            );
        }
        if (index == 98) {
            return (
                0x0000000000000000000000000000000003f9342cee53e548a9fdedb0adcc2ae2,
                0x72fa7646bf8373311d5f5c1326e88bc64126acb2b864618a0ebb41c3770d6dcc,
                0x00000000000000000000000000000000029595043a539ae16f8067c43dd77a9d,
                0x549f9fe517d0b596fee21c494777fb0696f8d2db705240a789c4df725c60d144
            );
        }
        if (index == 99) {
            return (
                0x0000000000000000000000000000000003927e81c5e9b71775caf42ece77211c,
                0xd0a1cb4da348590904d8823d1abd1133debf24758cd0490f36dca71b194d1e52,
                0x000000000000000000000000000000000cb8ade34b8af9fe0b3fe8ba99fb5912,
                0x10c648a63c0b616a8ef094ea61eb2b73fd9e1d869258bc0ad88bdb76ab03161d
            );
        }
        if (index == 100) {
            return (
                0x000000000000000000000000000000000cc50c8e29aaa116b7f4904759fc4dc9,
                0x383be62bc934b77a8b893e24d33791a81f2a3f51ae50740a17cac395d798526b,
                0x00000000000000000000000000000000118068165e6b98f64633d1579bf68288,
                0xb2321c32a4e45f5508c568345cb84ac5e092fca13e6f300019ccf187824dfb44
            );
        }
        if (index == 101) {
            return (
                0x0000000000000000000000000000000001df7989acef4caced803f8e3a010473,
                0x173196e8e3a7d8a1a1c32f90aa26c2acb73bd6730dd93c27b85201421d8c6b29,
                0x000000000000000000000000000000000c35039b78adf40daaec415eb7376d8f,
                0x31e0697467dabc21203d55adc54a01899d3e1c1320ec840d87492de642aeff30
            );
        }
        if (index == 102) {
            return (
                0x000000000000000000000000000000001217d7f5b8d1a43909124ed71e3835ff,
                0x1f1e3e97b5f3eabaee788e511977ff715e25e3502ad402440a1009546898563b,
                0x0000000000000000000000000000000003ec436218d3991f87b69ed0c1d95f54,
                0xaabe4d76cd3a2f542bdd518c8d8da9754ff69c243e5cd4316a9d9092b16487b2
            );
        }
        if (index == 103) {
            return (
                0x000000000000000000000000000000000505a1f16ccedff4edc457768585ecf2,
                0xec44c7d6b3e17ea7057e362dd3ea7fb7a9373ba5552aab69bf442ecab00e4454,
                0x000000000000000000000000000000000d725d2f7eea0f4a0198c29907c52fe9,
                0xc103693a70af7e36d157bdcf4e6d4c6626cb3669bc3d568f5be0a4c3dcf819d6
            );
        }
        if (index == 104) {
            return (
                0x00000000000000000000000000000000158c26d75d650e3963e959379d0d601b,
                0x4f00325dfc00df21bd43d2a31e776fa5d707cf56c8722e249e7842aa6d895d6f,
                0x0000000000000000000000000000000005d65bb0ef7798834b1919651c175a08,
                0x7f02ac70b8277742aa8385b4bb95321df5f46cb50e3d207e27014a6027c218cf
            );
        }
        if (index == 105) {
            return (
                0x0000000000000000000000000000000018b4095a0a68e3b63bd5a9b8a76bbc3a,
                0x988c05aa7faaddf50bedd71b3b4871ce06d80ef25148bff0084e2b9d787041a9,
                0x0000000000000000000000000000000016b2d97a8ee7d6f605e7b85dd4609f2c,
                0x7e8314a269ccd91522f207911a328df068d11488bb427cf16471ecddc92a3e76
            );
        }
        if (index == 106) {
            return (
                0x000000000000000000000000000000000253527ed18b038cfdbba9bf350890bf,
                0xa4af38f8ddb1984c6f7984ff14305d8919b1c22958e572d129d16b0e0c0406b8,
                0x0000000000000000000000000000000016db6a00922ed45f281f1d870a28797b,
                0x4db61c649976a7045de6db3bd49b11984d520cce62313a6ee243fd87ff85e94c
            );
        }
        if (index == 107) {
            return (
                0x000000000000000000000000000000000929f93e80a21e6ca485a468a5c0a125,
                0x6803f4d7416a7fa4409473d66fbf2cdf207e84414c29f686e9e8023c5ccbc4ec,
                0x00000000000000000000000000000000033721d9d308741add52ad237f62637e,
                0x4c41bc8f7ed636c6268d5bf5b465cf336b118ee7c7153ff3b2574dbacafa3f71
            );
        }
        if (index == 108) {
            return (
                0x0000000000000000000000000000000002ed26705ee2b67836f181d7d4d78f92,
                0x5abda54cd56d7e3ae5b24935c78a0d744586be09c5e0a888bf193ef9d83f71b9,
                0x000000000000000000000000000000000fe5baab4fc850b15065aee742e78134,
                0xae5cb2794b2ebc9e65b5b7e73f7af7f578d66b1d7ea823907e492d213f4d2ad8
            );
        }
        if (index == 109) {
            return (
                0x0000000000000000000000000000000006756972373aebfdd0f25eb6d08e8cc4,
                0xf236745c41d03b9f4e5fdbec132fc4bb05d9b9e67b29b97433b0d757f61c788c,
                0x000000000000000000000000000000000387ac6251cd1c3a2a5f1c5fe29b1b41,
                0xbb08e09e648d203d2f5715c77cfad9bfc829e67a6e3f5850296f34404a12cecd
            );
        }
        if (index == 110) {
            return (
                0x0000000000000000000000000000000018d6201043c4e79e0ae5350eaef60a08,
                0x2f0d9387769b0af21d96f914419654e0c2a35cfa605bc15076947dd42698ef4d,
                0x0000000000000000000000000000000002be521a323b3ffba509d9ee95939f57,
                0x7a7ce6e6421c0db07d01b088fcaf2321d2526c3e2dd1c153e2fe0c696a64daa7
            );
        }
        if (index == 111) {
            return (
                0x000000000000000000000000000000000b0959d6ed79c9c400c5df07ca921781,
                0xb6f2377fe5b9ebffcd07ef833ea6f2acd0b3fe1ed08ce8988227fdd06510a46d,
                0x000000000000000000000000000000000e2dd560cb6bcebb03bdb0226e66fd3d,
                0x9a59b97eadcdf4511d9fa642cd311ce7cd538836bf258ccf07b6bb2bb3f00236
            );
        }
        if (index == 112) {
            return (
                0x0000000000000000000000000000000013869de280d477ee0932cd7cfa774ad3,
                0xf275fd40e64d6181be00d3b37ffe9462e6cb6b7f64c172382a9c52551dbe6c1d,
                0x000000000000000000000000000000000ef363a8fb9694f9526b916bf8713120,
                0x013532c9f9d3aa7d5cc38e36de1e732c04fb5a569e0e6d001e78ba9262f1a996
            );
        }
        if (index == 113) {
            return (
                0x0000000000000000000000000000000003a35c9efa31e058cc3226134a056f88,
                0xbb590605a863eb022456c6f9bff2def1ce6fc4d532954516d01180fb809c3549,
                0x000000000000000000000000000000000e2e7faa899a60c8efefe3e65026f8e1,
                0x023eb12ed79aa3ab2af1ae31c2e9a13c2e0a47b5ef46de61bd3509f97f4fa467
            );
        }
        if (index == 114) {
            return (
                0x00000000000000000000000000000000041c8349362f8403c6968d0bcefe1d41,
                0x12c162a7fc214d80d96956d7aa12f34e8110d72ae63c9d76d2b3a012cf46c78b,
                0x00000000000000000000000000000000083df3a2e8c25b73dc22b54638df34cb,
                0x6df6c45b4d568481ea7349c3537450a110494fdb7f89a0f0e479305214824977
            );
        }
        if (index == 115) {
            return (
                0x000000000000000000000000000000000eef09cdceb053d72634a5ac51bbb361,
                0x2495338a3fac02f690863743b89fee4c513564842f9e690334fec25033bd0ec4,
                0x00000000000000000000000000000000031c9309d5a36f5c5ac538d341879ab0,
                0xe2a55519773c1f00cac21c495affe063a976aec5b3481f173509198c6aafcce9
            );
        }
        if (index == 116) {
            return (
                0x00000000000000000000000000000000005a2e53b9d6be145f81182cbd315bc6,
                0xefbef8d1c994b59efa33edf8e7005a490321b5c2465c6bfc70a973b6477776c5,
                0x0000000000000000000000000000000005c7719bf1a13db1e44b42ab1e4a1697,
                0xea9189116735df7d4d9725b25954120e53aba7569408476ca5afdca1c6741e6f
            );
        }
        if (index == 117) {
            return (
                0x0000000000000000000000000000000007b651c8caf24bbe1bb2ad96df7ea542,
                0x742256f6f7b88bc33b505f69e7cca719d57b526af3c3f0381b5ab21ff9c9dd0f,
                0x000000000000000000000000000000000056b0f1714d8f7c6bb30ee8c5440e60,
                0x1a99261432ac38c812535b29cc26985b814abbd8322a70ae27ec8b06e88c1ce6
            );
        }
        if (index == 118) {
            return (
                0x0000000000000000000000000000000009e3cc2c6efee3d310f98bc78acd13c0,
                0x4d4ae6f32aac9b61bdb48ab2ddaf2f1e02f3af0b8c8d32360821313b5c9d7b11,
                0x000000000000000000000000000000000f4b12763ab7c06c494a09cae92452b9,
                0x31f535d7534bbf0342c03c4e6e7fea6a27a32bb5a99f4cf15cfb51f2ff5fc4e7
            );
        }
        if (index == 119) {
            return (
                0x000000000000000000000000000000001805d13c22f55866dbe8e4cf7163ab9a,
                0x12263945d5c9eea8100e0b213968ea72c58d903564f79379da4702e9911047aa,
                0x00000000000000000000000000000000199fc6c17e3df392dda0717d7b559e64,
                0xd5ac64016459d6ead3c57732f6f24607934970ebe7fe18df1fd45e6c426fab2e
            );
        }
        if (index == 120) {
            return (
                0x0000000000000000000000000000000009bce74c4c20a97c38e4434b269ff408,
                0xb54d65865cc4e2990d25f788d589d3abc4feef5ada1946314e4a53b322e0f144,
                0x000000000000000000000000000000000fa2fe4f0774b6b73d0aadf21b751dfc,
                0x18e717f98376731877cb4f7b4f0f20101ee47e87dbc27cb0b8a92cc12a9ae144
            );
        }
        if (index == 121) {
            return (
                0x0000000000000000000000000000000016e5b0ca72fe9ffaf3ea037e2ab31da4,
                0x7758b2344bad7c3ebd956ce838b625ff586af67b083508c74f16d18977b7655f,
                0x00000000000000000000000000000000195fab81db29d380aa43927dd1f11636,
                0x6263f2308c0fa971aa3e11af6c30fd91c238110b768635667614afea2b33a893
            );
        }
        if (index == 122) {
            return (
                0x000000000000000000000000000000001093a38b4e19f5a479a7cec70b0058f1,
                0x29712068ef03a55175d752b2ae186d1d1a63eaab36ce50bfd8d90a1e98223399,
                0x0000000000000000000000000000000003cfe210624f85932e1ad71212112f1e,
                0xf3bc348676576b569c4c97c26362e14cbed68b8ca26ef6c5bfc7b9747b825dc1
            );
        }
        if (index == 123) {
            return (
                0x00000000000000000000000000000000174251cf9243d5aa33a9bc4829af8a63,
                0x038b3f726756c7a658437bf1d40a9de133ec0c4e8716cdc6580840f777275b78,
                0x000000000000000000000000000000000370364e2e0cfd04b7287f3d67f3e350,
                0xd785b8a1301ec449e6cea709083b529981ed8e6fabb9121187371e561650a95c
            );
        }
        if (index == 124) {
            return (
                0x00000000000000000000000000000000053390fdae22e48550263fd083ace6bf,
                0xb1e068de2e714126322a8e4282ff28f309a2b7be5515b2b2b891a814ad994f6d,
                0x0000000000000000000000000000000002550740e103b4ffcb833c999057b58f,
                0xdcccb433dbc2f2404b934aef35a02415dd1357d79ce3772c7e9f2dcd643cf836
            );
        }
        if (index == 125) {
            return (
                0x0000000000000000000000000000000019f0d3afb3e53f43e36048f39dc92f5e,
                0xd8cf184526abfc017a0d5bbb4c68c23acb3feb7e0908dfcca1c01f9eed3b3afe,
                0x0000000000000000000000000000000019e4176160e0c3d0502c254041ba26b1,
                0x975eeac159c91c364e056a25f766640b240a07a26abf177e1aef398abedc2ffd
            );
        }
        if (index == 126) {
            return (
                0x000000000000000000000000000000000b19958b9ae38efa23c1202367658bb6,
                0x20d19cd71c0422b596963d1714030bb304c710fcbe67da58afdd0b025a6b3a0c,
                0x000000000000000000000000000000000100559d89dd2ff9270645b17c39f4e0,
                0xf93dfb3daf4bef23f6e6a61678def3ddac24a629e8aeef342b4257fc3d681004
            );
        }
        if (index == 127) {
            return (
                0x0000000000000000000000000000000000f30e98cd592f59d0ecae0bea5e34f0,
                0x9b76c16540f3c09c170e84df24d4589c8b1c67a3788aafdbbf850e70ce9d8033,
                0x00000000000000000000000000000000192ad8b8942d84c0f79f49085ec6c8f1,
                0x6c9a48c88ffab007e08241b0b0fcd9738a2eb77400952940149903b8d3affed6
            );
        }
        if (index == 128) {
            return (
                0x0000000000000000000000000000000016134639b0317bc9fe33d832d578f84b,
                0x79c7e0ab02558b3282ed7ed1492305615c170387f8acbe50bd3584ee7645dc25,
                0x00000000000000000000000000000000033805a8f312032956895c0e3822c943,
                0x50c74b3018b2108b4adebdbc856524faa07059b5b6fd66268a0143b6345cb490
            );
        }
        if (index == 129) {
            return (
                0x00000000000000000000000000000000148654bb415403da66b3d8a527e35fba,
                0xa9c687ddf949e3d69bf55a15ee4199cea4c36dd4f37d3e90302b2e4b6831f581,
                0x000000000000000000000000000000001670b32af2ebf41f3086a08a27bb2296,
                0x7cb5c8ab61e635275d58935644a5cfc63f2c8c704c627dbb1d4032ea0fa1fc9a
            );
        }
        revert("Invalid IC index");
    }
}



================================================
FILE: src/verifier/TokamakVerifier.sol
================================================
    // SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import {ITokamakVerifier} from "../interface/ITokamakVerifier.sol";

/* solhint-disable max-line-length */
/// @author Project Ooo team
/// @dev It uses a custom memory layout inside the inline assembly block. Each reserved memory cell is declared in the
/// constants below.
/// @dev For a better understanding of the verifier algorithm please refer to the following papers:
/// *
/// * Original Tokamak zkSNARK Paper: https://eprint.iacr.org/2024/507.pdf
/// The notation used in the code is the same as in the papers.
/* solhint-enable max-line-length */
contract TokamakVerifier is ITokamakVerifier {
    /*//////////////////////////////////////////////////////////////
                                    Proof
    //////////////////////////////////////////////////////////////*/

    /// The encoding order of the `proof` (part1) is
    /// ```
    /// |                  672 bytes                 |
    /// | Polynomial commitments (16th first bytes)  |
    /// ```

    /// The encoding order of the `proof` (part2) is
    /// ```
    /// |               1344 bytes                |   32 bytes  |   32 bytes   |   32 bytes  |   32 bytes  |
    /// | Polynomial commitments (last 32 bytes)  |   R_{x,y}   |   R'_{x,y}   |   R''_{x,y} |   V_{x,y}   |
    /// ```

    // [s^{(0)}(x,y)]_1
    uint256 internal constant PUBLIC_INPUTS_S_0_X_SLOT_PART1 = 0x8000 + 0x200 + 0x040;
    uint256 internal constant PUBLIC_INPUTS_S_0_X_SLOT_PART2 = 0x8000 + 0x200 + 0x060;
    uint256 internal constant PUBLIC_INPUTS_S_0_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x080;
    uint256 internal constant PUBLIC_INPUTS_S_0_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x0a0;

    // [s^{(1)}(x,y)]_1
    uint256 internal constant PUBLIC_INPUTS_S_1_X_SLOT_PART1 = 0x8000 + 0x200 + 0x0c0;
    uint256 internal constant PUBLIC_INPUTS_S_1_X_SLOT_PART2 = 0x8000 + 0x200 + 0x0e0;
    uint256 internal constant PUBLIC_INPUTS_S_1_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x100;
    uint256 internal constant PUBLIC_INPUTS_S_1_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120;

    // U
    uint256 internal constant PROOF_POLY_U_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x020;
    uint256 internal constant PROOF_POLY_U_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x040;
    uint256 internal constant PROOF_POLY_U_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x060;
    uint256 internal constant PROOF_POLY_U_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x080;
    // V
    uint256 internal constant PROOF_POLY_V_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x0a0;
    uint256 internal constant PROOF_POLY_V_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x0c0;
    uint256 internal constant PROOF_POLY_V_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x0e0;
    uint256 internal constant PROOF_POLY_V_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x100;
    // W
    uint256 internal constant PROOF_POLY_W_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x120;
    uint256 internal constant PROOF_POLY_W_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x140;
    uint256 internal constant PROOF_POLY_W_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x160;
    uint256 internal constant PROOF_POLY_W_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x180;
    // O_mid
    uint256 internal constant PROOF_POLY_OMID_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x1a0;
    uint256 internal constant PROOF_POLY_OMID_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x1c0;
    uint256 internal constant PROOF_POLY_OMID_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x1e0;
    uint256 internal constant PROOF_POLY_OMID_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x200;
    // O_prv
    uint256 internal constant PROOF_POLY_OPRV_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x220;
    uint256 internal constant PROOF_POLY_OPRV_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x240;
    uint256 internal constant PROOF_POLY_OPRV_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x260;
    uint256 internal constant PROOF_POLY_OPRV_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x280;
    // Q_{AX}
    uint256 internal constant PROOF_POLY_QAX_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x2a0;
    uint256 internal constant PROOF_POLY_QAX_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x2c0;
    uint256 internal constant PROOF_POLY_QAX_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x2e0;
    uint256 internal constant PROOF_POLY_QAX_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x300;
    // Q_{AY}
    uint256 internal constant PROOF_POLY_QAY_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x320;
    uint256 internal constant PROOF_POLY_QAY_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x340;
    uint256 internal constant PROOF_POLY_QAY_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x360;
    uint256 internal constant PROOF_POLY_QAY_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x380;
    // Q_{CX}
    uint256 internal constant PROOF_POLY_QCX_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x3a0;
    uint256 internal constant PROOF_POLY_QCX_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x3c0;
    uint256 internal constant PROOF_POLY_QCX_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x3e0;
    uint256 internal constant PROOF_POLY_QCX_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x400;
    // Q_{CY}
    uint256 internal constant PROOF_POLY_QCY_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x420;
    uint256 internal constant PROOF_POLY_QCY_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x440;
    uint256 internal constant PROOF_POLY_QCY_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x460;
    uint256 internal constant PROOF_POLY_QCY_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x480;
    // Î _{Ï‡}
    uint256 internal constant PROOF_POLY_PI_CHI_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x4a0;
    uint256 internal constant PROOF_POLY_PI_CHI_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x4c0;
    uint256 internal constant PROOF_POLY_PI_CHI_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x4e0;
    uint256 internal constant PROOF_POLY_PI_CHI_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x500;
    // Î {Î¶}
    uint256 internal constant PROOF_POLY_PI_ZETA_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x520;
    uint256 internal constant PROOF_POLY_PI_ZETA_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x540;
    uint256 internal constant PROOF_POLY_PI_ZETA_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x560;
    uint256 internal constant PROOF_POLY_PI_ZETA_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x580;
    // B
    uint256 internal constant PROOF_POLY_B_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x5a0;
    uint256 internal constant PROOF_POLY_B_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x5c0;
    uint256 internal constant PROOF_POLY_B_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x5e0;
    uint256 internal constant PROOF_POLY_B_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x600;
    // R
    uint256 internal constant PROOF_POLY_R_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x620;
    uint256 internal constant PROOF_POLY_R_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x640;
    uint256 internal constant PROOF_POLY_R_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x660;
    uint256 internal constant PROOF_POLY_R_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x680;
    // M_Î¶
    uint256 internal constant PROOF_POLY_M_ZETA_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x6a0;
    uint256 internal constant PROOF_POLY_M_ZETA_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x6c0;
    uint256 internal constant PROOF_POLY_M_ZETA_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x6e0;
    uint256 internal constant PROOF_POLY_M_ZETA_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x700;
    // M_Ï‡
    uint256 internal constant PROOF_POLY_M_CHI_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x720;
    uint256 internal constant PROOF_POLY_M_CHI_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x740;
    uint256 internal constant PROOF_POLY_M_CHI_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x760;
    uint256 internal constant PROOF_POLY_M_CHI_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x780;
    // N_Î¶
    uint256 internal constant PROOF_POLY_N_ZETA_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x7a0;
    uint256 internal constant PROOF_POLY_N_ZETA_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x7c0;
    uint256 internal constant PROOF_POLY_N_ZETA_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x7e0;
    uint256 internal constant PROOF_POLY_N_ZETA_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x800;
    // N_Ï‡
    uint256 internal constant PROOF_POLY_N_CHI_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x820;
    uint256 internal constant PROOF_POLY_N_CHI_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x840;
    uint256 internal constant PROOF_POLY_N_CHI_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x860;
    uint256 internal constant PROOF_POLY_N_CHI_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x880;
    // O_pub
    uint256 internal constant PROOF_POLY_OPUB_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x8a0;
    uint256 internal constant PROOF_POLY_OPUB_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x8c0;
    uint256 internal constant PROOF_POLY_OPUB_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x8e0;
    uint256 internal constant PROOF_POLY_OPUB_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x900;
    // A
    uint256 internal constant PROOF_POLY_A_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x920;
    uint256 internal constant PROOF_POLY_A_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x940;
    uint256 internal constant PROOF_POLY_A_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0x960;
    uint256 internal constant PROOF_POLY_A_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0x980;
    // R_xy
    uint256 internal constant PROOF_R1XY_SLOT = 0x8000 + 0x200 + 0x120 + 0x9a0;
    // R'_xy
    uint256 internal constant PROOF_R2XY_SLOT = 0x8000 + 0x200 + 0x120 + 0x9c0;
    // R''_xy
    uint256 internal constant PROOF_R3XY_SLOT = 0x8000 + 0x200 + 0x120 + 0x9e0;
    // V_xy
    uint256 internal constant PROOF_VXY_SLOT = 0x8000 + 0x200 + 0x120 + 0xa00;

    /*//////////////////////////////////////////////////////////////
                transcript slot (used for challenge computation)
    //////////////////////////////////////////////////////////////*/

    uint256 internal constant TRANSCRIPT_BEGIN_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x00;
    uint256 internal constant TRANSCRIPT_DST_BYTE_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x03;
    uint256 internal constant TRANSCRIPT_STATE_0_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x04;
    uint256 internal constant TRANSCRIPT_STATE_1_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x24;
    uint256 internal constant TRANSCRIPT_CHALLENGE_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x44;

    /*//////////////////////////////////////////////////////////////
                                Challenges
    //////////////////////////////////////////////////////////////*/

    uint256 internal constant CHALLENGE_THETA_0_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x000;
    uint256 internal constant CHALLENGE_THETA_1_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x020;
    uint256 internal constant CHALLENGE_THETA_2_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x040;
    uint256 internal constant CHALLENGE_KAPPA_0_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x060;
    uint256 internal constant CHALLENGE_KAPPA_1_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x080;
    uint256 internal constant CHALLENGE_KAPPA_2_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x0a0;
    uint256 internal constant CHALLENGE_ZETA_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x0c0;
    uint256 internal constant CHALLENGE_XI_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x0e0;
    uint256 internal constant CHALLENGE_CHI_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100;

    /*//////////////////////////////////////////////////////////////
                        Intermediary verifier state
    //////////////////////////////////////////////////////////////*/

    // [F]_1
    uint256 internal constant INTERMERDIARY_POLY_F_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x020;
    uint256 internal constant INTERMERDIARY_POLY_F_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x040;
    uint256 internal constant INTERMERDIARY_POLY_F_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x060;
    uint256 internal constant INTERMERDIARY_POLY_F_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x080;

    // [G]_1
    uint256 internal constant INTERMERDIARY_POLY_G_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x0a0;
    uint256 internal constant INTERMERDIARY_POLY_G_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x0c0;
    uint256 internal constant INTERMERDIARY_POLY_G_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x0e0;
    uint256 internal constant INTERMERDIARY_POLY_G_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x100;

    // t_n(Ï‡)
    uint256 internal constant INTERMERDIARY_SCALAR_T_N_CHI_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x120;
    // t_smax(Î¶)
    uint256 internal constant INTERMERDIARY_SCALAR_T_SMAX_ZETA_SLOT =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x140;
    // t_ml(Ï‡)
    uint256 internal constant INTERMERDIARY_SCALAR_T_MI_CHI_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x160;
    // K_0(Ï‡)
    uint256 internal constant INTERMEDIARY_SCALAR_KO_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x180;
    // A_pub
    uint256 internal constant INTERMEDIARY_SCALAR_APUB_SLOT = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0;

    /*//////////////////////////////////////////////////////////////
                      Aggregated commitment
    //////////////////////////////////////////////////////////////*/

    uint256 internal constant AGG_LHS_A_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x020;
    uint256 internal constant AGG_LHS_A_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x040;
    uint256 internal constant AGG_LHS_A_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x060;
    uint256 internal constant AGG_LHS_A_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x080;

    uint256 internal constant AGG_LHS_B_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x0a0;
    uint256 internal constant AGG_LHS_B_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x0c0;
    uint256 internal constant AGG_LHS_B_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x0e0;
    uint256 internal constant AGG_LHS_B_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x100;

    uint256 internal constant AGG_LHS_C_X_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x120;
    uint256 internal constant AGG_LHS_C_X_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x140;
    uint256 internal constant AGG_LHS_C_Y_SLOT_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x160;
    uint256 internal constant AGG_LHS_C_Y_SLOT_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x180;

    uint256 internal constant PAIRING_AGG_LHS_X_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x1a0;
    uint256 internal constant PAIRING_AGG_LHS_X_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x1c0;
    uint256 internal constant PAIRING_AGG_LHS_Y_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x1e0;
    uint256 internal constant PAIRING_AGG_LHS_Y_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x200;

    uint256 internal constant PAIRING_AGG_AUX_X_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x220;
    uint256 internal constant PAIRING_AGG_AUX_X_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x240;
    uint256 internal constant PAIRING_AGG_AUX_Y_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x260;
    uint256 internal constant PAIRING_AGG_AUX_Y_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x280;

    uint256 internal constant PAIRING_AGG_LHS_AUX_X_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x2a0;
    uint256 internal constant PAIRING_AGG_LHS_AUX_X_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x2c0;
    uint256 internal constant PAIRING_AGG_LHS_AUX_Y_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x2e0;
    uint256 internal constant PAIRING_AGG_LHS_AUX_Y_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x300;

    uint256 internal constant PAIRING_AGG_RHS_1_X_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x320;
    uint256 internal constant PAIRING_AGG_RHS_1_X_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x340;
    uint256 internal constant PAIRING_AGG_RHS_1_Y_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x360;
    uint256 internal constant PAIRING_AGG_RHS_1_Y_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x380;

    uint256 internal constant PAIRING_AGG_RHS_2_X_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x3a0;
    uint256 internal constant PAIRING_AGG_RHS_2_X_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x3c0;
    uint256 internal constant PAIRING_AGG_RHS_2_Y_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x3e0;
    uint256 internal constant PAIRING_AGG_RHS_2_Y_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x400;

    /*//////////////////////////////////////////////////////////////
                                Pairing data
    //////////////////////////////////////////////////////////////*/

    uint256 internal constant BUFFER_AGGREGATED_POLY_X_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x420;
    uint256 internal constant BUFFER_AGGREGATED_POLY_X_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x440;
    uint256 internal constant BUFFER_AGGREGATED_POLY_Y_SLOT_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x460;
    uint256 internal constant BUFFER_AGGREGATED_POLY_Y_SLOT_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480;

    /*//////////////////////////////////////////////////////////////
                            Verification keys
    //////////////////////////////////////////////////////////////*/

    // [K^_1(X)L^-1(X)]_1
    uint256 internal constant VK_POLY_KXLX_X_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x020;
    uint256 internal constant VK_POLY_KXLX_X_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x040;
    uint256 internal constant VK_POLY_KXLX_Y_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x060;
    uint256 internal constant VK_POLY_KXLX_Y_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x080;

    // [x]_1
    uint256 internal constant VK_POLY_X_X_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x0a0;
    uint256 internal constant VK_POLY_X_X_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x0c0;
    uint256 internal constant VK_POLY_X_Y_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x0e0;
    uint256 internal constant VK_POLY_X_Y_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x100;

    // [y]_1
    uint256 internal constant VK_POLY_Y_X_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x120;
    uint256 internal constant VK_POLY_Y_X_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x140;
    uint256 internal constant VK_POLY_Y_Y_PART1 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x160;
    uint256 internal constant VK_POLY_Y_Y_PART2 = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x180;

    // [1]_1
    uint256 internal constant VK_IDENTITY_X_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x1a0;
    uint256 internal constant VK_IDENTITY_X_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x1c0;
    uint256 internal constant VK_IDENTITY_Y_PART1 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x1e0;
    uint256 internal constant VK_IDENTITY_Y_PART2 =
        0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x200;

    /*//////////////////////////////////////////////////////////////
                                trusted-setup param
    //////////////////////////////////////////////////////////////*/

    // smax
    uint256 internal constant PARAM_SMAX = 0x8000 + 0x200 + 0x120 + 0xa20 + 0x80 + 0x100 + 0x1a0 + 0x480 + 0x200 + 0x020;

    /*//////////////////////////////////////////////////////////////
                                Constants
    //////////////////////////////////////////////////////////////*/

    // Scalar field size
    // Q_MOD is the base field modulus (48 bytes long). To fit with the EVM, we sliced it into two 32bytes variables => 16 first bytes are zeros
    uint256 internal constant Q_MOD_PART1 = 0x000000000000000000000000000000001a0111ea397fe69a4b1ba7b6434bacd7;
    uint256 internal constant Q_MOD_PART2 = 0x64774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab;
    // R_MOD is the main subgroup order
    uint256 internal constant R_MOD = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001;

    /// @dev flip of 0xe000000000000000000000000000000000000000000000000000000000000000;
    uint256 internal constant FR_MASK = 0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff;

    // n
    uint256 internal constant CONSTANT_N = 2048;
    // Ï‰_512
    uint256 internal constant OMEGA_512 = 0x1bb466679a5d88b1ecfbede342dee7f415c1ad4c687f28a233811ea1fe0c65f4;
    // m_i
    uint256 internal constant CONSTANT_MI = 2048;

    // Ï‰_{m_i}^{-1}
    uint256 internal constant OMEGA_MI_1 = 0x394fda0d65ba213edeae67bc36f376e13cc5bb329aa58ff53dc9e5600f6fb2ac;

    // Ï‰_smax_64^{-1}
    uint256 internal constant OMEGA_SMAX_64_MINUS_1 = 0x199cdaee7b3c79d6566009b5882952d6a41e85011d426b52b891fa3f982b68c5;
    // Ï‰_smax_128^{-1}
    uint256 internal constant OMEGA_SMAX_128_MINUS_1 =
        0x1996fa8d52f970ba51420be43501370b166fb582ac74db12571ba2fccf28601b;
    // Ï‰_smax_256^{-1}
    uint256 internal constant OMEGA_SMAX_256_MINUS_1 =
        0x6d64ed25272e58ee91b000235a5bfd4fc03cae032393991be9561c176a2f777a;
    // Ï‰_smax_512^{-1}
    uint256 internal constant OMEGA_SMAX_512_MINUS_1 =
        0x1907a56e80f82b2df675522e37ad4eca1c510ebfb4543a3efb350dbef02a116e;
    // Ï‰_smax_1024^{-1}
    uint256 internal constant OMEGA_SMAX_1024_MINUS_1 =
        0x2bcd9508a3dad316105f067219141f4450a32c41aa67e0beb0ad80034eb71aa6;
    // Ï‰_smax_2048^{-1}
    uint256 internal constant OMEGA_SMAX_2048_MINUS_1 =
        0x394fda0d65ba213edeae67bc36f376e13cc5bb329aa58ff53dc9e5600f6fb2ac;

    /*//////////////////////////////////////////////////////////////
                            G2 elements
        //////////////////////////////////////////////////////////////*/

    // G2 Points for zkEVM Verifier (BLS12-381) - Standard Naming Convention
    // Each point uses 8 uint256 slots (256 bytes total)
    // Format: X0_PART1, X0_PART2, X1_PART1, X1_PART2, Y0_PART1, Y0_PART2, Y1_PART1, Y1_PART2

    //H: G2serde(Affine { x: 0x1116094a7c01d4fd8abcfea69c658c92c037765bee00556b8d4063c33540b316ac68a2d913d3adc3b43c7d7cc7505cfc17206c8ae661f247979b3f1daa7fb6d5f7ce9c17b5ed1d7e8b421a2508b3f09a603e6a5fab3fcde7364fd178d656ac36, y: 0x15bf297a4b9842fb1a3a6f2dbf6b94de06997b11b2f72436c22efbb48d2f74b0de7239ea182a2ee50c23ae3d0be6fdee09459611409874fe4b04b1a7e42cb84eb4ae01728dc55dbd1343fda8d0fe94a299fc757acc1d2602a49a005b4ff90190 })
    // [1]_2 (Identity/Generator point H)
    uint256 internal constant IDENTITY2_X0_PART1 = 0x000000000000000000000000000000001116094a7c01d4fd8abcfea69c658c92;
    uint256 internal constant IDENTITY2_X0_PART2 = 0xc037765bee00556b8d4063c33540b316ac68a2d913d3adc3b43c7d7cc7505cfc;
    uint256 internal constant IDENTITY2_X1_PART1 = 0x0000000000000000000000000000000017206c8ae661f247979b3f1daa7fb6d5;
    uint256 internal constant IDENTITY2_X1_PART2 = 0xf7ce9c17b5ed1d7e8b421a2508b3f09a603e6a5fab3fcde7364fd178d656ac36;
    uint256 internal constant IDENTITY2_Y0_PART1 = 0x0000000000000000000000000000000015bf297a4b9842fb1a3a6f2dbf6b94de;
    uint256 internal constant IDENTITY2_Y0_PART2 = 0x06997b11b2f72436c22efbb48d2f74b0de7239ea182a2ee50c23ae3d0be6fdee;
    uint256 internal constant IDENTITY2_Y1_PART1 = 0x0000000000000000000000000000000009459611409874fe4b04b1a7e42cb84e;
    uint256 internal constant IDENTITY2_Y1_PART2 = 0xb4ae01728dc55dbd1343fda8d0fe94a299fc757acc1d2602a49a005b4ff90190;

    //alpha: G2serde(Affine { x: 0x05fc26da747c6cfef0305b496594b460e39e12dca4aebacb2d4bb6d2c4b02b2c50fe7ffe6f33940434a15a9425aa82ed0494bd39f21522f3fe14c8f9283e3fa1e05e39e804bb1881ef4529958798c9b68126138e3594797bc2f7042824b7d97e, y: 0x11161b94b2a44106ed5b9226279a2469c0eccdfedd34359d8577b9d980b238e80b97ad277d2c3010e94054edfa20e2e00e0075cf9d5766c2f27a41f2ebaf2aa2029de98dae9e4ab91c03b2c36a905d1e31072a0999bcde2a3c7722870cf0a2ec })
    // [Î±]_2
    uint256 internal constant ALPHA_X0_PART1 = 0x0000000000000000000000000000000005fc26da747c6cfef0305b496594b460;
    uint256 internal constant ALPHA_X0_PART2 = 0xe39e12dca4aebacb2d4bb6d2c4b02b2c50fe7ffe6f33940434a15a9425aa82ed;
    uint256 internal constant ALPHA_X1_PART1 = 0x000000000000000000000000000000000494bd39f21522f3fe14c8f9283e3fa1;
    uint256 internal constant ALPHA_X1_PART2 = 0xe05e39e804bb1881ef4529958798c9b68126138e3594797bc2f7042824b7d97e;
    uint256 internal constant ALPHA_Y0_PART1 = 0x0000000000000000000000000000000011161b94b2a44106ed5b9226279a2469;
    uint256 internal constant ALPHA_Y0_PART2 = 0xc0eccdfedd34359d8577b9d980b238e80b97ad277d2c3010e94054edfa20e2e0;
    uint256 internal constant ALPHA_Y1_PART1 = 0x000000000000000000000000000000000e0075cf9d5766c2f27a41f2ebaf2aa2;
    uint256 internal constant ALPHA_Y1_PART2 = 0x029de98dae9e4ab91c03b2c36a905d1e31072a0999bcde2a3c7722870cf0a2ec;

    //alpha2: G2serde(Affine { x: 0x133162dff634e8ff94132dd738659db83d0618c48e8c6c8d5b0805ad237364eeaf06286440b00c8e68faeec4ed9c154b1065e41eba7012b1b416f58dd3bbdda89bf3a06944476337565ab07746065e3807f5a04f933453e48f3edb96b86f5e52, y: 0x19f032956715814f77a9bd9e06ccb681bf2af52adbbed8df7b01b04966db248c80b76328459349995d0780cfe4ac11ba0b13ca416c480313f7dfba208414d08412adecdc9f8b84e0ec2dcb4e532e2d6d1f6e6d2308bc7b4e38072e51d40c3d04 })
    // [Î±^2]_2
    uint256 internal constant ALPHA_POWER2_X0_PART1 = 0x00000000000000000000000000000000133162dff634e8ff94132dd738659db8;
    uint256 internal constant ALPHA_POWER2_X0_PART2 = 0x3d0618c48e8c6c8d5b0805ad237364eeaf06286440b00c8e68faeec4ed9c154b;
    uint256 internal constant ALPHA_POWER2_X1_PART1 = 0x000000000000000000000000000000001065e41eba7012b1b416f58dd3bbdda8;
    uint256 internal constant ALPHA_POWER2_X1_PART2 = 0x9bf3a06944476337565ab07746065e3807f5a04f933453e48f3edb96b86f5e52;
    uint256 internal constant ALPHA_POWER2_Y0_PART1 = 0x0000000000000000000000000000000019f032956715814f77a9bd9e06ccb681;
    uint256 internal constant ALPHA_POWER2_Y0_PART2 = 0xbf2af52adbbed8df7b01b04966db248c80b76328459349995d0780cfe4ac11ba;
    uint256 internal constant ALPHA_POWER2_Y1_PART1 = 0x000000000000000000000000000000000b13ca416c480313f7dfba208414d084;
    uint256 internal constant ALPHA_POWER2_Y1_PART2 = 0x12adecdc9f8b84e0ec2dcb4e532e2d6d1f6e6d2308bc7b4e38072e51d40c3d04;

    //alpha3: G2serde(Affine { x: 0x03f4debb62e445a8d577dfcb3b9e9e6fbfeff7390c23dae3c84bbe70394c5d8c8bfcd81f39ab65db1647ac9e7905a830048e5721d748709bdb68b01af622428ada2799bdb21845dad8e0e80ec4c02c89eb0a65f5f7f2b64a9d2f104ff9912c1a, y: 0x0c99a7e666f2e9bd896335d5ea1cd0d696fcc1fcc2658dc666f97f238a6ad6cb07997380d33e28beffb74262751b651011892c5548e7c5b9ed9d6e75d2507ff3285d8c4d9ac82b91766ae09f185bd4824f95abef13b87d3d96ed05635d7936b6 })
    // [Î±^3]_2
    uint256 internal constant ALPHA_POWER3_X0_PART1 = 0x0000000000000000000000000000000003f4debb62e445a8d577dfcb3b9e9e6f;
    uint256 internal constant ALPHA_POWER3_X0_PART2 = 0xbfeff7390c23dae3c84bbe70394c5d8c8bfcd81f39ab65db1647ac9e7905a830;
    uint256 internal constant ALPHA_POWER3_X1_PART1 = 0x00000000000000000000000000000000048e5721d748709bdb68b01af622428a;
    uint256 internal constant ALPHA_POWER3_X1_PART2 = 0xda2799bdb21845dad8e0e80ec4c02c89eb0a65f5f7f2b64a9d2f104ff9912c1a;
    uint256 internal constant ALPHA_POWER3_Y0_PART1 = 0x000000000000000000000000000000000c99a7e666f2e9bd896335d5ea1cd0d6;
    uint256 internal constant ALPHA_POWER3_Y0_PART2 = 0x96fcc1fcc2658dc666f97f238a6ad6cb07997380d33e28beffb74262751b6510;
    uint256 internal constant ALPHA_POWER3_Y1_PART1 = 0x0000000000000000000000000000000011892c5548e7c5b9ed9d6e75d2507ff3;
    uint256 internal constant ALPHA_POWER3_Y1_PART2 = 0x285d8c4d9ac82b91766ae09f185bd4824f95abef13b87d3d96ed05635d7936b6;

    //alpha4: G2serde(Affine { x: 0x119487452ff2249b913d3615596b23ed798963dce3e84bb1cda6d8275420d78d6b8c689444b44d6abf94336be9344f050fd4fedaf2dea68d920f1de7dd6136c094d9e733600996a597cd54aa910474408470624188e655f7f7fd28e490d561d8, y: 0x036d8893301ebf86f558727a258d0c01e274a405033f63d35a80b7547f9f893ff9502295e54dae44f0f40052d89c93f615774c7ad74887b825aa76fbc677f95caaf2fc055bc4cf92385d115876a2032e71455bcbc47323cfa19b1b0f44a681dc })
    // [Î±^4]_2
    uint256 internal constant ALPHA_POWER4_X0_PART1 = 0x00000000000000000000000000000000119487452ff2249b913d3615596b23ed;
    uint256 internal constant ALPHA_POWER4_X0_PART2 = 0x798963dce3e84bb1cda6d8275420d78d6b8c689444b44d6abf94336be9344f05;
    uint256 internal constant ALPHA_POWER4_X1_PART1 = 0x000000000000000000000000000000000fd4fedaf2dea68d920f1de7dd6136c0;
    uint256 internal constant ALPHA_POWER4_X1_PART2 = 0x94d9e733600996a597cd54aa910474408470624188e655f7f7fd28e490d561d8;
    uint256 internal constant ALPHA_POWER4_Y0_PART1 = 0x00000000000000000000000000000000036d8893301ebf86f558727a258d0c01;
    uint256 internal constant ALPHA_POWER4_Y0_PART2 = 0xe274a405033f63d35a80b7547f9f893ff9502295e54dae44f0f40052d89c93f6;
    uint256 internal constant ALPHA_POWER4_Y1_PART1 = 0x0000000000000000000000000000000015774c7ad74887b825aa76fbc677f95c;
    uint256 internal constant ALPHA_POWER4_Y1_PART2 = 0xaaf2fc055bc4cf92385d115876a2032e71455bcbc47323cfa19b1b0f44a681dc;

    //-gamma: G2serde(Affine { x: 0x0c5f05ae1cd7c8c9d23904a90041ba698baf0a264bfd553d2c4f9b51ac51795839aef12df95d82ca94bb88b705ac9c6518356bdcacde783dd402ae3b1b7004e365385d828b938721c6e17ecff44403ceeed486592da4e2acb6ad1a99d1ac7a10, y: 0x02c8345a6ed2c39c85d0060afda056f4afd58411c2f9bd04796de3d47fcf2437001ebafd8c378514f7bfc58d597bbdaa17227dbdfedcb0e7bab68b1a59ae7265b4e308f8c0343efe071a972e1c7eb3a6ee204a485782bcbc19d04ef85afc35ba })
    // -[Î³]_2 (negated for pairing)
    uint256 internal constant GAMMA_X0_PART1 = 0x000000000000000000000000000000000c5f05ae1cd7c8c9d23904a90041ba69;
    uint256 internal constant GAMMA_X0_PART2 = 0x8baf0a264bfd553d2c4f9b51ac51795839aef12df95d82ca94bb88b705ac9c65;
    uint256 internal constant GAMMA_X1_PART1 = 0x0000000000000000000000000000000018356bdcacde783dd402ae3b1b7004e3;
    uint256 internal constant GAMMA_X1_PART2 = 0x65385d828b938721c6e17ecff44403ceeed486592da4e2acb6ad1a99d1ac7a10;
    uint256 internal constant GAMMA_Y0_PART1 = 0x0000000000000000000000000000000002c8345a6ed2c39c85d0060afda056f4;
    uint256 internal constant GAMMA_Y0_PART2 = 0xafd58411c2f9bd04796de3d47fcf2437001ebafd8c378514f7bfc58d597bbdaa;
    uint256 internal constant GAMMA_Y1_PART1 = 0x0000000000000000000000000000000017227dbdfedcb0e7bab68b1a59ae7265;
    uint256 internal constant GAMMA_Y1_PART2 = 0xb4e308f8c0343efe071a972e1c7eb3a6ee204a485782bcbc19d04ef85afc35ba;

    //-eta: G2serde(Affine { x: 0x0dee20e8a1a4601b8b8498881220ca31036ee005b261f0cda1a47cd364094ac493a9446f69c00c18b85920798b7189790d952a8d8d2e7ab7774f04402897938d621ea0baf138e19617c320a2ec5de9d7694efef008994bc7a1b9f96939e38141, y: 0x008fe985823f536253d44624957d6cb56688c976fb9500a5de0f60e5b0ea13ded0f9b52bea37878fab734649ddc9416014584ce9324f72a304457fcd578a051a906515cd3d07ad3c146e9c4fceb44599219770bd16033d3e328cdfe9ba0040f4 })
    // -[Î·]_2 (negated for pairing)
    uint256 internal constant ETA_X0_PART1 = 0x000000000000000000000000000000000dee20e8a1a4601b8b8498881220ca31;
    uint256 internal constant ETA_X0_PART2 = 0x036ee005b261f0cda1a47cd364094ac493a9446f69c00c18b85920798b718979;
    uint256 internal constant ETA_X1_PART1 = 0x000000000000000000000000000000000d952a8d8d2e7ab7774f04402897938d;
    uint256 internal constant ETA_X1_PART2 = 0x621ea0baf138e19617c320a2ec5de9d7694efef008994bc7a1b9f96939e38141;
    uint256 internal constant ETA_Y0_PART1 = 0x00000000000000000000000000000000008fe985823f536253d44624957d6cb5;
    uint256 internal constant ETA_Y0_PART2 = 0x6688c976fb9500a5de0f60e5b0ea13ded0f9b52bea37878fab734649ddc94160;
    uint256 internal constant ETA_Y1_PART1 = 0x0000000000000000000000000000000014584ce9324f72a304457fcd578a051a;
    uint256 internal constant ETA_Y1_PART2 = 0x906515cd3d07ad3c146e9c4fceb44599219770bd16033d3e328cdfe9ba0040f4;

    //-delta: G2serde(Affine { x: 0x0d82e8b936233a9bfaf7587777b2ae7e2daa56831d2105076d0140015a9a299a42656cfa6149dc45246c121a37f05ffe04718ed40c6f593d1bdd16b161bd662fe33f1d39c3eab8548a90e0b8d15b2f68fcc73b63694e46f773c101ce369e57f6, y: 0x0ced763d46e2c7a1b36e7906825b663f16b6ee1eb58e77f918d2476a2afe5481b95c9fbfe525a77ece5004631ae82f9304a088624a997f337758547f065202f0900c0af7e6dedb86f4e4ce228d6e36e855f7a22a6a026478290b35b12161d339 })
    // -[Î´]_2 (negated for pairing)
    uint256 internal constant DELTA_X0_PART1 = 0x000000000000000000000000000000000d82e8b936233a9bfaf7587777b2ae7e;
    uint256 internal constant DELTA_X0_PART2 = 0x2daa56831d2105076d0140015a9a299a42656cfa6149dc45246c121a37f05ffe;
    uint256 internal constant DELTA_X1_PART1 = 0x0000000000000000000000000000000004718ed40c6f593d1bdd16b161bd662f;
    uint256 internal constant DELTA_X1_PART2 = 0xe33f1d39c3eab8548a90e0b8d15b2f68fcc73b63694e46f773c101ce369e57f6;
    uint256 internal constant DELTA_Y0_PART1 = 0x000000000000000000000000000000000ced763d46e2c7a1b36e7906825b663f;
    uint256 internal constant DELTA_Y0_PART2 = 0x16b6ee1eb58e77f918d2476a2afe5481b95c9fbfe525a77ece5004631ae82f93;
    uint256 internal constant DELTA_Y1_PART1 = 0x0000000000000000000000000000000004a088624a997f337758547f065202f0;
    uint256 internal constant DELTA_Y1_PART2 = 0x900c0af7e6dedb86f4e4ce228d6e36e855f7a22a6a026478290b35b12161d339;

    //-x: G2serde(Affine { x: 0x05fc26da747c6cfef0305b496594b460e39e12dca4aebacb2d4bb6d2c4b02b2c50fe7ffe6f33940434a15a9425aa82ed0494bd39f21522f3fe14c8f9283e3fa1e05e39e804bb1881ef4529958798c9b68126138e3594797bc2f7042824b7d97e, y: 0x08eaf65586dba5935dc015901bb1886da38a7d861650dd21e1b918c775febd3c131452d73427cfeed0beab1205dec7cb0c009c1a9c287fd758a165c3579c823561d961f744e6c8064b2d1fdd8c209905eda4d5f5179721d57d87dd78f30f07bf })
    // -[x]_2 (negated for pairing)
    uint256 internal constant X_X0_PART1 = 0x0000000000000000000000000000000005fc26da747c6cfef0305b496594b460;
    uint256 internal constant X_X0_PART2 = 0xe39e12dca4aebacb2d4bb6d2c4b02b2c50fe7ffe6f33940434a15a9425aa82ed;
    uint256 internal constant X_X1_PART1 = 0x000000000000000000000000000000000494bd39f21522f3fe14c8f9283e3fa1;
    uint256 internal constant X_X1_PART2 = 0xe05e39e804bb1881ef4529958798c9b68126138e3594797bc2f7042824b7d97e;
    uint256 internal constant X_Y0_PART1 = 0x0000000000000000000000000000000008eaf65586dba5935dc015901bb1886d;
    uint256 internal constant X_Y0_PART2 = 0xa38a7d861650dd21e1b918c775febd3c131452d73427cfeed0beab1205dec7cb;
    uint256 internal constant X_Y1_PART1 = 0x000000000000000000000000000000000c009c1a9c287fd758a165c3579c8235;
    uint256 internal constant X_Y1_PART2 = 0x61d961f744e6c8064b2d1fdd8c209905eda4d5f5179721d57d87dd78f30f07bf;

    //-y: G2serde(Affine { x: 0x0de2cd58780b23995a0e7795b1bde089da3ce45ff2cbce991549908da59ec96266cc2f9654c1b266a658997482afb0e10366edab3105b9b73a7730d96163c2c9e90109fc5ab19667422a2b9487c0be72dd9dd43d36956c324fcdcf53675a9f80, y: 0x141fa81ff24c54735cc358459366792096241a20e596a6e4ed95f8b8b149c7d20aeff35306317d6f8d18caf9953eebba14379f9fd21f1e8b838e6d58334313082e99282b71132b41f1e4c97dcccd725b09968dda8f9e56c24bddd4412e61299e })
    // -[y]_2 (negated for pairing)
    uint256 internal constant Y_X0_PART1 = 0x000000000000000000000000000000000de2cd58780b23995a0e7795b1bde089;
    uint256 internal constant Y_X0_PART2 = 0xda3ce45ff2cbce991549908da59ec96266cc2f9654c1b266a658997482afb0e1;
    uint256 internal constant Y_X1_PART1 = 0x000000000000000000000000000000000366edab3105b9b73a7730d96163c2c9;
    uint256 internal constant Y_X1_PART2 = 0xe90109fc5ab19667422a2b9487c0be72dd9dd43d36956c324fcdcf53675a9f80;
    uint256 internal constant Y_Y0_PART1 = 0x00000000000000000000000000000000141fa81ff24c54735cc3584593667920;
    uint256 internal constant Y_Y0_PART2 = 0x96241a20e596a6e4ed95f8b8b149c7d20aeff35306317d6f8d18caf9953eebba;
    uint256 internal constant Y_Y1_PART1 = 0x0000000000000000000000000000000014379f9fd21f1e8b838e6d5833431308;
    uint256 internal constant Y_Y1_PART2 = 0x2e99282b71132b41f1e4c97dcccd725b09968dda8f9e56c24bddd4412e61299e;

    /// @notice Load verification keys to memory in runtime.
    /// @dev The constants are loaded into memory in a specific layout declared in the constants starting from
    /// `VK_` prefix.
    /// NOTE: Function may corrupt the memory state if some memory was used before this function was called.
    function _loadVerificationKey() internal pure virtual {
        assembly {
            /*
            "lagrange_KL": {
                "x": "0x04f1e1a2ec023aef31bde5b77da1e69ddf5f0bc762904ccee1e8b0131e517246ccf938b28f294dcaca7dbd0c36ff3607",
                "y": "0x13440b9abcae5c5c5749fbc390065d1edea2da1ca7a4f63960dc958c9f32d289c3df14028dc7262642cc1466d6745bef"
            }
            */
            // preproccessed KL commitment vk
            mstore(VK_POLY_KXLX_X_PART1, 0x0000000000000000000000000000000004f1e1a2ec023aef31bde5b77da1e69d)
            mstore(VK_POLY_KXLX_X_PART2, 0xdf5f0bc762904ccee1e8b0131e517246ccf938b28f294dcaca7dbd0c36ff3607)
            mstore(VK_POLY_KXLX_Y_PART1, 0x0000000000000000000000000000000013440b9abcae5c5c5749fbc390065d1e)
            mstore(VK_POLY_KXLX_Y_PART2, 0xdea2da1ca7a4f63960dc958c9f32d289c3df14028dc7262642cc1466d6745bef)

            /*
            "G": {
                "x": "0x0b001b4cc05fa01578be7d4e821d6ff58f2a05c584fba3cb31a37942dece65eadec9a878add2282f7c2513abb8d4ab05",
                "y": "0x15e237775397ed22eef43dd36cdca277c9cf6fa7e4ffff0a5bb4b20a82392caacf0f63fb6cdb02bccf2f5af14970d6b9"
            },
            */
            // [1]_1 (Generator/Identity point)
            mstore(VK_IDENTITY_X_PART1, 0x000000000000000000000000000000000b001b4cc05fa01578be7d4e821d6ff5)
            mstore(VK_IDENTITY_X_PART2, 0x8f2a05c584fba3cb31a37942dece65eadec9a878add2282f7c2513abb8d4ab05)
            mstore(VK_IDENTITY_Y_PART1, 0x0000000000000000000000000000000015e237775397ed22eef43dd36cdca277)
            mstore(VK_IDENTITY_Y_PART2, 0xc9cf6fa7e4ffff0a5bb4b20a82392caacf0f63fb6cdb02bccf2f5af14970d6b9)

            /*
            "x": {
                "x": "0x0d45aca9cf6986877b859616c9613dfe38633f32c81a5a5e426f37beb4f1f9a8db94bcb17673c014031ed6f80406ae12",
                "y": "0x014de0221674a94bd5e60383f1f262d100c79178775b99480ec1a267fb28c905389357c2c111b94becf8676365f64133"
            },
            */
            // [x]_1 (Polynomial evaluation point)
            mstore(VK_POLY_X_X_PART1, 0x000000000000000000000000000000000d45aca9cf6986877b859616c9613dfe)
            mstore(VK_POLY_X_X_PART2, 0x38633f32c81a5a5e426f37beb4f1f9a8db94bcb17673c014031ed6f80406ae12)
            mstore(VK_POLY_X_Y_PART1, 0x00000000000000000000000000000000014de0221674a94bd5e60383f1f262d1)
            mstore(VK_POLY_X_Y_PART2, 0x00c79178775b99480ec1a267fb28c905389357c2c111b94becf8676365f64133)

            /*
            "y": {
                "x": "0x09cf106b4240325df41d6a76331883cbe61a678d7d877bf670446001be74d27580424e05a37af26bb85f99b380758888",
                "y": "0x0889c802a90694c68dfbcf207205778a7493cda2cbb6f9fb0b5ad39dbeef2fac91d847cc01d6040164ef30d840395af0"
            }
            */
            // [y]_1 (Polynomial evaluation point)
            mstore(VK_POLY_Y_X_PART1, 0x0000000000000000000000000000000009cf106b4240325df41d6a76331883cb)
            mstore(VK_POLY_Y_X_PART2, 0xe61a678d7d877bf670446001be74d27580424e05a37af26bb85f99b380758888)
            mstore(VK_POLY_Y_Y_PART1, 0x000000000000000000000000000000000889c802a90694c68dfbcf207205778a)
            mstore(VK_POLY_Y_Y_PART2, 0x7493cda2cbb6f9fb0b5ad39dbeef2fac91d847cc01d6040164ef30d840395af0)
        }
    }

    function verify(
        uint128[] calldata, //_proof part1 (16 bytes)
        uint256[] calldata, // _proof part2 (32 bytes)
        uint128[] calldata, // _preprocessedPart1 (16 bytes)
        uint256[] calldata, // _preprocessedPart2 (32 bytes)
        uint256[] calldata, // publicInputs (used for computing A_pub)
        uint256 // smax
    ) public view virtual returns (bool final_result) {
        // No memory was accessed yet, so keys can be loaded into the right place and not corrupt any other memory.
        _loadVerificationKey();

        // Beginning of the big inline assembly block that makes all the verification work.
        // Note: We use the custom memory layout, so the return value should be returned from the assembly, not
        // Solidity code.
        assembly {
            /*//////////////////////////////////////////////////////////////
                                        Utils
            //////////////////////////////////////////////////////////////*/

            /// @dev Reverts execution with a provided revert reason.
            /// @param len The byte length of the error message string, which is expected to be no more than 32.
            /// @param reason The 1-word revert reason string, encoded in ASCII.
            function revertWithMessage(len, reason) {
                // "Error(string)" signature: bytes32(bytes4(keccak256("Error(string)")))
                mstore(0x00, 0x08c379a000000000000000000000000000000000000000000000000000000000)
                // Data offset
                mstore(0x04, 0x0000000000000000000000000000000000000000000000000000000000000020)
                // Length of revert string
                mstore(0x24, len)
                // Revert reason
                mstore(0x44, reason)
                // Revert
                revert(0x00, 0x64)
            }

            /// @dev Performs modular exponentiation using the formula (value ^ power) mod R_MOD.
            function modexp(value, power) -> res {
                mstore(0x00, 0x20)
                mstore(0x20, 0x20)
                mstore(0x40, 0x20)
                mstore(0x60, value)
                mstore(0x80, power)
                mstore(0xa0, R_MOD)
                if iszero(staticcall(gas(), 5, 0, 0xc0, 0x00, 0x20)) {
                    revertWithMessage(24, "modexp precompile failed")
                }
                res := mload(0x00)
            }

            /// @dev Performs a G1 point multiplication operation and stores the result in a given memory destination.
            function g1pointMulIntoDest(point, s, dest) {
                mstore(0x00, mload(point))
                mstore(0x20, mload(add(point, 0x20)))
                mstore(0x40, mload(add(point, 0x40)))
                mstore(0x60, mload(add(point, 0x60)))
                mstore(0x80, s)
                // BLS12-381 G1MSM at address 0x0c
                if iszero(staticcall(gas(), 0x0c, 0, 0xa0, dest, 0x80)) {
                    revertWithMessage(30, "g1pointMulIntoDest: G1MSM failed")
                }
            }

            /// @dev Performs a G1 point addition operation and stores the result in a given memory destination.
            function g1pointAddIntoDest(p1, p2, dest) {
                mstore(0x00, mload(p1))
                mstore(0x20, mload(add(p1, 0x20)))
                mstore(0x40, mload(add(p1, 0x40)))
                mstore(0x60, mload(add(p1, 0x60)))
                mstore(0x80, mload(p2))
                mstore(0xa0, mload(add(p2, 0x20)))
                mstore(0xc0, mload(add(p2, 0x40)))
                mstore(0xe0, mload(add(p2, 0x60)))
                //  BLS12-381 G1ADDat address 0x0b
                if iszero(staticcall(gas(), 0x0b, 0x00, 0x100, dest, 0x80)) {
                    revertWithMessage(30, "g1pointAddIntoDest: G1ADD failed")
                }
            }

            /// @dev Performs a G1 point multiplication and addition operations and stores the result in a given memory destination.
            function g1pointMulAndAddIntoDest(point, s, dest) {
                mstore(0x00, mload(point))
                mstore(0x20, mload(add(point, 0x20)))
                mstore(0x40, mload(add(point, 0x40)))
                mstore(0x60, mload(add(point, 0x60)))
                mstore(0x80, s)
                let success := staticcall(gas(), 0x0c, 0, 0xa0, 0, 0x80)

                mstore(0x80, mload(dest))
                mstore(0xa0, mload(add(dest, 0x20)))
                mstore(0xc0, mload(add(dest, 0x40)))
                mstore(0xe0, mload(add(dest, 0x60)))
                success := and(success, staticcall(gas(), 0x0b, 0x00, 0x100, dest, 0x80))

                if iszero(success) { revertWithMessage(22, "g1pointMulAndAddIntoDest") }
            }

            /// @dev Performs a point subtraction operation and updates the first point with the result.
            function g1pointSubAssign(p1, p2) {
                // We'll use the fact that for BLS12-381 with 48-byte coordinates,
                // the precompile expects the full 384-bit representation

                // Copy p1 to memory
                mstore(0x00, mload(p1))
                mstore(0x20, mload(add(p1, 0x20)))
                mstore(0x40, mload(add(p1, 0x40)))
                mstore(0x60, mload(add(p1, 0x60)))

                // Copy p2's x-coordinate
                mstore(0x80, mload(p2))
                mstore(0xa0, mload(add(p2, 0x20)))

                // For the y-coordinate, we need to negate it
                // In BLS12-381, -y = q - y where q is the field modulus
                let y_low := mload(add(p2, 0x60))
                let y_high := mload(add(p2, 0x40))

                // Perform q - y
                let neg_y_low, neg_y_high

                // Since we're working with 384-bit numbers split into two 256-bit parts,
                // and the high 128 bits of the high part are always zero for valid field elements
                let borrow := 0

                // Subtract low part
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default { neg_y_low := sub(Q_MOD_PART2, y_low) }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(0xc0, neg_y_high)
                mstore(0xe0, neg_y_low)

                // Perform the addition
                if iszero(staticcall(gas(), 0x0b, 0x00, 0x100, p1, 0x80)) {
                    revertWithMessage(28, "pointSubAssign: G1ADD failed")
                }
            }

            /// @dev Performs a point subtraction operation and updates dest with the result.
            function g1pointSubIntoDest(p1, p2, dest) {
                // We'll use the fact that for BLS12-381 with 48-byte coordinates,
                // the precompile expects the full 384-bit representation

                // Copy p1 to memory
                mstore(0x00, mload(p1))
                mstore(0x20, mload(add(p1, 0x20)))
                mstore(0x40, mload(add(p1, 0x40)))
                mstore(0x60, mload(add(p1, 0x60)))

                // Copy p2's x-coordinate
                mstore(0x80, mload(p2))
                mstore(0xa0, mload(add(p2, 0x20)))

                // For the y-coordinate, we need to negate it
                // In BLS12-381, -y = q - y where q is the field modulus
                let y_low := mload(add(p2, 0x60))
                let y_high := mload(add(p2, 0x40))

                // Perform q - y
                let neg_y_low, neg_y_high

                // Since we're working with 384-bit numbers split into two 256-bit parts,
                // and the high 128 bits of the high part are always zero for valid field elements
                let borrow := 0

                // Subtract low part
                switch lt(Q_MOD_PART2, y_low)
                case 1 {
                    // Need to borrow from high part
                    neg_y_low := sub(Q_MOD_PART2, y_low)
                    neg_y_low := add(neg_y_low, not(0)) // Add 2^256
                    neg_y_low := add(neg_y_low, 1)
                    borrow := 1
                }
                default { neg_y_low := sub(Q_MOD_PART2, y_low) }

                // Subtract high part with borrow
                neg_y_high := sub(sub(Q_MOD_PART1, y_high), borrow)

                mstore(0xc0, neg_y_high)
                mstore(0xe0, neg_y_low)

                // Perform the addition
                if iszero(staticcall(gas(), 0x0b, 0x00, 0x100, dest, 0x80)) {
                    revertWithMessage(28, "pointSubAssign: G1ADD failed")
                }
            }

            /*//////////////////////////////////////////////////////////////
                                        Transcript helpers
                //////////////////////////////////////////////////////////////*/

            /// @dev Updates the transcript state with a new challenge value.
            function updateTranscript(value) {
                mstore8(TRANSCRIPT_DST_BYTE_SLOT, 0x00)
                mstore(TRANSCRIPT_CHALLENGE_SLOT, value)
                let newState0 := keccak256(TRANSCRIPT_BEGIN_SLOT, 0x64)
                mstore8(TRANSCRIPT_DST_BYTE_SLOT, 0x01)
                let newState1 := keccak256(TRANSCRIPT_BEGIN_SLOT, 0x64)
                mstore(TRANSCRIPT_STATE_1_SLOT, newState1)
                mstore(TRANSCRIPT_STATE_0_SLOT, newState0)
            }

            /// @dev Retrieves a transcript challenge.
            function getTranscriptChallenge(numberOfChallenge) -> challenge {
                mstore8(TRANSCRIPT_DST_BYTE_SLOT, 0x02)
                mstore(TRANSCRIPT_CHALLENGE_SLOT, shl(224, numberOfChallenge))
                challenge := and(keccak256(TRANSCRIPT_BEGIN_SLOT, 0x48), FR_MASK)
            }

            /*//////////////////////////////////////////////////////////////
                                        1. Load Proof
                //////////////////////////////////////////////////////////////*/

            function loadProof() {
                let offset := calldataload(0x04)
                let offset2 := calldataload(0x24)
                let offset3 := calldataload(0x44)
                let offset4 := calldataload(0x64)
                let part1LengthInWords := calldataload(add(offset, 0x04))
                let part2LengthInWords := calldataload(add(offset2, 0x04))
                let isValid := and(eq(part1LengthInWords, 38), eq(part2LengthInWords, 42))

                // revert if the length of the proof is not valid
                if iszero(isValid) { revertWithMessage(27, "loadProof: Proof is invalid") }

                // S PERMUTATION POLYNOMIALS
                {
                    let x0 := calldataload(add(offset3, 0x024))
                    let y0 := calldataload(add(offset3, 0x044))
                    let x1 := calldataload(add(offset3, 0x064))
                    let y1 := calldataload(add(offset3, 0x084))
                    mstore(PUBLIC_INPUTS_S_0_X_SLOT_PART1, x0)
                    mstore(PUBLIC_INPUTS_S_0_Y_SLOT_PART1, y0)
                    mstore(PUBLIC_INPUTS_S_1_X_SLOT_PART1, x1)
                    mstore(PUBLIC_INPUTS_S_1_Y_SLOT_PART1, y1)
                    x0 := calldataload(add(offset4, 0x024))
                    y0 := calldataload(add(offset4, 0x044))
                    x1 := calldataload(add(offset4, 0x064))
                    y1 := calldataload(add(offset4, 0x084))
                    mstore(PUBLIC_INPUTS_S_0_X_SLOT_PART2, x0)
                    mstore(PUBLIC_INPUTS_S_0_Y_SLOT_PART2, y0)
                    mstore(PUBLIC_INPUTS_S_1_X_SLOT_PART2, x1)
                    mstore(PUBLIC_INPUTS_S_1_Y_SLOT_PART2, y1)
                }
                // PROOF U, V & W
                {
                    let x0 := calldataload(add(offset, 0x024))
                    let y0 := calldataload(add(offset, 0x044))
                    let x1 := calldataload(add(offset, 0x064))
                    let y1 := calldataload(add(offset, 0x084))
                    let x2 := calldataload(add(offset, 0x0a4))
                    let y2 := calldataload(add(offset, 0x0c4))
                    mstore(PROOF_POLY_U_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_U_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_V_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_V_Y_SLOT_PART1, y1)
                    mstore(PROOF_POLY_W_X_SLOT_PART1, x2)
                    mstore(PROOF_POLY_W_Y_SLOT_PART1, y2)
                    x0 := calldataload(add(offset2, 0x024))
                    y0 := calldataload(add(offset2, 0x044))
                    x1 := calldataload(add(offset2, 0x064))
                    y1 := calldataload(add(offset2, 0x084))
                    x2 := calldataload(add(offset2, 0x0a4))
                    y2 := calldataload(add(offset2, 0x0c4))
                    mstore(PROOF_POLY_U_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_U_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_V_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_V_Y_SLOT_PART2, y1)
                    mstore(PROOF_POLY_W_X_SLOT_PART2, x2)
                    mstore(PROOF_POLY_W_Y_SLOT_PART2, y2)
                }
                // PROOF O_MID & O_PRV
                {
                    let x0 := calldataload(add(offset, 0x0e4))
                    let y0 := calldataload(add(offset, 0x104))
                    let x1 := calldataload(add(offset, 0x124))
                    let y1 := calldataload(add(offset, 0x144))
                    mstore(PROOF_POLY_OMID_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_OMID_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_OPRV_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_OPRV_Y_SLOT_PART1, y1)
                    x0 := calldataload(add(offset2, 0x0e4))
                    y0 := calldataload(add(offset2, 0x104))
                    x1 := calldataload(add(offset2, 0x124))
                    y1 := calldataload(add(offset2, 0x144))
                    mstore(PROOF_POLY_OMID_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_OMID_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_OPRV_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_OPRV_Y_SLOT_PART2, y1)
                }
                // PROOF Q_AX, Q_AY, Q_CX & Q_CY
                {
                    let x0 := calldataload(add(offset, 0x164))
                    let y0 := calldataload(add(offset, 0x184))
                    let x1 := calldataload(add(offset, 0x1a4))
                    let y1 := calldataload(add(offset, 0x1c4))
                    let x2 := calldataload(add(offset, 0x1e4))
                    let y2 := calldataload(add(offset, 0x204))
                    let x3 := calldataload(add(offset, 0x224))
                    let y3 := calldataload(add(offset, 0x244))
                    mstore(PROOF_POLY_QAX_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_QAX_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_QAY_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_QAY_Y_SLOT_PART1, y1)
                    mstore(PROOF_POLY_QCX_X_SLOT_PART1, x2)
                    mstore(PROOF_POLY_QCX_Y_SLOT_PART1, y2)
                    mstore(PROOF_POLY_QCY_X_SLOT_PART1, x3)
                    mstore(PROOF_POLY_QCY_Y_SLOT_PART1, y3)
                    x0 := calldataload(add(offset2, 0x164))
                    y0 := calldataload(add(offset2, 0x184))
                    x1 := calldataload(add(offset2, 0x1a4))
                    y1 := calldataload(add(offset2, 0x1c4))
                    x2 := calldataload(add(offset2, 0x1e4))
                    y2 := calldataload(add(offset2, 0x204))
                    x3 := calldataload(add(offset2, 0x224))
                    y3 := calldataload(add(offset2, 0x244))
                    mstore(PROOF_POLY_QAX_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_QAX_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_QAY_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_QAY_Y_SLOT_PART2, y1)
                    mstore(PROOF_POLY_QCX_X_SLOT_PART2, x2)
                    mstore(PROOF_POLY_QCX_Y_SLOT_PART2, y2)
                    mstore(PROOF_POLY_QCY_X_SLOT_PART2, x3)
                    mstore(PROOF_POLY_QCY_Y_SLOT_PART2, y3)
                }
                // PROOF Î _{Ï‡}, Î _{Î¶}
                {
                    let x0 := calldataload(add(offset, 0x264))
                    let y0 := calldataload(add(offset, 0x284))
                    let x1 := calldataload(add(offset, 0x2a4))
                    let y1 := calldataload(add(offset, 0x2c4))
                    mstore(PROOF_POLY_PI_CHI_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_PI_CHI_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_PI_ZETA_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_PI_ZETA_Y_SLOT_PART1, y1)
                    x0 := calldataload(add(offset2, 0x264))
                    y0 := calldataload(add(offset2, 0x284))
                    x1 := calldataload(add(offset2, 0x2a4))
                    y1 := calldataload(add(offset2, 0x2c4))
                    mstore(PROOF_POLY_PI_CHI_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_PI_CHI_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_PI_ZETA_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_PI_ZETA_Y_SLOT_PART2, y1)
                }
                // PROOF B & R
                {
                    let x0 := calldataload(add(offset, 0x2e4))
                    let y0 := calldataload(add(offset, 0x304))
                    let x1 := calldataload(add(offset, 0x324))
                    let y1 := calldataload(add(offset, 0x344))
                    mstore(PROOF_POLY_B_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_B_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_R_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_R_Y_SLOT_PART1, y1)
                    x0 := calldataload(add(offset2, 0x2e4))
                    y0 := calldataload(add(offset2, 0x304))
                    x1 := calldataload(add(offset2, 0x324))
                    y1 := calldataload(add(offset2, 0x344))
                    mstore(PROOF_POLY_B_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_B_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_R_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_R_Y_SLOT_PART2, y1)
                }
                // PROOF M_Î¶, M_Ï‡, N_Î¶ & N_Ï‡
                {
                    let x0 := calldataload(add(offset, 0x364))
                    let y0 := calldataload(add(offset, 0x384))
                    let x1 := calldataload(add(offset, 0x3a4))
                    let y1 := calldataload(add(offset, 0x3c4))
                    let x2 := calldataload(add(offset, 0x3e4))
                    let y2 := calldataload(add(offset, 0x404))
                    let x3 := calldataload(add(offset, 0x424))
                    let y3 := calldataload(add(offset, 0x444))
                    mstore(PROOF_POLY_M_ZETA_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_M_ZETA_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_M_CHI_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_M_CHI_Y_SLOT_PART1, y1)
                    mstore(PROOF_POLY_N_ZETA_X_SLOT_PART1, x2)
                    mstore(PROOF_POLY_N_ZETA_Y_SLOT_PART1, y2)
                    mstore(PROOF_POLY_N_CHI_X_SLOT_PART1, x3)
                    mstore(PROOF_POLY_N_CHI_Y_SLOT_PART1, y3)
                    x0 := calldataload(add(offset2, 0x364))
                    y0 := calldataload(add(offset2, 0x384))
                    x1 := calldataload(add(offset2, 0x3a4))
                    y1 := calldataload(add(offset2, 0x3c4))
                    x2 := calldataload(add(offset2, 0x3e4))
                    y2 := calldataload(add(offset2, 0x404))
                    x3 := calldataload(add(offset2, 0x424))
                    y3 := calldataload(add(offset2, 0x444))
                    mstore(PROOF_POLY_M_ZETA_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_M_ZETA_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_M_CHI_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_M_CHI_Y_SLOT_PART2, y1)
                    mstore(PROOF_POLY_N_ZETA_X_SLOT_PART2, x2)
                    mstore(PROOF_POLY_N_ZETA_Y_SLOT_PART2, y2)
                    mstore(PROOF_POLY_N_CHI_X_SLOT_PART2, x3)
                    mstore(PROOF_POLY_N_CHI_Y_SLOT_PART2, y3)
                }
                // PROOF O_PUB & A
                {
                    let x0 := calldataload(add(offset, 0x464))
                    let y0 := calldataload(add(offset, 0x484))
                    let x1 := calldataload(add(offset, 0x4a4))
                    let y1 := calldataload(add(offset, 0x4c4))
                    mstore(PROOF_POLY_OPUB_X_SLOT_PART1, x0)
                    mstore(PROOF_POLY_OPUB_Y_SLOT_PART1, y0)
                    mstore(PROOF_POLY_A_X_SLOT_PART1, x1)
                    mstore(PROOF_POLY_A_Y_SLOT_PART1, y1)
                    x0 := calldataload(add(offset2, 0x464))
                    y0 := calldataload(add(offset2, 0x484))
                    x1 := calldataload(add(offset2, 0x4a4))
                    y1 := calldataload(add(offset2, 0x4c4))
                    mstore(PROOF_POLY_OPUB_X_SLOT_PART2, x0)
                    mstore(PROOF_POLY_OPUB_Y_SLOT_PART2, y0)
                    mstore(PROOF_POLY_A_X_SLOT_PART2, x1)
                    mstore(PROOF_POLY_A_Y_SLOT_PART2, y1)
                }

                mstore(PROOF_R1XY_SLOT, mod(calldataload(add(offset2, 0x4e4)), R_MOD))
                mstore(PROOF_R2XY_SLOT, mod(calldataload(add(offset2, 0x504)), R_MOD))
                mstore(PROOF_R3XY_SLOT, mod(calldataload(add(offset2, 0x524)), R_MOD))
                mstore(PROOF_VXY_SLOT, mod(calldataload(add(offset2, 0x544)), R_MOD))

                // load smax
                let smax := calldataload(0xa4)
                let isValidSmax
                {
                    isValidSmax :=
                        or(
                            or(or(eq(smax, 64), eq(smax, 128)), or(eq(smax, 256), eq(smax, 512))),
                            or(eq(smax, 1024), eq(smax, 2048))
                        )
                    mstore(PARAM_SMAX, smax)
                }

                // Revert if smax is not valid
                if iszero(isValidSmax) { revertWithMessage(27, "loadProof: smax is invalid") }
            }

            /*//////////////////////////////////////////////////////////////
                                    2. Transcript initialization
                //////////////////////////////////////////////////////////////*/

            /// @notice Recomputes all challenges
            /// @dev The process is the following:
            /// Commit:   [U], [V], [W], [Q_AX], [Q_AY], [B]
            /// Get:      Î¸_0, Î¸_1, Î¸_2
            /// Commit:   [R]
            /// Get:      Îº0
            /// Commit:   [Q_CX], [Q_CY]
            /// Get:      Ï‡, Î¶
            /// Commit    V_xy, R1, R2, R3
            /// Get:      Îº1, Îº2

            function initializeTranscript() {
                // Round 1
                updateTranscript(mload(PROOF_POLY_U_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_U_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_U_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_U_Y_SLOT_PART2))

                updateTranscript(mload(PROOF_POLY_V_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_V_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_V_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_V_Y_SLOT_PART2))

                updateTranscript(mload(PROOF_POLY_W_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_W_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_W_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_W_Y_SLOT_PART2))

                updateTranscript(mload(PROOF_POLY_QAX_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QAX_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_QAX_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QAX_Y_SLOT_PART2))

                updateTranscript(mload(PROOF_POLY_QAY_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QAY_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_QAY_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QAY_Y_SLOT_PART2))

                updateTranscript(mload(PROOF_POLY_B_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_B_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_B_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_B_Y_SLOT_PART2))

                // compute thetas
                mstore(CHALLENGE_THETA_0_SLOT, getTranscriptChallenge(0))
                mstore(CHALLENGE_THETA_1_SLOT, getTranscriptChallenge(1))
                mstore(CHALLENGE_THETA_2_SLOT, getTranscriptChallenge(2))

                // Round 2
                updateTranscript(mload(PROOF_POLY_R_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_R_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_R_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_R_Y_SLOT_PART2))

                // compute Îº0
                mstore(CHALLENGE_KAPPA_0_SLOT, getTranscriptChallenge(3))

                // Round 3
                updateTranscript(mload(PROOF_POLY_QCX_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QCX_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_QCX_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QCX_Y_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_QCY_X_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QCY_X_SLOT_PART2))
                updateTranscript(mload(PROOF_POLY_QCY_Y_SLOT_PART1))
                updateTranscript(mload(PROOF_POLY_QCY_Y_SLOT_PART2))

                // compute Ï‡
                mstore(CHALLENGE_CHI_SLOT, getTranscriptChallenge(4))
                // compute Î¶
                mstore(CHALLENGE_ZETA_SLOT, getTranscriptChallenge(5))

                // Round 4
                updateTranscript(mload(PROOF_VXY_SLOT))
                updateTranscript(mload(PROOF_R1XY_SLOT))
                updateTranscript(mload(PROOF_R2XY_SLOT))
                updateTranscript(mload(PROOF_R3XY_SLOT))

                // compute Îº1
                mstore(CHALLENGE_KAPPA_1_SLOT, getTranscriptChallenge(6))
                // compute Îº2
                mstore(CHALLENGE_KAPPA_2_SLOT, getTranscriptChallenge(7))
            }

            /*//////////////////////////////////////////////////////////////
                                        3. Prepare Queries
                //////////////////////////////////////////////////////////////*/

            /// @dev Here we compute some queries for the final pairing
            /// We use the formulas:
            /// [F]_1:=[B]_1+Î¸_0[s^{(0)}(x,y)]_1+Î¸_1[s^{(1)}(x,y)]_1+Î¸_2[1]_1
            ///
            /// [G]_1:= [B]_1+Î¸_0[s^{(2)}(x,y)]_1+Î¸_1[y]_1+Î¸_2[1]_1
            ///
            /// t_n(Ï‡):=Ï‡^{n}-1
            ///
            /// t_{smax}(Î¶) := Î¶^{smax}-1
            ///
            /// t_{m_I}(Ï‡) := Ï‡^{m_I}-1

            function prepareQueries() {
                // calculate [F]_1
                {
                    let theta0 := mload(CHALLENGE_THETA_0_SLOT)
                    let theta1 := mload(CHALLENGE_THETA_1_SLOT)
                    let theta2 := mload(CHALLENGE_THETA_2_SLOT)

                    mstore(INTERMERDIARY_POLY_F_X_SLOT_PART1, mload(PROOF_POLY_B_X_SLOT_PART1))
                    mstore(INTERMERDIARY_POLY_F_X_SLOT_PART2, mload(PROOF_POLY_B_X_SLOT_PART2))
                    mstore(INTERMERDIARY_POLY_F_Y_SLOT_PART1, mload(PROOF_POLY_B_Y_SLOT_PART1))
                    mstore(INTERMERDIARY_POLY_F_Y_SLOT_PART2, mload(PROOF_POLY_B_Y_SLOT_PART2))

                    g1pointMulAndAddIntoDest(PUBLIC_INPUTS_S_0_X_SLOT_PART1, theta0, INTERMERDIARY_POLY_F_X_SLOT_PART1)
                    g1pointMulAndAddIntoDest(PUBLIC_INPUTS_S_1_X_SLOT_PART1, theta1, INTERMERDIARY_POLY_F_X_SLOT_PART1)
                    g1pointMulAndAddIntoDest(VK_IDENTITY_X_PART1, theta2, INTERMERDIARY_POLY_F_X_SLOT_PART1)
                }
                // calculate [G]_1
                {
                    let theta0 := mload(CHALLENGE_THETA_0_SLOT)
                    let theta1 := mload(CHALLENGE_THETA_1_SLOT)
                    let theta2 := mload(CHALLENGE_THETA_2_SLOT)

                    mstore(INTERMERDIARY_POLY_G_X_SLOT_PART1, mload(PROOF_POLY_B_X_SLOT_PART1))
                    mstore(INTERMERDIARY_POLY_G_X_SLOT_PART2, mload(PROOF_POLY_B_X_SLOT_PART2))
                    mstore(INTERMERDIARY_POLY_G_Y_SLOT_PART1, mload(PROOF_POLY_B_Y_SLOT_PART1))
                    mstore(INTERMERDIARY_POLY_G_Y_SLOT_PART2, mload(PROOF_POLY_B_Y_SLOT_PART2))

                    g1pointMulAndAddIntoDest(VK_POLY_X_X_PART1, theta0, INTERMERDIARY_POLY_G_X_SLOT_PART1)
                    g1pointMulAndAddIntoDest(VK_POLY_Y_X_PART1, theta1, INTERMERDIARY_POLY_G_X_SLOT_PART1)
                    g1pointMulAndAddIntoDest(VK_IDENTITY_X_PART1, theta2, INTERMERDIARY_POLY_G_X_SLOT_PART1)
                }
                // calculate t_n(Ï‡)
                {
                    let chi := mload(CHALLENGE_CHI_SLOT)
                    let t := sub(modexp(chi, CONSTANT_N), 1)
                    mstore(INTERMERDIARY_SCALAR_T_N_CHI_SLOT, t)
                }

                // calculate t_smax(Î¶)
                {
                    let zeta := mload(CHALLENGE_ZETA_SLOT)
                    let t := sub(modexp(zeta, mload(PARAM_SMAX)), 1)
                    mstore(INTERMERDIARY_SCALAR_T_SMAX_ZETA_SLOT, t)
                }

                // calculate t_mI(Ï‡)
                {
                    let chi := mload(CHALLENGE_CHI_SLOT)
                    let t := sub(modexp(chi, CONSTANT_MI), 1)
                    mstore(INTERMERDIARY_SCALAR_T_MI_CHI_SLOT, t)
                }
            }

            // lagrange_K0_eval computation
            function computeLagrangeK0Eval() {
                let chi := mload(CHALLENGE_CHI_SLOT)
                let m_i := CONSTANT_MI // 256

                // For k0_evals = [1, 0, 0, ..., 0], the polynomial evaluation becomes:
                // lagrange_K0_eval = L_0(chi) where L_0 is the 0th Lagrange basis polynomial
                // L_0(chi) = âˆ_{k=1}^{m_i-1} (chi - Ï‰^k) / (1 - Ï‰^k)
                // This is mathematically equivalent to: (chi^m_i - 1) / (m_i * (chi - 1))

                // Safety check: Ï‡ cannot be 1
                if eq(chi, 1) { revert(0, 0) }

                // Compute Ï‡^m_i mod R_MOD
                let chi_mi := modexp(chi, m_i)

                // Compute numerator (Ï‡^m_i - 1) mod R_MOD
                let numerator := addmod(chi_mi, sub(R_MOD, 1), R_MOD)

                // Compute denominator m_i*(Ï‡-1) mod R_MOD
                let chi_1 := addmod(chi, sub(R_MOD, 1), R_MOD)
                let denominator := mulmod(m_i, chi_1, R_MOD)

                // Check denominator is not zero
                if iszero(denominator) { revert(0, 0) }

                // Compute modular inverse using Fermat's little theorem
                let inv_denominator := modexp(denominator, sub(R_MOD, 2))

                // Final result: numerator * inv_denominator mod R_MOD
                let r := mulmod(numerator, inv_denominator, R_MOD)

                mstore(INTERMEDIARY_SCALAR_KO_SLOT, r)
            }

            // A_pub = A(chi)
            // A(chi) = sum_0^{l-1}(a_j * M_j(chi))
            function computeAPUB() {
                let chi := mload(CHALLENGE_CHI_SLOT)
                let offset := calldataload(0x84)

                let n := 512
                let omega := OMEGA_512
                let numPublicInputs := 512

                // Compute chi^512 - 1
                let chi_n := modexp(chi, n)
                let chi_n_1 := addmod(chi_n, sub(R_MOD, 1), R_MOD)

                // Check if chi is a 512th root of unity
                if iszero(chi_n_1) {
                    // Special case: find and return the corresponding value
                    let omega_power := 1
                    for { let i := 0 } lt(i, numPublicInputs) { i := add(i, 1) } {
                        if eq(chi, omega_power) {
                            let val := calldataload(add(add(offset, 0x24), mul(i, 0x20)))
                            mstore(INTERMEDIARY_SCALAR_APUB_SLOT, val)
                            leave
                        }
                        omega_power := mulmod(omega_power, omega, R_MOD)
                    }
                }

                // Normal case: compute weighted sum
                let weightedSum := 0
                let inv_n := modexp(n, sub(R_MOD, 2))

                // First pass: count non-zero values and store their indices
                let nonZeroCount := 0
                let tempOffset := 0x2000 // Temporary storage location

                for { let i := 0 } lt(i, numPublicInputs) { i := add(i, 1) } {
                    let val := calldataload(add(add(offset, 0x24), mul(i, 0x20)))
                    if val {
                        // Store index and value
                        mstore(add(tempOffset, mul(nonZeroCount, 0x40)), i)
                        mstore(add(tempOffset, add(mul(nonZeroCount, 0x40), 0x20)), val)
                        nonZeroCount := add(nonZeroCount, 1)
                    }
                }

                // Second pass: process only non-zero values
                for { let j := 0 } lt(j, nonZeroCount) { j := add(j, 1) } {
                    let i := mload(add(tempOffset, mul(j, 0x40)))
                    let val := mload(add(tempOffset, add(mul(j, 0x40), 0x20)))

                    // Compute omega^i using efficient method based on i
                    let omega_i := 1

                    // For small i, use repeated multiplication
                    if lt(i, 16) {
                        for { let k := 0 } lt(k, i) { k := add(k, 1) } { omega_i := mulmod(omega_i, omega, R_MOD) }
                    }
                    // For larger i, use modexp
                    if iszero(lt(i, 16)) { omega_i := modexp(omega, i) }

                    // Compute contribution
                    let denominator := addmod(chi, sub(R_MOD, omega_i), R_MOD)

                    if iszero(denominator) {
                        mstore(INTERMEDIARY_SCALAR_APUB_SLOT, val)
                        leave
                    }

                    // Compute full denominator: (chi - Ï‰^j) * n
                    let denominator_full := mulmod(denominator, n, R_MOD)
                    let inv_denominator_full := modexp(denominator_full, sub(R_MOD, 2))

                    // Compute numerator: a_j * Ï‰^j * (chi^n - 1)
                    let numerator := mulmod(val, omega_i, R_MOD)
                    numerator := mulmod(numerator, chi_n_1, R_MOD)

                    let contribution := mulmod(numerator, inv_denominator_full, R_MOD)
                    weightedSum := addmod(weightedSum, contribution, R_MOD)
                }

                // Result is the weighted sum (no additional factors needed)
                let result := weightedSum

                mstore(INTERMEDIARY_SCALAR_APUB_SLOT, result)
            }

            /*//////////////////////////////////////////////////////////////
                                        4. Compute LHS and AUX
                //////////////////////////////////////////////////////////////*/

            /// @dev Here we compute [LHS]_1 + [AUX]_1 aggregated commitment for the final pairing
            /// We use the formulas:
            /// [LHS]_1 := [LHS_B]_1 + Îº2([LHS_A]_1 + [LHS_C]_1)
            ///
            /// where
            ///
            /// [LHS_A]_1 := V_{x,y}[U]_1 - [W]_1 + Îº1([V]_1 - V_{x,y}[G]_1) - t_n(Ï‡)[Q_{A,X}]_1 - t_{s_{max}}(Î¶)[Q_{A,Y}]_1
            ///
            ///
            /// and where
            ///
            /// [LHS_C]_1 := Îº1^2(R_{x,y} - 1) * [K_{-1}(X)L_{-1}(X)]_1 + a[G]_1
            ///              - b[F]_1 - Îº1^2 * t_{m_l}(Ï‡) * [Q_{C,X}]_1 - Îº1^2 * t_{s_{max}}(Î¶) * [Q_{C,Y}]_1) + c[R]_1 + d[1 ]_1
            ///
            ///         with a := Îº1^2Îº0R_{x,y}((Ï‡-1)  + Îº0K_0(Ï‡))
            ///              b := Îº1^2Îº0((Ï‡-1) Râ€™_{x,y} + Îº0K_0(Ï‡)Râ€™â€™_{x,y})
            ///              c := Îº1^3 + Îº2 + Îº2^2
            ///              d := -Îº1^3R_{x,y} - Îº2Râ€™_{x,y} - Îº2^2Râ€™â€™_{x,y} - Îº1V_{x,y} - Îº1^4A_{pub}
            ///
            ///  and where
            ///
            ///  [LHS_B]_1 := (1+Îº2Îº1^4)[A]_1
            ///
            ///  and
            ///
            ///  [AUX]_1 := Îº2 * Ï‡ * [Î _{Ï‡}]_1 + Îº2 * Î¶ *[Î _Î¶]_1 +
            ///             Îº2^2 * Ï‰_{m_i}^{-1} * Ï‡ *[M_{Ï‡}]_1 + Îº2^2 * Î¶ * [M_{Î¶}]_1 + Îº2^3 * Ï‰_{m_i}^{-1} * Ï‡ * [N_{Ï‡}]_1 + Îº_2^3 Ï‰_smax^{-1} * Î¶ * [N_{Î¶}]
            ///

            /// @dev calculate [LHS_A]_1 = V_{x,y}[U]_1 - [W]_1 + Îº1[V]_1 - t_n(Ï‡)[Q_{A,X}]_1 - t_{s_{max}}(Î¶)[Q_{A,Y}]_1
            function prepareLHSA() {
                g1pointMulIntoDest(PROOF_POLY_U_X_SLOT_PART1, mload(PROOF_VXY_SLOT), AGG_LHS_A_X_SLOT_PART1)
                g1pointSubAssign(AGG_LHS_A_X_SLOT_PART1, PROOF_POLY_W_X_SLOT_PART1)

                //Îº1[V]_1
                g1pointMulIntoDest(
                    PROOF_POLY_V_X_SLOT_PART1, mload(CHALLENGE_KAPPA_1_SLOT), BUFFER_AGGREGATED_POLY_X_SLOT_PART1
                )

                // (V_{x,y}[U]_1 - [W]_1) + Îº1[V]_1
                g1pointAddIntoDest(AGG_LHS_A_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1, AGG_LHS_A_X_SLOT_PART1)

                // t_n(Ï‡)[Q_{A,X}]_1
                g1pointMulIntoDest(
                    PROOF_POLY_QAX_X_SLOT_PART1,
                    mload(INTERMERDIARY_SCALAR_T_N_CHI_SLOT),
                    BUFFER_AGGREGATED_POLY_X_SLOT_PART1
                )

                // (V_{x,y}[U]_1 - [W]_1) + (Îº1 * ([V]_1 - V_{x,y}[1]_1)) - t_n(Ï‡)[Q_{A,X}]_1
                g1pointSubAssign(AGG_LHS_A_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)

                // t_{s_{max}}(Î¶)[Q_{A,Y}]_1
                g1pointMulIntoDest(
                    PROOF_POLY_QAY_X_SLOT_PART1,
                    mload(INTERMERDIARY_SCALAR_T_SMAX_ZETA_SLOT),
                    BUFFER_AGGREGATED_POLY_X_SLOT_PART1
                )
                // V_{x,y}[U]_1 - [W]_1 + Îº1 * ([V]_1 - V_{x,y}[1]_1) - t_n(Ï‡)[Q_{A,X}]_1 - t_{s_{max}}(Î¶)[Q_{A,Y}]_1
                g1pointSubAssign(AGG_LHS_A_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)
            }

            /// @dev [LHS_B]_1 := (1+Îº2Îº1^4)[A]_1
            function prepareLHSB() {
                let kappa2 := mload(CHALLENGE_KAPPA_2_SLOT)
                let kappa1 := mload(CHALLENGE_KAPPA_1_SLOT)
                let A_pub := mload(INTERMEDIARY_SCALAR_APUB_SLOT)

                // 1+Îº2Îº1^4
                let coeff1 := addmod(1, mulmod(kappa2, modexp(kappa1, 4), R_MOD), R_MOD)

                // (1+Îº2Îº1^4)[A]_1
                g1pointMulIntoDest(PROOF_POLY_A_X_SLOT_PART1, coeff1, AGG_LHS_B_X_SLOT_PART1)
            }

            ///  @dev [LHS_C]_1 := Îº1^2(R_{x,y} - 1) * [K_{-1}(X)L_{-1}(X)]_1 + a[G]_1
            ///                    - b[F]_1 - Îº1^2 * t_{m_i}(Ï‡) * [Q_{C,X}]_1 - Îº1^2 * t_{s_{max}}(Î¶) * [Q_{C,Y}]_1) + c[R]_1 + d[1]_1
            function prepareLHSC() {
                let kappa0 := mload(CHALLENGE_KAPPA_0_SLOT)
                let kappa1 := mload(CHALLENGE_KAPPA_1_SLOT)
                let kappa1_pow2 := mulmod(kappa1, kappa1, R_MOD)
                let kappa1_pow3 := mulmod(kappa1, kappa1_pow2, R_MOD)
                let kappa2 := mload(CHALLENGE_KAPPA_2_SLOT)
                let kappa2_pow2 := mulmod(kappa2, kappa2, R_MOD)
                let chi := mload(CHALLENGE_CHI_SLOT)
                let chi_minus_1 := addmod(chi, sub(R_MOD, 1), R_MOD)
                let r1 := mload(PROOF_R1XY_SLOT)
                let r2 := mload(PROOF_R2XY_SLOT)
                let r3 := mload(PROOF_R3XY_SLOT)
                let k0 := mload(INTERMEDIARY_SCALAR_KO_SLOT)
                let V_xy := mload(PROOF_VXY_SLOT)
                let A_pub := mload(INTERMEDIARY_SCALAR_APUB_SLOT)
                let t_ml := mload(INTERMERDIARY_SCALAR_T_MI_CHI_SLOT)
                let t_smax := mload(INTERMERDIARY_SCALAR_T_SMAX_ZETA_SLOT)

                // a := Îº1^2 * Îº0 * R_{x,y} * ((Ï‡-1) + Îº0 * K_0(Ï‡))
                let a :=
                    mulmod(
                        mulmod(mulmod(mulmod(kappa1, kappa1, R_MOD), kappa0, R_MOD), r1, R_MOD),
                        addmod(chi_minus_1, mulmod(kappa0, k0, R_MOD), R_MOD),
                        R_MOD
                    )
                // b := Îº1^2 * Îº0 * ((Ï‡-1) Râ€™_{x,y} + Îº0K_0(Ï‡)Râ€™â€™_{x,y})
                let b :=
                    mulmod(
                        mulmod(kappa1_pow2, kappa0, R_MOD),
                        addmod(mulmod(chi_minus_1, r2, R_MOD), mulmod(mulmod(kappa0, k0, R_MOD), r3, R_MOD), R_MOD),
                        R_MOD
                    )
                // c := Îº1^3 + Îº2 + Îº2^2
                let c := addmod(kappa1_pow3, addmod(kappa2, kappa2_pow2, R_MOD), R_MOD)
                //    d := -Îº1^3R_{x,y} - Îº2Râ€™_{x,y} - Îº2^2Râ€™â€™_{x,y} - Îº1V_{x,y} - Îº1^4A_{pub}
                // => d := - (Îº1^3R_{x,y} + Îº2Râ€™_{x,y} + Îº2^2Râ€™â€™_{x,y} + Îº1V_{x,y} + Îº1^4A_{pub})
                let d :=
                    sub(
                        R_MOD,
                        addmod(
                            addmod(
                                addmod(mulmod(kappa1_pow3, r1, R_MOD), mulmod(kappa2, r2, R_MOD), R_MOD),
                                mulmod(kappa2_pow2, r3, R_MOD),
                                R_MOD
                            ),
                            addmod(
                                mulmod(kappa1, V_xy, R_MOD), mulmod(mulmod(kappa1, kappa1_pow3, R_MOD), A_pub, R_MOD), R_MOD
                            ),
                            R_MOD
                        )
                    )
                // Îº1^2(R_x,y - 1)
                let kappa1_r_minus_1 := mulmod(mulmod(kappa1, kappa1, R_MOD), sub(r1, 1), R_MOD)
                // Îº1^2 * t_{m_l}(Ï‡)
                let kappa1_tml := mulmod(kappa1_pow2, t_ml, R_MOD)
                // Îº1^2 * t_{s_{max}}(Î¶)
                let kappa1_tsmax := mulmod(kappa1_pow2, t_smax, R_MOD)

                g1pointMulIntoDest(VK_POLY_KXLX_X_PART1, kappa1_r_minus_1, AGG_LHS_C_X_SLOT_PART1)
                g1pointMulAndAddIntoDest(INTERMERDIARY_POLY_G_X_SLOT_PART1, a, AGG_LHS_C_X_SLOT_PART1)

                g1pointMulIntoDest(INTERMERDIARY_POLY_F_X_SLOT_PART1, b, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)
                g1pointSubAssign(AGG_LHS_C_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)

                g1pointMulIntoDest(PROOF_POLY_QCX_X_SLOT_PART1, kappa1_tml, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)
                g1pointSubAssign(AGG_LHS_C_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)

                g1pointMulIntoDest(PROOF_POLY_QCY_X_SLOT_PART1, kappa1_tsmax, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)
                g1pointSubAssign(AGG_LHS_C_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)

                g1pointMulAndAddIntoDest(PROOF_POLY_R_X_SLOT_PART1, c, AGG_LHS_C_X_SLOT_PART1)
                g1pointMulAndAddIntoDest(VK_IDENTITY_X_PART1, d, AGG_LHS_C_X_SLOT_PART1)
            }

            /// @dev [RHS_1]_1 := Îº2[Î _{Ï‡}]_1 + Îº2^2[M_{Ï‡}]_1 + Îº2^3[N_{Ï‡}]_1
            function prepareRHS1() {
                let kappa2 := mload(CHALLENGE_KAPPA_2_SLOT)
                let kappa2_pow2 := mulmod(kappa2, kappa2, R_MOD)
                let kappa2_pow3 := mulmod(kappa2_pow2, kappa2, R_MOD)

                g1pointMulIntoDest(PROOF_POLY_PI_CHI_X_SLOT_PART1, kappa2, PAIRING_AGG_RHS_1_X_SLOT_PART1)
                g1pointMulAndAddIntoDest(PROOF_POLY_M_CHI_X_SLOT_PART1, kappa2_pow2, PAIRING_AGG_RHS_1_X_SLOT_PART1)
                g1pointMulAndAddIntoDest(PROOF_POLY_N_CHI_X_SLOT_PART1, kappa2_pow3, PAIRING_AGG_RHS_1_X_SLOT_PART1)
            }

            /// @dev [RHS_2]_1 := Îº2[Î _{Î¶}]_1 + Îº2^2[M_{Î¶}]_1 + Îº2^3[N_{Î¶}]_1
            function prepareRHS2() {
                let kappa2 := mload(CHALLENGE_KAPPA_2_SLOT)
                let kappa2_pow2 := mulmod(kappa2, kappa2, R_MOD)
                let kappa2_pow3 := mulmod(kappa2_pow2, kappa2, R_MOD)

                g1pointMulIntoDest(PROOF_POLY_PI_ZETA_X_SLOT_PART1, kappa2, PAIRING_AGG_RHS_2_X_SLOT_PART1)
                g1pointMulAndAddIntoDest(PROOF_POLY_M_ZETA_X_SLOT_PART1, kappa2_pow2, PAIRING_AGG_RHS_2_X_SLOT_PART1)
                g1pointMulAndAddIntoDest(PROOF_POLY_N_ZETA_X_SLOT_PART1, kappa2_pow3, PAIRING_AGG_RHS_2_X_SLOT_PART1)
            }

            // @dev Function to get the correct omega_smax^{-1} value based on smax parameter
            function getOmegaSmaxInverse(smax) -> omega_smax_inv {
                switch smax
                case 64 { omega_smax_inv := OMEGA_SMAX_64_MINUS_1 }
                case 128 { omega_smax_inv := OMEGA_SMAX_128_MINUS_1 }
                case 256 { omega_smax_inv := OMEGA_SMAX_256_MINUS_1 }
                case 512 { omega_smax_inv := OMEGA_SMAX_512_MINUS_1 }
                case 1024 { omega_smax_inv := OMEGA_SMAX_1024_MINUS_1 }
                case 2048 { omega_smax_inv := OMEGA_SMAX_2048_MINUS_1 }
                default {
                    // This should never happen if loadProof validation is correct
                    revertWithMessage(25, "Invalid smax for omega")
                }
            }

            /// @dev [LHS]_1 := [LHS_B]_1 + Îº2([LHS_A]_1 + [LHS_C]_1)
            /// @dev [AUX]_1 := Îº2 * Ï‡ * [Î _{Ï‡}]_1 + Îº2 * Î¶ *[Î _Î¶]_1 +
            ///                 Îº2^2 * Ï‰_{m_l}^{-1} * Ï‡ *[M_{Ï‡}]_1 + Îº2^2 * Î¶ * [M_Î¶]_1 + Îº2^3 * Ï‰_{m_l}^{-1} * Ï‡ * [N_{Ï‡}]_1 + Îº_2^3 * Ï‰_smax^{-1} * Î¶ * [N_{Î¶}]
            function prepareAggregatedCommitment() {
                // calculate [LHS]_1 = [LHS_B]_1 + Îº2([LHS_A]_1 + [LHS_C]_1)
                {
                    let kappa2 := mload(CHALLENGE_KAPPA_2_SLOT)

                    // First add [LHS_A]_1 + [LHS_C]_1
                    g1pointAddIntoDest(
                        AGG_LHS_A_X_SLOT_PART1, AGG_LHS_C_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1
                    )

                    // Multiply by Îº2: Îº2([LHS_A]_1 + [LHS_C]_1)
                    g1pointMulIntoDest(BUFFER_AGGREGATED_POLY_X_SLOT_PART1, kappa2, BUFFER_AGGREGATED_POLY_X_SLOT_PART1)

                    // Add [LHS_B]_1: [LHS_B]_1 + Îº2([LHS_A]_1 + [LHS_C]_1)
                    g1pointAddIntoDest(
                        AGG_LHS_B_X_SLOT_PART1, BUFFER_AGGREGATED_POLY_X_SLOT_PART1, PAIRING_AGG_LHS_X_SLOT_PART1
                    )
                }

                // calculate [AUX]_1
                {
                    let kappa2 := mload(CHALLENGE_KAPPA_2_SLOT)
                    let chi := mload(CHALLENGE_CHI_SLOT)
                    let zeta := mload(CHALLENGE_ZETA_SLOT)
                    let omega_ml := OMEGA_MI_1
                    let omega_smax := getOmegaSmaxInverse(mload(PARAM_SMAX))

                    let kappa2_chi := mulmod(kappa2, chi, R_MOD)
                    let kappa2_zeta := mulmod(kappa2, zeta, R_MOD)
                    let kappa2_pow2_omega_ml_chi :=
                        mulmod(mulmod(mulmod(kappa2, kappa2, R_MOD), omega_ml, R_MOD), chi, R_MOD)
                    let kappa2_pow2_zeta := mulmod(mulmod(kappa2, kappa2, R_MOD), zeta, R_MOD)
                    let kappa2_pow3_omega_ml_chi :=
                        mulmod(mulmod(mulmod(mulmod(kappa2, kappa2, R_MOD), kappa2, R_MOD), omega_ml, R_MOD), chi, R_MOD)
                    let kappa2_pow3_omega_smax_zeta :=
                        mulmod(mulmod(mulmod(mulmod(kappa2, kappa2, R_MOD), kappa2, R_MOD), omega_smax, R_MOD), zeta, R_MOD)
                    // [AUX]_1 accumulation
                    // Îº2 * Ï‡ * [Î _{Ï‡}]_1
                    g1pointMulIntoDest(PROOF_POLY_PI_CHI_X_SLOT_PART1, kappa2_chi, PAIRING_AGG_AUX_X_SLOT_PART1)
                    // += Îº2 * Î¶ *[Î _Î¶]_1
                    g1pointMulAndAddIntoDest(PROOF_POLY_PI_ZETA_X_SLOT_PART1, kappa2_zeta, PAIRING_AGG_AUX_X_SLOT_PART1)
                    // += Îº2^2 * Ï‰_{m_l}^{-1} * Ï‡ *[M_{Ï‡}]_1
                    g1pointMulAndAddIntoDest(
                        PROOF_POLY_M_CHI_X_SLOT_PART1, kappa2_pow2_omega_ml_chi, PAIRING_AGG_AUX_X_SLOT_PART1
                    )
                    // += Îº2^2 * Î¶ * [M_Î¶]_1
                    g1pointMulAndAddIntoDest(
                        PROOF_POLY_M_ZETA_X_SLOT_PART1, kappa2_pow2_zeta, PAIRING_AGG_AUX_X_SLOT_PART1
                    )
                    // Îº2^3 * Ï‰_{m_l}^{-1} * Ï‡ * [N_{Ï‡}]_1
                    g1pointMulAndAddIntoDest(
                        PROOF_POLY_N_CHI_X_SLOT_PART1, kappa2_pow3_omega_ml_chi, PAIRING_AGG_AUX_X_SLOT_PART1
                    )
                    // Îº2^3 * Ï‰_smax^{-1} * Î¶ * [N_{Î¶}]
                    g1pointMulAndAddIntoDest(
                        PROOF_POLY_N_ZETA_X_SLOT_PART1, kappa2_pow3_omega_smax_zeta, PAIRING_AGG_AUX_X_SLOT_PART1
                    )
                }

                // calculate [LHS]_1 + [AUX]_1
                {
                    g1pointAddIntoDest(
                        PAIRING_AGG_LHS_X_SLOT_PART1, PAIRING_AGG_AUX_X_SLOT_PART1, PAIRING_AGG_LHS_AUX_X_SLOT_PART1
                    )
                }
            }

            /*////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
                                                                            5. Pairing
                ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////*/

            /// @notice Checks the final pairing
            /// @dev We should check the equation:
            ///
            ///    /                                                  \           /                                                          \
            ///   | e([LHS]_1 + [AUX]_1, [1]_2)e([B]_1, [Î±^4]_2)       |         |  e([O_pub], [Î³]_2])e([O_mid]_1, [Î·]_2)e([O_prv]_1, [Î´]_2)  |
            ///   | e([U]_1, [Î±]_2)e([V]_1, [Î±^2]_2)e([W]_1, [Î±^3]_2)  |    =    |  . e(Îº2[Î _{Ï‡}]_1 + Îº2^2[M_{Ï‡}]_1 + Îº2^3[N_{Ï‡}]_1, [x]_2)   |
            ///    \                                                  /          |  . e(Îº2[Î _{Î¶}]_1 + Îº2^2[M_{Î¶}]_1 + Îº2^3[N_{Î¶}]_1, [y]_2)   |
            ///                                                                   \                                                          /
            // e(P1, P2) = e(G1, G2)
            // e(P1, P2)*e(G1, -G2) = 1

            function finalPairing() {
                // load [LHS]_1 + [AUX]_1
                mstore(0x000, mload(PAIRING_AGG_LHS_AUX_X_SLOT_PART1))
                mstore(0x020, mload(PAIRING_AGG_LHS_AUX_X_SLOT_PART2))
                mstore(0x040, mload(PAIRING_AGG_LHS_AUX_Y_SLOT_PART1))
                mstore(0x060, mload(PAIRING_AGG_LHS_AUX_Y_SLOT_PART2))

                // load [1]_2
                mstore(0x080, IDENTITY2_X1_PART1)
                mstore(0x0a0, IDENTITY2_X1_PART2)
                mstore(0x0c0, IDENTITY2_X0_PART1)
                mstore(0x0e0, IDENTITY2_X0_PART2)
                mstore(0x100, IDENTITY2_Y1_PART1)
                mstore(0x120, IDENTITY2_Y1_PART2)
                mstore(0x140, IDENTITY2_Y0_PART1)
                mstore(0x160, IDENTITY2_Y0_PART2)

                // load [B]_1
                mstore(0x180, mload(PROOF_POLY_B_X_SLOT_PART1))
                mstore(0x1a0, mload(PROOF_POLY_B_X_SLOT_PART2))
                mstore(0x1c0, mload(PROOF_POLY_B_Y_SLOT_PART1))
                mstore(0x1e0, mload(PROOF_POLY_B_Y_SLOT_PART2))

                // load [Î±^4]_2
                mstore(0x200, ALPHA_POWER4_X1_PART1)
                mstore(0x220, ALPHA_POWER4_X1_PART2)
                mstore(0x240, ALPHA_POWER4_X0_PART1)
                mstore(0x260, ALPHA_POWER4_X0_PART2)
                mstore(0x280, ALPHA_POWER4_Y1_PART1)
                mstore(0x2a0, ALPHA_POWER4_Y1_PART2)
                mstore(0x2c0, ALPHA_POWER4_Y0_PART1)
                mstore(0x2e0, ALPHA_POWER4_Y0_PART2)

                // load [U]_1
                mstore(0x300, mload(PROOF_POLY_U_X_SLOT_PART1))
                mstore(0x320, mload(PROOF_POLY_U_X_SLOT_PART2))
                mstore(0x340, mload(PROOF_POLY_U_Y_SLOT_PART1))
                mstore(0x360, mload(PROOF_POLY_U_Y_SLOT_PART2))

                // load [Î±]_2
                mstore(0x380, ALPHA_X1_PART1)
                mstore(0x3a0, ALPHA_X1_PART2)
                mstore(0x3c0, ALPHA_X0_PART1)
                mstore(0x3e0, ALPHA_X0_PART2)
                mstore(0x400, ALPHA_Y1_PART1)
                mstore(0x420, ALPHA_Y1_PART2)
                mstore(0x440, ALPHA_Y0_PART1)
                mstore(0x460, ALPHA_Y0_PART2)

                // load [V]_1
                mstore(0x480, mload(PROOF_POLY_V_X_SLOT_PART1))
                mstore(0x4a0, mload(PROOF_POLY_V_X_SLOT_PART2))
                mstore(0x4c0, mload(PROOF_POLY_V_Y_SLOT_PART1))
                mstore(0x4e0, mload(PROOF_POLY_V_Y_SLOT_PART2))

                // load [Î±^2]_2
                mstore(0x500, ALPHA_POWER2_X1_PART1)
                mstore(0x520, ALPHA_POWER2_X1_PART2)
                mstore(0x540, ALPHA_POWER2_X0_PART1)
                mstore(0x560, ALPHA_POWER2_X0_PART2)
                mstore(0x580, ALPHA_POWER2_Y1_PART1)
                mstore(0x5a0, ALPHA_POWER2_Y1_PART2)
                mstore(0x5c0, ALPHA_POWER2_Y0_PART1)
                mstore(0x5e0, ALPHA_POWER2_Y0_PART2)

                // load [W]_1
                mstore(0x600, mload(PROOF_POLY_W_X_SLOT_PART1))
                mstore(0x620, mload(PROOF_POLY_W_X_SLOT_PART2))
                mstore(0x640, mload(PROOF_POLY_W_Y_SLOT_PART1))
                mstore(0x660, mload(PROOF_POLY_W_Y_SLOT_PART2))

                // load [Î±^3]_2
                mstore(0x680, ALPHA_POWER3_X1_PART1)
                mstore(0x6a0, ALPHA_POWER3_X1_PART2)
                mstore(0x6c0, ALPHA_POWER3_X0_PART1)
                mstore(0x6e0, ALPHA_POWER3_X0_PART2)
                mstore(0x700, ALPHA_POWER3_Y1_PART1)
                mstore(0x720, ALPHA_POWER3_Y1_PART2)
                mstore(0x740, ALPHA_POWER3_Y0_PART1)
                mstore(0x760, ALPHA_POWER3_Y0_PART2)

                // load [O_pub]_1
                mstore(0x780, mload(PROOF_POLY_OPUB_X_SLOT_PART1))
                mstore(0x7a0, mload(PROOF_POLY_OPUB_X_SLOT_PART2))
                mstore(0x7c0, mload(PROOF_POLY_OPUB_Y_SLOT_PART1))
                mstore(0x7e0, mload(PROOF_POLY_OPUB_Y_SLOT_PART2))

                // load -[Î³]_2
                mstore(0x800, GAMMA_X1_PART1)
                mstore(0x820, GAMMA_X1_PART2)
                mstore(0x840, GAMMA_X0_PART1)
                mstore(0x860, GAMMA_X0_PART2)
                mstore(0x880, GAMMA_Y1_PART1)
                mstore(0x8a0, GAMMA_Y1_PART2)
                mstore(0x8c0, GAMMA_Y0_PART1)
                mstore(0x8e0, GAMMA_Y0_PART2)

                // load [O_mid]_1
                mstore(0x900, mload(PROOF_POLY_OMID_X_SLOT_PART1))
                mstore(0x920, mload(PROOF_POLY_OMID_X_SLOT_PART2))
                mstore(0x940, mload(PROOF_POLY_OMID_Y_SLOT_PART1))
                mstore(0x960, mload(PROOF_POLY_OMID_Y_SLOT_PART2))

                // load -[Î·]_2
                mstore(0x980, ETA_X1_PART1)
                mstore(0x9a0, ETA_X1_PART2)
                mstore(0x9c0, ETA_X0_PART1)
                mstore(0x9e0, ETA_X0_PART2)
                mstore(0xa00, ETA_Y1_PART1)
                mstore(0xa20, ETA_Y1_PART2)
                mstore(0xa40, ETA_Y0_PART1)
                mstore(0xa60, ETA_Y0_PART2)

                // load [O_prv]_1
                mstore(0xa80, mload(PROOF_POLY_OPRV_X_SLOT_PART1))
                mstore(0xaa0, mload(PROOF_POLY_OPRV_X_SLOT_PART2))
                mstore(0xac0, mload(PROOF_POLY_OPRV_Y_SLOT_PART1))
                mstore(0xae0, mload(PROOF_POLY_OPRV_Y_SLOT_PART2))

                // load -[Î´]_2
                mstore(0xb00, DELTA_X1_PART1)
                mstore(0xb20, DELTA_X1_PART2)
                mstore(0xb40, DELTA_X0_PART1)
                mstore(0xb60, DELTA_X0_PART2)
                mstore(0xb80, DELTA_Y1_PART1)
                mstore(0xba0, DELTA_Y1_PART2)
                mstore(0xbc0, DELTA_Y0_PART1)
                mstore(0xbe0, DELTA_Y0_PART2)

                // load [RHS_1]_1 := Îº2[Î _{Ï‡}]_1 + Îº2^2[M_{Ï‡}]_1 + Îº2^3[N_{Ï‡}]_1
                mstore(0xc00, mload(PAIRING_AGG_RHS_1_X_SLOT_PART1))
                mstore(0xc20, mload(PAIRING_AGG_RHS_1_X_SLOT_PART2))
                mstore(0xc40, mload(PAIRING_AGG_RHS_1_Y_SLOT_PART1))
                mstore(0xc60, mload(PAIRING_AGG_RHS_1_Y_SLOT_PART2))

                // load -[x]_2
                mstore(0xc80, X_X1_PART1)
                mstore(0xca0, X_X1_PART2)
                mstore(0xcc0, X_X0_PART1)
                mstore(0xce0, X_X0_PART2)
                mstore(0xd00, X_Y1_PART1)
                mstore(0xd20, X_Y1_PART2)
                mstore(0xd40, X_Y0_PART1)
                mstore(0xd60, X_Y0_PART2)

                // load [RHS_2]_2 := Îº2[Î _{Î¶}]_1 + Îº2^2[M_{Î¶}]_1 + Îº2^3[N_{Î¶}]_1
                mstore(0xd80, mload(PAIRING_AGG_RHS_2_X_SLOT_PART1))
                mstore(0xda0, mload(PAIRING_AGG_RHS_2_X_SLOT_PART2))
                mstore(0xdc0, mload(PAIRING_AGG_RHS_2_Y_SLOT_PART1))
                mstore(0xde0, mload(PAIRING_AGG_RHS_2_Y_SLOT_PART2))

                // load -[y]_2
                mstore(0xe00, Y_X1_PART1)
                mstore(0xe20, Y_X1_PART2)
                mstore(0xe40, Y_X0_PART1)
                mstore(0xe60, Y_X0_PART2)
                mstore(0xe80, Y_Y1_PART1)
                mstore(0xea0, Y_Y1_PART2)
                mstore(0xec0, Y_Y0_PART1)
                mstore(0xee0, Y_Y0_PART2)

                // precompile call
                let success := staticcall(gas(), 0x0f, 0, 0xf00, 0x00, 0x20)
                if iszero(success) { revertWithMessage(32, "finalPairing: precompile failure") }
                if iszero(mload(0)) { revertWithMessage(29, "finalPairing: pairing failure") }
            }

            // Step1: Load the PI/proof
            loadProof()

            // Step2: Recompute all the challenges with the transcript
            initializeTranscript()

            // Step3: computation of [F]_1, [G]_1, t_n(Ï‡), t_smax(Î¶) and t_ml(Ï‡), K0(Ï‡) and A_pub
            prepareQueries()
            computeLagrangeK0Eval()
            computeAPUB()

            // Step4: computation of the final polynomial commitments - COMMENTED OUT FOR DEBUGGING
            prepareLHSA()
            prepareLHSB()
            prepareLHSC()
            prepareRHS1()
            prepareRHS2()
            prepareAggregatedCommitment()

            // Step5: final pairing - COMMENTED OUT FOR DEBUGGING
            finalPairing()
            final_result := true

            // DEBUG: Return A_pub instead of final result
            mstore(0x00, final_result)
            return(0x00, 0x20)
        }
    }
}



================================================
FILE: test/bridge/Bridge.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeWithdrawManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/ITokamakVerifier.sol";
import "../../src/interface/IZecFrost.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import "../../src/interface/IGroth16Verifier32Leaves.sol";
import "../../src/interface/IGroth16Verifier64Leaves.sol";
import "../../src/interface/IGroth16Verifier128Leaves.sol";
import {ZecFrost} from "../../src/library/ZecFrost.sol";

// Mock Contracts
contract MockZecFrost is IZecFrost {
    address public mockSigner;

    // Mapping of signature vectors to their recovered addresses
    mapping(bytes32 => address) private signatureVectorToSigner;

    constructor() {
        mockSigner = address(this);

        // Vector 1 signature (valid) - recovers to user1 (0xd96b35D012879d89cfBA6fE215F1015863a6f6d0)
        bytes32 vector1Key = keccak256(
            abi.encodePacked(
                uint256(0x1fb4c0436e9054ae0b237cde3d7a478ce82405b43fdbb5bf1d63c9f8d912dd5d),
                uint256(0x3a7784df441925a8859b9f3baf8d570d488493506437db3ccf230a4b43b27c1e),
                uint256(0xc7fdcb364dd8577e47dd479185ca659adbfcd1b8675e5cbb36e5f93ca4e15b25)
            )
        );
        signatureVectorToSigner[vector1Key] = 0xd96b35D012879d89cfBA6fE215F1015863a6f6d0;

        // Vector 2 signature (invalid) - recovers to user2 (0x012C2171f631e27C4bA9f7f8262af2a48956939A)
        bytes32 vector2Key = keccak256(
            abi.encodePacked(
                uint256(0xc303bb5de5a5962d9af9b45f5e0bdc919de2aac9153b8c353960f50aa3cb950c),
                uint256(0x6df25261f523a8ea346f49dad49b3b36786e653a129cff327a0fea5839e712a2),
                uint256(0x27c26d628367261edb63b64eefc48a192a8130e9cd608b75820775684af010b0)
            )
        );
        signatureVectorToSigner[vector2Key] = 0x012C2171f631e27C4bA9f7f8262af2a48956939A;
    }

    function verify(bytes32, uint256, uint256, uint256 rx, uint256 ry, uint256 z)
        external
        view
        override
        returns (address)
    {
        // Check if this is one of our known signature vectors
        bytes32 vectorKey = keccak256(abi.encodePacked(rx, ry, z));
        address vectorSigner = signatureVectorToSigner[vectorKey];

        if (vectorSigner != address(0)) {
            return vectorSigner;
        }

        // Fall back to mock signer for unknown vectors
        return mockSigner;
    }

    function setMockSigner(address _signer) external {
        mockSigner = _signer;
    }
}

import {TokamakVerifier} from "../../src/verifier/TokamakVerifier.sol";
import {Groth16Verifier16Leaves} from "../../src/verifier/Groth16Verifier16Leaves.sol";
import {Groth16Verifier32Leaves} from "../../src/verifier/Groth16Verifier32Leaves.sol";
import {Groth16Verifier64Leaves} from "../../src/verifier/Groth16Verifier64Leaves.sol";
import {Groth16Verifier128Leaves} from "../../src/verifier/Groth16Verifier128Leaves.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/library/RLP.sol";
import "@openzeppelin/token/ERC20/ERC20.sol";

// Mock Contracts
contract MockTokamakVerifier is ITokamakVerifier {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verify(
        uint128[] calldata,
        uint256[] calldata,
        uint128[] calldata,
        uint256[] calldata,
        uint256[] calldata,
        uint256
    ) external view override returns (bool) {
        return shouldVerify;
    }
}

contract MockGroth16Verifier is IGroth16Verifier16Leaves {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[33] calldata)
        external
        view
        override
        returns (bool)
    {
        return shouldVerify;
    }
}

contract MockGroth16Verifier32 is IGroth16Verifier32Leaves {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[65] calldata)
        external
        view
        override
        returns (bool)
    {
        return shouldVerify;
    }
}

contract MockGroth16Verifier64 is IGroth16Verifier64Leaves {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[129] calldata)
        external
        view
        override
        returns (bool)
    {
        return shouldVerify;
    }
}

contract MockGroth16Verifier128 is IGroth16Verifier128Leaves {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[257] calldata)
        external
        view
        override
        returns (bool)
    {
        return shouldVerify;
    }
}

contract MockERC20 is ERC20 {
    constructor() ERC20("Mock Token", "MOCK") {
        _mint(msg.sender, 1000000 * 10 ** 18);
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}

// High precision token (27 decimals)
contract HighPrecisionToken is ERC20 {
    constructor() ERC20("High Precision Token", "HPT") {}

    function decimals() public pure override returns (uint8) {
        return 27;
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}

// USDT-like token (6 decimals)
contract USDTLikeToken is ERC20 {
    constructor() ERC20("USDT Like Token", "USDT") {}

    function decimals() public pure override returns (uint8) {
        return 6;
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}

contract BridgeCoreTest is Test {
    using RLP for bytes;

    BridgeCore public bridge;
    BridgeProofManager public proofManager;
    BridgeDepositManager public depositManager;
    BridgeWithdrawManager public withdrawManager;
    BridgeAdminManager public adminManager;
    MockTokamakVerifier public tokamakVerifier;
    MockZecFrost public mockZecFrost;
    MockGroth16Verifier public groth16Verifier16;
    MockGroth16Verifier32 public groth16Verifier32;
    MockGroth16Verifier64 public groth16Verifier64;
    MockGroth16Verifier128 public groth16Verifier128;
    MockERC20 public token;
    HighPrecisionToken public highPrecisionToken;
    USDTLikeToken public usdtLikeToken;

    address public owner = address(1);
    address public leader = address(2);
    address public leader2 = address(22);
    address public user1 = 0xd96b35D012879d89cfBA6fE215F1015863a6f6d0; // Address that ZecFrost signature 1 recovers to
    address public user2 = address(3);
    address public user3 = address(4);

    address public l2Leader = address(12);
    address public l2User1 = address(13);
    address public l2User2 = address(14);
    address public l2User3 = address(15);

    uint256 public constant INITIAL_BALANCE = 1000 ether;
    uint256 public constant INITIAL_TOKEN_BALANCE = 1000 * 10 ** 18;

    event ChannelOpened(bytes32 indexed channelId, address indexed targetContract);
    event ChannelFinalized(bytes32 indexed channelId);
    event Deposited(bytes32 indexed channelId, address indexed user, address token, uint256 amount);
    event Withdrawn(bytes32 indexed channelId, address indexed user, address token, uint256 amount);
    event EmergencyWithdrawn(bytes32 indexed channelId, address indexed user, address token, uint256 amount);
    event StateInitialized(bytes32 indexed channelId, bytes32 currentStateRoot);
    event TokamakZkSnarkProofsVerified(bytes32 indexed channelId, address indexed signer);

    function setUp() public {
        // Deploy contracts
        vm.startPrank(owner);

        tokamakVerifier = new MockTokamakVerifier();
        mockZecFrost = new MockZecFrost();
        groth16Verifier16 = new MockGroth16Verifier();
        groth16Verifier32 = new MockGroth16Verifier32();
        groth16Verifier64 = new MockGroth16Verifier64();
        groth16Verifier128 = new MockGroth16Verifier128();
        token = new MockERC20();
        highPrecisionToken = new HighPrecisionToken();
        usdtLikeToken = new USDTLikeToken();

        // Deploy manager implementations
        BridgeDepositManager depositManagerImpl = new BridgeDepositManager();
        BridgeWithdrawManager withdrawManagerImpl = new BridgeWithdrawManager();
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();
        BridgeProofManager proofManagerImpl = new BridgeProofManager();

        // Deploy core contract with proxy first
        BridgeCore implementation = new BridgeCore();
        bytes memory bridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(0), address(0), address(0), address(0), owner) // Temporary addresses
        );
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(implementation), bridgeInitData);
        bridge = BridgeCore(address(bridgeProxy));

        // Deploy manager proxies with bridge address
        bytes memory depositInitData = abi.encodeCall(BridgeDepositManager.initialize, (address(bridge), owner));
        ERC1967Proxy depositProxy = new ERC1967Proxy(address(depositManagerImpl), depositInitData);
        depositManager = BridgeDepositManager(address(depositProxy));

        bytes memory withdrawInitData = abi.encodeCall(BridgeWithdrawManager.initialize, (address(bridge), owner));
        ERC1967Proxy withdrawProxy = new ERC1967Proxy(address(withdrawManagerImpl), withdrawInitData);
        withdrawManager = BridgeWithdrawManager(payable(address(withdrawProxy)));

        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        address[4] memory groth16Verifiers = [
            address(groth16Verifier16),
            address(groth16Verifier32),
            address(groth16Verifier64),
            address(groth16Verifier128)
        ];
        bytes memory proofInitData = abi.encodeCall(
            BridgeProofManager.initialize,
            (address(bridge), address(tokamakVerifier), address(mockZecFrost), groth16Verifiers, owner)
        );
        ERC1967Proxy proofProxy = new ERC1967Proxy(address(proofManagerImpl), proofInitData);
        proofManager = BridgeProofManager(address(proofProxy));

        // Update bridge with manager addresses
        bridge.updateManagerAddresses(
            address(depositManager), address(proofManager), address(withdrawManager), address(adminManager)
        );

        // Configure mock ZecFrost - we'll set the actual expected signer later in tests

        // Fund test accounts
        vm.deal(leader, INITIAL_BALANCE);
        vm.deal(leader2, INITIAL_BALANCE);
        vm.deal(user1, INITIAL_BALANCE);
        vm.deal(user2, INITIAL_BALANCE);
        vm.deal(user3, INITIAL_BALANCE);

        token.mint(leader, INITIAL_TOKEN_BALANCE);
        token.mint(leader2, INITIAL_TOKEN_BALANCE);
        token.mint(user1, INITIAL_TOKEN_BALANCE);
        token.mint(user2, INITIAL_TOKEN_BALANCE);
        token.mint(user3, INITIAL_TOKEN_BALANCE);

        // Mint high precision tokens (2 tokens = 2 * 10^27)
        uint256 highPrecisionAmount = 2 * 10 ** 27;
        highPrecisionToken.mint(user1, highPrecisionAmount);
        highPrecisionToken.mint(user2, highPrecisionAmount);
        highPrecisionToken.mint(user3, highPrecisionAmount);

        // Mint USDT-like tokens (1 token = 1 * 10^6)
        uint256 usdtAmount = 1 * 10 ** 6;
        usdtLikeToken.mint(user1, usdtAmount);
        usdtLikeToken.mint(user2, usdtAmount);
        usdtLikeToken.mint(user3, usdtAmount);

        // Use the correct preprocessed data from ProofSubmission.t.sol
        uint128[] memory preprocessedPart1 = new uint128[](4);
        preprocessedPart1[0] = 0x1136c7a73653af0cbdc9fda441a80391;
        preprocessedPart1[1] = 0x007c86367643476dcdb0e9bcf1617f1c;
        preprocessedPart1[2] = 0x18c9e2822155742dd5fbd050aa293be5;
        preprocessedPart1[3] = 0x00b248168d62853defda478a7a46e0a0;
        uint256[] memory preprocessedPart2 = new uint256[](4);
        preprocessedPart2[0] = 0xc4383bb8c86977fc45c94bc42353e37b39907e30b52054990083a85cf5256c22;
        preprocessedPart2[1] = 0x8fc97f11906d661f0b434c3c49d0ec8b3cac2928f6ff6fac5815686d175d2e87;
        preprocessedPart2[2] = 0xf84798df0fcfbd79e070d2303170d78e438e4b32975a4ebf6e1ff32863f2cc3e;
        preprocessedPart2[3] = 0xc6b05d5e144de6e3b25f09093b9ba94c194452d8decf3af3390cfa46df134c0e;

        // Use the actual registered function instance hash from the deployed contract
        bytes32 functionInstanceHash = 0xd157cb883adb9cb0e27d9dc419e2a4be817d856281b994583b5bae64be94d35a;

        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(token), emptySlots, balanceSlot, true);
        adminManager.setAllowedTargetContract(address(highPrecisionToken), emptySlots, balanceSlot, true);
        adminManager.setAllowedTargetContract(address(usdtLikeToken), emptySlots, balanceSlot, true);

        // Register transfer function for each token using 4-byte selector (standard format)
        bytes32 transferSig = bytes32(bytes4(keccak256("transfer(address,uint256)")));
        adminManager.registerFunction(
            address(token), transferSig, preprocessedPart1, preprocessedPart2, functionInstanceHash
        );
        adminManager.registerFunction(
            address(highPrecisionToken), transferSig, preprocessedPart1, preprocessedPart2, functionInstanceHash
        );
        adminManager.registerFunction(
            address(usdtLikeToken), transferSig, preprocessedPart1, preprocessedPart2, functionInstanceHash
        );

        vm.stopPrank();
    }

    // ========== Helper Functions for ZecFrost Signatures ==========

    /**
     * @dev Creates a ZecFrost signature that verifies against user1 (0xd96b35D012879d89cfBA6fE215F1015863a6f6d0)
     */
    // Using BridgeProofManager.Signature directly

    struct TestChannelInitializationProof {
        uint256[4] pA;
        uint256[8] pB;
        uint256[4] pC;
        bytes32 merkleRoot;
    }

    // Using BridgeProofManager.ProofData and IBridgeCore.RegisteredFunction directly

    function _createZecFrostSignature() internal pure returns (BridgeProofManager.Signature memory) {
        return _createZecFrostSignatureForChannel(bytes32(uint256(1))); // Default test channel ID
    }

    function _createZecFrostSignatureForChannel(bytes32 channelId)
        internal
        pure
        returns (BridgeProofManager.Signature memory)
    {
        // Create commitment hash for the given channel and standard finalStateRoot
        bytes32 finalStateRoot = bytes32(uint256(keccak256("finalStateRoot")));
        bytes32 commitmentHash = keccak256(abi.encodePacked(channelId, finalStateRoot));

        // Return Vector 1 signature data - recovers to 0xd96b35D012879d89cfBA6fE215F1015863a6f6d0 (user1)
        return BridgeProofManager.Signature({
            message: commitmentHash,
            rx: 0x1fb4c0436e9054ae0b237cde3d7a478ce82405b43fdbb5bf1d63c9f8d912dd5d,
            ry: 0x3a7784df441925a8859b9f3baf8d570d488493506437db3ccf230a4b43b27c1e,
            z: 0xc7fdcb364dd8577e47dd479185ca659adbfcd1b8675e5cbb36e5f93ca4e15b25
        });
    }

    function _createZecFrostSignatureForProofData(bytes32 channelId, uint256[] memory publicInputs)
        internal
        pure
        returns (BridgeProofManager.Signature memory)
    {
        // Extract finalStateRoot from proof data (indices 1 and 0)
        bytes32 finalStateRoot = bytes32((publicInputs[1] << 128) | publicInputs[0]);
        bytes32 commitmentHash = keccak256(abi.encodePacked(channelId, finalStateRoot));

        // Return Vector 1 signature data - recovers to 0xd96b35D012879d89cfBA6fE215F1015863a6f6d0 (user1)
        return BridgeProofManager.Signature({
            message: commitmentHash,
            rx: 0x1fb4c0436e9054ae0b237cde3d7a478ce82405b43fdbb5bf1d63c9f8d912dd5d,
            ry: 0x3a7784df441925a8859b9f3baf8d570d488493506437db3ccf230a4b43b27c1e,
            z: 0xc7fdcb364dd8577e47dd479185ca659adbfcd1b8675e5cbb36e5f93ca4e15b25
        });
    }

    /**
     * @dev Creates a ZecFrost signature that verifies against user2 (0x012C2171f631e27C4bA9f7f8262af2a48956939A)
     */
    function _createWrongZecFrostSignature() internal pure returns (BridgeProofManager.Signature memory) {
        return _createWrongZecFrostSignatureForChannel(bytes32(uint256(1))); // Default test channel ID
    }

    function _createWrongZecFrostSignatureForChannel(bytes32 channelId)
        internal
        pure
        returns (BridgeProofManager.Signature memory)
    {
        // Create commitment hash for the given channel and finalStateRoot
        bytes32 finalStateRoot = bytes32(uint256(keccak256("finalStateRoot")));
        bytes32 commitmentHash = keccak256(abi.encodePacked(channelId, finalStateRoot));

        // Return Vector 2 signature data - recovers to 0x012C2171f631e27C4bA9f7f8262af2a48956939A (user2)
        return BridgeProofManager.Signature({
            message: commitmentHash,
            rx: 0xc303bb5de5a5962d9af9b45f5e0bdc919de2aac9153b8c353960f50aa3cb950c,
            ry: 0x6df25261f523a8ea346f49dad49b3b36786e653a129cff327a0fea5839e712a2,
            z: 0x27c26d628367261edb63b64eefc48a192a8130e9cd608b75820775684af010b0
        });
    }

    // ========== Helper Functions for Channel Creation ==========

    function _createChannelParams() internal view returns (BridgeCore.ChannelParams memory) {
        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        return BridgeCore.ChannelParams({
            channelId: keccak256(abi.encode(address(this), uint256(1))),
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
    }

    function _createGroth16Proof(bytes32 merkleRoot) internal pure returns (TestChannelInitializationProof memory) {
        // Mock Groth16 proof data
        uint256[4] memory pA = [uint256(1), uint256(2), uint256(3), uint256(4)];
        uint256[8] memory pB =
            [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)];
        uint256[4] memory pC = [uint256(13), uint256(14), uint256(15), uint256(16)];

        return TestChannelInitializationProof({pA: pA, pB: pB, pC: pC, merkleRoot: merkleRoot});
    }

    // ========== Helper Functions for MPT Leaves ==========

    /**
     * @dev Creates a mock MPT leaf with RLP-encoded account data: [nonce, balance, storageHash, codeHash]
     */
    function _createMockMPTLeaf(uint256 balance) internal pure returns (bytes memory) {
        bytes[] memory accountFields = new bytes[](4);

        // nonce = 0
        accountFields[0] = RLP.encode(abi.encodePacked(uint256(0)));

        // balance
        accountFields[1] = RLP.encode(abi.encodePacked(balance));

        // storageHash (empty storage)
        accountFields[2] = RLP.encode(abi.encodePacked(keccak256("")));

        // codeHash (empty code)
        accountFields[3] = RLP.encode(abi.encodePacked(keccak256("")));

        return RLP.encodeList(accountFields);
    }

    /**
     * @dev Creates MPT leaves for a given set of balances
     */
    function _createMPTLeaves(uint256[] memory balances) internal pure returns (bytes[] memory) {
        bytes[] memory leaves = new bytes[](balances.length);
        for (uint256 i = 0; i < balances.length; i++) {
            leaves[i] = _createMockMPTLeaf(balances[i]);
        }
        return leaves;
    }

    /**
     * @dev Creates ProofData struct for testing
     */
    function _createProofData(
        uint128[] memory proofPart1,
        uint256[] memory proofPart2,
        uint256[] memory publicInputs,
        uint256 smax,
        uint256[] memory finalBalances
    ) internal pure returns (BridgeProofManager.ProofData memory, uint256[] memory) {
        BridgeProofManager.ProofData memory proofData = BridgeProofManager.ProofData({
            proofPart1: proofPart1,
            proofPart2: proofPart2,
            publicInputs: publicInputs,
            smax: smax
        });
        return (proofData, finalBalances);
    }

    /**
     * @dev Creates mock participant roots for testing
     */
    function _createMockParticipantRoots(uint256 count) internal pure returns (bytes32[] memory) {
        bytes32[] memory participantRoots = new bytes32[](count);
        for (uint256 i = 0; i < count; i++) {
            // Generate deterministic mock roots based on participant index
            participantRoots[i] = keccak256(abi.encodePacked("participant_root", i));
        }
        return participantRoots;
    }

    /**
     * @dev Creates ProofData struct for testing with mock participantRoots (for backwards compatibility)
     * This version handles the old signature for existing tests
     */
    function _createProofDataSimple(
        uint128[] memory proofPart1,
        uint256[] memory proofPart2,
        uint256[] memory publicInputs,
        uint256 smax,
        bytes[] memory, /* initialMPTLeaves */
        bytes[] memory finalMPTLeaves
    ) internal view returns (BridgeProofManager.ProofData memory, uint256[] memory) {
        // Set proper state root values for bridge tests to pass state root chain validation
        _setTestStateRoots(publicInputs, bytes32(uint256(0))); // Assume channel 0 for now
        return _createProofDataFromMPT(proofPart1, proofPart2, publicInputs, smax, finalMPTLeaves);
    }

    function _createProofDataSimpleForChannel(
        bytes32 channelId,
        uint128[] memory proofPart1,
        uint256[] memory proofPart2,
        uint256[] memory publicInputs,
        uint256 smax,
        bytes[] memory, /* initialMPTLeaves */
        bytes[] memory finalMPTLeaves
    ) internal view returns (BridgeProofManager.ProofData memory, uint256[] memory) {
        // Set proper state root values for bridge tests to pass state root chain validation
        _setTestStateRoots(publicInputs, channelId);
        return _createProofDataFromMPT(proofPart1, proofPart2, publicInputs, smax, finalMPTLeaves);
    }

    function _setTestStateRoots(uint256[] memory publicInputs, bytes32 channelId) internal view {
        if (publicInputs.length >= 12) {
            // Use the actual initial state root from the specified channel
            bytes32 actualInitialRoot = bridge.getChannelInitialStateRoot(channelId);
            uint256 inputRootHigh = uint256(actualInitialRoot) >> 128;
            uint256 inputRootLow = uint256(actualInitialRoot) & 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

            // Use the finalStateRoot (which is set in publicInputs[0]) for output
            // Note: publicInputs[0] is currently set to the full keccak256("finalStateRoot") hash
            bytes32 finalStateRoot = bytes32(publicInputs[0]);
            uint256 outputRootHigh = uint256(finalStateRoot) >> 128;
            uint256 outputRootLow = uint256(finalStateRoot) & 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

            publicInputs[8] = inputRootLow; // input state root low
            publicInputs[9] = inputRootHigh; // input state root high
            publicInputs[0] = outputRootLow; // output state root low
            publicInputs[1] = outputRootHigh; // output state root high
        }

        // Set function signature at index 14 (transfer function selector: 0xa9059cbb)
        if (publicInputs.length >= 17) {
            publicInputs[14] = 0xa9059cbb; // transfer(address,uint256) function selector
        }
        // Set function instance data (indices 66-511) to match computeCorrectFunctionInstanceHash
        _setFunctionInstanceData(publicInputs);
    }

    // Overloaded version for pure functions that can't access bridge state
    function _setTestStateRoots(uint256[] memory publicInputs) internal pure {
        if (publicInputs.length >= 12) {
            // Use the hardcoded mock root for pure functions
            bytes32 mockRoot = keccak256(abi.encodePacked("mockRoot"));
            uint256 inputRootHigh = uint256(mockRoot) >> 128;
            uint256 inputRootLow = uint256(mockRoot) & 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

            // Use the finalStateRoot (which is set in publicInputs[0]) for output
            bytes32 finalStateRoot = bytes32(publicInputs[0]);
            uint256 outputRootHigh = uint256(finalStateRoot) >> 128;
            uint256 outputRootLow = uint256(finalStateRoot) & 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF;

            publicInputs[8] = inputRootLow; // input state root low
            publicInputs[9] = inputRootHigh; // input state root high
            publicInputs[0] = outputRootLow; // output state root low
            publicInputs[1] = outputRootHigh; // output state root high
        }

        // Set function signature at index 14 (transfer function selector: 0xa9059cbb)
        if (publicInputs.length >= 17) {
            publicInputs[14] = 0xa9059cbb; // transfer(address,uint256) function selector
        }
        // Set function instance data (indices 66-511) to match computeCorrectFunctionInstanceHash
        _setFunctionInstanceData(publicInputs);
    }

    function _setFunctionInstanceData(uint256[] memory publicInputs) internal pure {
        if (publicInputs.length < 512) return; // Need at least 512 elements for function instance data

        // Call the helper that creates the same function instances array
        uint256[] memory functionInstances = _getCorrectFunctionInstanceData();

        // Set the function instance data in publicInputs starting at index 64
        for (uint256 i = 0; i < 446 && (64 + i) < publicInputs.length; i++) {
            publicInputs[64 + i] = functionInstances[i];
        }
    }

    function _getCorrectFunctionInstanceData() internal pure returns (uint256[] memory) {
        // Exact copy of the function instance data from computeCorrectFunctionInstanceHash
        uint256[] memory functionInstances = new uint256[](446);

        // All 181 assignments copied from computeCorrectFunctionInstanceHash
        functionInstances[0] = 0x01;
        functionInstances[1] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[2] = 0xffffffff;
        functionInstances[3] = 0xe72f6afd7d1f72623e6b071492d1122b;
        functionInstances[4] = 0x11dafe5d23e1218086a365b99fbf3d3b;
        functionInstances[5] = 0x3e26ba5cc220fed7cc3f870e59d292aa;
        functionInstances[6] = 0x1d523cf1ddab1a1793132e78c866c0c3;
        functionInstances[7] = 0x00;
        functionInstances[8] = 0x00;
        functionInstances[9] = 0x01;
        functionInstances[10] = 0x00;
        functionInstances[11] = 0x80;
        functionInstances[12] = 0x00;
        functionInstances[13] = 0x00;
        functionInstances[14] = 0x00;
        functionInstances[15] = 0x200000;
        functionInstances[16] = 0x04;
        functionInstances[17] = 0x00;
        functionInstances[18] = 0x44;
        functionInstances[19] = 0x00;
        functionInstances[20] = 0x010000;
        functionInstances[21] = 0xe0;
        functionInstances[22] = 0x00;
        functionInstances[23] = 0x08000000;
        functionInstances[24] = 0x20;
        functionInstances[25] = 0x00;
        functionInstances[26] = 0x10000000;
        functionInstances[27] = 0xe0;
        functionInstances[28] = 0x00;
        functionInstances[29] = 0x10000000;
        functionInstances[30] = 0x70a08231;
        functionInstances[31] = 0x00;
        functionInstances[32] = 0x100000;
        functionInstances[33] = 0x095ea7b3;
        functionInstances[34] = 0x00;
        functionInstances[35] = 0x100000;
        functionInstances[36] = 0x23b872dd;
        functionInstances[37] = 0x00;
        functionInstances[38] = 0x100000;
        functionInstances[39] = 0x18160ddd;
        functionInstances[40] = 0x00;
        functionInstances[41] = 0x100000;
        functionInstances[42] = 0x313ce567;
        functionInstances[43] = 0x00;
        functionInstances[44] = 0x100000;
        functionInstances[45] = 0x06fdde03;
        functionInstances[46] = 0x00;
        functionInstances[47] = 0x100000;
        functionInstances[48] = 0x95d89b41;
        functionInstances[49] = 0x00;
        functionInstances[50] = 0x100000;
        functionInstances[51] = 0x39509351;
        functionInstances[52] = 0x00;
        functionInstances[53] = 0x100000;
        functionInstances[54] = 0xa457c2d7;
        functionInstances[55] = 0x00;
        functionInstances[56] = 0x100000;
        functionInstances[57] = 0xa9059cbb;
        functionInstances[58] = 0x00;
        functionInstances[59] = 0x100000;
        functionInstances[60] = 0x04;
        functionInstances[61] = 0x00;
        functionInstances[62] = 0x44;
        functionInstances[63] = 0x00;
        functionInstances[64] = 0x08;
        functionInstances[65] = 0x40;
        functionInstances[66] = 0x00;
        functionInstances[67] = 0x010000;
        functionInstances[68] = 0x200000;
        functionInstances[69] = 0x02;
        functionInstances[70] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[71] = 0xffffffff;
        functionInstances[72] = 0x20;
        functionInstances[73] = 0x00;
        functionInstances[74] = 0x02;
        functionInstances[75] = 0x20;
        functionInstances[76] = 0x00;
        functionInstances[77] = 0x04;
        functionInstances[78] = 0x00;
        functionInstances[79] = 0x01;
        functionInstances[80] = 0x00;
        functionInstances[81] = 0x00;
        functionInstances[82] = 0x00;
        functionInstances[83] = 0x00;
        functionInstances[84] = 0x01;
        functionInstances[85] = 0x00;
        functionInstances[86] = 0x00;
        functionInstances[87] = 0x00;
        functionInstances[88] = 0x00;
        functionInstances[89] = 0x01;
        functionInstances[90] = 0x00;
        functionInstances[91] = 0x00;
        functionInstances[92] = 0x00;
        functionInstances[93] = 0x00;
        functionInstances[94] = 0x01;
        functionInstances[95] = 0x00;
        functionInstances[96] = 0x00;
        functionInstances[97] = 0x00;
        functionInstances[98] = 0x00;
        functionInstances[99] = 0x01;
        functionInstances[100] = 0x00;
        functionInstances[101] = 0x00;
        functionInstances[102] = 0x00;
        functionInstances[103] = 0x00;
        functionInstances[104] = 0x01;
        functionInstances[105] = 0x00;
        functionInstances[106] = 0x00;
        functionInstances[107] = 0x00;
        functionInstances[108] = 0x00;
        functionInstances[109] = 0x01;
        functionInstances[110] = 0x00;
        functionInstances[111] = 0x00;
        functionInstances[112] = 0x00;
        functionInstances[113] = 0x00;
        functionInstances[114] = 0x01;
        functionInstances[115] = 0x00;
        functionInstances[116] = 0x00;
        functionInstances[117] = 0x00;
        functionInstances[118] = 0x00;
        functionInstances[119] = 0x01;
        functionInstances[120] = 0x00;
        functionInstances[121] = 0x00;
        functionInstances[122] = 0x00;
        functionInstances[123] = 0x00;
        functionInstances[124] = 0x01;
        functionInstances[125] = 0x00;
        functionInstances[126] = 0x020000;
        functionInstances[127] = 0x70a08231;
        functionInstances[128] = 0x00;
        functionInstances[129] = 0x100000;
        functionInstances[130] = 0x02;
        functionInstances[131] = 0x00;
        functionInstances[132] = 0x04;
        functionInstances[133] = 0x00;
        functionInstances[134] = 0x00;
        functionInstances[135] = 0x40;
        functionInstances[136] = 0x00;
        functionInstances[137] = 0x08;
        functionInstances[138] = 0x00;
        functionInstances[139] = 0x40;
        functionInstances[140] = 0x00;
        functionInstances[141] = 0x10000001;
        functionInstances[142] = 0x04;
        functionInstances[143] = 0x00;
        functionInstances[144] = 0x24;
        functionInstances[145] = 0x00;
        functionInstances[146] = 0x08;
        functionInstances[147] = 0x40;
        functionInstances[148] = 0x00;
        functionInstances[149] = 0x200000;
        functionInstances[150] = 0x020000;
        functionInstances[151] = 0x095ea7b3;
        functionInstances[152] = 0x00;
        functionInstances[153] = 0x100000;
        functionInstances[154] = 0x23b872dd;
        functionInstances[155] = 0x00;
        functionInstances[156] = 0x100000;
        functionInstances[157] = 0x18160ddd;
        functionInstances[158] = 0x00;
        functionInstances[159] = 0x100000;
        functionInstances[160] = 0x313ce567;
        functionInstances[161] = 0x00;
        functionInstances[162] = 0x100000;
        functionInstances[163] = 0x06fdde03;
        functionInstances[164] = 0x00;
        functionInstances[165] = 0x100000;
        functionInstances[166] = 0x95d89b41;
        functionInstances[167] = 0x00;
        functionInstances[168] = 0x100000;
        functionInstances[169] = 0x39509351;
        functionInstances[170] = 0x00;
        functionInstances[171] = 0x100000;
        functionInstances[172] = 0xa457c2d7;
        functionInstances[173] = 0x00;
        functionInstances[174] = 0x100000;
        functionInstances[175] = 0xa9059cbb;
        functionInstances[176] = 0x00;
        functionInstances[177] = 0x100000;
        functionInstances[178] = 0x04;
        functionInstances[179] = 0x00;
        functionInstances[180] = 0x44;

        // Rest remain zero (indices 181-445 are default initialized to 0)
        return functionInstances;
    }

    /**
     * @dev Helper function to create a simple proof data for tests that still use old MPT structure
     * Converts old MPT-based calls to new function-based structure
     */
    function _createProofDataFromMPT(
        uint128[] memory proofPart1,
        uint256[] memory proofPart2,
        uint256[] memory publicInputs,
        uint256 smax,
        bytes[] memory finalMPTLeaves
    ) internal pure returns (BridgeProofManager.ProofData memory, uint256[] memory) {
        // Set proper state root values and function signature for bridge tests
        _setTestStateRoots(publicInputs);

        // Create final balances array - we'll decode the intended values from the leaf count pattern
        uint256 participantCount = finalMPTLeaves.length;
        uint256[] memory finalBalances = new uint256[](participantCount);

        // Simple pattern based on participant count to avoid stack too deep
        if (smax == 6 && participantCount == 3) {
            // testSubmitAggregatedProof expects redistribution (6,0,0)
            finalBalances[0] = 6 ether;
            finalBalances[1] = 0 ether;
            finalBalances[2] = 0 ether;
        } else {
            // Default: each participant gets (i+1) ether to match deposit pattern
            for (uint256 i = 0; i < participantCount; i++) {
                finalBalances[i] = (i + 1) * 1 ether;
            }
        }

        BridgeProofManager.ProofData memory proofData = BridgeProofManager.ProofData({
            proofPart1: proofPart1,
            proofPart2: proofPart2,
            publicInputs: publicInputs,
            smax: smax
        });

        return (proofData, finalBalances);
    }

    /**
     * @dev Helper function to create proof data with non-conserving balances for violation tests
     */
    function _createProofDataViolatingConservation(
        uint128[] memory proofPart1,
        uint256[] memory proofPart2,
        uint256[] memory publicInputs,
        uint256 smax
    ) internal pure returns (BridgeProofManager.ProofData memory, uint256[] memory) {
        // Set proper state root values for bridge tests to pass state root chain validation
        _setTestStateRoots(publicInputs);

        // Create final balances that violate conservation (total 7 instead of 6)
        uint256[] memory finalBalances = new uint256[](3);
        finalBalances[0] = 2 ether; // Total will be 2+2+3=7 ether, violating conservation
        finalBalances[1] = 2 ether;
        finalBalances[2] = 3 ether;

        BridgeProofManager.ProofData memory proofData = BridgeProofManager.ProofData({
            proofPart1: proofPart1,
            proofPart2: proofPart2,
            publicInputs: publicInputs,
            smax: smax
        });

        return (proofData, finalBalances);
    }

    // ========== Channel Opening Tests ==========

    function testOpenChannel() public {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 channelId = keccak256(abi.encode(address(this), uint256(2)));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
        bytes32 returnedChannelId = bridge.openChannel(params);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        assertEq(returnedChannelId, channelId);

        BridgeCore.ChannelState state = bridge.getChannelState(channelId);
        address targetContractReturned = bridge.getChannelTargetContract(channelId);
        address[] memory channelParticipants = bridge.getChannelParticipants(channelId);

        assertEq(targetContractReturned, address(token));
        assertEq(uint8(state), uint8(BridgeCore.ChannelState.Initialized));

        // Check that all participants are whitelisted
        assertTrue(bridge.isChannelWhitelisted(channelId, user1));
        assertTrue(bridge.isChannelWhitelisted(channelId, user2));
        assertTrue(bridge.isChannelWhitelisted(channelId, user3));

        assertEq(channelParticipants.length, 0); // No deposits made yet

        vm.stopPrank();
    }

    function testParticipantCountOverflow() public {
        vm.startPrank(leader);

        // Create 16 participants (NOT including the leader)
        address[] memory participants = new address[](16);
        for (uint256 i = 0; i < 16; i++) {
            participants[i] = address(uint160(1000 + i));
            token.mint(participants[i], 10 ether);
        }

        // Open channel - leader will be auto-whitelisted as 17th participant
        bytes32 channelId = keccak256(abi.encode(leader, "overflow-test"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: false
        });
        bridge.openChannel(params);

        vm.stopPrank();

        // Verify tree size - should be 32, not 16
        uint256 treeSize = bridge.getChannelTreeSize(channelId);

        // Now have leader + 16 whitelisted users deposit
        // This creates 17 participants for a tree that might only support 16

        // Leader deposits
        vm.startPrank(leader);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory leaderMptKeys = new bytes32[](1);
        leaderMptKeys[0] = bytes32(uint256(1));
        depositManager.depositToken(channelId, 1 ether, leaderMptKeys);
        vm.stopPrank();

        // All 16 participants deposit
        for (uint256 i = 0; i < 16; i++) {
            vm.startPrank(participants[i]);
            token.approve(address(depositManager), 1 ether);
            bytes32[] memory mptKeys = new bytes32[](1);
            mptKeys[0] = bytes32(uint256(2 + i));
            depositManager.depositToken(channelId, 1 ether, mptKeys);
            vm.stopPrank();
        }

        // Get participant count
        address[] memory channelParticipants = bridge.getChannelParticipants(channelId);

        // Should have 17 participants total

        assertEq(channelParticipants.length, 17, "Should have 17 participants");

        // Tree size must accommodate all participants
        assertTrue(treeSize >= channelParticipants.length, "Tree size must be >= participant count");
    }

    function testMultipleChannelsWithSameLeader() public {
        vm.startPrank(leader);

        address[] memory participants = new address[](2);
        participants[0] = user1;
        participants[1] = user2;

        // Create first channel
        bytes32 channelId1 = keccak256(abi.encode(leader, "channel1"));
        BridgeCore.ChannelParams memory params1 = BridgeCore.ChannelParams({
            channelId: channelId1,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: false
        });
        bridge.openChannel(params1);

        // Create second channel with same leader
        bytes32 channelId2 = keccak256(abi.encode(leader, "channel2"));
        BridgeCore.ChannelParams memory params2 = BridgeCore.ChannelParams({
            channelId: channelId2,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: false
        });
        bridge.openChannel(params2);

        vm.stopPrank();

        // Verify leader is set for both channels
        assertTrue(bridge.isMarkedChannelLeader(leader, channelId1), "Leader should be marked for channel 1");
        assertTrue(bridge.isMarkedChannelLeader(leader, channelId2), "Leader should be marked for channel 2");

        // Cleanup first channel
        vm.prank(address(withdrawManager));
        bridge.cleanupChannel(channelId1);

        // Verify first channel is deleted but second still exists
        assertEq(bridge.getChannelLeader(channelId1), address(0), "First channel should be deleted");
        assertFalse(bridge.isMarkedChannelLeader(leader, channelId1), "Leader should not be marked for deleted channel 1");
        assertTrue(
            bridge.isMarkedChannelLeader(leader, channelId2),
            "Leader should still be marked for channel 2"
        );

        // Cleanup second channel
        vm.prank(address(withdrawManager));
        bridge.cleanupChannel(channelId2);

        // Now both channels should be deleted
        assertEq(bridge.getChannelLeader(channelId2), address(0), "Second channel should be deleted");
        assertFalse(
            bridge.isMarkedChannelLeader(leader, channelId2),
            "Leader should not be marked for deleted channel 2"
        );
    }

    // ========== Deposit Tests ==========

    function testDepositTokenBasic() public {
        bytes32 channelId = _createChannel();
        uint256 depositAmount = 1 ether;

        vm.startPrank(user1);

        // Approve and deposit token
        token.approve(address(depositManager), depositAmount);

        vm.expectEmit(true, true, true, true);
        emit Deposited(channelId, user1, address(token), depositAmount);
        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId, depositAmount, mptKeys);
        uint256 amountStored = bridge.getValidatedUserSlotValue(channelId, user1, 0);
        assertEq(amountStored, depositAmount);

        vm.stopPrank();
    }

    function testDepositTokenNotParticipant() public {
        bytes32 channelId = _createChannel();

        vm.startPrank(address(999));
        token.mint(address(999), 1 ether);
        token.approve(address(depositManager), 1 ether);
        vm.expectRevert("Not whitelisted");
        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId, 1 ether, mptKeys);
        vm.stopPrank();
    }

    function testDepositToken() public {
        bytes32 channelId = _createTokenChannel();
        uint256 depositAmount = 100 * 10 ** 18;

        vm.startPrank(user1);

        token.approve(address(depositManager), depositAmount);

        vm.expectEmit(true, true, true, true);
        emit Deposited(channelId, user1, address(token), depositAmount);

        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId, depositAmount, mptKeys);

        assertEq(token.balanceOf(address(depositManager)), depositAmount);

        vm.stopPrank();
    }

    // ========== State Initialization Tests ==========

    function testInitializeChannelState() public {
        bytes32 channelId = _createChannel();

        // Leader must deposit before initializing
        vm.startPrank(leader);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(uint160(l2Leader)));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Make deposits using DepositManager
        vm.startPrank(user1);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId, 1 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user3);
        token.approve(address(depositManager), 3 ether);
        bytes32[] memory mptKeys3 = new bytes32[](1);
        mptKeys3[0] = bytes32(uint256(uint160(l2User3)));
        depositManager.depositToken(channelId, 3 ether, mptKeys3);
        vm.stopPrank();

        // Initialize state
        bytes32 mockMerkleRoot = keccak256(abi.encodePacked("mockRoot"));
        TestChannelInitializationProof memory mockProof = TestChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: mockMerkleRoot
        });
        vm.roll(10); // Set block number high enough to avoid underflow in block.number - 3
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: mockProof.pA,
                pB: mockProof.pB,
                pC: mockProof.pC,
                merkleRoot: mockProof.merkleRoot
            })
        );

        // Check state using individual getters since getChannelInfo doesn't exist
        BridgeCore.ChannelState state = bridge.getChannelState(channelId);

        assertEq(uint8(state), uint8(BridgeCore.ChannelState.Open));
    }

    /**
     * @notice Tests that initializeChannelState produces different root hashes for channels
     *         with the same participants but different deposit amounts
     * @dev This test verifies the fix for the bug where different deposits produced identical hashes
     */
    function testInitializeChannelStateDifferentDeposits() public {
        // Simplified test: just verify that token channels with different deposits create different root hashes
        // Use tokens to match working patterns exactly

        // Create first channel
        bytes32 channelId1 = _createChannel();

        // Leader must deposit before initializing
        vm.startPrank(leader);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(uint160(l2Leader)));
        depositManager.depositToken(channelId1, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Make specific deposits - Set 1: [1, 2, 0]
        vm.startPrank(user1);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId1, 1 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        token.approve(address(depositManager), 2 ether);
        bytes32[] memory mptKeys2 = new bytes32[](1);
        mptKeys2[0] = bytes32(uint256(uint160(l2User2)));
        depositManager.depositToken(channelId1, 2 ether, mptKeys2);
        vm.stopPrank();
        // user3 makes no deposit

        // Initialize and get root hash 1
        bytes32 mockMerkleRoot1 = keccak256(abi.encodePacked("mockRoot1"));
        TestChannelInitializationProof memory mockProof1 = TestChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: mockMerkleRoot1
        });
        vm.roll(15); // Set block number high enough to avoid underflow in block.number - 3
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId1,
            BridgeProofManager.ChannelInitializationProof({
                pA: mockProof1.pA,
                pB: mockProof1.pB,
                pC: mockProof1.pC,
                merkleRoot: mockProof1.merkleRoot
            })
        );
        (,,, bytes32 rootHash1) = bridge.getChannelInfo(channelId1);

        // Simple approach: just verify the root hashes are different after initialization
        // No need to complete full lifecycle for this test

        // Create second channel with different leader to avoid "Channel limit reached"
        bytes32 channelId2 = _createChannelWithLeader(leader2);

        // Leader2 must deposit before initializing
        vm.startPrank(leader2);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader2 = new bytes32[](1);
        mptKeysLeader2[0] = bytes32(uint256(uint160(address(32)))); // l2Leader2
        depositManager.depositToken(channelId2, 1 ether, mptKeysLeader2);
        vm.stopPrank();

        vm.startPrank(user1);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysC2_1 = new bytes32[](1);
        mptKeysC2_1[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId2, 1 ether, mptKeysC2_1);
        vm.stopPrank();

        vm.startPrank(user2);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysC2_2 = new bytes32[](1);
        mptKeysC2_2[0] = bytes32(uint256(uint160(l2User2)));
        depositManager.depositToken(channelId2, 1 ether, mptKeysC2_2); // Same amount this time
        vm.stopPrank();
        // user3 makes no deposit

        // Initialize and get root hash 2
        bytes32 mockMerkleRoot2 = keccak256(abi.encodePacked("mockRoot2"));
        TestChannelInitializationProof memory mockProof2 = TestChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: mockMerkleRoot2
        });
        vm.roll(20); // Set block number high enough to avoid underflow in block.number - 3
        vm.prank(leader2);
        proofManager.initializeChannelState(
            channelId2,
            BridgeProofManager.ChannelInitializationProof({
                pA: mockProof2.pA,
                pB: mockProof2.pB,
                pC: mockProof2.pC,
                merkleRoot: mockProof2.merkleRoot
            })
        );
        (,,, bytes32 rootHash2) = bridge.getChannelInfo(channelId2);

        // The root hashes should be different for different deposit amounts
        assertTrue(rootHash1 != rootHash2, "Root hashes should be different for different deposit amounts");
    }

    function testInitialize_ChannelStateNotLeader() public {
        bytes32 channelId = _createChannel();

        bytes32 mockMerkleRoot = keccak256(abi.encodePacked("mockRoot"));
        TestChannelInitializationProof memory mockProof = TestChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: mockMerkleRoot
        });
        vm.prank(user1);
        vm.expectRevert("Not leader");
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: mockProof.pA,
                pB: mockProof.pB,
                pC: mockProof.pC,
                merkleRoot: mockProof.merkleRoot
            })
        );
    }

    function _createChannel() internal returns (bytes32) {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "createChannel"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        vm.stopPrank();

        return channelId;
    }

    function _createTokenChannel() internal returns (bytes32) {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "createTokenChannel"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        vm.stopPrank();

        return channelId;
    }

    function _createChannelWithLeader(address newLeader) internal returns (bytes32) {
        vm.startPrank(newLeader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 channelId = keccak256(abi.encode(address(this), newLeader, block.timestamp, "createChannelWithLeader"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        vm.stopPrank();

        return channelId;
    }

    function _initializeChannel() internal returns (bytes32) {
        bytes32 channelId = _createChannel();

        // Configure MockZecFrost to accept the channel's expected signer
        address expectedSigner = bridge.getChannelSignerAddr(channelId);
        mockZecFrost.setMockSigner(expectedSigner);

        // Leader must deposit before initializing
        vm.startPrank(leader);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(uint160(l2Leader)));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Make deposits
        vm.startPrank(user1);
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId, 1 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        token.approve(address(depositManager), 2 ether);
        bytes32[] memory mptKeys2 = new bytes32[](1);
        mptKeys2[0] = bytes32(uint256(uint160(l2User2)));
        depositManager.depositToken(channelId, 2 ether, mptKeys2);
        vm.stopPrank();

        vm.startPrank(user3);
        token.approve(address(depositManager), 3 ether);
        bytes32[] memory mptKeys3 = new bytes32[](1);
        mptKeys3[0] = bytes32(uint256(uint160(l2User3)));
        depositManager.depositToken(channelId, 3 ether, mptKeys3);
        vm.stopPrank();

        // Initialize state
        bytes32 mockMerkleRoot = keccak256(abi.encodePacked("mockRoot"));
        TestChannelInitializationProof memory mockProof = TestChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: mockMerkleRoot
        });
        vm.roll(25); // Set block number high enough to avoid underflow in block.number - 3
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: mockProof.pA,
                pB: mockProof.pB,
                pC: mockProof.pC,
                merkleRoot: mockProof.merkleRoot
            })
        );

        return channelId;
    }

    function _submitProof() internal returns (bytes32) {
        bytes32 channelId = _initializeChannel();

        uint128[] memory proofPart1 = new uint128[](1);
        uint256[] memory proofPart2 = new uint256[](1);
        uint256[] memory publicInputs = new uint256[](512);
        publicInputs[0] = uint256(keccak256("finalStateRoot"));

        // Create MPT leaves matching the deposited amounts
        uint256[] memory balances = new uint256[](3);
        balances[0] = 1 ether;
        balances[1] = 2 ether;
        balances[2] = 3 ether;

        bytes[] memory initialMPTLeaves = _createMPTLeaves(balances);
        bytes[] memory finalMPTLeaves = _createMPTLeaves(balances);

        // Advance time past the channel timeout to allow proof submission
        vm.warp(block.timestamp + 1 days + 1);

        vm.prank(leader);
        (BridgeProofManager.ProofData memory proofDataLocal,) = _createProofDataSimpleForChannel(
            channelId, proofPart1, proofPart2, publicInputs, 0, initialMPTLeaves, finalMPTLeaves
        );
        proofManager.submitProofAndSignature(
            channelId,
            _wrapProofInArray(proofDataLocal),
            _createZecFrostSignatureForProofData(channelId, proofDataLocal.publicInputs)
        );

        return channelId;
    }

    function _getSignedChannel() internal returns (bytes32) {
        // _submitProof now includes signature, so it's already signed and in Closing state
        return _submitProof();
    }

    function _getClosedChannel() internal returns (bytes32) {
        bytes32 channelId = _getSignedChannel();

        vm.prank(leader);

        return channelId;
    }

    // ========== Fuzz Tests ==========

    function testFuzzDeposit(uint256 amount) public {
        vm.assume(amount > 0 && amount < 100 ether);

        bytes32 channelId = _createChannel();

        vm.deal(user1, amount);
        vm.startPrank(user1);
        token.approve(address(depositManager), amount);
        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(uint256(uint160(l2User1)));
        depositManager.depositToken(channelId, amount, mptKeys);
        vm.stopPrank();
    }

    function testFuzzTimeout(uint256 timeout) public {
        vm.assume(timeout >= 1 hours && timeout <= 7 days);

        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 testChannelId = keccak256(abi.encode(address(this), timeout, "testFuzzTimeout"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: testChannelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
        bytes32 channelId = bridge.openChannel(params);
        assertEq(channelId, testChannelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        vm.stopPrank();
    }

    // ========== Integration Tests ==========

    function testSignatureCommitmentProtection() public {
        bytes32 channelId = _initializeChannel();
        uint128[] memory proofPart1 = new uint128[](1);
        uint256[] memory proofPart2 = new uint256[](1);

        // Malicious proof with different final state root
        uint256[] memory maliciousPublicInputs = new uint256[](512);
        maliciousPublicInputs[0] = uint256(keccak256("maliciousStateRoot"));

        uint256[] memory balances = new uint256[](3);
        balances[0] = 1 ether;
        balances[1] = 2 ether;
        balances[2] = 3 ether;
        bytes[] memory initialMPTLeaves = _createMPTLeaves(balances);
        bytes[] memory finalMPTLeaves = _createMPTLeaves(balances);

        vm.warp(block.timestamp + 1 days + 1);

        // Try to submit malicious proof with signature meant for legitimate proof
        (BridgeProofManager.ProofData memory maliciousProof,) =
            _createProofDataSimple(proofPart1, proofPart2, maliciousPublicInputs, 0, initialMPTLeaves, finalMPTLeaves);

        // Create signature for legitimate proof (different finalStateRoot)
        bytes32 legitimateCommitmentHash =
            keccak256(abi.encodePacked(channelId, bytes32(uint256(keccak256("legitimateStateRoot")))));
        BridgeProofManager.Signature memory legitimateSignature = BridgeProofManager.Signature({
            message: legitimateCommitmentHash,
            rx: 0x1fb4c0436e9054ae0b237cde3d7a478ce82405b43fdbb5bf1d63c9f8d912dd5d,
            ry: 0x3a7784df441925a8859b9f3baf8d570d488493506437db3ccf230a4b43b27c1e,
            z: 0xc7fdcb364dd8577e47dd479185ca659adbfcd1b8675e5cbb36e5f93ca4e15b25
        });

        // This should fail because signature doesn't match proof content
        vm.expectRevert("Signature must commit to proof content");
        proofManager.submitProofAndSignature(channelId, _wrapProofInArray(maliciousProof), legitimateSignature);

        // Verify channel state unchanged
        require(bridge.getChannelState(channelId) == BridgeCore.ChannelState.Open);
    }

    /**
     * @dev Helper to setup channel with specified number of participants
     */
    function _setupChannelWithParticipants(uint256 participantCount) internal returns (bytes32 channelId) {
        // Use different leaders to avoid "channel limit reached" error
        address channelLeader = address(uint160(100 + participantCount));

        // Fund the leader
        vm.deal(channelLeader, 10 ether);

        vm.startPrank(channelLeader);

        address[] memory participants = new address[](participantCount);
        for (uint256 i = 0; i < participantCount; i++) {
            participants[i] = address(uint160(3 + i)); // Start from address(3)
        }

        channelId = keccak256(abi.encode(address(this), participantCount, block.timestamp, "setupChannel"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });
        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        // Leader must deposit before initializing
        token.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(200 + participantCount)); // Unique L2 key for leader
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Deposit for each participant
        for (uint256 i = 0; i < participantCount; i++) {
            // Fund the participant
            vm.deal(participants[i], 10 ether);

            vm.startPrank(participants[i]);
            token.approve(address(depositManager), (i + 1) * 1 ether);
            bytes32[] memory mptKeys = new bytes32[](1);
            mptKeys[0] = bytes32(uint256(13 + i)); // Use different MPT keys
            depositManager.depositToken(channelId, (i + 1) * 1 ether, mptKeys);
            vm.stopPrank();
        }

        bytes32 mockMerkleRoot = keccak256(abi.encodePacked("mockRoot"));
        TestChannelInitializationProof memory mockProof = TestChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: mockMerkleRoot
        });
        vm.prank(channelLeader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: mockProof.pA,
                pB: mockProof.pB,
                pC: mockProof.pC,
                merkleRoot: mockProof.merkleRoot
            })
        );

        vm.stopPrank();
    }

    // ========== Tree Size Selection Tests ==========

    function testTreeSize128LeavesSelection() public {
        // Use a fresh leader for this test
        address testLeader = address(0x999);
        vm.deal(testLeader, 10 ether);
        vm.startPrank(testLeader);

        // Create 33 whitelisted users to force 64-leaf tree selection
        // 33 whitelisted users Ã— 1 contract = 33 leaves, which requires 64-leaf tree
        address[] memory participants = new address[](33);
        for (uint256 i = 0; i < 33; i++) {
            participants[i] = address(uint160(1000 + i)); // Generate unique addresses
        }

        bytes32 testChannelId = keccak256(abi.encode(address(this), testLeader, "test64Leaves"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: testChannelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });

        // Open the channel
        bytes32 channelId = bridge.openChannel(params);
        assertEq(channelId, testChannelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );

        // Verify the channel was created successfully
        assertEq(channelId, testChannelId);

        // Get channel info to verify participants and target contract
        (address targetContract, BridgeCore.ChannelState state, uint256 participantCount,) =
            bridge.getChannelInfo(channelId);

        assertEq(targetContract, address(token));
        assertEq(uint8(state), uint8(BridgeCore.ChannelState.Initialized));
        assertEq(participantCount, 0); // No deposits made yet, so no actual participants

        // Verify that the contract selected the 64-leaf tree
        uint256 requiredTreeSize = bridge.getChannelTreeSize(channelId);
        assertEq(requiredTreeSize, 64, "Should select 64-leaf tree for 33 participants");

        vm.stopPrank();
    }

    function _wrapProofInArray(BridgeProofManager.ProofData memory proof)
        internal
        pure
        returns (BridgeProofManager.ProofData[] memory)
    {
        BridgeProofManager.ProofData[] memory proofs = new BridgeProofManager.ProofData[](1);
        proofs[0] = proof;
        return proofs;
    }

    function computeCorrectFunctionInstanceHash() internal pure returns (bytes32) {
        uint256[] memory functionInstances = new uint256[](446);

        functionInstances[0] = 0x01;
        functionInstances[1] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[2] = 0xffffffff;
        functionInstances[3] = 0xe72f6afd7d1f72623e6b071492d1122b;
        functionInstances[4] = 0x11dafe5d23e1218086a365b99fbf3d3b;
        functionInstances[5] = 0x3e26ba5cc220fed7cc3f870e59d292aa;
        functionInstances[6] = 0x1d523cf1ddab1a1793132e78c866c0c3;
        functionInstances[7] = 0x00;
        functionInstances[8] = 0x00;
        functionInstances[9] = 0x01;
        functionInstances[10] = 0x00;
        functionInstances[11] = 0x80;
        functionInstances[12] = 0x00;
        functionInstances[13] = 0x00;
        functionInstances[14] = 0x00;
        functionInstances[15] = 0x200000;
        functionInstances[16] = 0x04;
        functionInstances[17] = 0x00;
        functionInstances[18] = 0x44;
        functionInstances[19] = 0x00;
        functionInstances[20] = 0x010000;
        functionInstances[21] = 0xe0;
        functionInstances[22] = 0x00;
        functionInstances[23] = 0x08000000;
        functionInstances[24] = 0x20;
        functionInstances[25] = 0x00;
        functionInstances[26] = 0x10000000;
        functionInstances[27] = 0xe0;
        functionInstances[28] = 0x00;
        functionInstances[29] = 0x10000000;
        functionInstances[30] = 0x70a08231;
        functionInstances[31] = 0x00;
        functionInstances[32] = 0x020000;
        functionInstances[33] = 0x98650275;
        functionInstances[34] = 0x00;
        functionInstances[35] = 0x020000;
        functionInstances[36] = 0xaa271e1a;
        functionInstances[37] = 0x00;
        functionInstances[38] = 0x020000;
        functionInstances[39] = 0x98650275;
        functionInstances[40] = 0x00;
        functionInstances[41] = 0x100000;
        functionInstances[42] = 0xa457c2d7;
        functionInstances[43] = 0x00;
        functionInstances[44] = 0x100000;
        functionInstances[45] = 0xa9059cbb;
        functionInstances[46] = 0x00;
        functionInstances[47] = 0x100000;
        functionInstances[48] = 0x04;
        functionInstances[49] = 0x00;
        functionInstances[50] = 0x44;
        functionInstances[51] = 0x00;
        functionInstances[52] = 0x08;
        functionInstances[53] = 0x40;
        functionInstances[54] = 0x00;
        functionInstances[55] = 0x010000;
        functionInstances[56] = 0x200000;
        functionInstances[57] = 0x02;
        functionInstances[58] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[59] = 0xffffffff;
        functionInstances[60] = 0x20;
        functionInstances[61] = 0x00;
        functionInstances[62] = 0x02;
        functionInstances[63] = 0x20;
        functionInstances[64] = 0x00;
        functionInstances[65] = 0x02;
        functionInstances[66] = 0x00;
        functionInstances[67] = 0x00;
        functionInstances[68] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[69] = 0xffffffff;
        functionInstances[70] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[71] = 0xffffffff;
        functionInstances[72] = 0x100000;
        functionInstances[73] = 0x200000;
        functionInstances[74] = 0x00;
        functionInstances[75] = 0x00;
        functionInstances[76] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[77] = 0xffffffff;
        functionInstances[78] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[79] = 0xffffffff;
        functionInstances[80] = 0x100000;
        functionInstances[81] = 0x200000;
        functionInstances[82] = 0x60;
        functionInstances[83] = 0x00;
        functionInstances[84] = 0x02;
        functionInstances[85] = 0x20;
        functionInstances[86] = 0x00;
        functionInstances[87] = 0x02;
        functionInstances[88] = 0x00;
        functionInstances[89] = 0x00;
        functionInstances[90] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[91] = 0xffffffff;
        functionInstances[92] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[93] = 0xffffffff;
        functionInstances[94] = 0x20;
        functionInstances[95] = 0x00;
        functionInstances[96] = 0x02;
        functionInstances[97] = 0x20;
        functionInstances[98] = 0x00;
        functionInstances[99] = 0x02;
        functionInstances[100] = 0x1da9;
        functionInstances[101] = 0x00;
        functionInstances[102] = 0xffffffff;
        functionInstances[103] = 0x00;
        functionInstances[104] = 0x020000;
        functionInstances[105] = 0x200000;
        functionInstances[106] = 0x08;
        functionInstances[107] = 0x00;
        functionInstances[108] = 0x00;
        functionInstances[109] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[110] = 0xffffffff;
        functionInstances[111] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[112] = 0xffffffff;
        functionInstances[113] = 0x20;
        functionInstances[114] = 0x00;
        functionInstances[115] = 0x02;
        functionInstances[116] = 0x20;
        functionInstances[117] = 0x00;
        functionInstances[118] = 0x02;
        functionInstances[119] = 0x00;
        functionInstances[120] = 0x00;
        functionInstances[121] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[122] = 0xffffffff;
        functionInstances[123] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[124] = 0xffffffff;
        functionInstances[125] = 0x20;
        functionInstances[126] = 0x00;
        functionInstances[127] = 0x02;
        functionInstances[128] = 0x20;
        functionInstances[129] = 0x00;
        functionInstances[130] = 0x02;
        functionInstances[131] = 0x1acc;
        functionInstances[132] = 0x00;
        functionInstances[133] = 0xffffffff;
        functionInstances[134] = 0x00;
        functionInstances[135] = 0x02;
        functionInstances[136] = 0x010000;
        functionInstances[137] = 0x200000;
        functionInstances[138] = 0x00;
        functionInstances[139] = 0x00;
        functionInstances[140] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[141] = 0xffffffff;
        functionInstances[142] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[143] = 0xffffffff;
        functionInstances[144] = 0x20;
        functionInstances[145] = 0x00;
        functionInstances[146] = 0x02;
        functionInstances[147] = 0x20;
        functionInstances[148] = 0x00;
        functionInstances[149] = 0x02;
        functionInstances[150] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[151] = 0xffffffff;
        functionInstances[152] = 0xffffffffffffffffffffffffffffffff;
        functionInstances[153] = 0xffffffff;
        functionInstances[154] = 0x20;
        functionInstances[155] = 0x00;
        functionInstances[156] = 0x02;
        functionInstances[157] = 0x08;
        functionInstances[158] = 0x07;
        functionInstances[159] = 0x00;
        functionInstances[160] = 0x15;
        functionInstances[161] = 0x00;
        functionInstances[162] = 0x0100;
        functionInstances[163] = 0x00;
        functionInstances[164] = 0x01;
        functionInstances[165] = 0x00;
        functionInstances[166] = 0x10;
        functionInstances[167] = 0xff;
        functionInstances[168] = 0x00;
        functionInstances[169] = 0x200000;
        functionInstances[170] = 0x200000;
        functionInstances[171] = 0x01;
        functionInstances[172] = 0x00;
        functionInstances[173] = 0x200000;
        functionInstances[174] = 0x200000;
        functionInstances[175] = 0x200000;
        functionInstances[176] = 0x200000;
        functionInstances[177] = 0x20;
        functionInstances[178] = 0x00;
        functionInstances[179] = 0x02;
        functionInstances[180] = 0x08;
        // Rest are zeros (181-445)

        return keccak256(abi.encodePacked(functionInstances));
    }
}



================================================
FILE: test/bridge/ChannelIdTest.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/IBridgeCore.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";

/**
 * @title ChannelIdTest
 * @notice Test the new bytes32 channelId system
 */
contract ChannelIdTest is Test {
    BridgeCore bridgeCore;
    BridgeAdminManager adminManager;

    address constant TARGET_CONTRACT = address(0x123456);
    address constant USER1 = address(0x1001);
    address constant USER2 = address(0x1002);

    function setUp() public {
        bridgeCore = new BridgeCore();
        adminManager = new BridgeAdminManager();

        ERC1967Proxy bridgeCoreProxy = new ERC1967Proxy(
            address(bridgeCore),
            abi.encodeCall(
                bridgeCore.initialize, (address(0), address(0), address(0), address(adminManager), address(this))
            )
        );
        bridgeCore = BridgeCore(address(bridgeCoreProxy));

        ERC1967Proxy adminManagerProxy = new ERC1967Proxy(
            address(adminManager), abi.encodeCall(adminManager.initialize, (address(bridgeCore), address(this)))
        );
        adminManager = BridgeAdminManager(address(adminManagerProxy));

        bridgeCore.updateManagerAddresses(address(0), address(0), address(0), address(adminManager));

        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(TARGET_CONTRACT, emptySlots, balanceSlot, true);
    }

    function testNewChannelIdSystem() public {
        // Generate a channel ID
        bytes32 salt = bytes32(uint256(12345));
        bytes32 channelId = bridgeCore.generateChannelId(address(this), salt);

        assertNotEq(channelId, bytes32(0), "Channel ID should not be zero");

        // Create channel with generated ID
        address[] memory participants = new address[](2);
        participants[0] = USER1;
        participants[1] = USER2;

        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: TARGET_CONTRACT,
            whitelisted: participants,
            enableFrostSignature: false
        });

        bytes32 returnedChannelId = bridgeCore.openChannel(params);
        assertEq(returnedChannelId, channelId, "Returned channel ID should match input");

        // Verify channel exists
        BridgeCore.ChannelState state = bridgeCore.getChannelState(channelId);
        assertEq(uint256(state), uint256(BridgeCore.ChannelState.Initialized), "Channel should be initialized");

        address leader = bridgeCore.getChannelLeader(channelId);
        assertEq(leader, address(this), "Channel leader should be correct");
    }

    function testDuplicateChannelId() public {
        bytes32 channelId = keccak256("test-channel");

        address[] memory participants = new address[](2);
        participants[0] = USER1;
        participants[1] = USER2;

        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: TARGET_CONTRACT,
            whitelisted: participants,
            enableFrostSignature: false
        });

        // First call should succeed
        bridgeCore.openChannel(params);

        // Second call with same ID should fail
        vm.expectRevert("Channel ID already exists");
        bridgeCore.openChannel(params);
    }

    function testZeroChannelId() public {
        address[] memory participants = new address[](2);
        participants[0] = USER1;
        participants[1] = USER2;

        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: bytes32(0),
            targetContract: TARGET_CONTRACT,
            whitelisted: participants,
            enableFrostSignature: false
        });

        vm.expectRevert("Channel ID cannot be zero");
        bridgeCore.openChannel(params);
    }

    function testGenerateChannelId() public view {
        address leader = address(0x123);
        bytes32 salt1 = bytes32(uint256(1));
        bytes32 salt2 = bytes32(uint256(2));

        bytes32 id1 = bridgeCore.generateChannelId(leader, salt1);
        bytes32 id2 = bridgeCore.generateChannelId(leader, salt2);

        // Different salts should produce different IDs
        assertNotEq(id1, id2, "Different salts should produce different channel IDs");

        // Same inputs should produce same ID
        bytes32 id3 = bridgeCore.generateChannelId(leader, salt1);
        assertEq(id1, id3, "Same inputs should produce same channel ID");
    }
}



================================================
FILE: test/bridge/ModularArchitectureTest.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "forge-std/console.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/ITokamakVerifier.sol";
import "../../src/interface/IZecFrost.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import "../../src/library/ZecFrost.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "@openzeppelin/token/ERC20/ERC20.sol";

// Mock contracts for testing
contract MockTokamakVerifier is ITokamakVerifier {
    function verify(
        uint128[] calldata,
        uint256[] calldata,
        uint128[] calldata,
        uint256[] calldata,
        uint256[] calldata,
        uint256
    ) external pure returns (bool) {
        return true;
    }
}

contract MockGroth16Verifier is IGroth16Verifier16Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[33] calldata)
        external
        pure
        returns (bool)
    {
        return true;
    }
}

contract TestToken is ERC20 {
    constructor() ERC20("Test Token", "TEST") {
        _mint(msg.sender, 1000000 ether);
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}

/**
 * @title ModularArchitectureTest
 * @notice Test that demonstrates the working modular architecture
 */
contract ModularArchitectureTest is Test {
    BridgeCore public bridge;
    BridgeProofManager public proofManager;
    BridgeDepositManager public depositManager;
    BridgeAdminManager public adminManager;

    MockTokamakVerifier public tokamakVerifier;
    MockGroth16Verifier public groth16Verifier;
    ZecFrost public zecFrost;
    TestToken public testToken;

    address public owner = makeAddr("owner");
    address public leader = makeAddr("leader");
    address public user1 = makeAddr("user1");
    address public user2 = makeAddr("user2");
    address public user3 = makeAddr("user3");

    function setUp() public {
        vm.startPrank(owner);

        // Deploy mock contracts
        tokamakVerifier = new MockTokamakVerifier();
        groth16Verifier = new MockGroth16Verifier();
        zecFrost = new ZecFrost();
        testToken = new TestToken();

        // Deploy manager implementations
        BridgeDepositManager depositManagerImpl = new BridgeDepositManager();
        BridgeProofManager proofManagerImpl = new BridgeProofManager();
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();

        // Deploy core contract with proxy first
        BridgeCore implementation = new BridgeCore();
        bytes memory bridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(0), address(0), address(0), address(0), owner) // Temporary addresses
        );
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(implementation), bridgeInitData);
        bridge = BridgeCore(address(bridgeProxy));

        // Deploy manager proxies with bridge address
        bytes memory depositInitData = abi.encodeCall(BridgeDepositManager.initialize, (address(bridge), owner));
        ERC1967Proxy depositProxy = new ERC1967Proxy(address(depositManagerImpl), depositInitData);
        depositManager = BridgeDepositManager(address(depositProxy));

        address[4] memory groth16Verifiers =
            [address(groth16Verifier), address(groth16Verifier), address(groth16Verifier), address(groth16Verifier)];
        bytes memory proofInitData = abi.encodeCall(
            BridgeProofManager.initialize,
            (address(bridge), address(tokamakVerifier), address(zecFrost), groth16Verifiers, owner)
        );
        ERC1967Proxy proofProxy = new ERC1967Proxy(address(proofManagerImpl), proofInitData);
        proofManager = BridgeProofManager(address(proofProxy));

        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        // Update bridge with manager addresses
        bridge.updateManagerAddresses(address(depositManager), address(proofManager), address(0), address(adminManager));

        // Register the test token and its transfer function
        uint128[] memory preprocessedPart1 = new uint128[](4);
        uint256[] memory preprocessedPart2 = new uint256[](4);
        bytes32 transferSig = keccak256("transfer(address,uint256)");

        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);
        adminManager.registerFunction(
            address(testToken), transferSig, preprocessedPart1, preprocessedPart2, keccak256("test_instance_hash")
        );

        // Fund test accounts
        vm.deal(leader, 10 ether);
        vm.deal(user1, 10 ether);
        vm.deal(user2, 10 ether);
        vm.deal(user3, 10 ether);

        // Mint test tokens for users and leader
        testToken.mint(user1, 1000 ether);
        testToken.mint(user2, 1000 ether);
        testToken.mint(user3, 1000 ether);
        testToken.mint(leader, 1000 ether);

        vm.stopPrank();
    }

    function testModularArchitectureBasic() public view {
        // Test that all contracts are properly deployed
        assertEq(bridge.owner(), owner);
        assertEq(depositManager.owner(), owner);
        assertEq(proofManager.owner(), owner);

        // Test that managers are properly linked
        assertEq(address(depositManager.bridge()), address(bridge));
        assertEq(address(proofManager.bridge()), address(bridge));
    }

    function testGetImplementationAddress() public view {
        // Test that getImplementation() returns the correct implementation addresses
        address bridgeImpl = bridge.getImplementation();
        address depositImpl = depositManager.getImplementation();
        address proofImpl = proofManager.getImplementation();

        // Verify that implementation addresses are not zero and not the proxy addresses
        assertTrue(bridgeImpl != address(0), "Bridge implementation should not be zero");
        assertTrue(depositImpl != address(0), "Deposit manager implementation should not be zero");
        assertTrue(proofImpl != address(0), "Proof manager implementation should not be zero");

        assertTrue(bridgeImpl != address(bridge), "Implementation should not equal proxy address");
        assertTrue(depositImpl != address(depositManager), "Implementation should not equal proxy address");
        assertTrue(proofImpl != address(proofManager), "Implementation should not equal proxy address");

        console.log("Bridge proxy:", address(bridge));
        console.log("Bridge implementation:", bridgeImpl);
        console.log("Deposit manager proxy:", address(depositManager));
        console.log("Deposit manager implementation:", depositImpl);
        console.log("Proof manager proxy:", address(proofManager));
        console.log("Proof manager implementation:", proofImpl);
    }

    function testChannelCreationAndDeposits() public {
        // Create a channel
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "testBasicChannelOperations"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(testToken),
            whitelisted: participants,
            enableFrostSignature: true
        });

        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(channelId, 1, 2);
        vm.stopPrank();

        // Verify channel creation
        assertEq(returnedChannelId, channelId);
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(BridgeCore.ChannelState.Initialized));
        assertEq(bridge.getChannelTargetContract(channelId), address(testToken));

        // Test deposit using DepositManager
        vm.startPrank(user1);
        testToken.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(uint256(123));
        depositManager.depositToken(channelId, 1 ether, mptKeys);
        vm.stopPrank();

        // Verify deposit was recorded
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 1 ether);
        assertEq(bridge.getL2MptKey(channelId, user1, 0), 123);
    }

    function testChannelStateInitialization() public {
        // Create and deposit to a channel
        bytes32 channelId = _createChannelWithDeposits();

        // Get the actual leader who created the channel
        address actualLeader = bridge.getChannelLeader(channelId);

        // Initialize channel state using ProofManager (leader is the channel creator)
        vm.roll(30); // Set block number high enough to avoid underflow in block.number - 3
        vm.startPrank(actualLeader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
                pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
                pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
                merkleRoot: keccak256(abi.encodePacked("mockRoot"))
            })
        );
        vm.stopPrank();

        // Verify state transition
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(BridgeCore.ChannelState.Open));
    }

    function _createChannelWithDeposits() internal returns (bytes32 channelId) {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        channelId = keccak256(abi.encode(address(this), block.timestamp, "createChannelWithDeposits"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(testToken),
            whitelisted: participants,
            enableFrostSignature: true
        });

        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(channelId, 1, 2);

        // Leader must deposit before initializing
        testToken.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(999));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Add deposits
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(uint256(123));
        vm.startPrank(user1);
        testToken.approve(address(depositManager), 1 ether);
        depositManager.depositToken(channelId, 1 ether, mptKeys1);
        vm.stopPrank();

        bytes32[] memory mptKeys2 = new bytes32[](1);
        mptKeys2[0] = bytes32(uint256(456));
        vm.startPrank(user2);
        testToken.approve(address(depositManager), 2 ether);
        depositManager.depositToken(channelId, 2 ether, mptKeys2);
        vm.stopPrank();

        bytes32[] memory mptKeys3 = new bytes32[](1);
        mptKeys3[0] = bytes32(uint256(789));
        vm.startPrank(user3);
        testToken.approve(address(depositManager), 3 ether);
        depositManager.depositToken(channelId, 3 ether, mptKeys3);
        vm.stopPrank();
    }

    function testChannelWithoutFrostSignature() public {
        vm.prank(leader);
        address[] memory participants = new address[](2);
        participants[0] = user1;
        participants[1] = user2;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "testDisableFrostSignature"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(testToken),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);

        // Verify frost signature is disabled for this channel
        assertFalse(bridge.isFrostSignatureEnabled(channelId));

        // Verify channel was created successfully
        assertTrue(bridge.isChannelWhitelisted(channelId, user1));
        assertTrue(bridge.isChannelWhitelisted(channelId, user2));
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Initialized));

        // Test that deposit works without setting public key
        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(uint256(123));
        vm.startPrank(user1);
        testToken.approve(address(depositManager), 1 ether);
        depositManager.depositToken(channelId, 1 ether, mptKeys);
        vm.stopPrank();

        // Verify deposit was recorded
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 1 ether);
        assertEq(bridge.getL2MptKey(channelId, user1, 0), 123);
    }
}



================================================
FILE: test/bridge/MptKeysAndPubSignals.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/ITokamakVerifier.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import "../../src/library/ZecFrost.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "@openzeppelin/token/ERC20/ERC20.sol";

// Simple ERC20 token (no additional storage slots)
contract SimpleToken is ERC20 {
    constructor() ERC20("Simple Token", "SIMPLE") {
        _mint(msg.sender, 1000000 ether);
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}

// USDT-like token with blacklist functionality (1 additional storage slot)
contract USDTToken is ERC20 {
    mapping(address => bool) private _isBlackListed;

    constructor() ERC20("Mock USDT", "USDT") {
        _mint(msg.sender, 1000000 ether);
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }

    function addBlackList(address user) external {
        _isBlackListed[user] = true;
    }

    function removeBlackList(address user) external {
        _isBlackListed[user] = false;
    }

    function isBlackListed(address user) external view returns (bool) {
        return _isBlackListed[user];
    }
}

contract MockTokamakVerifier is ITokamakVerifier {
    function verify(uint128[] calldata, uint256[] calldata, uint128[] calldata, uint256[] calldata, uint256[] calldata, uint256)
        external
        pure
        returns (bool)
    {
        return true;
    }
}

contract MockGroth16Verifier is IGroth16Verifier16Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[33] calldata)
        external
        pure
        returns (bool)
    {
        return true;
    }
}

/**
 * @title MptKeysAndPubSignalsTest
 * @notice Tests for MPT keys storage and pubSignals array construction in initializeChannelState
 */
contract MptKeysAndPubSignalsTest is Test {
    BridgeCore public bridge;
    BridgeProofManager public proofManager;
    BridgeDepositManager public depositManager;
    BridgeAdminManager public adminManager;

    MockTokamakVerifier public tokamakVerifier;
    MockGroth16Verifier public groth16Verifier;
    ZecFrost public zecFrost;
    SimpleToken public simpleToken;
    USDTToken public usdtToken;

    address public owner = makeAddr("owner");
    address public leader = makeAddr("leader");
    address public user1 = makeAddr("user1");
    address public user2 = makeAddr("user2");
    address public user3 = makeAddr("user3");

    // MPT keys for testing
    uint256 constant USER1_BALANCE_MPT_KEY = 1001;
    uint256 constant USER1_BLACKLIST_MPT_KEY = 2001;
    uint256 constant USER2_BALANCE_MPT_KEY = 1002;
    uint256 constant USER2_BLACKLIST_MPT_KEY = 2002;
    uint256 constant USER3_BALANCE_MPT_KEY = 1003;
    uint256 constant USER3_BLACKLIST_MPT_KEY = 2003;

    function setUp() public {
        vm.roll(100); // Set block number to avoid underflow

        vm.startPrank(owner);

        // Deploy mock contracts
        tokamakVerifier = new MockTokamakVerifier();
        groth16Verifier = new MockGroth16Verifier();
        zecFrost = new ZecFrost();
        simpleToken = new SimpleToken();
        usdtToken = new USDTToken();

        // Deploy manager implementations
        BridgeDepositManager depositManagerImpl = new BridgeDepositManager();
        BridgeProofManager proofManagerImpl = new BridgeProofManager();
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();

        // Deploy core contract with proxy
        BridgeCore implementation = new BridgeCore();
        bytes memory bridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(0), address(0), address(0), address(0), owner)
        );
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(implementation), bridgeInitData);
        bridge = BridgeCore(address(bridgeProxy));

        // Deploy manager proxies
        bytes memory depositInitData = abi.encodeCall(BridgeDepositManager.initialize, (address(bridge), owner));
        ERC1967Proxy depositProxy = new ERC1967Proxy(address(depositManagerImpl), depositInitData);
        depositManager = BridgeDepositManager(address(depositProxy));

        address[4] memory groth16Verifiers = [
            address(groth16Verifier),
            address(groth16Verifier),
            address(groth16Verifier),
            address(groth16Verifier)
        ];
        bytes memory proofInitData = abi.encodeCall(
            BridgeProofManager.initialize,
            (address(bridge), address(tokamakVerifier), address(zecFrost), groth16Verifiers, owner)
        );
        ERC1967Proxy proofProxy = new ERC1967Proxy(address(proofManagerImpl), proofInitData);
        proofManager = BridgeProofManager(address(proofProxy));

        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        // Update manager addresses
        bridge.updateManagerAddresses(
            address(depositManager), address(proofManager), address(0), address(adminManager)
        );

        // Register simple token with balance slot only
        IBridgeCore.PreAllocatedLeaf[] memory emptyLeaves = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory simpleSlots = new IBridgeCore.UserStorageSlot[](1);
        simpleSlots[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0, // balance slot
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false // balance comes from deposits
        });
        adminManager.setAllowedTargetContract(address(simpleToken), emptyLeaves, simpleSlots, true);

        // Register USDT token with balance + isBlackListed storage slots
        IBridgeCore.UserStorageSlot[] memory usdtSlots = new IBridgeCore.UserStorageSlot[](2);
        usdtSlots[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 2, // USDT balance slot
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false // balance comes from deposits
        });
        usdtSlots[1] = IBridgeCore.UserStorageSlot({
            slotOffset: 6, // USDT isBlackListed slot
            getterFunctionSignature: bytes32(bytes4(keccak256("isBlackListed(address)"))),
            isLoadedOnChain: true // fetched from chain
        });
        adminManager.setAllowedTargetContract(address(usdtToken), emptyLeaves, usdtSlots, true);

        // Mint tokens to participants and leader
        simpleToken.mint(user1, 100 ether);
        simpleToken.mint(user2, 100 ether);
        simpleToken.mint(user3, 100 ether);
        simpleToken.mint(leader, 100 ether);
        usdtToken.mint(user1, 100 ether);
        usdtToken.mint(user2, 100 ether);
        usdtToken.mint(user3, 100 ether);
        usdtToken.mint(leader, 100 ether);

        vm.stopPrank();
    }

    // ========== MPT KEYS STORAGE TESTS ==========

    function testMptKeysStoredCorrectlyForSimpleToken() public {
        bytes32 channelId = _createSimpleTokenChannel();

        // User1 deposits with 1 MPT key (balance only)
        vm.startPrank(user1);
        simpleToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys = new bytes32[](1);
        mptKeys[0] = bytes32(USER1_BALANCE_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys);
        vm.stopPrank();

        // Verify MPT key stored correctly at slot 0
        uint256 storedKey = bridge.getL2MptKey(channelId, user1, 0);
        assertEq(storedKey, USER1_BALANCE_MPT_KEY, "Balance MPT key not stored correctly");
    }

    function testMptKeysStoredCorrectlyForUSDTToken() public {
        bytes32 channelId = _createUSDTChannel();

        // User1 deposits with 2 MPT keys (balance + isBlackListed)
        vm.startPrank(user1);
        usdtToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys = new bytes32[](2);
        mptKeys[0] = bytes32(USER1_BALANCE_MPT_KEY);
        mptKeys[1] = bytes32(USER1_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys);
        vm.stopPrank();

        // Verify MPT keys stored correctly at respective slots
        uint256 balanceKey = bridge.getL2MptKey(channelId, user1, 0);
        uint256 blacklistKey = bridge.getL2MptKey(channelId, user1, 1);

        assertEq(balanceKey, USER1_BALANCE_MPT_KEY, "Balance MPT key not stored correctly");
        assertEq(blacklistKey, USER1_BLACKLIST_MPT_KEY, "Blacklist MPT key not stored correctly");
    }

    function testMptKeysStoredCorrectlyForMultipleUsers() public {
        bytes32 channelId = _createUSDTChannel();

        // User1 deposits
        vm.startPrank(user1);
        usdtToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](2);
        mptKeys1[0] = bytes32(USER1_BALANCE_MPT_KEY);
        mptKeys1[1] = bytes32(USER1_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        // User2 deposits
        vm.startPrank(user2);
        usdtToken.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](2);
        mptKeys2[0] = bytes32(USER2_BALANCE_MPT_KEY);
        mptKeys2[1] = bytes32(USER2_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        // User3 deposits
        vm.startPrank(user3);
        usdtToken.approve(address(depositManager), 15 ether);
        bytes32[] memory mptKeys3 = new bytes32[](2);
        mptKeys3[0] = bytes32(USER3_BALANCE_MPT_KEY);
        mptKeys3[1] = bytes32(USER3_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 15 ether, mptKeys3);
        vm.stopPrank();

        // Verify all MPT keys stored correctly
        assertEq(bridge.getL2MptKey(channelId, user1, 0), USER1_BALANCE_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user1, 1), USER1_BLACKLIST_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user2, 0), USER2_BALANCE_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user2, 1), USER2_BLACKLIST_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user3, 0), USER3_BALANCE_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user3, 1), USER3_BLACKLIST_MPT_KEY);
    }

    function testMptKeysCountMismatchReverts() public {
        bytes32 channelId = _createUSDTChannel();

        // Try to deposit with wrong number of MPT keys (1 instead of 2)
        vm.startPrank(user1);
        usdtToken.approve(address(depositManager), 10 ether);
        bytes32[] memory wrongMptKeys = new bytes32[](1);
        wrongMptKeys[0] = bytes32(USER1_BALANCE_MPT_KEY);

        vm.expectRevert("MPT keys count mismatch");
        depositManager.depositToken(channelId, 10 ether, wrongMptKeys);
        vm.stopPrank();
    }

    function testMptKeysTooManyReverts() public {
        bytes32 channelId = _createSimpleTokenChannel();

        // Try to deposit with too many MPT keys (2 instead of 1)
        vm.startPrank(user1);
        simpleToken.approve(address(depositManager), 10 ether);
        bytes32[] memory wrongMptKeys = new bytes32[](2);
        wrongMptKeys[0] = bytes32(USER1_BALANCE_MPT_KEY);
        wrongMptKeys[1] = bytes32(USER1_BLACKLIST_MPT_KEY);

        vm.expectRevert("MPT keys count mismatch");
        depositManager.depositToken(channelId, 10 ether, wrongMptKeys);
        vm.stopPrank();
    }

    // ========== PUBSIGNALS INPUT DATA VERIFICATION TESTS ==========
    // These tests verify that all the data that goes into pubSignals construction is correct

    function testPubSignalsInputsForSimpleToken() public {
        bytes32 channelId = _createSimpleTokenChannel();

        // Leader must deposit before initializing
        vm.startPrank(leader);
        simpleToken.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(999));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // User1 deposits 10 ether
        vm.startPrank(user1);
        simpleToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(USER1_BALANCE_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        // User2 deposits 20 ether
        vm.startPrank(user2);
        simpleToken.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](1);
        mptKeys2[0] = bytes32(USER2_BALANCE_MPT_KEY);
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        // Verify all inputs that go into pubSignals are correct
        address[] memory participants = bridge.getChannelParticipants(channelId);
        assertEq(participants.length, 3, "Should have 3 participants (leader + 2 users)");
        assertEq(participants[0], leader);
        assertEq(participants[1], user1);
        assertEq(participants[2], user2);

        // Verify balances
        assertEq(bridge.getValidatedUserSlotValue(channelId, leader, 0), 1 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 10 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user2, 0), 20 ether);

        // Verify MPT keys for balance slot (slot 0)
        assertEq(bridge.getL2MptKey(channelId, user1, 0), USER1_BALANCE_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user2, 0), USER2_BALANCE_MPT_KEY);

        // Verify tree size
        assertEq(bridge.getChannelTreeSize(channelId), 16);

        // Initialize channel to verify the proof manager accepts the data
        bytes32 merkleRoot = keccak256("testMerkleRoot");
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
                pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
                pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
                merkleRoot: merkleRoot
            })
        );

        // Verify channel state changed to Open (proves initialization succeeded)
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Open));
    }

    function testPubSignalsInputsForUSDTToken() public {
        bytes32 channelId = _createUSDTChannel();

        // Leader must deposit before initializing
        vm.startPrank(leader);
        usdtToken.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](2);
        mptKeysLeader[0] = bytes32(uint256(998));
        mptKeysLeader[1] = bytes32(uint256(999));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // User1 deposits 10 ether (will not be blacklisted)
        vm.startPrank(user1);
        usdtToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](2);
        mptKeys1[0] = bytes32(USER1_BALANCE_MPT_KEY);
        mptKeys1[1] = bytes32(USER1_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        // User2 deposits 20 ether (will be blacklisted after deposit)
        vm.startPrank(user2);
        usdtToken.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](2);
        mptKeys2[0] = bytes32(USER2_BALANCE_MPT_KEY);
        mptKeys2[1] = bytes32(USER2_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        // Blacklist user2 AFTER deposit
        vm.prank(owner);
        usdtToken.addBlackList(user2);

        // Verify all inputs that go into pubSignals
        address[] memory participants = bridge.getChannelParticipants(channelId);
        assertEq(participants.length, 3, "Should have 3 participants (leader + 2 users)");
        assertEq(participants[0], leader);
        assertEq(participants[1], user1);
        assertEq(participants[2], user2);

        // Verify balances
        assertEq(bridge.getValidatedUserSlotValue(channelId, leader, 0), 1 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 10 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user2, 0), 20 ether);

        // Verify MPT keys for balance slot (slot 0)
        assertEq(bridge.getL2MptKey(channelId, user1, 0), USER1_BALANCE_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user2, 0), USER2_BALANCE_MPT_KEY);

        // Verify MPT keys for blacklist slot (slot 1)
        assertEq(bridge.getL2MptKey(channelId, user1, 1), USER1_BLACKLIST_MPT_KEY);
        assertEq(bridge.getL2MptKey(channelId, user2, 1), USER2_BLACKLIST_MPT_KEY);

        // Verify blacklist status (will be fetched via staticcall during initialization)
        assertFalse(usdtToken.isBlackListed(user1), "user1 should not be blacklisted");
        assertTrue(usdtToken.isBlackListed(user2), "user2 should be blacklisted");

        // Verify tree size (3 participants * 2 slots = 6 leaves, fits in tree size 16)
        assertEq(bridge.getChannelTreeSize(channelId), 16);

        // Initialize channel to verify the proof manager accepts the data
        bytes32 merkleRoot = keccak256("testMerkleRoot");
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
                pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
                pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
                merkleRoot: merkleRoot
            })
        );

        // Verify channel state changed to Open
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Open));
    }

    function testPubSignalsConstructionLogic() public {
        bytes32 channelId = _createUSDTChannel();

        // Leader must deposit before initializing
        vm.startPrank(leader);
        usdtToken.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](2);
        mptKeysLeader[0] = bytes32(uint256(998));
        mptKeysLeader[1] = bytes32(uint256(999));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Setup: 3 users deposit with specific MPT keys and amounts
        vm.startPrank(user1);
        usdtToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](2);
        mptKeys1[0] = bytes32(USER1_BALANCE_MPT_KEY);
        mptKeys1[1] = bytes32(USER1_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        usdtToken.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](2);
        mptKeys2[0] = bytes32(USER2_BALANCE_MPT_KEY);
        mptKeys2[1] = bytes32(USER2_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        vm.startPrank(user3);
        usdtToken.approve(address(depositManager), 15 ether);
        bytes32[] memory mptKeys3 = new bytes32[](2);
        mptKeys3[0] = bytes32(USER3_BALANCE_MPT_KEY);
        mptKeys3[1] = bytes32(USER3_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 15 ether, mptKeys3);
        vm.stopPrank();

        // Blacklist user3
        vm.prank(owner);
        usdtToken.addBlackList(user3);

        // Manually construct what pubSignals SHOULD look like
        // Based on initializeChannelState logic:
        // pubSignals[0] = merkleRoot
        // For treeSize=16:
        //   Indices 1-16: keys
        //   Indices 17-32: values
        // Order: ALL balance leaves first, then ALL blacklist leaves

        uint256 treeSize = bridge.getChannelTreeSize(channelId);
        assertEq(treeSize, 16, "Tree size should be 16");

        address[] memory participants = bridge.getChannelParticipants(channelId);
        assertEq(participants.length, 4, "Should have 4 participants (leader + 3 users)");
        assertEq(participants[0], leader, "First participant should be leader");
        assertEq(participants[1], user1, "Second participant should be user1");
        assertEq(participants[2], user2, "Third participant should be user2");
        assertEq(participants[3], user3, "Fourth participant should be user3");

        // Verify balances for users (not checking leader's MPT key as it uses different constant)
        assertEq(bridge.getL2MptKey(channelId, user1, 0), USER1_BALANCE_MPT_KEY, "user1 balance key");
        assertEq(bridge.getL2MptKey(channelId, user2, 0), USER2_BALANCE_MPT_KEY, "user2 balance key");
        assertEq(bridge.getL2MptKey(channelId, user3, 0), USER3_BALANCE_MPT_KEY, "user3 balance key");
        assertEq(bridge.getL2MptKey(channelId, user1, 1), USER1_BLACKLIST_MPT_KEY, "user1 blacklist key");
        assertEq(bridge.getL2MptKey(channelId, user2, 1), USER2_BLACKLIST_MPT_KEY, "user2 blacklist key");
        assertEq(bridge.getL2MptKey(channelId, user3, 1), USER3_BLACKLIST_MPT_KEY, "user3 blacklist key");

        assertEq(bridge.getValidatedUserSlotValue(channelId, leader, 0), 1 ether, "leader balance");
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 10 ether, "user1 balance");
        assertEq(bridge.getValidatedUserSlotValue(channelId, user2, 0), 20 ether, "user2 balance");
        assertEq(bridge.getValidatedUserSlotValue(channelId, user3, 0), 15 ether, "user3 balance");
        assertEq(usdtToken.isBlackListed(leader) ? 1 : 0, 0, "leader not blacklisted");
        assertEq(usdtToken.isBlackListed(user1) ? 1 : 0, 0, "user1 not blacklisted");
        assertEq(usdtToken.isBlackListed(user2) ? 1 : 0, 0, "user2 not blacklisted");
        assertEq(usdtToken.isBlackListed(user3) ? 1 : 0, 1, "user3 is blacklisted");

        // Initialize channel to confirm the proof manager constructs pubSignals correctly
        bytes32 merkleRoot = keccak256("testMerkleRoot");
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
                pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
                pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
                merkleRoot: merkleRoot
            })
        );

        // Channel initialization succeeded
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Open));
    }

    function testPubSignalsOrderingIsCorrect() public {
        // This test verifies the ordering: ALL balance leaves first, then ALL additional storage slot leaves
        bytes32 channelId = _createUSDTChannel();

        // Leader must deposit before initializing
        vm.startPrank(leader);
        usdtToken.approve(address(depositManager), 1 ether);
        bytes32[] memory mptKeysLeader = new bytes32[](2);
        mptKeysLeader[0] = bytes32(uint256(998));
        mptKeysLeader[1] = bytes32(uint256(999));
        depositManager.depositToken(channelId, 1 ether, mptKeysLeader);
        vm.stopPrank();

        // Deposit for all 3 users
        vm.startPrank(user1);
        usdtToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](2);
        mptKeys1[0] = bytes32(USER1_BALANCE_MPT_KEY);
        mptKeys1[1] = bytes32(USER1_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        usdtToken.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](2);
        mptKeys2[0] = bytes32(USER2_BALANCE_MPT_KEY);
        mptKeys2[1] = bytes32(USER2_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        vm.startPrank(user3);
        usdtToken.approve(address(depositManager), 15 ether);
        bytes32[] memory mptKeys3 = new bytes32[](2);
        mptKeys3[0] = bytes32(USER3_BALANCE_MPT_KEY);
        mptKeys3[1] = bytes32(USER3_BLACKLIST_MPT_KEY);
        depositManager.depositToken(channelId, 15 ether, mptKeys3);
        vm.stopPrank();

        // Get participants to verify ordering
        address[] memory participants = bridge.getChannelParticipants(channelId);

        // The pubSignals should be ordered as:
        // [0]: merkleRoot
        // [1]: participants[0] balance key (leader)
        // [2]: participants[1] balance key (user1)
        // [3]: participants[2] balance key (user2)
        // [4]: participants[3] balance key (user3)
        // [5]: participants[0] blacklist key (leader)
        // [6]: participants[1] blacklist key (user1)
        // [7]: participants[2] blacklist key (user2)
        // [8]: participants[3] blacklist key (user3)
        // ... zeros until treeSize
        // [treeSize+1]: participants[0] balance value
        // etc.

        // Verify participants are in expected order (leader first, then users)
        assertEq(participants.length, 4, "Should have 4 participants");
        assertEq(participants[0], leader);
        assertEq(participants[1], user1);
        assertEq(participants[2], user2);
        assertEq(participants[3], user3);

        // Initialize to confirm the construction works
        vm.prank(leader);
        proofManager.initializeChannelState(
            channelId,
            BridgeProofManager.ChannelInitializationProof({
                pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
                pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
                pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
                merkleRoot: keccak256("testRoot")
            })
        );

        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Open));
    }

    // ========== HELPER FUNCTIONS ==========

    function _createSimpleTokenChannel() internal returns (bytes32 channelId) {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        channelId = keccak256(abi.encode(address(this), block.timestamp, "simpleTokenChannel"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(simpleToken),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bridge.openChannel(params);
        vm.stopPrank();
    }

    function _createUSDTChannel() internal returns (bytes32 channelId) {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        channelId = keccak256(abi.encode(address(this), block.timestamp, "usdtChannel"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(usdtToken),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bridge.openChannel(params);
        vm.stopPrank();
    }
}



================================================
FILE: test/bridge/PreAllocatedLeaves.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeAdminManager.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "@openzeppelin/token/ERC20/ERC20.sol";

contract TestToken is ERC20 {
    constructor() ERC20("Test Token", "TEST") {
        _mint(msg.sender, 1000000 ether);
    }
}

/**
 * @title PreAllocatedLeavesTest
 * @notice Test the pre-allocated leaves system
 */
contract PreAllocatedLeavesTest is Test {
    BridgeCore public bridge;
    BridgeAdminManager public adminManager;
    TestToken public testToken;

    address public owner = makeAddr("owner");
    address public user1 = makeAddr("user1");
    address public user2 = makeAddr("user2");

    function setUp() public {
        vm.startPrank(owner);

        testToken = new TestToken();

        // Deploy core contract with proxy
        BridgeCore implementation = new BridgeCore();
        bytes memory bridgeInitData =
            abi.encodeCall(BridgeCore.initialize, (address(0), address(0), address(0), address(0), owner));
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(implementation), bridgeInitData);
        bridge = BridgeCore(address(bridgeProxy));

        // Deploy admin manager
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();
        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        // Update bridge with manager addresses
        bridge.updateManagerAddresses(address(0), address(0), address(0), address(adminManager));

        vm.stopPrank();
    }

    function testSetupTonTransferPreAllocatedLeaf() public {
        vm.startPrank(owner);

        // First allow the target contract
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);

        // Setup TON transfer pre-allocated leaf
        adminManager.setupTonTransferPreAllocatedLeaf(address(testToken));

        // Verify the pre-allocated leaf was set correctly
        (uint256 value, bool exists) = adminManager.getPreAllocatedLeaf(address(testToken), bytes32(uint256(0x07)));
        assertTrue(exists, "Pre-allocated leaf should exist");
        assertEq(value, 18, "Pre-allocated leaf value should be 18 (decimals)");

        // Get all pre-allocated keys
        bytes32[] memory keys = bridge.getPreAllocatedKeys(address(testToken));
        assertEq(keys.length, 1, "Should have 1 pre-allocated key");
        assertEq(keys[0], bytes32(uint256(0x07)), "First key should be 0x07");

        vm.stopPrank();
    }

    function testCustomPreAllocatedLeaf() public {
        vm.startPrank(owner);

        // First allow the target contract
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);

        // Set a custom pre-allocated leaf
        bytes32 customKey = bytes32(uint256(0x42));
        uint256 customValue = 1337;
        adminManager.setPreAllocatedLeaf(address(testToken), customKey, customValue);

        // Verify the custom pre-allocated leaf
        (uint256 value, bool exists) = adminManager.getPreAllocatedLeaf(address(testToken), customKey);
        assertTrue(exists, "Custom pre-allocated leaf should exist");
        assertEq(value, customValue, "Custom pre-allocated leaf value should match");

        vm.stopPrank();
    }

    function testMultiplePreAllocatedLeaves() public {
        vm.startPrank(owner);

        // First allow the target contract
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);

        // Set multiple pre-allocated leaves
        adminManager.setPreAllocatedLeaf(address(testToken), bytes32(uint256(0x01)), 100);
        adminManager.setPreAllocatedLeaf(address(testToken), bytes32(uint256(0x02)), 200);
        adminManager.setPreAllocatedLeaf(address(testToken), bytes32(uint256(0x03)), 300);

        // Get all pre-allocated keys
        bytes32[] memory keys = bridge.getPreAllocatedKeys(address(testToken));
        assertEq(keys.length, 3, "Should have 3 pre-allocated keys");

        vm.stopPrank();
    }

    function testRemovePreAllocatedLeaf() public {
        vm.startPrank(owner);

        // First allow the target contract
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);

        // Set a pre-allocated leaf
        bytes32 testKey = bytes32(uint256(0x42));
        adminManager.setPreAllocatedLeaf(address(testToken), testKey, 1337);

        // Verify it exists
        (uint256 value, bool exists) = adminManager.getPreAllocatedLeaf(address(testToken), testKey);
        assertTrue(exists, "Pre-allocated leaf should exist");

        // Remove it
        adminManager.removePreAllocatedLeaf(address(testToken), testKey);

        // Verify it no longer exists
        (value, exists) = adminManager.getPreAllocatedLeaf(address(testToken), testKey);
        assertFalse(exists, "Pre-allocated leaf should not exist after removal");

        vm.stopPrank();
    }

    function testChannelOpeningWithPreAllocatedLeaves() public {
        vm.startPrank(owner);

        // First allow the target contract
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);

        // Setup TON transfer pre-allocated leaf (1 leaf)
        adminManager.setupTonTransferPreAllocatedLeaf(address(testToken));

        vm.stopPrank();

        // Create participants
        // With 1 balance slot: numberOfUserStorageSlot = 1
        // With 1 pre-allocated leaf: preAllocatedCount = 1
        // maxAllowedParticipants = ((128 - 1) / 1) - 1 = 127 - 1 = 126
        address[] memory participants = new address[](126);
        for (uint256 i = 0; i < 126; i++) {
            participants[i] = address(uint160(i + 1));
        }

        vm.startPrank(user1);

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "preAllocTest1"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(testToken),
            whitelisted: participants,
            enableFrostSignature: true
        });

        // This should succeed with 126 participants (plus leader = 127 total)
        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);

        // Verify the channel has the correct pre-allocated leaves count
        uint256 preAllocatedCount = bridge.getChannelPreAllocatedLeavesCount(returnedChannelId);
        assertEq(preAllocatedCount, 1, "Channel should have 1 pre-allocated leaf");

        vm.stopPrank();
    }

    function testChannelOpeningFailsWithTooManyParticipants() public {
        vm.startPrank(owner);

        // First allow the target contract
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(testToken), emptySlots, balanceSlot, true);

        // Setup TON transfer pre-allocated leaf (1 leaf)
        adminManager.setupTonTransferPreAllocatedLeaf(address(testToken));

        vm.stopPrank();

        // Try to create with 127 participants (max is 126, should fail)
        // maxAllowedParticipants = ((128 - 1) / 1) - 1 = 127 - 1 = 126
        address[] memory participants = new address[](127);
        for (uint256 i = 0; i < 127; i++) {
            participants[i] = address(uint160(i + 1));
        }

        vm.startPrank(user1);

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "preAllocTest2"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(testToken),
            whitelisted: participants,
            enableFrostSignature: true
        });

        // This should fail
        vm.expectRevert("Invalid whitelisted count considering pre-allocated leaves");
        bridge.openChannel(params);

        vm.stopPrank();
    }
}



================================================
FILE: test/bridge/ProofSubmission.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeWithdrawManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/ITokamakVerifier.sol";
import "../../src/interface/IZecFrost.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import {ZecFrost} from "../../src/library/ZecFrost.sol";
import {TokamakVerifier} from "../../src/verifier/TokamakVerifier.sol";
import {Groth16Verifier16Leaves} from "../../src/verifier/Groth16Verifier16Leaves.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "@openzeppelin/token/ERC20/ERC20.sol";

// Mock Contracts
contract MockTokamakVerifier is ITokamakVerifier {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verify(
        uint128[] calldata,
        uint256[] calldata,
        uint128[] calldata,
        uint256[] calldata,
        uint256[] calldata,
        uint256
    ) external view override returns (bool) {
        return shouldVerify;
    }
}

contract MockZecFrost is IZecFrost {
    address public mockSigner;

    constructor() {
        mockSigner = address(this);
    }

    function verify(bytes32, uint256, uint256, uint256, uint256, uint256) external view override returns (address) {
        return mockSigner;
    }

    function setMockSigner(address _signer) external {
        mockSigner = _signer;
    }
}

contract MockGroth16Verifier is IGroth16Verifier16Leaves {
    bool public shouldVerify = true;

    function setShouldVerify(bool _should) external {
        shouldVerify = _should;
    }

    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[33] calldata)
        external
        view
        returns (bool)
    {
        return shouldVerify;
    }
}

contract TestERC20 is ERC20 {
    constructor(string memory name, string memory symbol, uint8 _decimals) ERC20(name, symbol) {
        _setupDecimals(_decimals);
    }

    function _setupDecimals(uint8 _decimals) internal {
        // Note: This is a simplified mock. In production, you'd use OpenZeppelin's approach
        // For testing purposes, we'll just mint tokens to test addresses
    }

    function mint(address to, uint256 amount) public {
        _mint(to, amount);
    }

    function decimals() public view virtual override returns (uint8) {
        return super.decimals();
    }
}

contract ProofSubmissionTest is Test {
    BridgeCore public bridge;
    BridgeDepositManager public depositManager;
    BridgeProofManager public proofManager;
    BridgeWithdrawManager public withdrawManager;
    BridgeAdminManager public adminManager;

    MockTokamakVerifier public mockVerifier;
    MockZecFrost public mockZecFrost;
    MockGroth16Verifier public mockGroth16Verifier;

    TestERC20 public token;

    address public leader = address(0x1);
    address public user1 = address(0x2);
    address public user2 = address(0x3);
    address public owner = address(0x4);

    uint128[] public proofPart1;
    uint256[] public proofPart2;
    uint256[] public publicInputs;

    function setUp() public {
        vm.startPrank(owner);

        // Deploy mock contracts
        mockVerifier = new MockTokamakVerifier();
        mockZecFrost = new MockZecFrost();
        mockGroth16Verifier = new MockGroth16Verifier();

        // Deploy test token
        token = new TestERC20("TestToken", "TT", 18);

        // Deploy implementation contracts
        BridgeCore bridgeImpl = new BridgeCore();
        BridgeDepositManager depositManagerImpl = new BridgeDepositManager();
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();
        BridgeProofManager proofManagerImpl = new BridgeProofManager();
        BridgeWithdrawManager withdrawManagerImpl = new BridgeWithdrawManager();

        address[4] memory groth16Verifiers = [
            address(mockGroth16Verifier),
            address(mockGroth16Verifier),
            address(mockGroth16Verifier),
            address(mockGroth16Verifier)
        ];

        // Deploy bridge with proxy pattern first
        bytes memory bridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(0), address(0), address(0), address(0), owner) // Temporary addresses
        );
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(bridgeImpl), bridgeInitData);
        bridge = BridgeCore(payable(address(bridgeProxy)));

        // Deploy manager contracts as proxies
        bytes memory depositInitData = abi.encodeCall(BridgeDepositManager.initialize, (address(bridge), owner));
        ERC1967Proxy depositProxy = new ERC1967Proxy(address(depositManagerImpl), depositInitData);
        depositManager = BridgeDepositManager(address(depositProxy));

        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        bytes memory proofInitData = abi.encodeCall(
            BridgeProofManager.initialize,
            (address(bridge), address(mockVerifier), address(mockZecFrost), groth16Verifiers, owner)
        );
        ERC1967Proxy proofProxy = new ERC1967Proxy(address(proofManagerImpl), proofInitData);
        proofManager = BridgeProofManager(address(proofProxy));

        bytes memory withdrawInitData = abi.encodeCall(BridgeWithdrawManager.initialize, (address(bridge), owner));
        ERC1967Proxy withdrawProxy = new ERC1967Proxy(address(withdrawManagerImpl), withdrawInitData);
        withdrawManager = BridgeWithdrawManager(payable(address(withdrawProxy)));

        // Update bridge with manager addresses
        bridge.updateManagerAddresses(
            address(depositManager), address(proofManager), address(withdrawManager), address(adminManager)
        );

        // Register the test token and its transfer function
        uint128[] memory preprocessedPart1 = new uint128[](4);
        uint256[] memory preprocessedPart2 = new uint256[](4);
        bytes32 transferSig = bytes32(bytes4(keccak256("transfer(address,uint256)")));

        // Use the actual registered function instance hash from the deployed contract
        bytes32 functionInstanceHash = 0xd157cb883adb9cb0e27d9dc419e2a4be817d856281b994583b5bae64be94d35a;

        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(token), emptySlots, balanceSlot, true);
        adminManager.registerFunction(
            address(token), transferSig, preprocessedPart1, preprocessedPart2, functionInstanceHash
        );

        vm.stopPrank();
    }

    function setupChannelWithDeposits() public returns (bytes32 channelId) {
        vm.startPrank(leader);
        vm.deal(leader, 10 ether);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = leader;

        channelId = keccak256(abi.encode(address(this), block.timestamp, "proofSubmissionChannel"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: true
        });

        bytes32 returnedChannelId = bridge.openChannel(params);
        assertEq(returnedChannelId, channelId);
        bridge.setChannelPublicKey(
            channelId,
            0x51909117a840e98bbcf1aae0375c6e85920b641edee21518cb79a19ac347f638,
            0xf2cf51268a560b92b57994c09af3c129e7f5646a48e668564edde80fd5076c6e
        );
        vm.stopPrank();

        // Make deposits to become participants
        token.mint(user1, 1000e18);
        vm.startPrank(user1);
        token.approve(address(depositManager), 2e18);
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(uint256(10));
        depositManager.depositToken(channelId, 2e18, mptKeys1);
        vm.stopPrank();

        token.mint(user2, 1000e18);
        vm.startPrank(user2);
        token.approve(address(depositManager), 500e18);
        bytes32[] memory mptKeys2 = new bytes32[](1);
        mptKeys2[0] = bytes32(uint256(20));
        depositManager.depositToken(channelId, 500e18, mptKeys2);
        vm.stopPrank();

        token.mint(leader, 1000e18);
        vm.startPrank(leader);
        token.approve(address(depositManager), 1e18);
        bytes32[] memory mptKeys3 = new bytes32[](1);
        mptKeys3[0] = bytes32(uint256(30));
        depositManager.depositToken(channelId, 1e18, mptKeys3);
        vm.stopPrank();
    }

    function computeCorrectFunctionInstanceHash() public pure returns (bytes32) {
        uint256[] memory correctData = new uint256[](446);

        // Set specific known values that should hash to the correct instance hash
        correctData[0] = 0x01;
        correctData[1] = 0xffffffffffffffffffffffffffffffff;
        correctData[2] = 0xffffffff;

        return keccak256(abi.encodePacked(correctData));
    }

    function testcheckInstanceHash() public pure {
        bytes32 expectedHash = computeCorrectFunctionInstanceHash();
        console.logBytes32(expectedHash);
    }
}



================================================
FILE: test/bridge/TimeoutWithdrawal.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeWithdrawManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/ITokamakVerifier.sol";
import "../../src/interface/IZecFrost.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import "../../src/interface/IGroth16Verifier32Leaves.sol";
import "../../src/interface/IGroth16Verifier64Leaves.sol";
import "../../src/interface/IGroth16Verifier128Leaves.sol";
import "lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";

// Mock Contracts
contract MockToken is ERC20 {
    uint8 private _decimals;

    constructor(string memory name, string memory symbol, uint8 decimals_) ERC20(name, symbol) {
        _decimals = decimals_;
    }

    function decimals() public view override returns (uint8) {
        return _decimals;
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }
}

contract MockZecFrost is IZecFrost {
    function verify(bytes32 message, uint256 pkx, uint256 pky, uint256 rx, uint256 ry, uint256 z)
        external
        pure
        returns (address)
    {
        // Always return a fixed address for testing
        return address(0x1234567890123456789012345678901234567890);
    }
}

contract MockTokamakVerifier is ITokamakVerifier {
    function verify(
        uint128[] calldata proofPart1,
        uint256[] calldata proofPart2,
        uint128[] calldata preprocessedPart1,
        uint256[] calldata preprocessedPart2,
        uint256[] calldata publicInputs,
        uint256 smax
    ) external pure returns (bool) {
        return true;
    }
}

contract MockGroth16Verifier is IGroth16Verifier16Leaves, IGroth16Verifier32Leaves, IGroth16Verifier64Leaves, IGroth16Verifier128Leaves {
    function verifyProof(uint256[4] calldata pA, uint256[8] calldata pB, uint256[4] calldata pC, uint256[33] calldata publicSignals)
        external
        pure
        returns (bool)
    {
        return true;
    }

    function verifyProof(uint256[4] calldata pA, uint256[8] calldata pB, uint256[4] calldata pC, uint256[65] calldata publicSignals)
        external
        pure
        returns (bool)
    {
        return true;
    }

    function verifyProof(uint256[4] calldata pA, uint256[8] calldata pB, uint256[4] calldata pC, uint256[129] calldata publicSignals)
        external
        pure
        returns (bool)
    {
        return true;
    }

    function verifyProof(uint256[4] calldata pA, uint256[8] calldata pB, uint256[4] calldata pC, uint256[257] calldata publicSignals)
        external
        pure
        returns (bool)
    {
        return true;
    }
}

contract TimeoutWithdrawalTest is Test {
    BridgeCore public bridge;
    BridgeDepositManager public depositManager;
    BridgeProofManager public proofManager;
    BridgeWithdrawManager public withdrawManager;
    BridgeAdminManager public adminManager;
    MockToken public token;
    MockTokamakVerifier public zkVerifier;
    MockZecFrost public zecFrost;
    MockGroth16Verifier public groth16Verifier16;
    MockGroth16Verifier public groth16Verifier32;
    MockGroth16Verifier public groth16Verifier64;
    MockGroth16Verifier public groth16Verifier128;

    address public owner = address(this);
    address public leader = makeAddr("leader");
    address public user1 = makeAddr("user1");
    address public user2 = makeAddr("user2");
    address public user3 = makeAddr("user3");

    bytes32 public channelId;
    uint256 public constant DEPOSIT_AMOUNT = 1 ether;

    event Withdrawn(bytes32 indexed channelId, address indexed user, address token, uint256 amount);

    function setUp() public {
        // Set proper block number to avoid underflow in blockhash calculations
        vm.roll(10);
        
        // Deploy mock contracts
        token = new MockToken("TestToken", "TT", 18);
        zkVerifier = new MockTokamakVerifier();
        zecFrost = new MockZecFrost();
        groth16Verifier16 = new MockGroth16Verifier();
        groth16Verifier32 = new MockGroth16Verifier();
        groth16Verifier64 = new MockGroth16Verifier();
        groth16Verifier128 = new MockGroth16Verifier();

        // Deploy manager implementations
        BridgeDepositManager depositManagerImpl = new BridgeDepositManager();
        BridgeWithdrawManager withdrawManagerImpl = new BridgeWithdrawManager();
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();
        BridgeProofManager proofManagerImpl = new BridgeProofManager();

        // Deploy core contract with proxy first
        BridgeCore implementation = new BridgeCore();
        bytes memory bridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(0), address(0), address(0), address(0), owner) // Temporary addresses
        );
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(implementation), bridgeInitData);
        bridge = BridgeCore(address(bridgeProxy));

        // Deploy manager proxies with bridge address
        bytes memory depositInitData = abi.encodeCall(BridgeDepositManager.initialize, (address(bridge), owner));
        ERC1967Proxy depositProxy = new ERC1967Proxy(address(depositManagerImpl), depositInitData);
        depositManager = BridgeDepositManager(address(depositProxy));

        bytes memory withdrawInitData = abi.encodeCall(BridgeWithdrawManager.initialize, (address(bridge), owner));
        ERC1967Proxy withdrawProxy = new ERC1967Proxy(address(withdrawManagerImpl), withdrawInitData);
        withdrawManager = BridgeWithdrawManager(address(withdrawProxy));

        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        address[4] memory groth16Verifiers = [
            address(groth16Verifier16),
            address(groth16Verifier32),
            address(groth16Verifier64),
            address(groth16Verifier128)
        ];
        bytes memory proofInitData = abi.encodeCall(
            BridgeProofManager.initialize,
            (address(bridge), address(zkVerifier), address(zecFrost), groth16Verifiers, owner)
        );
        ERC1967Proxy proofProxy = new ERC1967Proxy(address(proofManagerImpl), proofInitData);
        proofManager = BridgeProofManager(address(proofProxy));

        // Update managers to point to the correct bridge and update bridge with manager addresses
        vm.startPrank(owner);
        
        // Create a new bridge with the correct manager addresses
        BridgeCore newImplementation = new BridgeCore();
        bytes memory correctBridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(depositManager), address(proofManager), address(withdrawManager), address(adminManager), owner)
        );
        ERC1967Proxy newBridgeProxy = new ERC1967Proxy(address(newImplementation), correctBridgeInitData);
        bridge = BridgeCore(address(newBridgeProxy));

        // Update all managers to point to the new bridge
        depositManager.updateBridge(address(bridge));
        withdrawManager.updateBridge(address(bridge));
        proofManager.updateBridge(address(bridge));
        adminManager.updateBridge(address(bridge));
        
        vm.stopPrank();

        // Set up allowed target contract with balance slot
        vm.startPrank(owner);
        IBridgeCore.PreAllocatedLeaf[] memory emptyLeaves = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(token), emptyLeaves, balanceSlot, true);
        vm.stopPrank();

        // Mint tokens to participants and leader
        token.mint(user1, 10 ether);
        token.mint(user2, 10 ether);
        token.mint(user3, 10 ether);
        token.mint(leader, 10 ether);

        // Setup channel
        _setupChannel();
    }

    function _setupChannel() internal {
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        channelId = keccak256(abi.encode(leader, block.timestamp, "timeout_test"));

        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(token),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bridge.openChannel(params);

        // Leader must deposit before initializing
        token.approve(address(depositManager), DEPOSIT_AMOUNT);
        bytes32[] memory mptKeysLeader = new bytes32[](1);
        mptKeysLeader[0] = bytes32(uint256(999));
        depositManager.depositToken(channelId, DEPOSIT_AMOUNT, mptKeysLeader);
        vm.stopPrank();

        // Make deposits
        _makeDeposits();
    }

    function _makeDeposits() internal {
        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        for (uint256 i = 0; i < participants.length; i++) {
            vm.startPrank(participants[i]);
            token.approve(address(depositManager), DEPOSIT_AMOUNT);
            bytes32[] memory mptKeys = new bytes32[](1);
            mptKeys[0] = bytes32(uint256(i + 1));
            depositManager.depositToken(channelId, DEPOSIT_AMOUNT, mptKeys);
            vm.stopPrank();
        }
    }

    function _initializeChannel() internal {
        vm.startPrank(leader);
        
        BridgeProofManager.ChannelInitializationProof memory mockProof = BridgeProofManager.ChannelInitializationProof({
            pA: [uint256(1), uint256(2), uint256(3), uint256(4)],
            pB: [uint256(5), uint256(6), uint256(7), uint256(8), uint256(9), uint256(10), uint256(11), uint256(12)],
            pC: [uint256(13), uint256(14), uint256(15), uint256(16)],
            merkleRoot: keccak256(abi.encodePacked("mockRoot"))
        });
        
        proofManager.initializeChannelState(channelId, mockProof);
        vm.stopPrank();
    }

    function testWithdrawOnTimeoutSuccess() public {
        _initializeChannel();

        // Fast forward past timeout
        vm.warp(block.timestamp + bridge.CHANNEL_TIMEOUT() + 1);

        uint256 initialTokenBalance = token.balanceOf(user1);

        vm.expectEmit(true, true, true, true);
        emit Withdrawn(channelId, user1, address(token), DEPOSIT_AMOUNT);

        vm.prank(user1);
        withdrawManager.withdraw(channelId, address(token));

        // Check user received their deposit back
        assertEq(token.balanceOf(user1), initialTokenBalance + DEPOSIT_AMOUNT);

        // Verify user's validatedUserStorage is cleared after withdrawal
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 0);
    }

    function testWithdrawOnTimeoutBeforeTimeout() public {
        _initializeChannel();

        vm.expectRevert("Channel must be deleted or timed out");
        vm.prank(user1);
        withdrawManager.withdraw(channelId, address(token));
    }

    function testWithdrawOnTimeoutAlreadyWithdrawn() public {
        _initializeChannel();

        // Fast forward past timeout
        vm.warp(block.timestamp + bridge.CHANNEL_TIMEOUT() + 1);

        // First withdrawal
        vm.prank(user1);
        withdrawManager.withdraw(channelId, address(token));

        // Try to withdraw again
        vm.expectRevert("No withdrawable amount");
        vm.prank(user1);
        withdrawManager.withdraw(channelId, address(token));
    }

    function testWithdrawOnTimeoutNotParticipant() public {
        _initializeChannel();

        // Fast forward past timeout
        vm.warp(block.timestamp + bridge.CHANNEL_TIMEOUT() + 1);

        address nonParticipant = makeAddr("nonParticipant");

        vm.expectRevert("No withdrawable amount");
        vm.prank(nonParticipant);
        withdrawManager.withdraw(channelId, address(token));
    }



    function testMultipleUsersCanWithdrawOnTimeout() public {
        _initializeChannel();

        // Fast forward past timeout
        vm.warp(block.timestamp + bridge.CHANNEL_TIMEOUT() + 1);

        uint256 user1InitialBalance = token.balanceOf(user1);
        uint256 user2InitialBalance = token.balanceOf(user2);

        // User1 withdraws
        vm.prank(user1);
        withdrawManager.withdraw(channelId, address(token));

        // User2 withdraws
        vm.prank(user2);
        withdrawManager.withdraw(channelId, address(token));

        // Both should have received their deposits back
        assertEq(token.balanceOf(user1), user1InitialBalance + DEPOSIT_AMOUNT);
        assertEq(token.balanceOf(user2), user2InitialBalance + DEPOSIT_AMOUNT);

        // Verify both users' validatedUserStorage is cleared after withdrawal
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 0);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user2, 0), 0);
    }

    function _submitMockProof() internal {
        BridgeProofManager.ProofData[] memory proofs = new BridgeProofManager.ProofData[](1);
        uint256[] memory publicInputs = new uint256[](64);
        
        // Get the initial state root from the channel
        bytes32 initialStateRoot = bridge.getChannelInitialStateRoot(channelId);
        bytes32 finalStateRoot = keccak256(abi.encodePacked("finalRoot"));
        
        // Set required public inputs for state root validation
        publicInputs[0] = uint256(finalStateRoot) >> 128; // final state root part 1
        publicInputs[1] = uint256(finalStateRoot) & ((1 << 128) - 1); // final state root part 2
        publicInputs[8] = uint256(initialStateRoot) >> 128; // initial state root part 1
        publicInputs[9] = uint256(initialStateRoot) & ((1 << 128) - 1); // initial state root part 2
        
        // Set block info data to match the stored blockInfosHash
        bytes32 storedBlockInfoHash = bridge.getChannelBlockInfosHash(channelId);
        // For mock purposes, we'll just set some basic block info that should work
        for (uint256 i = 40; i < 64; i += 2) {
            publicInputs[i] = 0; // mock block info data - simplified for testing
            publicInputs[i + 1] = 0;
        }
        
        proofs[0] = BridgeProofManager.ProofData({
            proofPart1: new uint128[](8),
            proofPart2: new uint256[](8), 
            publicInputs: publicInputs,
            smax: 1000
        });

        BridgeProofManager.Signature memory signature = BridgeProofManager.Signature({
            message: bytes32(0),
            rx: 0,
            ry: 0,
            z: 0
        });

        proofManager.submitProofAndSignature(channelId, proofs, signature);
    }
}


================================================
FILE: test/bridge/UserStorageSlots.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/BridgeDepositManager.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/ITokamakVerifier.sol";
import "../../src/interface/IZecFrost.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import "../../src/library/ZecFrost.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "@openzeppelin/token/ERC20/ERC20.sol";

// Mock USDT-like token with blacklist functionality
contract MockUSDT is ERC20 {
    mapping(address => bool) private _isBlackListed;

    constructor() ERC20("Mock USDT", "USDT") {
        _mint(msg.sender, 1000000 ether);
    }

    function mint(address to, uint256 amount) external {
        _mint(to, amount);
    }

    function addBlackList(address _evilUser) external {
        _isBlackListed[_evilUser] = true;
    }

    function removeBlackList(address _clearedUser) external {
        _isBlackListed[_clearedUser] = false;
    }

    function isBlackListed(address _maker) external view returns (bool) {
        return _isBlackListed[_maker];
    }

    // Override transfer to check blacklist
    function transfer(address to, uint256 amount) public override returns (bool) {
        require(!_isBlackListed[msg.sender], "Sender is blacklisted");
        require(!_isBlackListed[to], "Recipient is blacklisted");
        return super.transfer(to, amount);
    }

    function transferFrom(address from, address to, uint256 amount) public override returns (bool) {
        require(!_isBlackListed[from], "Sender is blacklisted");
        require(!_isBlackListed[to], "Recipient is blacklisted");
        return super.transferFrom(from, to, amount);
    }
}

contract MockTokamakVerifier is ITokamakVerifier {
    function verify(
        uint128[] calldata,
        uint256[] calldata,
        uint128[] calldata,
        uint256[] calldata,
        uint256[] calldata,
        uint256
    ) external pure returns (bool) {
        return true;
    }
}

contract MockGroth16Verifier is IGroth16Verifier16Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[33] calldata)
        external
        pure
        returns (bool)
    {
        return true;
    }
}

/**
 * @title UserStorageSlotsTest
 * @notice Test initializeChannelState with additional user storage slots (like USDT's isBlackListed)
 */
contract UserStorageSlotsTest is Test {
    BridgeCore public bridge;
    BridgeProofManager public proofManager;
    BridgeDepositManager public depositManager;
    BridgeAdminManager public adminManager;

    MockTokamakVerifier public tokamakVerifier;
    MockGroth16Verifier public groth16Verifier;
    ZecFrost public zecFrost;
    MockUSDT public usdt;

    address public owner = makeAddr("owner");
    address public leader = makeAddr("leader");
    address public user1 = makeAddr("user1");
    address public user2 = makeAddr("user2");
    address public user3 = makeAddr("user3");

    function setUp() public {
        // Set block number to avoid underflow in blockhash calculations
        vm.roll(100);

        vm.startPrank(owner);

        // Deploy mock contracts
        tokamakVerifier = new MockTokamakVerifier();
        groth16Verifier = new MockGroth16Verifier();
        zecFrost = new ZecFrost();
        usdt = new MockUSDT();

        // Deploy manager implementations
        BridgeDepositManager depositManagerImpl = new BridgeDepositManager();
        BridgeProofManager proofManagerImpl = new BridgeProofManager();
        BridgeAdminManager adminManagerImpl = new BridgeAdminManager();

        // Deploy core contract with proxy
        BridgeCore implementation = new BridgeCore();
        bytes memory bridgeInitData = abi.encodeCall(
            BridgeCore.initialize,
            (address(0), address(0), address(0), address(0), owner)
        );
        ERC1967Proxy bridgeProxy = new ERC1967Proxy(address(implementation), bridgeInitData);
        bridge = BridgeCore(address(bridgeProxy));

        // Deploy manager proxies
        bytes memory depositInitData = abi.encodeCall(BridgeDepositManager.initialize, (address(bridge), owner));
        ERC1967Proxy depositProxy = new ERC1967Proxy(address(depositManagerImpl), depositInitData);
        depositManager = BridgeDepositManager(address(depositProxy));

        address[4] memory groth16Verifiers =
            [address(groth16Verifier), address(groth16Verifier), address(groth16Verifier), address(groth16Verifier)];
        bytes memory proofInitData = abi.encodeCall(
            BridgeProofManager.initialize,
            (address(bridge), address(tokamakVerifier), address(zecFrost), groth16Verifiers, owner)
        );
        ERC1967Proxy proofProxy = new ERC1967Proxy(address(proofManagerImpl), proofInitData);
        proofManager = BridgeProofManager(address(proofProxy));

        bytes memory adminInitData = abi.encodeCall(BridgeAdminManager.initialize, (address(bridge), owner));
        ERC1967Proxy adminProxy = new ERC1967Proxy(address(adminManagerImpl), adminInitData);
        adminManager = BridgeAdminManager(address(adminProxy));

        // Update manager addresses
        bridge.updateManagerAddresses(
            address(depositManager), address(proofManager), address(0), address(adminManager)
        );
        depositManager.updateBridge(address(bridge));
        proofManager.updateBridge(address(bridge));
        adminManager.updateBridge(address(bridge));

        // Set up USDT as allowed target contract with balance + isBlackListed slots
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory userStorageSlots = new IBridgeCore.UserStorageSlot[](2);

        // Slot 0: balance (not loaded from chain, comes from deposits)
        userStorageSlots[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 2, // USDT balance slot offset
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });

        // Slot 1: isBlackListed (loaded from chain via staticcall)
        userStorageSlots[1] = IBridgeCore.UserStorageSlot({
            slotOffset: 6, // USDT isBlackListed slot offset
            getterFunctionSignature: bytes32(bytes4(keccak256("isBlackListed(address)"))),
            isLoadedOnChain: true
        });

        adminManager.setAllowedTargetContract(address(usdt), emptySlots, userStorageSlots, true);

        // Mint tokens to participants
        usdt.mint(leader, 100 ether);
        usdt.mint(user1, 100 ether);
        usdt.mint(user2, 100 ether);
        usdt.mint(user3, 100 ether);

        vm.stopPrank();
    }

    function testInitializeChannelStateWithBlacklistSlot() public {
        // Create channel
        vm.startPrank(leader);

        address[] memory participants = new address[](3);
        participants[0] = user1;
        participants[1] = user2;
        participants[2] = user3;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "testBlacklist"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(usdt),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bridge.openChannel(params);
        vm.stopPrank();

        // Deposit tokens (2 mptKeys each: balance + isBlackListed)
        vm.startPrank(user1);
        usdt.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](2);
        mptKeys1[0] = bytes32(uint256(1)); // balance slot
        mptKeys1[1] = bytes32(uint256(101)); // isBlackListed slot
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        usdt.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](2);
        mptKeys2[0] = bytes32(uint256(2));
        mptKeys2[1] = bytes32(uint256(102));
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        vm.startPrank(user3);
        usdt.approve(address(depositManager), 15 ether);
        bytes32[] memory mptKeys3 = new bytes32[](2);
        mptKeys3[0] = bytes32(uint256(3));
        mptKeys3[1] = bytes32(uint256(103));
        depositManager.depositToken(channelId, 15 ether, mptKeys3);
        vm.stopPrank();

        // Leader deposits to participate
        vm.startPrank(leader);
        usdt.approve(address(depositManager), 5 ether);
        bytes32[] memory mptKeys4 = new bytes32[](2);
        mptKeys4[0] = bytes32(uint256(4));
        mptKeys4[1] = bytes32(uint256(104));
        depositManager.depositToken(channelId, 5 ether, mptKeys4);
        vm.stopPrank();

        // Blacklist user3 AFTER deposits (to test staticcall fetches blacklist status correctly)
        vm.prank(owner);
        usdt.addBlackList(user3);

        // Verify balances are tracked
        assertEq(bridge.getValidatedUserSlotValue(channelId, user1, 0), 10 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user2, 0), 20 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, user3, 0), 15 ether);
        assertEq(bridge.getValidatedUserSlotValue(channelId, leader, 0), 5 ether);

        // Verify blacklist status
        assertFalse(usdt.isBlackListed(user1));
        assertFalse(usdt.isBlackListed(user2));
        assertTrue(usdt.isBlackListed(user3)); // user3 is blacklisted
        assertFalse(usdt.isBlackListed(leader));

        // Initialize channel state with proof
        vm.startPrank(leader);

        uint256[4] memory pA;
        uint256[8] memory pB;
        uint256[4] memory pC;

        BridgeProofManager.ChannelInitializationProof memory proof = BridgeProofManager.ChannelInitializationProof({
            merkleRoot: bytes32(uint256(123456)),
            pA: pA,
            pB: pB,
            pC: pC
        });

        // This should work - the proof manager will fetch both balance and isBlackListed status
        // Tree structure will be:
        // - 4 participants
        // - Each has 2 leaves: balance + isBlackListed
        // - Total: 8 user leaves (4 participants * 2 slots each)
        // - Tree size should be 16 (minimum that fits 8 leaves)
        proofManager.initializeChannelState(channelId, proof);

        vm.stopPrank();

        // Verify channel state changed to Open
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Open));

        // Verify tree size is correct (should be 16 to accommodate 4 participants * 2 storage slots each)
        assertEq(bridge.getChannelTreeSize(channelId), 16);
    }

    function testInitializeChannelStateWithoutBlacklist() public {
        // Create channel with simple ERC20 (no additional storage slots)
        MockUSDT simpleToken = new MockUSDT();

        vm.startPrank(owner);
        simpleToken.mint(leader, 100 ether);
        simpleToken.mint(user1, 100 ether);
        simpleToken.mint(user2, 100 ether);

        // Set up simple token with balance slot only
        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(address(simpleToken), emptySlots, balanceSlot, true);
        vm.stopPrank();

        // Create channel
        vm.startPrank(leader);

        address[] memory participants = new address[](2);
        participants[0] = user1;
        participants[1] = user2;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "testSimple"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(simpleToken),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bridge.openChannel(params);
        vm.stopPrank();

        // Deposit tokens (1 mptKey each: balance only for simple token)
        vm.startPrank(user1);
        simpleToken.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](1);
        mptKeys1[0] = bytes32(uint256(1));
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        simpleToken.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](1);
        mptKeys2[0] = bytes32(uint256(2));
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        vm.startPrank(leader);
        simpleToken.approve(address(depositManager), 5 ether);
        bytes32[] memory mptKeys3 = new bytes32[](1);
        mptKeys3[0] = bytes32(uint256(3));
        depositManager.depositToken(channelId, 5 ether, mptKeys3);
        vm.stopPrank();

        // Initialize channel state with proof
        vm.startPrank(leader);

        uint256[4] memory pA;
        uint256[8] memory pB;
        uint256[4] memory pC;

        BridgeProofManager.ChannelInitializationProof memory proof = BridgeProofManager.ChannelInitializationProof({
            merkleRoot: bytes32(uint256(123456)),
            pA: pA,
            pB: pB,
            pC: pC
        });

        // This should work - only balance leaves (no additional storage slots)
        // Tree structure will be:
        // - 3 participants
        // - Each has 1 leaf: balance only
        // - Total: 3 user leaves
        // - Tree size should be 16 (minimum)
        proofManager.initializeChannelState(channelId, proof);

        vm.stopPrank();

        // Verify channel state changed to Open
        assertEq(uint8(bridge.getChannelState(channelId)), uint8(IBridgeCore.ChannelState.Open));

        // Verify tree size (should be 16 for 3 participants with 1 slot each)
        assertEq(bridge.getChannelTreeSize(channelId), 16);
    }

    function testVerifyFinalBalancesWithUserStorageSlots() public {
        // Create channel with USDT (has isBlackListed slot)
        vm.startPrank(leader);

        address[] memory participants = new address[](2);
        participants[0] = user1;
        participants[1] = user2;

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, "testFinalBalances"));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: address(usdt),
            whitelisted: participants,
            enableFrostSignature: false
        });

        bridge.openChannel(params);
        vm.stopPrank();

        // Deposit tokens (2 mptKeys each: balance + isBlackListed)
        vm.startPrank(user1);
        usdt.approve(address(depositManager), 10 ether);
        bytes32[] memory mptKeys1 = new bytes32[](2);
        mptKeys1[0] = bytes32(uint256(1));
        mptKeys1[1] = bytes32(uint256(101));
        depositManager.depositToken(channelId, 10 ether, mptKeys1);
        vm.stopPrank();

        vm.startPrank(user2);
        usdt.approve(address(depositManager), 20 ether);
        bytes32[] memory mptKeys2 = new bytes32[](2);
        mptKeys2[0] = bytes32(uint256(2));
        mptKeys2[1] = bytes32(uint256(102));
        depositManager.depositToken(channelId, 20 ether, mptKeys2);
        vm.stopPrank();

        // Leader deposits to participate
        vm.startPrank(leader);
        usdt.approve(address(depositManager), 5 ether);
        bytes32[] memory mptKeys3 = new bytes32[](2);
        mptKeys3[0] = bytes32(uint256(3));
        mptKeys3[1] = bytes32(uint256(103));
        depositManager.depositToken(channelId, 5 ether, mptKeys3);
        vm.stopPrank();

        // Initialize channel state
        vm.startPrank(leader);

        uint256[4] memory pA;
        uint256[8] memory pB;
        uint256[4] memory pC;

        BridgeProofManager.ChannelInitializationProof memory initProof = BridgeProofManager.ChannelInitializationProof({
            merkleRoot: bytes32(uint256(123456)),
            pA: pA,
            pB: pB,
            pC: pC
        });

        proofManager.initializeChannelState(channelId, initProof);
        vm.stopPrank();

        // Set channel to Closing state manually for testing
        vm.prank(address(proofManager));
        bridge.setChannelState(channelId, BridgeCore.ChannelState.Closing);

        // Set final state root
        vm.prank(address(proofManager));
        bridge.setChannelFinalStateRoot(channelId, bytes32(uint256(789012)));

        // Verify final balances with user storage slots
        vm.startPrank(leader);

        // Final slot values: [balance, isBlackListed] for each participant
        uint256[][] memory finalSlotValues = new uint256[][](3);
        finalSlotValues[0] = new uint256[](2); // user1: balance + not blacklisted
        finalSlotValues[0][0] = 8 ether;       // balance
        finalSlotValues[0][1] = 0;             // not blacklisted
        finalSlotValues[1] = new uint256[](2); // user2: balance + not blacklisted
        finalSlotValues[1][0] = 22 ether;      // balance
        finalSlotValues[1][1] = 0;             // not blacklisted
        finalSlotValues[2] = new uint256[](2); // leader: balance + not blacklisted
        finalSlotValues[2][0] = 5 ether;       // balance
        finalSlotValues[2][1] = 0;             // not blacklisted

        // Permutation array: First all balances (3), then all isBlackListed (3) = 6 entries total
        uint256[] memory permutation = new uint256[](6);
        permutation[0] = 0; // user1 balance
        permutation[1] = 1; // user2 balance
        permutation[2] = 2; // leader balance
        permutation[3] = 3; // user1 isBlackListed
        permutation[4] = 4; // user2 isBlackListed
        permutation[5] = 5; // leader isBlackListed

        BridgeProofManager.ChannelFinalizationProof memory finalProof = BridgeProofManager.ChannelFinalizationProof({
            pA: pA,
            pB: pB,
            pC: pC
        });

        proofManager.updateValidatedUserStorage(channelId, finalSlotValues, permutation, finalProof);

        vm.stopPrank();

        // Verify channel was cleaned up (leader should be zero address)
        assertEq(bridge.getChannelLeader(channelId), address(0));
    }
}



================================================
FILE: test/bridge/VerifyFinalBalancesInput.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "../../src/BridgeProofManager.sol";
import "../../src/interface/IBridgeCore.sol";
import "../../src/interface/IGroth16Verifier16Leaves.sol";
import "../../src/interface/IGroth16Verifier32Leaves.sol";
import "../../src/interface/IGroth16Verifier64Leaves.sol";
import "../../src/interface/IGroth16Verifier128Leaves.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";

contract MockGroth16Verifier16 is IGroth16Verifier16Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[33] calldata)
        external
        pure
        override
        returns (bool)
    {
        return true;
    }
}

contract MockGroth16Verifier32 is IGroth16Verifier32Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[65] calldata)
        external
        pure
        override
        returns (bool)
    {
        return true;
    }
}

contract MockGroth16Verifier64 is IGroth16Verifier64Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[129] calldata)
        external
        pure
        override
        returns (bool)
    {
        return true;
    }
}

contract MockGroth16Verifier128 is IGroth16Verifier128Leaves {
    function verifyProof(uint256[4] calldata, uint256[8] calldata, uint256[4] calldata, uint256[257] calldata)
        external
        pure
        override
        returns (bool)
    {
        return true;
    }
}

contract MockBridgeCore {
    IBridgeCore.ChannelState public state;
    bool public frostEnabled;
    bool public signatureVerified;
    address[] public participants;
    bytes32 public finalStateRoot;
    uint256 public treeSize;
    address public targetContract;
    address public channelLeader;
    bool public isCleanedUp;
    mapping(address => mapping(uint8 => uint256)) public l2MptKeys;

    function setConfig(
        IBridgeCore.ChannelState _state,
        bool _frostEnabled,
        bool _signatureVerified,
        address[] calldata _participants,
        bytes32 _finalStateRoot,
        uint256 _treeSize,
        address _targetContract
    ) external {
        state = _state;
        frostEnabled = _frostEnabled;
        signatureVerified = _signatureVerified;
        finalStateRoot = _finalStateRoot;
        treeSize = _treeSize;
        targetContract = _targetContract;

        delete participants;
        for (uint256 i = 0; i < _participants.length; i++) {
            participants.push(_participants[i]);
        }
    }

    function setL2MptKey(address participant, uint8 slotIndex, uint256 key) external {
        l2MptKeys[participant][slotIndex] = key;
    }

    function getChannelState(bytes32) external view returns (IBridgeCore.ChannelState) {
        return state;
    }

    function isFrostSignatureEnabled(bytes32) external view returns (bool) {
        return frostEnabled;
    }

    function isSignatureVerified(bytes32) external view returns (bool) {
        return signatureVerified;
    }

    function getChannelParticipants(bytes32) external view returns (address[] memory) {
        return participants;
    }

    function getChannelFinalStateRoot(bytes32) external view returns (bytes32) {
        return finalStateRoot;
    }

    function getChannelTreeSize(bytes32) external view returns (uint256) {
        return treeSize;
    }

    function getChannelTargetContract(bytes32) external view returns (address) {
        return targetContract;
    }

    function getPreAllocatedLeavesCount(address) external pure returns (uint256) {
        return 0;
    }

    function getPreAllocatedKeys(address) external pure returns (bytes32[] memory keys) {
        return new bytes32[](0);
    }

    function getPreAllocatedLeaf(address, bytes32) external pure returns (uint256 value, bool exists) {
        return (0, false);
    }

    function getL2MptKey(bytes32, address participant, uint8 slotIndex) external view returns (uint256) {
        return l2MptKeys[participant][slotIndex];
    }

    function getTargetContractData(address) external pure returns (IBridgeCore.TargetContract memory) {
        // Return target contract data with balance slot only
        IBridgeCore.RegisteredFunction[] memory emptyFunctions = new IBridgeCore.RegisteredFunction[](0);
        IBridgeCore.PreAllocatedLeaf[] memory emptyLeaves = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false // balance comes from deposits
        });

        return IBridgeCore.TargetContract({
            preAllocatedLeaves: emptyLeaves,
            registeredFunctions: emptyFunctions,
            userStorageSlots: balanceSlot
        });
    }

    function setChannelValidatedUserStorage(bytes32, address[] memory, uint256[][] memory) external {}

    function getBalanceSlotIndex(address) external pure returns (uint8) {
        return 0; // Balance is always slot 0 in mock
    }

    function setChannelCloseTimestamp(bytes32, uint256) external {}

    function setChannelState(bytes32, IBridgeCore.ChannelState newState) external {
        state = newState;
    }

    function getChannelLeader(bytes32) external view returns (address) {
        return isCleanedUp ? address(0) : channelLeader;
    }

    function cleanupChannel(bytes32) external {
        isCleanedUp = true;
    }

    function setChannelLeader(address _leader) external {
        channelLeader = _leader;
        isCleanedUp = false;
    }
}

contract VerifyFinalBalancesInputTest is Test {
    BridgeProofManager private proofManager;
    MockBridgeCore private bridge;

    function setUp() public {
        bridge = new MockBridgeCore();
        MockGroth16Verifier16 verifier16 = new MockGroth16Verifier16();
        MockGroth16Verifier32 verifier32 = new MockGroth16Verifier32();
        MockGroth16Verifier64 verifier64 = new MockGroth16Verifier64();
        MockGroth16Verifier128 verifier128 = new MockGroth16Verifier128();

        BridgeProofManager implementation = new BridgeProofManager();
        address[4] memory groth16Verifiers =
            [address(verifier16), address(verifier32), address(verifier64), address(verifier128)];
        bytes memory initData = abi.encodeCall(
            BridgeProofManager.initialize, (address(bridge), address(0), address(0), groth16Verifiers, address(this))
        );
        ERC1967Proxy proxy = new ERC1967Proxy(address(implementation), initData);
        proofManager = BridgeProofManager(address(proxy));

        address[] memory participants = new address[](6);
        participants[0] = address(0x1);
        participants[1] = address(0x2);
        participants[2] = address(0x3);
        participants[3] = address(0x4);
        participants[4] = address(0x5);
        participants[5] = address(0x6);

        bridge.setConfig(
            IBridgeCore.ChannelState.Closing,
            false,
            false,
            participants,
            bytes32(uint256(0x1234)),
            16,
            address(0xBEEF)
        );

        // Set a channel leader for testing cleanup
        bridge.setChannelLeader(address(0x123));
    }

    function testVerifyFinalBalancesGroth16WithProvidedInputs() public {
        bytes32 channelId = bytes32(uint256(42));

        // Final slot values: balance only for each participant (slot 0)
        uint256[][] memory finalSlotValues = new uint256[][](6);
        finalSlotValues[0] = new uint256[](1);
        finalSlotValues[0][0] = 8_000000000000000000;
        finalSlotValues[1] = new uint256[](1);
        finalSlotValues[1][0] = 21_000000000000000000;
        finalSlotValues[2] = new uint256[](1);
        finalSlotValues[2][0] = 9_000000000000000000;
        finalSlotValues[3] = new uint256[](1);
        finalSlotValues[3][0] = 18_000000000000000000;
        finalSlotValues[4] = new uint256[](1);
        finalSlotValues[4][0] = 4_000000000000000000;
        finalSlotValues[5] = new uint256[](1);
        finalSlotValues[5][0] = 30_000000000000000000;

        uint256[] memory permutation = new uint256[](6);
        permutation[0] = 3;
        permutation[1] = 1;
        permutation[2] = 2;
        permutation[3] = 5;
        permutation[4] = 4;
        permutation[5] = 0;

        BridgeProofManager.ChannelFinalizationProof memory proof = BridgeProofManager.ChannelFinalizationProof({
            pA: [
                uint256(25546506726576549862703313676415253466),
                uint256(65946752761513164061266583987877524705193624113638805923614457567397607972749),
                uint256(24675421685932766870833412730604877816),
                uint256(58772741817313822323502079494608416713920431158614398725016740819096558635401)
            ],
            pB: [
                uint256(31347278282182569007908832442228656946),
                uint256(12665697616816053464553685608559496052136261122222142867729314109943591015754),
                uint256(6051998485137480424856207640890397089),
                uint256(87617300905886048105866437119239048073159957382564843056571516236237121608608),
                uint256(10634102124677411946799263515026313413),
                uint256(64040208428763102104370976949313845538807892975225355818699706868960574854068),
                uint256(9790437446372267409736494228062217688),
                uint256(84718647226524725255019004369863264203108205468972348680699883185005433632338)
            ],
            pC: [
                uint256(5813280287475954323271733704717975580),
                uint256(23763792764603797328692382840135723114106796924529151365650978050209750609770),
                uint256(3178742565597861311701415040477857415),
                uint256(44332132520306597723180470057924869519466279516040935671669539451214623582779)
            ]
        });

        (bool ok, bytes memory data) = address(proofManager).call(
            abi.encodeCall(
                BridgeProofManager.updateValidatedUserStorage, (channelId, finalSlotValues, permutation, proof)
            )
        );
        if (!ok) {
            revert(_decodeRevert(data));
        }
        // Channel should be cleaned up after verification, so leader should not exist
        assertEq(bridge.getChannelLeader(channelId), address(0));
    }

    function _decodeRevert(bytes memory data) private pure returns (string memory) {
        if (data.length < 68) {
            return "updateValidatedUserStorage reverted";
        }
        bytes4 selector;
        assembly {
            selector := mload(add(data, 0x20))
        }
        if (selector == 0x08c379a0) {
            assembly {
                data := add(data, 0x04)
            }
            return abi.decode(data, (string));
        }
        return "updateValidatedUserStorage reverted (non-string)";
    }
}



================================================
FILE: test/frost/ZecFrost.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0-only
pragma solidity 0.8.29;

import {Test, console} from "forge-std/Test.sol";
import {ZecFrost} from "../../src/library/ZecFrost.sol";

contract ZecFrostTest is Test {
    ZecFrost zecFrost;

    function setUp() public {
        zecFrost = new ZecFrost();
    }

    function test_Verify01() public view {
        bytes32 message = 0x4141414141414141414141414141414141414141414141414141414141414141;

        uint256 px = 0x4F6340CFDD930A6F54E730188E3071D150877FA664945FB6F120C18B56CE1C09;
        uint256 py = 0x802A5E67C00A70D85B9A088EAC7CF5B9FB46AC5C0B2BD7D1E189FAC210F6B7EF;

        uint256 rx = 0x501DCFE29D881AA855BF25979BD79F751AA9536AF7A389403CD345B02D1E6F25;
        uint256 ry = 0x839AD3B762F50FE560F4688A15A1CAED522919F33928567F95BC48CBD9B8C771;

        uint256 z = 0x4FDEA9858F3E6484F1F0D64E7C17879C25F68DA8BD0E82B063CF7410DDF5A886;

        address addr;
        assembly ("memory-safe") {
            mstore(0x00, px)
            mstore(0x20, py)
            addr := and(keccak256(0x00, 0x40), sub(shl(160, 1), 1))
        }

        uint256 gasStart = gasleft();
        address result = zecFrost.verify(message, px, py, rx, ry, z);
        uint256 gasUsed = gasStart - gasleft();

        console.log("Gas used by FROST.verify:", gasUsed);

        assertEq(result, addr);
    }

    function test_VerifyWithInvalidPublicKey() public view {
        // bug originally found here:
        // https://github.com/chronicleprotocol/scribe/issues/56
        // merkleplant raised this topic in X and on forum:
        // https://ethresear.ch/t/you-can-kinda-abuse-ecrecover-to-do-ecmul-in-secp256k1-today/2384/19

        bytes32 message = 0x4141414141414141414141414141414141414141414141414141414141414141;

        // this bug with ecrecover happens when public key X
        // in range `[0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141, 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F)`
        // this can happen with `1 / 2^128` chance

        uint256 px = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141; // public key x >= Secp256k1.N
        uint256 py = 0x98F66641CB0AE1776B463EBDEE3D77FE2658F021DB48E2C8AC7AB4C92F83621E;

        uint256 rx = 0x0000000000000000000000000000000000000000000000000000000000000001;
        uint256 ry = 0x4218F20AE6C646B363DB68605822FB14264CA8D2587FDD6FBC750D587E76A7EE;

        uint256 z = 0x4242424242424242424242424242424242424242424242424242424242424242;

        assertEq(zecFrost.verify(message, px, py, rx, ry, z), address(0));
        assertFalse(zecFrost.isValidPublicKey(px, py));
    }

    function test_VerifyCustomParameters() public view {
        bytes32 message = 0x91be4311c2af6d02623ae6bc08eed804a9394c0ebe344a273cacc4fa06c6e80b;

        uint256 px = 0x65ceb565a2028bcc940074da00994958c1965a0f801fc1a06811a1195426db0b;
        uint256 py = 0x767293b33676de95ce3d0acf97e1bb0326fe7e2896d17c4df5d7055b4699445c;

        uint256 rx = 0x00d1c2066f3cfb50b1882a2f85655c64fa1518edb27585ac64c9c1f853383a04;
        uint256 ry = 0x475633b801338dcd6167a445926dc0e20f051266e9038be76b433c0004ff2f9c;

        uint256 z = 0x4ed729ad86526f2599577c051225e9c15c0cd85861872c153b338da05b0bb946;

        address expectedAddr;
        assembly ("memory-safe") {
            mstore(0x00, px)
            mstore(0x20, py)
            expectedAddr := and(keccak256(0x00, 0x40), sub(shl(160, 1), 1))
        }

        uint256 gasStart = gasleft();
        address result = zecFrost.verify(message, px, py, rx, ry, z);
        uint256 gasUsed = gasStart - gasleft();

        console.log("Gas used by FROST.verify (custom params):", gasUsed);
        console.log("Expected address:", expectedAddr);
        console.log("Verified address:", result);
        console.logBytes32(message);

        assertTrue(zecFrost.isValidPublicKey(px, py), "Public key should be valid");
        assertEq(result, expectedAddr, "FROST signature should verify to expected address");
    }

    function test_AddressComputationDiscrepancy() public pure {
        uint256 px = 0x65ceb565a2028bcc940074da00994958c1965a0f801fc1a06811a1195426db0b;
        uint256 py = 0x767293b33676de95ce3d0acf97e1bb0326fe7e2896d17c4df5d7055b4699445c;

        // FROST/ZecFrost way: keccak256(px || py) -> truncate to 160 bits
        address frostAddr;
        assembly ("memory-safe") {
            mstore(0x00, px)
            mstore(0x20, py)
            frostAddr := and(keccak256(0x00, 0x40), sub(shl(160, 1), 1))
        }

        // BridgeCore way: keccak256(abi.encodePacked(px, py)) -> truncate to 160 bits
        bytes32 h = keccak256(abi.encodePacked(px, py));
        address bridgeCoreAddr = address(uint160(uint256(h)));

        console.log("FROST computed address:", frostAddr);
        console.log("BridgeCore computed address:", bridgeCoreAddr);
        console.log("BridgeCore expected (from issue):", address(0x86278a8c51E0789a19F19D84ed17bCdcaB1aC9b4));

        // They should be the same since abi.encodePacked(px, py) == px || py for uint256s
        assertEq(frostAddr, bridgeCoreAddr, "Address computation should be identical");
    }
}



================================================
FILE: test/groth16/128_leaves/Groth16Verifier128LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "forge-std/console.sol";
import "../../../src/verifier/Groth16Verifier128Leaves.sol";
import "../../../src/verifier/Groth16Verifier128LeavesIC1.sol";
import "../../../src/verifier/Groth16Verifier128LeavesIC2.sol";

contract Groth16Verifier128LeavesTest is Test {
    Groth16Verifier128Leaves verifier;
    Groth16Verifier128LeavesIC1 icContract1;
    Groth16Verifier128LeavesIC2 icContract2;

    // BLS12-381 proof constants for 128 leaves
    uint256 constant pA_x_PART1 = 0x00000000000000000000000000000000076aed58b3189ab0a86591abf032f406;
    uint256 constant pA_x_PART2 = 0x3d85023cd1e1241c8c351225f94b4ab1b4a87abdd05af4d303cdff8103562d5c;
    uint256 constant pA_y_PART1 = 0x000000000000000000000000000000000cafae81f350610933c88c3ac2dfe6d9;
    uint256 constant pA_y_PART2 = 0x24ea6589895595bae03a864ac1c4a2e6d62f3f8a08d33fd19f4c8699bcf31655;

    uint256 constant pB_x0_PART1 = 0x000000000000000000000000000000000e5e674854319a6a8e4ab14c660881e1;
    uint256 constant pB_x0_PART2 = 0xc9762263b12f8661f50feb00e41de3a16708b7e37b64e2fc033cee3febcc6eb2;
    uint256 constant pB_x1_PART1 = 0x00000000000000000000000000000000085656305f6a8e4cfbb0599f71d2a269;
    uint256 constant pB_x1_PART2 = 0xb405d46a6299bf657abfb0f9b30d557b9e3df0d1f20f3c9b4f4681db41dd92a5;
    uint256 constant pB_y0_PART1 = 0x000000000000000000000000000000000ff9f7876abae6c6a37e0b2c5fd284e7;
    uint256 constant pB_y0_PART2 = 0x2a955d1e00bed62c8ed430a5226a7adcaa0f6ac4314c980568561727fe8adb03;
    uint256 constant pB_y1_PART1 = 0x000000000000000000000000000000000340304e51ee4e5eac0584008de96fed;
    uint256 constant pB_y1_PART2 = 0xc98c43ff84a1db5f46f783fa4b3986c8f1f50cf5b7a6031d6abfbdad9be9310f;

    uint256 constant pC_x_PART1 = 0x000000000000000000000000000000000ec43fc63089c2a31f37c0440cf03435;
    uint256 constant pC_x_PART2 = 0x0a3e66d477dd88c5a26193982aff587c7778640e3de2042864491b86a40f93e5;
    uint256 constant pC_y_PART1 = 0x00000000000000000000000000000000103e2efa463c48f4fa750c3285d7ddd6;
    uint256 constant pC_y_PART2 = 0xdf1fcb65adc5d4b00e1bb3af933a6e52a968c42ab962dd444023802196b51a36;

    function setUp() public {
        // Deploy IC constants contracts first
        icContract1 = new Groth16Verifier128LeavesIC1();
        icContract2 = new Groth16Verifier128LeavesIC2();
        // Deploy main verifier with IC contract addresses
        verifier = new Groth16Verifier128Leaves(address(icContract1), address(icContract2));
    }

    function testProof128() public view {
        // Proof data from proof.json
        uint256[4] memory proof_a = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        uint256[8] memory proof_b =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        uint256[4] memory proof_c = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals array with 257 elements from public.json
        uint256[257] memory pub_signals = [
            26975209276776476692791800104944319946909193252482610676888258047264401491067,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000
        ];

        // Verify with the proof data
        bool result = verifier.verifyProof(proof_a, proof_b, proof_c, pub_signals);

        console.log("128-leaf proof verification result:", result);
        assertTrue(result, "Proof should be valid");
    }
}



================================================
FILE: test/groth16/128_leaves/proof.json
================================================
{
 "pi_a": [
  "1141686076780515651615118164123075230248692211704850477776315045424309947224473381255864671171279851254383960796508",
  "1952593586738326781327797634990053743724320818660629462213792590937673299279646697531747239656315660615109984851541",
  "1"
 ],
 "pi_b": [
  [
   "1283220625572857136343214655155145228480394400141311213497024726422620416038178391386371752610106919508465283863205",
   "2211555106007980303195168497223852097906149833200955440759598630774475624675443683433249918164816675371059558248114"
  ],
  [
   "500334230341773862281426367188640596954801154554970842505422369797423391183613288858163922401860516206885844103439",
   "2458998131298292319636579161745884410100463371963820844105342032162449513408911356315046736871487380925763931527939"
  ],
  [
   "1",
   "0"
  ]
 ],
 "pi_c": [
  "2272787462871609760028048480461594698990509776957314159853048383802017273514346233073340629074236389980758516667365",
  "2500011784122817865966426433767557462493790917297649486327559452785369702013840870064254345922163030083609013066294",
  "1"
 ],
 "protocol": "groth16",
 "curve": "bls12381"
}


================================================
FILE: test/groth16/128_leaves/public.json
================================================
[
  "26975209276776476692791800104944319946909193252482610676888258047264401491067",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000"
]


================================================
FILE: test/groth16/16_leaves/Groth16Verifier16LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "forge-std/console.sol";
import "../../../src/verifier/Groth16Verifier16Leaves.sol";

contract Groth16Verifier16LeavesTest is Test {
    Groth16Verifier16Leaves public verifier;

    // BLS12-381 proof constants from test/proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x000000000000000000000000000000001704850f141027d38db82f9a156aee28;
    uint256 constant pA_x_PART2 = 0xb3f725613a9e9a5d2aa5d464e4e6c1bd0a9de4947b9a04967abf26d0b3e10f3a;
    uint256 constant pA_y_PART1 = 0x0000000000000000000000000000000006325a7118ee745184433e60cb84ccbf;
    uint256 constant pA_y_PART2 = 0x515433e324e6d78350910475b1f94a486214996b07ac363314dd0c5b8c3aaa29;

    uint256 constant pB_x0_PART1 = 0x000000000000000000000000000000001332d8875c37890b2a86f0a0015bb523;
    uint256 constant pB_x0_PART2 = 0x94b2cd85dd4dce83ff30862f4f8903f876d245f4988e3bd92aae71838a2a0ae7;
    uint256 constant pB_x1_PART1 = 0x000000000000000000000000000000000f97e07d90a2a9c2a823923f235c0f61;
    uint256 constant pB_x1_PART2 = 0xcb1185cbbd8191cf2122505bee2f94c1ce2eb60d19d44e42f7bcfd45bb2904a9;

    uint256 constant pB_y0_PART1 = 0x00000000000000000000000000000000151f0eb1cdd70dbf4bc7405232abab0a;
    uint256 constant pB_y0_PART2 = 0xbba50119f06b18d96a700a92a4baf1f4e921cabae97160f1856f145aca288d2f;
    uint256 constant pB_y1_PART1 = 0x0000000000000000000000000000000004c1ecd4035c3ebc0fa9591fca69f94c;
    uint256 constant pB_y1_PART2 = 0xbe72adaeaedf3e8ea5219f1f4ea72764c49eb845cebb9e681c0abfb03b53152a;

    uint256 constant pC_x_PART1 = 0x00000000000000000000000000000000100ce14e889866d9d134118098a1728b;
    uint256 constant pC_x_PART2 = 0x69dcd611c3c32af5c09952256b83fd2ad85b7d4b446f14dc9cef9f0a9a3fa970;
    uint256 constant pC_y_PART1 = 0x000000000000000000000000000000000acc5d3f42b695721aca04114462d719;
    uint256 constant pC_y_PART2 = 0x9bbc7a5f23d3dfff777aa61408144a047e7795e1571f60b40257dfc92173494f;

    function setUp() public {
        verifier = new Groth16Verifier16Leaves();
    }

    function testValidProof16() public view {
        // Test data from test/proof.json and ../prover/16_leaves/public.json
        // This proof is generated for BLS12-381 curve with 16-leaf Merkle tree

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from public.json (33 values for 16-leaf Merkle tree proof)
        uint256[33] memory _pubSignals = [
            uint256(8717996803693071601560617594908257064884645203109477683134260534252752083859),
            uint256(6218676549690402052910318315276979534381485872621884367715834658603456243904),
            uint256(0),
            uint256(0),
            uint256(5708510646087729135889959965248975632956651064800454628727069218571497917126),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(2000000000000000000000000000),
            uint256(0),
            uint256(0),
            uint256(1000000),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0)
        ];

        // Verify the proof
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        assertTrue(result, "Valid proof should pass verification");
    }

    function testGasConsumption16() public view {
        // Test data from test/proof.json and ../prover/16_leaves/public.json
        // This test measures gas consumption for BLS12-381 Groth16 verification

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from public.json (33 values for 16-leaf Merkle tree proof)
        uint256[33] memory _pubSignals = [
            uint256(8717996803693071601560617594908257064884645203109477683134260534252752083859),
            uint256(6218676549690402052910318315276979534381485872621884367715834658603456243904),
            uint256(0),
            uint256(0),
            uint256(5708510646087729135889959965248975632956651064800454628727069218571497917126),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(2000000000000000000000000000),
            uint256(0),
            uint256(0),
            uint256(1000000),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0),
            uint256(0)
        ];

        // Measure gas consumption
        uint256 gasStart = gasleft();
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        uint256 gasEnd = gasleft();

        uint256 gasUsed = gasStart - gasEnd;

        // Log the gas consumption
        console.log("=== BLS12-381 Groth16 Verification Gas Report ===");
        console.log("Gas used for proof verification:", gasUsed);
        console.log("Proof verification result:", result ? "PASSED" : "FAILED");
        console.log("Circuit: 16-leaf Merkle tree");
        console.log("Public signals: 33");
        console.log("Curve: BLS12-381");
        console.log("Protocol: Groth16");

        // Assert the proof is valid
        assertTrue(result, "Valid proof should pass verification");
    }
}



================================================
FILE: test/groth16/16_leaves/proof.json
================================================
{
 "pi_a": [
  "3542741396304482615986524903929454638960341424374521416359268825957778616291270934031983959523679336794478440681274",
  "953758271674766532783308886372556810446844158487584184770398948677568855124613770557554490530148731879067638999593",
  "1"
 ],
 "pi_b": [
  [
   "2400023788120685775900292888371193300041474654050699474702695783847781209340034100046264277744563399016135434765481",
   "2954937519439967922194139383254431108210040268076091693705141221962939880989568290854600634078319447612653180685031"
  ],
  [
   "732249339805134858012376070910120084644835441827797426578962608908062019401167559203195117751768527524495875052842",
   "3250868365504523559501479623312381192011536555907774606832037075628285006746557217245546655666011310982013758508335"
  ],
  [
   "1",
   "0"
  ]
 ],
 "pi_c": [
  "2470369252636646841999893318459284852825574353930525847287092897605678970220440243932810376676327704442283940096368",
  "1662010149702018469708739319100206629240676413139159476042154217377086241634155167859385360194114661793677159123279",
  "1"
 ],
 "protocol": "groth16",
 "curve": "bls12381"
}


================================================
FILE: test/groth16/16_leaves/public.json
================================================
[
  "8717996803693071601560617594908257064884645203109477683134260534252752083859",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "0",
  "0",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "2000000000000000000000000000",
  "0",
  "0",
  "1000000",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0",
  "0"
]


================================================
FILE: test/groth16/32_leaves/Groth16Verifier32LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "forge-std/console.sol";
import "../../../src/verifier/Groth16Verifier32Leaves.sol";

contract Groth16Verifier32LeavesTest is Test {
    Groth16Verifier32Leaves public verifier;

    // BLS12-381 proof constants from test/32_leaves/proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x00000000000000000000000000000000131e00eb6ba9a3b9fd61acdc9e909bcd;
    uint256 constant pA_x_PART2 = 0xc60795eb6d59149d688f21b2b9f3be63034b057564a3f80e17342caaecaa638e;
    uint256 constant pA_y_PART1 = 0x0000000000000000000000000000000004367b464c9d582ec6b7cd8abb043363;
    uint256 constant pA_y_PART2 = 0xc0f1b06b3b566865c1856588ebd94afd368759dbbd5b64f4d37371b0d495e320;

    //x1
    uint256 constant pB_x0_PART1 = 0x0000000000000000000000000000000010d7d41b359798150e7a63288de8b3f0;
    uint256 constant pB_x0_PART2 = 0xd3938e8d082993af469d2a37402e420ecfaf6d79aa1002ce45f8bb9b2c1582f9;
    //x0
    uint256 constant pB_x1_PART1 = 0x000000000000000000000000000000000c531036c339254e6b5864adbd3611e0;
    uint256 constant pB_x1_PART2 = 0x205a6380cd72fc618c91b86f69c52aaec4ebfe617e54f0c041b7356f3241e21c;

    //y0
    uint256 constant pB_y0_PART1 = 0x0000000000000000000000000000000003b0e7dca5b9a72192b5be190e7bfef9;
    uint256 constant pB_y0_PART2 = 0xc14311e988e898a61c766bfbb246272397770b7972dfee249b52ec4df74cb4c2;
    //y1
    uint256 constant pB_y1_PART1 = 0x00000000000000000000000000000000194cdf0b52d54d5b922950e2e1810b2c;
    uint256 constant pB_y1_PART2 = 0x7a15c5c06cc31adb37d34090f762ff7d925c0657b97d633945136dfe97bf4af7;

    uint256 constant pC_x_PART1 = 0x0000000000000000000000000000000004b3b2102a988de4a19aba67c15bad17;
    uint256 constant pC_x_PART2 = 0xdc415b7719d7c359b51a1f00c9fa19cfcd5baf26d6778131623772d790bd468a;
    uint256 constant pC_y_PART1 = 0x000000000000000000000000000000000ca6b8775b49dd6390acfe96969c8650;
    uint256 constant pC_y_PART2 = 0x39caa56372d4d490065d20c7f160d44fcadd8effb56aeaeb3d1973dc99a10d8b;

    function setUp() public {
        verifier = new Groth16Verifier32Leaves();
    }

    function testValidProof32() public view {
        // Test data from test/proof.json and ../prover/16_leaves/public.json
        // This proof is generated for BLS12-381 curve with 16-leaf Merkle tree

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from test/32_leaves/public.json (65 values for 32-leaf Merkle tree proof)
        uint256[65] memory _pubSignals = [
            uint256(5895493230319637670729027073304946012562138136683578821957235132381685112735),
            uint256(6218676549690402052910318315276979534381485872621884367715834658603456243904),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(5708510646087729135889959965248975632956651064800454628727069218571497917126),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2000000000000000000000000000),
            uint256(20000000000000000000000000000),
            uint256(20000000000000000000000000000),
            uint256(1000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000)
        ];

        // Verify the proof
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        assertTrue(result, "Valid proof should pass verification");
    }

    function testGasConsumption32() public view {
        // Test data from test/32_leaves/proof.json and test/32_leaves/public.json
        // This test measures gas consumption for BLS12-381 Groth16 verification

        // pi_a - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pA = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        // pi_b - G2 point (x0_PART1, x0_PART2, x1_PART1, x1_PART2, y0_PART1, y0_PART2, y1_PART1, y1_PART2)
        uint256[8] memory _pB =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        // pi_c - G1 point (x_PART1, x_PART2, y_PART1, y_PART2)
        uint256[4] memory _pC = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Public signals from test/32_leaves/public.json (65 values for 32-leaf Merkle tree proof)
        uint256[65] memory _pubSignals = [
            uint256(5895493230319637670729027073304946012562138136683578821957235132381685112735),
            uint256(6218676549690402052910318315276979534381485872621884367715834658603456243904),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(5708510646087729135889959965248975632956651064800454628727069218571497917126),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2186765496904020529103183152769795343814858726218843677158346586034562439040),
            uint256(2000000000000000000000000000),
            uint256(20000000000000000000000000000),
            uint256(20000000000000000000000000000),
            uint256(1000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(10000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(200000000000000000000000000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(100000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000),
            uint256(2000000000000000000000000000000)
        ];

        // Measure gas consumption
        uint256 gasStart = gasleft();
        bool result = verifier.verifyProof(_pA, _pB, _pC, _pubSignals);
        uint256 gasEnd = gasleft();

        uint256 gasUsed = gasStart - gasEnd;

        // Log the gas consumption
        console.log("=== BLS12-381 Groth16 Verification Gas Report ===");
        console.log("Gas used for proof verification:", gasUsed);
        console.log("Proof verification result:", result ? "PASSED" : "FAILED");
        console.log("Circuit: 32-leaf Merkle tree");
        console.log("Public signals: 65");
        console.log("Curve: BLS12-381");
        console.log("Protocol: Groth16");

        // Assert the proof is valid
        assertTrue(result, "Valid proof should pass verification");
    }
}



================================================
FILE: test/groth16/32_leaves/proof.json
================================================
{
 "pi_a": [
  "2942406614171244654080176976675034820726108047050664088731628320171911275761123580709945755768899020962089283511182",
  "648412115145778188141479423907310872225212083379719460662319298051288730777968209193207396081095013546882544034592",
  "1"
 ],
 "pi_b": [
  [
   "1896908952327798142499475833126384984940362847955123673346133267426408637720715720507675617983285259637123128091164",
   "2592387311676449604077664058324966710129829205405883260321389991571364705679775720017594736805936788234846501962489"
  ],
  [
   "3894069240985397732017228793943890743635156726683239535063683023414916871321553984057966110107804346170764720818935",
   "568102732277773017283525544551384763855624811083203607714134814598441507044050956735192455505066248954290706887874"
  ],
  [
   "1",
   "0"
  ]
 ],
 "pi_c": [
  "723694151021800667941453577301986232023947119857881530339324558643150724228674628294743122176408670755737778865802",
  "1947205932865527864785403586726753321605458218239247892659151489328932785176771228973870581788584095522535357091211",
  "1"
 ],
 "protocol": "groth16",
 "curve": "bls12381"
}


================================================
FILE: test/groth16/32_leaves/public.json
================================================
[
  "5895493230319637670729027073304946012562138136683578821957235132381685112735",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2186765496904020529103183152769795343814858726218843677158346586034562439040",
  "2000000000000000000000000000",
  "20000000000000000000000000000",
  "20000000000000000000000000000",
  "1000000",
  "10000000",
  "10000000",
  "10000000",
  "10000000",
  "10000000",
  "10000000",
  "10000000",
  "200000000000000000000000000000",
  "200000000000000000000000000000",
  "200000000000000000000000000000",
  "200000000000000000000000000000",
  "200000000000000000000000000000",
  "100000000",
  "100000000",
  "100000000",
  "100000000",
  "100000000",
  "100000000",
  "100000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000",
  "2000000000000000000000000000000"
]


================================================
FILE: test/groth16/64_leaves/Groth16Verifier64LeavesTest.t.sol
================================================
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "forge-std/console.sol";
import "../../../src/verifier/Groth16Verifier64Leaves.sol";
import "../../../src/verifier/Groth16Verifier64LeavesIC.sol";

contract Groth16Verifier64LeavesNewProofTest is Test {
    Groth16Verifier64Leaves verifier;
    Groth16Verifier64LeavesIC icContract;

    // Updated BLS12-381 proof constants from new proof.json - split into PART1/PART2
    uint256 constant pA_x_PART1 = 0x000000000000000000000000000000000c2c7403abb0d7f9774667af73c84cbe;
    uint256 constant pA_x_PART2 = 0x6d615eec6620e135cf3764a2b798e37c39f3449c5c67cf1ee1adb82e1984696a;
    uint256 constant pA_y_PART1 = 0x0000000000000000000000000000000014104f1ea260fd94e9e946275fd78bee;
    uint256 constant pA_y_PART2 = 0xc85653aed170fa0c8f259a3b34a4624150a85bc817febfa3f251da31558fe519;

    //x0
    uint256 constant pB_x0_PART1 = 0x00000000000000000000000000000000052c670ce3848f29d28fc43e806e00f8;
    uint256 constant pB_x0_PART2 = 0x6294d7a1f647a55f539228dabe12a1b6e2cd53274196e66a097220327b34537f;
    //x1
    uint256 constant pB_x1_PART1 = 0x000000000000000000000000000000001260199a730516c11d484d418bdf4280;
    uint256 constant pB_x1_PART2 = 0xbc886344866cc0ec0d9bd280480f4e0c4cb717dc61832cd6f2115cd9db6bfe2d;
    //y0
    uint256 constant pB_y0_PART1 = 0x00000000000000000000000000000000154c003d4c9b7fd20b6fdbc5e9a561b0;
    uint256 constant pB_y0_PART2 = 0x8bfe6767182b7d908be77400691a3037687b62b2eac3f0734ed0e2dc20978ddb;
    //y1
    uint256 constant pB_y1_PART1 = 0x00000000000000000000000000000000108cd334783e96f5f7f0b39fedc77592;
    uint256 constant pB_y1_PART2 = 0xb1642e9ea4d6bddd02c076903c77f70d854222c53e89c83da3b4b7fc31271c5e;

    uint256 constant pC_x_PART1 = 0x000000000000000000000000000000001641171bf90e5d5fa491c2a8581c6c72;
    uint256 constant pC_x_PART2 = 0x9da24b959702f23f66531cbc4c1cb2f8316146e168997e4b56c3cf272ed3116d;
    uint256 constant pC_y_PART1 = 0x00000000000000000000000000000000068a4ddcf98e105f28eaff2b8e6143ca;
    uint256 constant pC_y_PART2 = 0xd325622716af87dee0eb2e0a1fce70b0b95f6a046e0b6fca6bb1082a6be3489f;

    function setUp() public {
        // Deploy IC constants contract first
        icContract = new Groth16Verifier64LeavesIC();
        // Deploy main verifier with IC contract address
        verifier = new Groth16Verifier64Leaves(address(icContract));
    }

    function testVerifyProof64() public view {
        // New proof data from updated proof.json
        uint256[4] memory proof_a = [pA_x_PART1, pA_x_PART2, pA_y_PART1, pA_y_PART2];

        uint256[8] memory proof_b =
            [pB_x0_PART1, pB_x0_PART2, pB_x1_PART1, pB_x1_PART2, pB_y0_PART1, pB_y0_PART2, pB_y1_PART1, pB_y1_PART2];

        uint256[4] memory proof_c = [pC_x_PART1, pC_x_PART2, pC_y_PART1, pC_y_PART2];

        // Updated public signals array with 129 elements from new public.json
        uint256[129] memory pub_signals = [
            50803289751659168012871184753748907509578899911239403202058491060091161856746,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            6218676549690402052910318315276979534381485872621884367715834658603456243904,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            5708510646087729135889959965248975632956651064800454628727069218571497917126,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            123456789123456789123456789123456789123456789123456789123456789123456789,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000,
            2000000000000000000000000000
        ];

        // Verify with new proof data
        bool result = verifier.verifyProof(proof_a, proof_b, proof_c, pub_signals);

        console.log("New 64-leaf proof verification result:", result);
        assertTrue(result, "New proof should be valid");
    }
}



================================================
FILE: test/groth16/64_leaves/proof.json
================================================
{
 "pi_a": [
  "1873695488722637731434672535512330882261963926449420789353974556695082025618492073858234165217768828560029121800554",
  "3088087180415228862858364115837324242758971365881541383387588484650037395869264815768227574071074119764284699305241",
  "1"
 ],
 "pi_b": [
  [
   "2828231473679796028944628604702381373598378186792298270900514172205226549699986020626951501088001384653264899538477",
   "796266435302962483198171116626348281107531275574248352265986394156190435994081114781437947510369179828291414283135"
  ],
  [
   "2547293177283018001546023154175653877238924695566802852791662156772821156361925219316313237895513024271417384311902",
   "3277889627647391651282804827293875941914610538263267867942053769957308711388656554617990517693822777488540901543387"
  ],
  [
   "1",
   "0"
  ]
 ],
 "pi_c": [
  "3425243929182415354666290249952452881230250744847698834702138232049963365599166481265006389320820155698214065082733",
  "1006636697592914982920421936142940549814453672080725970635456858107117445441181100796852822457040155434727973800095",
  "1"
 ],
 "protocol": "groth16",
 "curve": "bls12381"
}


================================================
FILE: test/groth16/64_leaves/public.json
================================================
[
  "50803289751659168012871184753748907509578899911239403202058491060091161856746",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "6218676549690402052910318315276979534381485872621884367715834658603456243904",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "5708510646087729135889959965248975632956651064800454628727069218571497917126",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "123456789123456789123456789123456789123456789123456789123456789123456789",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000",
  "2000000000000000000000000000"
]


================================================
FILE: test/js-scripts/generate_proof.sh
================================================
#!/bin/bash

# Script to generate Groth16 proofs for testing
# Usage: ./generate_proof.sh [mpt_key1] [balance1] [mpt_key2] [balance2] [mpt_key3] [balance3]

# Default test values if no arguments provided
if [ $# -eq 0 ]; then
    echo "Using default test values..."
    MPT_KEY1="1461501637330902918203684832716283019655932542976"  # uint160 of address(0xd69B7AaaE8C1c9F0546AfA4Fd8eD39741cE3f59F)
    BALANCE1="1000000000000000000"  # 1 ETH
    MPT_KEY2="1240746827509629851092253602051341618533"  # uint160 of address(0xb18E7CdB6Aa28Cc645227041329896446A1478bd)
    BALANCE2="2000000000000000000"  # 2 ETH
    MPT_KEY3="1033628234203421458715762354672"  # uint160 of address(0x9D70617FF571Ac34516C610a51023EE1F28373e8)
    BALANCE3="3000000000000000000"  # 3 ETH
else
    MPT_KEY1=$1
    BALANCE1=$2
    MPT_KEY2=$3
    BALANCE2=$4
    MPT_KEY3=$5
    BALANCE3=$6
fi

echo "Generating Groth16 proof with:"
echo "Participant 1: MPT Key = $MPT_KEY1, Balance = $BALANCE1"
echo "Participant 2: MPT Key = $MPT_KEY2, Balance = $BALANCE2"  
echo "Participant 3: MPT Key = $MPT_KEY3, Balance = $BALANCE3"

# Change to the project root directory
cd "$(dirname "$0")/../.."

# Run the Node.js script
node test/js-scripts/generateGroth16Proof.js $MPT_KEY1 $BALANCE1 $MPT_KEY2 $BALANCE2 $MPT_KEY3 $BALANCE3


================================================
FILE: test/js-scripts/generateGroth16Proof.js
================================================
#!/usr/bin/env node

import snarkjs from "snarkjs";
import fs from "fs";
import path from "path";
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

/**
 * Script to generate Groth16 proofs for testing the RollupBridge contract
 * Usage: node generateGroth16Proof.js [participant1_mpt_key] [participant1_balance] [participant2_mpt_key] [participant2_balance] [participant3_mpt_key] [participant3_balance]
 * Example: node generateGroth16Proof.js 1461501637330902918203684832716283019655932542976 1000000000000000000 1240746827509629851092253602051341618533 2000000000000000000 1033628234203421458715762354672 3000000000000000000
 */

async function generateProof() {
    const args = process.argv.slice(2);
    
    if (args.length < 6) {
        console.log("Usage: node generateGroth16Proof.js [mpt_key1] [balance1] [mpt_key2] [balance2] [mpt_key3] [balance3]");
        console.log("Example: node generateGroth16Proof.js 1461501637330902918203684832716283019655932542976 1000000000000000000 1240746827509629851092253602051341618533 2000000000000000000 1033628234203421458715762354672 3000000000000000000");
        process.exit(1);
    }

    // Parse arguments
    const participants = [];
    for (let i = 0; i < 6; i += 2) {
        participants.push({
            mptKey: args[i],
            balance: args[i + 1]
        });
    }

    // Build input for the circuit
    const input = {
        merkle_keys: new Array(50).fill("0"),
        storage_values: new Array(50).fill("0")
    };

    // Fill in the actual participant data
    for (let i = 0; i < participants.length; i++) {
        input.merkle_keys[i] = participants[i].mptKey;
        input.storage_values[i] = participants[i].balance;
    }

    // Paths to circuit files
    const circuitWasm = path.join(__dirname, "../../groth16/circuits/build/merkle_tree_circuit_js/merkle_tree_circuit.wasm");
    const circuitZkey = path.join(__dirname, "../../groth16/trusted-setup/merkle_tree_circuit_final.zkey");

    try {
        console.log("Generating witness...");
        console.log("Input:", JSON.stringify(input, null, 2));

        // Check if circuit files exist
        if (!fs.existsSync(circuitWasm)) {
            throw new Error(`Circuit WASM file not found at: ${circuitWasm}`);
        }
        if (!fs.existsSync(circuitZkey)) {
            throw new Error(`Circuit zkey file not found at: ${circuitZkey}`);
        }

        // Generate witness
        const { witness } = await snarkjs.wtns.calculate(input, circuitWasm);

        console.log("Generating proof...");
        
        // Generate the proof
        const { proof, publicSignals } = await snarkjs.groth16.prove(circuitZkey, witness);

        console.log("\\n=== GENERATED PROOF ===");
        console.log("Proof A:", [proof.pi_a[0], proof.pi_a[1]]);
        console.log("Proof B:", [[proof.pi_b[0][1], proof.pi_b[0][0]], [proof.pi_b[1][1], proof.pi_b[1][0]]]);
        console.log("Proof C:", [proof.pi_c[0], proof.pi_c[1]]);
        console.log("Public signals (first 10):", publicSignals.slice(0, 10));
        console.log("Merkle root (last signal):", publicSignals[publicSignals.length - 1]);

        // Format for Solidity test
        console.log("\\n=== SOLIDITY TEST FORMAT ===");
        console.log(`uint[2] memory pA = [uint(${proof.pi_a[0]}), uint(${proof.pi_a[1]})];`);
        console.log(`uint[2][2] memory pB = [[uint(${proof.pi_b[0][1]}), uint(${proof.pi_b[0][0]})], [uint(${proof.pi_b[1][1]}), uint(${proof.pi_b[1][0]})]];`);
        console.log(`uint[2] memory pC = [uint(${proof.pi_c[0]}), uint(${proof.pi_c[1]})];`);
        console.log(`bytes32 merkleRoot = bytes32(uint256(${publicSignals[publicSignals.length - 1]}));`);

        // Save to files
        const outputDir = path.join(__dirname, "../proof-outputs");
        if (!fs.existsSync(outputDir)) {
            fs.mkdirSync(outputDir, { recursive: true });
        }

        fs.writeFileSync(path.join(outputDir, "proof.json"), JSON.stringify(proof, null, 2));
        fs.writeFileSync(path.join(outputDir, "public.json"), JSON.stringify(publicSignals, null, 2));
        fs.writeFileSync(path.join(outputDir, "input.json"), JSON.stringify(input, null, 2));

        console.log(`\\nFiles saved to: ${outputDir}`);

        // Verify the proof
        const verificationKey = JSON.parse(fs.readFileSync(path.join(__dirname, "../../groth16/trusted-setup/verification_key.json")));
        const isValid = await snarkjs.groth16.verify(verificationKey, publicSignals, proof);
        console.log("\\nProof verification:", isValid ? "âœ“ VALID" : "âœ— INVALID");

    } catch (error) {
        console.error("Error generating proof:", error);
        process.exit(1);
    }
}

// Run the script
generateProof().catch(console.error);


================================================
FILE: test/js-scripts/generateProof.js
================================================
import { SimpleQuaternaryTree } from "./simpleQuaternaryTree.js";
import { computeLeaf } from "./merkleTree.js";

/**
 * Generate merkle proof for a specific user's withdrawal - SIMPLIFIED INTERFACE
 * 
 * Usage: node generateProofSimple.js <channelId> <userL2Address> <finalStateRoot>
 * 
 * This version uses a much simpler interface by hardcoding the test participant data.
 * For production, participant data would come from the contract or be passed differently.
 */

function generateWithdrawalProof() {
  const inputs = process.argv.slice(2);
  
  // Check if we're in quiet mode for FFI
  const isQuiet = process.env.FFI_MODE === 'true' || process.argv.includes('--ffi');

  if (inputs.length !== 3) {
    if (!isQuiet) {
      console.error(`Expected 3 arguments, got ${inputs.length}`);
      console.error('Usage: node generateProofSimple.js <channelId> <userL2Address> <finalStateRoot>');
      console.error('Example: node generateProofSimple.js 0 0xd69B7AaaE8C1c9F0546AfA4Fd8eD39741cE3f59F 0x123...');
    }
    process.exit(1);
  }

  // Parse inputs
  const channelId = inputs[0];
  const userL2Address = inputs[1];
  const finalStateRoot = inputs[2];

  // Hardcoded test participant data (in a real implementation, this would come from the contract)
  const participantsData = [
    {
      participantRoot: "0x8449acb4300b58b00e4852ab07d43f298eaa35688eaa3917ca205f20e6db73e8",
      l2Address: "0xd69B7AaaE8C1c9F0546AfA4Fd8eD39741cE3f59F", // participant1
      balance: "1000000000000000000"
    },
    {
      participantRoot: "0x3bec727653ae8d56ac6d9c103182ff799fe0a3b512e9840f397f0d21848373e8", 
      l2Address: "0xb18E7CdB6Aa28Cc645227041329896446A1478bd", // participant2
      balance: "1000000000000000000"
    },
    {
      participantRoot: "0x11e1e541a59fb2cd7fa4371d63103972695ee4bb4d1e646e72427cf6cdc16498",
      l2Address: "0x9D70617FF571Ac34516C610a51023EE1F28373e8", // participant3
      balance: "1000000000000000000"
    }
  ];

  if (!isQuiet) {
    console.log(`Generating withdrawal proof for:`);
    console.log(`- Channel ID: ${channelId}`);
    console.log(`- User L2 Address: ${userL2Address}`);
    console.log(`- Final State Root: ${finalStateRoot}`);
    console.log(`- Total participants: ${participantsData.length}`);
  }

  try {
    // Find user's index in participants data
    let userLeafIndex = -1;
    let userParticipantRoot = null;
    let userBalance = null;
    
    for (let i = 0; i < participantsData.length; i++) {
      const participant = participantsData[i];
      if (participant.l2Address.toLowerCase() === userL2Address.toLowerCase()) {
        userLeafIndex = i;
        userParticipantRoot = participant.participantRoot;
        userBalance = participant.balance;
        if (!isQuiet) console.log(`\nFound user at index ${i} with balance ${userBalance}`);
        break;
      }
    }
    
    if (userLeafIndex === -1) {
      throw new Error(`User's L2 address ${userL2Address} not found in participants data`);
    }

    // Build the final state tree with individual participant roots
    if (!isQuiet) console.log(`\nStep 1: Building tree with individual participant roots...`);
    
    const tree = new SimpleQuaternaryTree(3);
    const leaves = [];
    
    for (const { participantRoot, l2Address, balance } of participantsData) {
      const leaf = computeLeaf(participantRoot, l2Address, balance);
      leaves.push(leaf);
    }
    
    tree.insertAll(leaves);
    const computedTreeRoot = tree.root();
    
    if (!isQuiet) {
      console.log(`Computed tree root: ${computedTreeRoot}`);
      console.log(`Expected finalStateRoot: ${finalStateRoot}`);
      console.log(`Tree root matches finalStateRoot: ${computedTreeRoot === finalStateRoot ? 'YES' : 'NO'}`);
    }
    
    // Compute user's leaf exactly like the contract does during withdrawal  
    const userLeafValue = computeLeaf(userParticipantRoot, userL2Address, userBalance);
    if (!isQuiet) console.log(`\nUser's withdrawal leaf: ${userLeafValue} at index ${userLeafIndex}`);
    
    // Generate merkle proof for the user's specific leaf
    const proofData = tree.proof(userLeafIndex);
    if (!isQuiet) {
      console.log(`\nGenerating proof for user's leaf at index: ${userLeafIndex}`);
      console.log(`Merkle proof has ${proofData.pathElements.length} elements`);
    }
    
    // Verify our proof locally
    const isValid = tree.verifyProof(userLeafIndex, userLeafValue, proofData.pathElements);
    if (!isQuiet) console.log(`\nâœ“ Proof verification: ${isValid ? 'PASSED' : 'FAILED'}`);
    
    if (!isValid) {
      throw new Error('Generated proof failed local verification');
    }

    const result = {
      channelId,
      claimedBalance: userBalance, 
      leafIndex: userLeafIndex,
      merkleProof: proofData.pathElements,
      leafValue: userLeafValue,
      userL2Address,
      computedTreeRoot,
      expectedFinalRoot: finalStateRoot
    };

    return result;

  } catch (error) {
    if (!isQuiet) console.error('\nâŒ Proof generation failed:', error);
    throw error;
  }
}

// Main execution
if (import.meta.url === `file://${process.argv[1]}`) {
  try {
    const proofData = generateWithdrawalProof();
    
    // Check if we're running in FFI mode (suppress logs for Foundry)
    const isFFIMode = process.env.FFI_MODE === 'true' || process.argv.includes('--ffi');
    
    if (isFFIMode) {
      // Output simple format for FFI parsing: channelId,claimedBalance,leafIndex,proof1,proof2,...
      console.log(`${proofData.channelId},${proofData.claimedBalance},${proofData.leafIndex},${proofData.merkleProof.join(',')}`);
    } else {
      // Human-readable output
      console.log('\nâœ… Withdrawal proof generated successfully!');
      console.log('\nðŸ“‹ Proof Data for withdraw:');
      console.log(`channelId: ${proofData.channelId}`);
      console.log(`claimedBalance: ${proofData.claimedBalance}`);
      console.log(`leafIndex: ${proofData.leafIndex}`);
      console.log(`merkleProof: [${proofData.merkleProof.map(p => `"${p}"`).join(', ')}]`);
      
      console.log('\nðŸ”§ Smart Contract Call:');
      console.log('withdraw(');
      console.log(`  ${proofData.channelId}, // channelId`);
      console.log(`  ${proofData.claimedBalance}, // claimedBalance`);
      console.log(`  ${proofData.leafIndex}, // leafIndex`);
      console.log(`  [${proofData.merkleProof.map(p => `"${p}"`).join(', ')}] // merkleProof`);
      console.log(')');
      
      // Also output as JSON for programmatic use
      console.log('\nðŸ“„ JSON Output:');
      console.log(JSON.stringify(proofData, null, 2));
    }
    
  } catch (error) {
    if (process.env.FFI_MODE === 'true' || process.argv.includes('--ffi')) {
      // In FFI mode, output error in a way that won't break parsing
      console.error(JSON.stringify({error: error.message}));
    } else {
      console.error('Script failed:', error);
    }
    process.exit(1);
  }
}

export default generateWithdrawalProof;


================================================
FILE: test/js-scripts/merkleTree.js
================================================
import { ethers } from 'ethers';

function hashFour(a, b, c, d) {
  return ethers.keccak256(ethers.AbiCoder.defaultAbiCoder().encode(
    ['bytes32', 'bytes32', 'bytes32', 'bytes32'],
    [a, b, c, d]
  ));
}

function computeZeros(level) {
  let zero = ethers.ZeroHash;
  for (let i = 0; i < level; i++) {
    zero = hashFour(zero, zero, zero, zero);
  }
  return zero;
}

export class QuaternaryTree {
  constructor(depth) {
    this.depth = depth;
    this.storage = new Map();
    this.cachedSubtrees = new Map();
    this.nextLeafIndex = 0;
    this.roots = []; // Track all roots like the contract
    this.currentRootIndex = 0;
    
    // Pre-compute zero values for each level
    this.zeros = [];
    for (let level = 0; level <= depth; level++) {
      this.zeros[level] = computeZeros(level);
    }
  }

  init() {
    // Initialize empty tree with zero subtrees cached
    for (let level = 0; level <= this.depth; level++) {
      this.cachedSubtrees.set(this.levelToKey(level), this.zeros[level]);
    }
    
    // Set initial root (matching contract's initializeChannelState)
    const initialRoot = this.zeros[this.depth];
    this.roots.push(initialRoot);
    this.currentRootIndex = 0;
  }

  levelToKey(level) {
    return `level-${level}`;
  }

  static indexToKey(level, index) {
    return `${level}-${index}`;
  }

  getIndex(leaf) {
    for (const [key, value] of this.storage.entries()) {
      if (value === leaf && key.startsWith('0-')) {
        return parseInt(key.split('-')[1]);
      }
    }
    return -1;
  }

  root() {
    return this.roots[this.currentRootIndex] || this.zeros[this.depth];
  }
  
  getCurrentRoot() {
    return this.roots[this.currentRootIndex] || this.zeros[this.depth];
  }
  
  getLastRootInSequence() {
    return this.roots[this.roots.length - 1] || this.zeros[this.depth];
  }

  proof(index) {
    const leaf = this.storage.get(QuaternaryTree.indexToKey(0, index));
    if (!leaf) throw new Error("leaf not found");

    const pathElements = [];
    let currentIndex = index;

    for (let level = 0; level < this.depth; level++) {
      const childIndex = currentIndex % 4;
      
      // Get the 3 siblings needed for quaternary proof
      // We need to get actual stored values from the tree
      for (let i = 0; i < 4; i++) {
        if (i !== childIndex) {
          const siblingIndex = Math.floor(currentIndex / 4) * 4 + i;
          let sibling;
          
          // Check if this sibling exists in storage at level 0 (leaves)
          if (level === 0) {
            sibling = this.storage.get(QuaternaryTree.indexToKey(0, siblingIndex)) || this.zeros[level];
          } else {
            // For higher levels, we need to compute what the sibling would be
            // This is complex because the tree uses cached subtrees logic
            // For now, use zero as placeholder - this needs proper implementation
            sibling = this.zeros[level];
          }
          pathElements.push(sibling);
        }
      }
      
      currentIndex = Math.floor(currentIndex / 4);
    }

    return {
      root: this.root(),
      pathElements,
      childIndex: index % 4,
      leaf,
    };
  }

  insert(leaf) {
    const index = this.nextLeafIndex;
    this.update(index, leaf, true);
    this.nextLeafIndex++;
  }

  update(index, newLeaf, isInsert = false) {
    if (!isInsert && index >= this.nextLeafIndex) {
      throw Error("Use insert method for new elements.");
    } else if (isInsert && index < this.nextLeafIndex) {
      throw Error("Use update method for existing elements.");
    }

    // Check if tree is full
    const maxLeaves = 4 ** this.depth;
    if (index >= maxLeaves) {
      throw Error("MerkleTreeFull");
    }

    // Store the leaf
    this.storage.set(QuaternaryTree.indexToKey(0, index), newLeaf);

    // Update the cached subtrees and compute new root (matching contract exactly)
    let currentHash = newLeaf;
    let currentIndex = index;

    for (let level = 0; level < this.depth; level++) {
      if (currentIndex % 4 === 0) {
        // This is a leftmost node, cache it
        this.cachedSubtrees.set(this.levelToKey(level), currentHash);
        break;
      } else {
        // Compute parent hash using 4 children (matching contract _insertLeaf)
        const left = this.cachedSubtrees.get(this.levelToKey(level)) || this.zeros[level];
        const child2 = currentIndex % 4 >= 2 ? currentHash : ethers.ZeroHash;
        const child3 = currentIndex % 4 === 3 ? currentHash : ethers.ZeroHash;
        const child4 = ethers.ZeroHash;

        currentHash = hashFour(left, child2, child3, child4);
        currentIndex = Math.floor(currentIndex / 4);
      }
    }

    // Update tree state (matching contract)
    if (isInsert) {
      this.nextLeafIndex = index + 1;
    }

    // Store new root (matching contract)
    this.currentRootIndex += 1;
    this.roots.push(currentHash);
    this.storage.set(QuaternaryTree.indexToKey(this.depth, 0), currentHash);
  }

  traverse(index, fn) {
    let currentIndex = index;
    for (let level = 0; level < this.depth; level++) {
      fn(level, currentIndex);
      currentIndex = Math.floor(currentIndex / 4);
    }
  }
}


// Build tree exactly like contract does during initializeChannelState
export function buildInitialStateTree(channelId, participants) {
  const TREE_DEPTH = 3;
  const tree = new QuaternaryTree(TREE_DEPTH);
  tree.init();
  
  let nonce = 0;
  
  // Insert leaves sequentially like the contract does
  for (let i = 0; i < participants.length; i++) {
    const { l2Address, balance } = participants[i];
    
    // Compute prevRoot based on current nonce (matching contract logic)
    let prevRoot;
    if (nonce === 0) {
      prevRoot = ethers.zeroPadValue(ethers.toBeHex(BigInt(channelId)), 32);
    } else {
      prevRoot = tree.getLastRootInSequence();
    }
    
    // Compute leaf with current prevRoot
    const leaf = computeLeaf(prevRoot, l2Address, balance);
    
    // Insert leaf (this updates the tree and creates a new root)
    tree.insert(leaf);
    
    nonce++;
  }
  
  return tree;
}

// Build final state tree where all participants use the same prevRoot
export function buildFinalStateTree(finalStateRoot, participants) {
  const TREE_DEPTH = 3;
  const tree = new QuaternaryTree(TREE_DEPTH);
  tree.init();
  
  // In final state, ALL participants use the same prevRoot (finalStateRoot)
  const leaves = [];
  for (const { l2Address, balance } of participants) {
    const leaf = computeLeaf(finalStateRoot, l2Address, balance);
    leaves.push(leaf);
  }
  
  // Insert all leaves at once
  for (const leaf of leaves) {
    tree.insert(leaf);
  }
  
  return tree;
}

// Build final state tree where each participant uses their individual prevRoot
export function buildFinalStateTreeWithIndividualRoots(participants) {
  const TREE_DEPTH = 3;
  const tree = new QuaternaryTree(TREE_DEPTH);
  tree.init();
  
  // Each participant uses their specific prevRoot
  const leaves = [];
  for (const { participantRoot, l2Address, balance } of participants) {
    const leaf = computeLeaf(participantRoot, l2Address, balance);
    leaves.push(leaf);
  }
  
  // Insert all leaves at once
  for (const leaf of leaves) {
    tree.insert(leaf);
  }
  
  return tree;
}

// Legacy function for backward compatibility
export function merkleTree(leaves) {
  const TREE_DEPTH = 3;
  const tree = new QuaternaryTree(TREE_DEPTH);
  tree.init();
  
  for (const leaf of leaves) {
    tree.insert(leaf);
  }
  
  return tree;
}

// Helper function to compute leaf like the contract does
export function computeLeaf(prevRoot, l2Address, balance) {
  // RLC computation matching contract's _computeLeafPure
  // Use abi.encodePacked (like the contract) instead of abi.encode
  const l2AddressBytes32 = ethers.zeroPadValue(ethers.toBeHex(BigInt(l2Address)), 32);
  const packedData = ethers.concat([prevRoot, l2AddressBytes32]);
  const gamma = ethers.keccak256(packedData);
  
  // RLC formula: l2Address + gamma * balance
  const leafValue = (BigInt(l2Address) + BigInt(gamma) * BigInt(balance)) % (2n ** 256n);
  return ethers.zeroPadValue(ethers.toBeHex(leafValue), 32);
}



================================================
FILE: test/js-scripts/simpleQuaternaryTree.js
================================================
import { ethers } from "ethers";

// Simple quaternary tree implementation for proof generation
export class SimpleQuaternaryTree {
  constructor(depth = 3) {
    this.depth = depth;
    this.maxLeaves = 4 ** depth;
    this.leaves = new Array(this.maxLeaves).fill(ethers.ZeroHash);
    this.tree = {}; // Store all nodes: tree[level][index] = hash
    
    // Initialize tree structure
    for (let level = 0; level <= depth; level++) {
      this.tree[level] = {};
    }
  }

  insert(index, leaf) {
    if (index >= this.maxLeaves) throw new Error("Index out of bounds");
    
    this.leaves[index] = leaf;
    this.tree[0][index] = leaf;
    
    // Rebuild the entire tree (simple but correct approach)
    this.rebuild();
  }

  insertAll(leaves) {
    for (let i = 0; i < leaves.length; i++) {
      if (i >= this.maxLeaves) break;
      this.leaves[i] = leaves[i];
      this.tree[0][i] = leaves[i];
    }
    this.rebuild();
  }

  rebuild() {
    // Build tree level by level
    for (let level = 1; level <= this.depth; level++) {
      const nodesInLevel = 4 ** (this.depth - level);
      
      for (let nodeIndex = 0; nodeIndex < nodesInLevel; nodeIndex++) {
        // Each node at this level is computed from 4 children at previous level
        const childBaseIndex = nodeIndex * 4;
        const prevLevel = level - 1;
        
        const child0 = this.tree[prevLevel][childBaseIndex] || ethers.ZeroHash;
        const child1 = this.tree[prevLevel][childBaseIndex + 1] || ethers.ZeroHash;
        const child2 = this.tree[prevLevel][childBaseIndex + 2] || ethers.ZeroHash;
        const child3 = this.tree[prevLevel][childBaseIndex + 3] || ethers.ZeroHash;
        
        this.tree[level][nodeIndex] = this.hashFour(child0, child1, child2, child3);
      }
    }
  }

  hashFour(a, b, c, d) {
    const packed = ethers.solidityPacked(["bytes32", "bytes32", "bytes32", "bytes32"], [a, b, c, d]);
    return ethers.keccak256(packed);
  }

  root() {
    return this.tree[this.depth][0] || ethers.ZeroHash;
  }

  proof(leafIndex) {
    if (leafIndex >= this.maxLeaves) throw new Error("Leaf index out of bounds");
    
    const pathElements = [];
    let currentIndex = leafIndex;
    
    for (let level = 0; level < this.depth; level++) {
      const childIndex = currentIndex % 4;
      const siblingBaseIndex = Math.floor(currentIndex / 4) * 4;
      
      // Add the 3 siblings (in order, excluding the child)
      for (let i = 0; i < 4; i++) {
        if (i !== childIndex) {
          const sibling = this.tree[level][siblingBaseIndex + i] || ethers.ZeroHash;
          pathElements.push(sibling);
        }
      }
      
      currentIndex = Math.floor(currentIndex / 4);
    }

    return {
      pathElements,
      leafIndex,
      leaf: this.tree[0][leafIndex]
    };
  }

  // Verify proof manually (for testing)
  verifyProof(leafIndex, leaf, proof) {
    let computedHash = leaf;
    let index = leafIndex;
    let proofIndex = 0;

    for (let level = 0; level < this.depth; level++) {
      const childIndex = index % 4;

      if (childIndex === 0) {
        computedHash = this.hashFour(computedHash, proof[proofIndex], proof[proofIndex + 1], proof[proofIndex + 2]);
      } else if (childIndex === 1) {
        computedHash = this.hashFour(proof[proofIndex], computedHash, proof[proofIndex + 1], proof[proofIndex + 2]);
      } else if (childIndex === 2) {
        computedHash = this.hashFour(proof[proofIndex], proof[proofIndex + 1], computedHash, proof[proofIndex + 2]);
      } else {
        computedHash = this.hashFour(proof[proofIndex], proof[proofIndex + 1], proof[proofIndex + 2], computedHash);
      }

      proofIndex += 3;
      index = Math.floor(index / 4);
    }

    return computedHash === this.root();
  }
}


================================================
FILE: test/scalability/ChannelScalability.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import "forge-std/Test.sol";
import "forge-std/console.sol";
import "../../src/BridgeCore.sol";
import "../../src/BridgeAdminManager.sol";
import "../../src/interface/IBridgeCore.sol";
import "lib/openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";

/**
 * @title ChannelScalabilityTest
 * @notice Proof that channel creation is O(1) regardless of existing channel count
 */
contract SimpleChannelScalabilityTest is Test {
    BridgeCore bridgeCore;
    BridgeAdminManager adminManager;

    address constant TARGET_CONTRACT = address(0x123456);

    function setUp() public {
        bridgeCore = new BridgeCore();
        adminManager = new BridgeAdminManager();

        ERC1967Proxy bridgeCoreProxy = new ERC1967Proxy(
            address(bridgeCore),
            abi.encodeCall(
                bridgeCore.initialize, (address(0), address(0), address(0), address(adminManager), address(this))
            )
        );
        bridgeCore = BridgeCore(address(bridgeCoreProxy));

        ERC1967Proxy adminManagerProxy = new ERC1967Proxy(
            address(adminManager), abi.encodeCall(adminManager.initialize, (address(bridgeCore), address(this)))
        );
        adminManager = BridgeAdminManager(address(adminManagerProxy));

        bridgeCore.updateManagerAddresses(address(0), address(0), address(0), address(adminManager));

        IBridgeCore.PreAllocatedLeaf[] memory emptySlots = new IBridgeCore.PreAllocatedLeaf[](0);
        IBridgeCore.UserStorageSlot[] memory balanceSlot = new IBridgeCore.UserStorageSlot[](1);
        balanceSlot[0] = IBridgeCore.UserStorageSlot({
            slotOffset: 0,
            getterFunctionSignature: bytes32(0),
            isLoadedOnChain: false
        });
        adminManager.setAllowedTargetContract(TARGET_CONTRACT, emptySlots, balanceSlot, true);
    }

    /**
     * @notice Proves channel creation cost is stable across different channel counts
     */
    function testOpenChannelGasStability() public {
        console.log("=== Channel Creation Gas Stability Test ===");

        // Measure first channel
        uint256 gas1 = _measureChannelCreation();
        console.log("Channel #1 gas: %d", gas1);

        // Create 50 more channels
        _createChannels(50);
        uint256 gas51 = _measureChannelCreation();
        console.log("Channel #51 gas: %d", gas51);

        // Create 100 more channels
        _createChannels(100);
        uint256 gas151 = _measureChannelCreation();
        console.log("Channel #151 gas: %d", gas151);

        _createChannels(200);
        uint256 gas351 = _measureChannelCreation();
        console.log("Channel #351 gas: %d", gas351);

        // Analyze results
        uint256 variance1 = gas51 > gas1 ? gas51 - gas1 : gas1 - gas51;
        uint256 variance2 = gas151 > gas1 ? gas151 - gas1 : gas1 - gas151;

        uint256 percentage1 = (variance1 * 100) / gas1;
        uint256 percentage2 = (variance2 * 100) / gas1;

        console.log("Variance from baseline (51 vs 1): %d (%d%%)", variance1, percentage1);
        console.log("Variance from baseline (151 vs 1): %d (%d%%)", variance2, percentage2);

        // Gas should be very stable (within 10%)
        assertLt(percentage1, 10, "Channel 51 should have similar gas to channel 1");
        assertLt(percentage2, 10, "Channel 151 should have similar gas to channel 1");

        console.log("");
        console.log("PROOF COMPLETE: Channel creation is O(1)");
        console.log("No DoS vulnerability exists related to channel count");
    }

    function _measureChannelCreation() internal returns (uint256) {
        address[] memory participants = new address[](2);
        participants[0] = address(0x1001);
        participants[1] = address(0x1002);

        bytes32 channelId = keccak256(abi.encode(address(this), block.timestamp, gasleft()));
        BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
            channelId: channelId,
            targetContract: TARGET_CONTRACT,
            whitelisted: participants,
            enableFrostSignature: false
        });

        address leader = address(uint160(0x8000 + block.number + gasleft()));

        vm.startPrank(leader);
        uint256 gasBeforeChannel = gasleft();
        bridgeCore.openChannel(params);
        uint256 gasAfterChannel = gasleft();
        vm.stopPrank();

        return gasBeforeChannel - gasAfterChannel;
    }

    function _createChannels(uint256 count) internal {
        address[] memory participants = new address[](2);
        participants[0] = address(0x1001);
        participants[1] = address(0x1002);

        for (uint256 i = 0; i < count; i++) {
            bytes32 channelId = keccak256(abi.encode(address(this), i, block.timestamp, gasleft()));
            BridgeCore.ChannelParams memory params = BridgeCore.ChannelParams({
                channelId: channelId,
                targetContract: TARGET_CONTRACT,
                whitelisted: participants,
                enableFrostSignature: false
            });

            address leader = address(uint160(0x9000 + i + block.number + gasleft()));
            vm.startPrank(leader);
            bridgeCore.openChannel(params);
            vm.stopPrank();
        }
    }
}



================================================
FILE: test/verifier/Verifier.t.sol
================================================
// SPDX-License-Identifier: MIT
pragma solidity 0.8.29;

import {Test} from "forge-std/Test.sol";
import {TokamakVerifier} from "../../src/verifier/TokamakVerifier.sol";

import "forge-std/console.sol";

contract testTokamakVerifier is Test {
    address owner;

    TokamakVerifier verifier;

    uint128[] public serializedProofPart1;
    uint256[] public serializedProofPart2;
    uint128[] public preprocessedPart1;
    uint256[] public preprocessedPart2;
    uint256[] public publicInputs;
    uint256 public smax;

    function setUp() public virtual {
        verifier = new TokamakVerifier();

        owner = makeAddr("owner");
        vm.startPrank(owner);
        vm.stopPrank();

        // serializedserializedProofPart1: First 16 bytes (32 hex chars) of each coordinate
        // serializedserializedProofPart2: Last 32 bytes (64 hex chars) of each coordinate
        // preprocessedPart1: First 16 bytes (32 hex chars) of each preprocessed committment coordinate
        // preprocessedPart2: last 32 bytes (64 hex chars) of each preprocessed committment coordinate

        /*
        {
    "preprocess_entries_part1": [
    "0x0009bbc7b057876cfc754a192e990683",
    "0x1508f2445c632c43eb3f9df4fc2f1894",
    "0x155cb5eeafb6e4cf7147420e1ce64b17",
    "0x150e9343bcaa1cac0acb160871c5c886"
    ],
    "preprocess_entries_part2": [
    "0x2516192ae1c6b963f3f8e0a1a88b9d669ddbb70cce11452260f4a7c0e71bdbd7",
    "0x60754cda6595f02b2696e5fad29df24e0c9343af6ef16804484b7253261564da",
    "0x6637521519a48e13f11e77f2f3b61bd40ea0a7c2d8d6455b908cd0d943fefa65",
    "0x5bab1505911b91f98e0a7515340ca6bf507c7b7286aff2c079d64acc3a9a26f8"
    ]
        }
        */

        // PREPROCESSED PART 1 (First 16 bytes - 32 hex chars)
        preprocessedPart1.push(0x1136c7a73653af0cbdc9fda441a80391);
        preprocessedPart1.push(0x007c86367643476dcdb0e9bcf1617f1c);
        preprocessedPart1.push(0x18c9e2822155742dd5fbd050aa293be5);
        preprocessedPart1.push(0x00b248168d62853defda478a7a46e0a0);

        // PREPROCESSED PART 2 (Last 32 bytes - 64 hex chars)
        preprocessedPart2.push(0xc4383bb8c86977fc45c94bc42353e37b39907e30b52054990083a85cf5256c22);
        preprocessedPart2.push(0x8fc97f11906d661f0b434c3c49d0ec8b3cac2928f6ff6fac5815686d175d2e87);
        preprocessedPart2.push(0xf84798df0fcfbd79e070d2303170d78e438e4b32975a4ebf6e1ff32863f2cc3e);
        preprocessedPart2.push(0xc6b05d5e144de6e3b25f09093b9ba94c194452d8decf3af3390cfa46df134c0e);

        // SERIALIZED PROOF PART 1 (First 16 bytes - 32 hex chars)
        serializedProofPart1.push(0x15815614b1d3cfda780a76f38debd7a8);
        serializedProofPart1.push(0x15b853b4b6eda1d03dc7425ff8de2ab8);
        serializedProofPart1.push(0x1579e2d3f28e91954ea7f08662b1cf3c);
        serializedProofPart1.push(0x1193fdc21cf50013a57a04b95a980e70);
        serializedProofPart1.push(0x0ef6fa45a824d55e6ab0242e79346af4);
        serializedProofPart1.push(0x0579570790721e06f618e9b435e99fcc);
        serializedProofPart1.push(0x0712c6c5aaa97978302ea53ed788bb9f);
        serializedProofPart1.push(0x0fd202428e1846b62b08551224fc44fa);
        serializedProofPart1.push(0x192da2abb37a61d57edd3cb783519fff);
        serializedProofPart1.push(0x037fecce4bb5d2c935aea5d5dce3eb69);
        serializedProofPart1.push(0x188d99fd3fa3fb713313356e80d011a5);
        serializedProofPart1.push(0x00a815a29deb9b4c2b7f59fad3d0aa70);
        serializedProofPart1.push(0x0dd23c7c26c943439e5793ec06d24027);
        serializedProofPart1.push(0x13af2ab494a3a28b5a9329fcc15e3358);
        serializedProofPart1.push(0x16d79ba31faebbd9be3c5d6ec33405b6);
        serializedProofPart1.push(0x041cb373ead122e1a5755f5e7e11b52a);
        serializedProofPart1.push(0x144bd4c7d0d646d7a50710a2408d10f1);
        serializedProofPart1.push(0x14035301f93670a1083c4bf0410ed855);
        serializedProofPart1.push(0x1106f645a82f2e3098a2d184d5ecce06);
        serializedProofPart1.push(0x12a69c3983176f94b3af657430db1c47);
        serializedProofPart1.push(0x10247238a26ae53c84ad57577454ed6b);
        serializedProofPart1.push(0x1552e5c50974761247a91ad853b5831f);
        serializedProofPart1.push(0x0ed5ac16f53d550faa94b3f89e7c3068);
        serializedProofPart1.push(0x0de8107eff76583c9db6296e542e6f72);
        serializedProofPart1.push(0x059d13674332bae80788f4aad61a36bb);
        serializedProofPart1.push(0x11928ff2162df1dee7bd651f1f06b247);
        serializedProofPart1.push(0x17a05db254eda53ead06061a27b8051a);
        serializedProofPart1.push(0x09cb514bf0ba929adabafa7898023cf3);
        serializedProofPart1.push(0x13eb334743fa8f040a1d288c03872162);
        serializedProofPart1.push(0x1882f3c85de4b5e36314f849a9a35d6c);
        serializedProofPart1.push(0x085686e98ae7c7a0d4ad61f7e1fc2207);
        serializedProofPart1.push(0x0445f9424f1f95b4d831006e7a13f0f0);
        serializedProofPart1.push(0x13eb334743fa8f040a1d288c03872162);
        serializedProofPart1.push(0x1882f3c85de4b5e36314f849a9a35d6c);
        serializedProofPart1.push(0x1674357a821eb6fbd29b19d2bc46bf11);
        serializedProofPart1.push(0x090838093c14b593a824dfe2f491af72);
        serializedProofPart1.push(0x0bf54da2ebdc1f4d8cf126c88c579e2a);
        serializedProofPart1.push(0x04fef23658e5ec9ac987a183ba44f153);

        // SERIALIZED PROOF PART 2 (Last 32 bytes - 64 hex chars)
        serializedProofPart2.push(0x218a2513b9f5d2f07da97b9c001c29cfd1def3795cdc67c7a55aae80d6fa1739);
        serializedProofPart2.push(0x870afac1b023aeb155cd0407035ede2b91c0411f25f3e814419af37045549bf2);
        serializedProofPart2.push(0xb803b959f341ba8d0df34277acf806a22987ee4405bfdb8a6075abab622d8938);
        serializedProofPart2.push(0x4cf5ef5575cc65795c91a41bedd329a870d531132d4c01c0daacfa21ae9d0c9b);
        serializedProofPart2.push(0x5cff38c52fa19d052a230f004a5767cd06f0ee607f235dee61c279901e1eb334);
        serializedProofPart2.push(0x903044616e6a82670d4f0e7da1c2acce49b2f2fdb4bec4d892a6c61a605dabe7);
        serializedProofPart2.push(0x238c8319cab91bf944028e56fdc53fac686912eddb2681bb31da98de1a45046f);
        serializedProofPart2.push(0x72751b0b8849f28e90a043496f8e3c721a9a2c11dc37dfb4b8eb2e51617b838f);
        serializedProofPart2.push(0x1786cc8744ba3c625faf3e425d6efb7fb7a8843f3e7bf849c5bb91aeda51039b);
        serializedProofPart2.push(0xb44c14a62ea7274bfaaeef7f9d177295533ca16b8424c570f40d336f750899c5);
        serializedProofPart2.push(0x0b7e53ae849ff813c770b7fa067c015db95084df6ccfc2d08d7ed344106e9446);
        serializedProofPart2.push(0x903f8c62ade1fe442f896656ccd601dea9f6b884de44ca50179e95b69d7e9278);
        serializedProofPart2.push(0x1a576bce68d74c7f45d2099e21c03ba18b785d4443ca24664a4358b5b4492b07);
        serializedProofPart2.push(0x706a7e78137f8ab4bb6fab55cb7829e4dcd332e07db3233827d57b974ba772c7);
        serializedProofPart2.push(0x08608535f35ba479cbdf98ec4117f1d6d0d5bbbc7120d15975db81ef47084bb1);
        serializedProofPart2.push(0x7a41b65ce8cea584d8903d0e7d311b291df68e8b5cbb2f03aec78b1f632859f3);
        serializedProofPart2.push(0xb51ec8eabaef042a70a4993bae881b2352090b550a0b778918cfa65affcafeb4);
        serializedProofPart2.push(0xab74f4e1b4bb1455e8f57881cc861f7dab291441b019bf6b2b42edff13ab4ff8);
        serializedProofPart2.push(0xd8717ef8b4c49967258125a65a627ffb1039a70986016de2326013298fdad205);
        serializedProofPart2.push(0xb910ebe08c152b86b2cc202f10b89f09bb995327673800c6ff6960cee9fe0fa6);
        serializedProofPart2.push(0x51a0b49263eb04d442553649aa8ba2bff8bf08395e94a40aaf2d6cdf4de5e200);
        serializedProofPart2.push(0x2deddc72de9bd7c8539eb2dbffc05c6d0c6d3dc082211da6b9d2cf6261c5b95c);
        serializedProofPart2.push(0xe90764e8c3c608909905317d1db45264d115e53ff1f5560812e9ad9a712a1aef);
        serializedProofPart2.push(0xf3f16f05a8ac974202fca819ad30654566669e877c575b752e6f2844e8bf811d);
        serializedProofPart2.push(0x7074d02532f74b37b3bf2e2e80e6efd74a59d9c2be7014205f8b0a68da5cf660);
        serializedProofPart2.push(0xb5cb826a1ede3b7eaf370442e4c37560272964a6cacf8d5b7f16a37c376289c9);
        serializedProofPart2.push(0x895f9fab7c3b6d2d2f4c8abab824bce78ebb829d678c9c7893938b1be37797da);
        serializedProofPart2.push(0xe2b5b0dc5b4927868448b343b342c3cbdcc5ed11ec5ca34cafd05d8e1a7d30e5);
        serializedProofPart2.push(0x24a58a466697866ac22e9279dab43ac2b643e6752eedf664396ece2bb61e3e99);
        serializedProofPart2.push(0x4906165f727bdc79f02b6a0b717bacff91e4d980566e205199160e1b84237097);
        serializedProofPart2.push(0x1ae0176fd63ecfa263c5f019842cee0fb2b00c92cdfae64746dd78fc0dd8f58d);
        serializedProofPart2.push(0xf2f32da4b9ea674a98015718df38ef40fd8d4187f23a738ec8fd70902be929d2);
        serializedProofPart2.push(0x24a58a466697866ac22e9279dab43ac2b643e6752eedf664396ece2bb61e3e99);
        serializedProofPart2.push(0x4906165f727bdc79f02b6a0b717bacff91e4d980566e205199160e1b84237097);
        serializedProofPart2.push(0x6ec7a66b4c594cc793e83b44f4da30ad8dd9184f02414a35da49deacc2aeae29);
        serializedProofPart2.push(0x61a58def048a6f157c8c269ce1ff0f622a851eac19fab9060f6cb2e33599eac2);
        serializedProofPart2.push(0x55cc89b9e9e4a9a7c389845c00289a0b8471efb1d4a0bb58c39accb4dc0794a8);
        serializedProofPart2.push(0x2919e53d947ef94f43e16675e04a66b6746bbea448cd8ef68b1c477fa86fc4e9);
        serializedProofPart2.push(0x17fbc25ff5a04b607706778a88332341049268460ee170d1cf06cd64634ee20a);
        serializedProofPart2.push(0x6ead56bfcbba4c416108882629c6c61b940ea05f76cce26606537b96506e15e6);
        serializedProofPart2.push(0x447fff7ec6e9996301a21dbae35881d00d3fc12c7226ba85ff28245be34db010);
        serializedProofPart2.push(0x32fe3527e7bac897c0083e5362f707898d66b4ac5c52bd5004afbe7d713bf6c9);

        // PUBLIC INPUTS (concatenated from instance.json: a_pub_user + a_pub_block + a_pub_function - 512 total)
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x697f6a98de69bdc71426efe52f459cfc);
        publicInputs.push(0x7380218991c8a0feb79bb9715fd26e2a);
        publicInputs.push(0x85e43e3f03778631a09942dd08cf2e8d);
        publicInputs.push(0x4f3d75526b4d4b109e87539730a792e4);
        publicInputs.push(0xe21d7692eebc6214c1585134fda4b0d6);
        publicInputs.push(0x0c8ba5023657fe4b7d7c4edb122894ba);
        publicInputs.push(0x85b8f5c0457dbc3b7c8a280373c40044);
        publicInputs.push(0xa30fe402);
        publicInputs.push(0xa9059cbb);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);

        // a_pub_block (indices 42-65)
        publicInputs.push(0x29dec4629dfb4170647c4ed4efc392cd);
        publicInputs.push(0xf24a01ae);
        publicInputs.push(0x6939333c);
        publicInputs.push(0x00);
        publicInputs.push(0x95abdc);
        publicInputs.push(0x00);
        publicInputs.push(0x19959c1873750220732ca5148bab3254);
        publicInputs.push(0xa0c5ba1cddaf068fc86d068a534eb367);
        publicInputs.push(0x039386c7);
        publicInputs.push(0x00);
        publicInputs.push(0xaa36a7);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xb29b7b4ce683591d957141ca7e4bbc9d);
        publicInputs.push(0x151ac8176283d1313ff21b9d60ad82ce);
        // Rest are zeros (60-65)
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);

        // a_pub_function (indices 66-517) - All the function instance data
        publicInputs.push(0x01);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xe72f6afd7d1f72623e6b071492d1122b);
        publicInputs.push(0x11dafe5d23e1218086a365b99fbf3d3b);
        publicInputs.push(0x3e26ba5cc220fed7cc3f870e59d292aa);
        publicInputs.push(0x1d523cf1ddab1a1793132e78c866c0c3);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x01);
        publicInputs.push(0x00);
        publicInputs.push(0x80);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0x200000);
        publicInputs.push(0x04);
        publicInputs.push(0x00);
        publicInputs.push(0x44);
        publicInputs.push(0x00);
        publicInputs.push(0x010000);
        publicInputs.push(0xe0);
        publicInputs.push(0x00);
        publicInputs.push(0x08000000);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x10000000);
        publicInputs.push(0xe0);
        publicInputs.push(0x00);
        publicInputs.push(0x10000000);
        publicInputs.push(0x70a08231);
        publicInputs.push(0x00);
        publicInputs.push(0x020000);
        publicInputs.push(0x98650275);
        publicInputs.push(0x00);
        publicInputs.push(0x020000);
        publicInputs.push(0xaa271e1a);
        publicInputs.push(0x00);
        publicInputs.push(0x020000);
        publicInputs.push(0x98650275);
        publicInputs.push(0x00);
        publicInputs.push(0x100000);
        publicInputs.push(0xa457c2d7);
        publicInputs.push(0x00);
        publicInputs.push(0x100000);
        publicInputs.push(0xa9059cbb);
        publicInputs.push(0x00);
        publicInputs.push(0x100000);
        publicInputs.push(0x04);
        publicInputs.push(0x00);
        publicInputs.push(0x44);
        publicInputs.push(0x00);
        publicInputs.push(0x08);
        publicInputs.push(0x40);
        publicInputs.push(0x00);
        publicInputs.push(0x010000);
        publicInputs.push(0x200000);
        publicInputs.push(0x02);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x100000);
        publicInputs.push(0x200000);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x100000);
        publicInputs.push(0x200000);
        publicInputs.push(0x60);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x1da9);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x00);
        publicInputs.push(0x020000);
        publicInputs.push(0x200000);
        publicInputs.push(0x08);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x1acc);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x010000);
        publicInputs.push(0x200000);
        publicInputs.push(0x00);
        publicInputs.push(0x00);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0xffffffffffffffffffffffffffffffff);
        publicInputs.push(0xffffffff);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x08);
        publicInputs.push(0x07);
        publicInputs.push(0x00);
        publicInputs.push(0x15);
        publicInputs.push(0x00);
        publicInputs.push(0x0100);
        publicInputs.push(0x00);
        publicInputs.push(0x01);
        publicInputs.push(0x00);
        publicInputs.push(0x10);
        publicInputs.push(0xff);
        publicInputs.push(0x00);
        publicInputs.push(0x200000);
        publicInputs.push(0x200000);
        publicInputs.push(0x01);
        publicInputs.push(0x00);
        publicInputs.push(0x200000);
        publicInputs.push(0x200000);
        publicInputs.push(0x200000);
        publicInputs.push(0x200000);
        publicInputs.push(0x20);
        publicInputs.push(0x00);
        publicInputs.push(0x02);
        publicInputs.push(0x08);
        // Rest are all zeros (247-511)
        for (uint256 i = 247; i < 512; i++) {
            publicInputs.push(0x00);
        }

        smax = 256;
    }

    function testVerifier() public {
        uint256 gasBefore = gasleft();

        // Use low-level call to get the actual bytes returned
        (bool success, bytes memory returnData) = address(verifier).call(
            abi.encodeWithSignature(
                "verify(uint128[],uint256[],uint128[],uint256[],uint256[],uint256)",
                serializedProofPart1,
                serializedProofPart2,
                preprocessedPart1,
                preprocessedPart2,
                publicInputs,
                smax
            )
        );

        uint256 gasAfter = gasleft();
        uint256 gasUsed = gasBefore - gasAfter;

        console.log("Gas used:", gasUsed);
        assert(success == true);
    }

    function testWrongProof_shouldRevert() public {
        serializedProofPart1[4] = 0x0cf3e4f4ddb78781cd5740f3f2a1a3db; // Wrong U_X part1
        serializedProofPart1[5] = 0x0f4b46798d566e5f6653c4fe4df20e83; // Wrong U_Y part1

        serializedProofPart2[4] = 0xd3e45812526acc1d689ce05e186d3a8b9e921ad3a4701013336f3f00c654c908; // Wrong U_X part2
        serializedProofPart2[5] = 0x76983b4b6af2d6a17be232aeeb9fdd374990fdcbd9b1a4654bfbbc5f4bba7e13; // Wrong U_X part2
        vm.expectRevert(bytes("finalPairing: pairing failure"));
        verifier.verify(
            serializedProofPart1, serializedProofPart2, preprocessedPart1, preprocessedPart2, publicInputs, smax
        );
    }

    function testEmptyPublicInput_shouldRevert() public {
        uint256[] memory newPublicInputs;
        vm.expectRevert(bytes("finalPairing: pairing failure"));
        verifier.verify(
            serializedProofPart1, serializedProofPart2, preprocessedPart1, preprocessedPart2, newPublicInputs, smax
        );
    }

    function testWrongSizeProof_shouldRevert() public {
        serializedProofPart1.push(0x0d8838cc826baa7ccd8cfe0692e8a13d); // new point X
        serializedProofPart1.push(0x103aeb959c53fdd5f13b70a350363881); // new point Y
        serializedProofPart2.push(0xbbae56c781b300594dac0753e75154a00b83cc4e6849ef3f07bb56610a02c828); // new point X
        serializedProofPart2.push(0xf3447285889202e7e24cd08a058a758a76ee4c8440131be202ad8bc0cc91ee70); // new point Y

        vm.expectRevert(bytes("loadProof: Proof is invalid"));
        verifier.verify(
            serializedProofPart1, serializedProofPart2, preprocessedPart1, preprocessedPart2, publicInputs, smax
        );
    }

    function testEmptyProof_shouldRevert() public {
        uint128[] memory newserializedProofPart1;
        uint256[] memory newserializedProofPart2;

        vm.expectRevert(bytes("loadProof: Proof is invalid"));
        verifier.verify(
            newserializedProofPart1, newserializedProofPart2, preprocessedPart1, preprocessedPart2, publicInputs, smax
        );
    }
}



================================================
FILE: test/verifier/proof1/channel5_proof1.json
================================================
{
  "proof_entries_part1": [
    "0x1561ed36e27f4d6114d6c8a36fecfbb1",
    "0x0151c14b191da19f77058d03002995a3",
    "0x061377bb72a985cae2bb2797030882d2",
    "0x11777e18043b1b9749450893132706f2",
    "0x1137aee3922f070b4e6ba5634613fdc0",
    "0x0012149cec72fcafb0768b01c498ad90",
    "0x0193c5e28d6259f79d702c2305ed4c5c",
    "0x037ca9373803d90bf2efc2a240f0bb7f",
    "0x0237ebbbb58b3f6a04b37ff0d9ac9399",
    "0x14a5b9d6193fd4fc0064eadbd7da4ea0",
    "0x1070f2aaf5561bbc0ad6feae37683cdd",
    "0x09a7008d70016ee2c31ddc036d73c900",
    "0x0d658b61c53eecbb8bd03dddd4e89f22",
    "0x131ce2ce82a5704e999a047add37fef8",
    "0x05040f5c56f1039d4bf797a46268f811",
    "0x19c1aab945d7bff67198f067e8cd4bca",
    "0x0bdfbcf67209f82e2b8d771ffb70d1a3",
    "0x0cd57182cb964698aa70521a156e1bd0",
    "0x047d30636c10ee797ba34a3e7b11283b",
    "0x0f450b3032222e169606ada1c7590f7a",
    "0x04cd6e9381ce4294eb8e9284b7b6a0ff",
    "0x0db8f57a92e71881e0f9e31edcc5ae44",
    "0x15b11a13bf916d9aab2cb78cd64f3566",
    "0x0599baa32b25ff3d3dd583c59f8f2572",
    "0x0db7fc9b72075dbc10e35326e8faa672",
    "0x14a6ea4023a7d0e859260d6a14d4b304",
    "0x054762b1da9320437d895d0625afe2db",
    "0x13f4de711640e39a875583f516f1a1c6",
    "0x08d7eda32267cde0a6e32c63ebd21d5e",
    "0x05ab7fb2a0fad64c71cebdf6529c60a0",
    "0x0bc7987795b75b73ee11c2f9fd0dec2d",
    "0x094c2b3ac910d852a2d91638c4c0a162",
    "0x08d7eda32267cde0a6e32c63ebd21d5e",
    "0x05ab7fb2a0fad64c71cebdf6529c60a0",
    "0x128febe3228013340969ca4dde497082",
    "0x10d612212485a512165139e73bba6f7f",
    "0x159b8c9cd775a820c4e031bf893e6eb1",
    "0x077c61de01964832198dd609d1b13107"
  ],
  "proof_entries_part2": [
    "0xbf2b11d1737281cfee57678c1a3dbac5cb1607c752b2e29b9c51b4a65b11bb6a",
    "0xff975fd167d92e0445fbb5f52a76ff80ff9e73e5b3260c348b9c2de946e0e9a8",
    "0xaa880a3b4330883e9ae7804fd6d7fbe7080866611eb19639fd054719d71a7c80",
    "0x95d9d6d85e08049ff3f525818d4c3d3ddf1a48e3e6aad229dbc2d6d52db90610",
    "0xf83eb601d793409d08b2d963153cfd83c1bdebea22060c1e3c2a512e239a51ac",
    "0x7f43c8a660b2444e5d207e7c1bf473d200be87f1736bc25925ab8379d78de226",
    "0xfb9badb894e1392d882c84681f81849be36578a940c90058ae0e0ece15b13281",
    "0xd1614c16e95274ec313f398f195b07e16498fc588b41bb298a721ddb746a04cf",
    "0x2f0adb6d6ffccdaa3847b1cd85ea56691e2c0bdefb1531ce9091eed2d5880083",
    "0xf20412a4143ed0da13ba8350159043f888a0da2bde8fd03f9035287c8cda3dbd",
    "0xb5525516dd53081f907163bec4763a46331668139d19caa95f12ee9d6376c005",
    "0xb106c461f58d35224775c49332753fd53ccee0b9c1d56f007961e97f8e9b32e7",
    "0xade59dac77439db65a1adb102a7d7b6f99e731bae0ff154344c7dd0459e3fd26",
    "0x245211fda6e0d1d01cc4ffd5f9a15cd5044eb2c911886a7e25b889234438eecd",
    "0xfc554eb8599bb323da6cfb22998433181522579344f0150fb203442def4b1c90",
    "0x7f57140a268850a01e1759ca87655024c5f6d3a06a69358ec0b001849bcaa5ec",
    "0x3446a9152efa04bad31971c1379484bc6824a03a8c02a40d2d4d3063d6f8ebb2",
    "0xa18c648a8cea127cebd5304ac2b8a7ac88a01f94981f145b54efe7e117a68e0e",
    "0xf8e5e3160a49dcbcf3ca58a8edf3cb1c8fe4a61e3ba859e2e9ef43a2b51eadcb",
    "0xe79b19a74553332f4a7d4e5ff8c1632a0431698c65933f8e51e3532093881a3a",
    "0xcf30c1cd966e711c1e7b1a99aa2aafd9b18be3db497f551cdb4b368ada76ca8e",
    "0x42bc24e057767e0958594088ebed707abb37db29a27da3083a45cff589922cd7",
    "0x6cebbed847a933316f74bb7086e094c9fec1b1690e204a8f0f2cfd827d3b48f5",
    "0x3727f1a8de98e145220fd9d356a23670f05432e4e0bafc5dcf7e84eead5297d1",
    "0x2a20d745ad75f98198b5e81dd4b2f0c631b18b3a813204ac06ef51260f013294",
    "0x3cbebd6ea45fb79c9f76da3ee07a54dc64a73f5efbb03ec8c5086b7163d1a846",
    "0x5a6dfb93bce42687aa9d28192ed7d073f36765b51e7caf99131bfa0815d3cab8",
    "0x9b02180195b1a401a65a31611712f29d8c31ace5820becd52fde473d8d92a6a8",
    "0x0c007d31dc56158c71a102bf80995c445d1e0f707b2f1fedd21bb54018a5e683",
    "0x9111debc1fa2f4f595ab58c4b44b828833bd7b9d78867166d8e9882a36490293",
    "0xd236bcdbcab6d355076130b89aed3eb0491f61674f55621467aea92ee57c7bcc",
    "0x4de31f87e7883b8feeb316733a23fb51b76d75b2b5a2055113368431c9174b74",
    "0x0c007d31dc56158c71a102bf80995c445d1e0f707b2f1fedd21bb54018a5e683",
    "0x9111debc1fa2f4f595ab58c4b44b828833bd7b9d78867166d8e9882a36490293",
    "0xa974ad66b76c4e6fc372795c1ae08a932d2da142358218e25b6e3470d5f2c763",
    "0xe16da42e5597ca36ac1b6a2acefa072847dee1a8e2d29713ad08363ce9e28814",
    "0xdc1d436214be1ed57fcb6015668b4b29ce1e801619b017c23347a0ad0657b731",
    "0xa9e71960ce843e37bbdb8b557614031fe7feeb21cb0c96b27919a86af493fd28",
    "0x3953786e1401544fa78156384c8fd60081b0b7bc7fc361d545c8ffb2f4123b35",
    "0x26cb8034a8a970461a6e75d3ea17d814e5e4c66beb138c0979a6b323af58c13a",
    "0x141ddeb0867939bea66c91055680bc2ff30e3d8a2580a15d62718793f355560e",
    "0x6cb63f94279c385a6de65bce0ac459b52a278f4a2a1c4a7a2fda415ba4d5bff6"
  ],
  "a_pub_user": [
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x769375dc5a3b94bcf40f75827be355f8",
    "0x5876a74c8e49224c5997659e57ca9a5b",
    "0x7c4a3489a695f09d962204ae3cb42fd0",
    "0x0bfee9c26c3cd9549157ef90c7a648e7",
    "0xa1de99584b859abf3ecc0a3d8ae22c4d",
    "0x0c2d7a50c82d20362117a77c54dffbad",
    "0x85b8f5c0457dbc3b7c8a280373c40044",
    "0xa30fe402",
    "0xa9059cbb",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ],
  "a_pub_block": [
    "0x4a13a0977f4d7101ebc24b87bb23f0d5",
    "0x13cb6ae3",
    "0x6941286c",
    "0x00",
    "0x965505",
    "0x00",
    "0xaaa74863900cd1aa397b147b5e3a97df",
    "0x3158a0204e0c6977c846dec8dcb483ab",
    "0x03938700",
    "0x00",
    "0xaa36a7",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x08dc98d739f58a805255c068ea55c0bc",
    "0x236aee1beb6982e29d97f81729692e5e",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ],
  "a_pub_function": [
    "0x01",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xe72f6afd7d1f72623e6b071492d1122b",
    "0x11dafe5d23e1218086a365b99fbf3d3b",
    "0x3e26ba5cc220fed7cc3f870e59d292aa",
    "0x1d523cf1ddab1a1793132e78c866c0c3",
    "0x00",
    "0x00",
    "0x01",
    "0x00",
    "0x80",
    "0x00",
    "0x00",
    "0x00",
    "0x200000",
    "0x04",
    "0x00",
    "0x44",
    "0x00",
    "0x010000",
    "0xe0",
    "0x00",
    "0x08000000",
    "0x20",
    "0x00",
    "0x10000000",
    "0xe0",
    "0x00",
    "0x10000000",
    "0x70a08231",
    "0x00",
    "0x020000",
    "0x98650275",
    "0x00",
    "0x020000",
    "0xaa271e1a",
    "0x00",
    "0x020000",
    "0x98650275",
    "0x00",
    "0x100000",
    "0xa457c2d7",
    "0x00",
    "0x100000",
    "0xa9059cbb",
    "0x00",
    "0x100000",
    "0x04",
    "0x00",
    "0x44",
    "0x00",
    "0x08",
    "0x40",
    "0x00",
    "0x010000",
    "0x200000",
    "0x02",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x100000",
    "0x200000",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x100000",
    "0x200000",
    "0x60",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x1da9",
    "0x00",
    "0xffffffff",
    "0x00",
    "0x020000",
    "0x200000",
    "0x08",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x1acc",
    "0x00",
    "0xffffffff",
    "0x00",
    "0x02",
    "0x010000",
    "0x200000",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x08",
    "0x07",
    "0x00",
    "0x15",
    "0x00",
    "0x0100",
    "0x00",
    "0x01",
    "0x00",
    "0x10",
    "0xff",
    "0x00",
    "0x200000",
    "0x200000",
    "0x01",
    "0x00",
    "0x200000",
    "0x200000",
    "0x200000",
    "0x200000",
    "0x20",
    "0x00",
    "0x02",
    "0x08",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ]
}


================================================
FILE: test/verifier/proof1/channel5_proof2.json
================================================
{
  "proof_entries_part1": [
    "0x0c597e8d067ec027a89b1d50df61957e",
    "0x1839f50a8395d1525a27a69e74f06912",
    "0x13fac61cd1f73bfea5e6953e6e60b3dc",
    "0x047c09792a826f665fbbca710968f432",
    "0x010db3f03e5e109a14d90ef3330dd591",
    "0x0a20f50ad4099ca62148776c08a20d4c",
    "0x0226161b164c7697e53aa2ba33966090",
    "0x10bc5e57cae070035ee4f86dc10214bd",
    "0x1009da7dfb280ef694a5b9b26b5bf799",
    "0x053cecd0ad95cc095f29ba507097404d",
    "0x056608410082af9d8a01e2e1c1465e9f",
    "0x0daccec848b12ca04cbfa11dfcf4f8f0",
    "0x18330b375928a4027db6e53310ed9669",
    "0x10f6fb277dcb3277cf7dc87e0302e89e",
    "0x15e1e5fdca6d000e1da477c487b41bf2",
    "0x09135e9c4317fcf65d1e740047607b4b",
    "0x1884c5bbb6f838fe2f79602f3d845084",
    "0x0c0a6c31c670cf879bce67ecd679a14e",
    "0x0ae7702e13c3ffdfe1cf7ceb464878e2",
    "0x0750f38845b4e885b7d674ae0a29ff61",
    "0x196d21cc245543853a64a4f9dd62bb26",
    "0x17441de0c9b2623e7544fca3f6d608ba",
    "0x1850d8c3788c59453e8e269528f449d1",
    "0x06f0dde5643c8125a846a32e896634d3",
    "0x021c3fdb09904af0fd058819ef6d47b5",
    "0x090e7739294f93d13d4255452e1af810",
    "0x11a0815a46669fba0e05f56a3669737f",
    "0x032e1fde654804faaf561eb4d2bc0fba",
    "0x0eaef939a6bd2f223c8ef10df3f4f5c6",
    "0x0af7cb70eba5c0790088052d44a12e75",
    "0x0ea486e17e7a492d16e93c25de65df5d",
    "0x0737e4cdda09bd2dea45afc834aa819b",
    "0x0eaef939a6bd2f223c8ef10df3f4f5c6",
    "0x0af7cb70eba5c0790088052d44a12e75",
    "0x12474eee681e9b55658ea783608b167b",
    "0x18238d358dfd1f2cf22ce49c2299d9bf",
    "0x012cef14b72bd5892448c07d8e3f896b",
    "0x1089a6ace6dc814d7c78cf9e609655e3"
  ],
  "proof_entries_part2": [
    "0x3d6796b0cd2ea2d0ce2c804cafb1a4d79f45b6b608c9a59f77f2f489fd022555",
    "0x9ecd891b5c9036beaf5c7f7317f20e7289fc0699d377058802ad1bfb734c2144",
    "0xadd1c702ca34b7e57b21816ace84d310d856161a3ed2f5a6b47bfc6bff769ff1",
    "0x56663f0167a4740f005f90b538a0882824db3d9ffcd6fc71754c805efce4d26e",
    "0xa776e72b0419fb3a4c235e13051d9db126de97523a07329f3b3a33197c33e563",
    "0x6f20930a3ceedd9d3a2f49a3152f69b6d38595d4982ca610ad4fe58398ef22b7",
    "0x7a6e8b177dd09b1c46bd474dd0c1352912584842016a215fd248259f430314b8",
    "0xad3538f4caec7dd096e0c20d0bb7f71859e9415054203b2fd45ef450be1136e8",
    "0xcbc335109f130a1557231c8eac45db3ccbaf06d2766ce70d1cfd3c56be31e814",
    "0x1c8ee0eab1a5f59a48fb06f1d32b2272d99b8ef7adf8a14fa95cf1894204a73b",
    "0xaf7c9ae42281302f9b4ef49f54b0a9b3f020859e8e777cdd47bddfa032cf8b1a",
    "0x111aee3560b669a766e836133302ae8439296ceed46e21ef3180f94e5b066bf7",
    "0xbcdf20618bbf1504fec5feafc051e7d0a84958c60a2cd34f595bead5b3fd253f",
    "0x388be43825c83438cc85da5cc07672944f78173aaad84f58a123eae2be25021c",
    "0x9df2da609d08d3e47a6b99a8127f68f2f96c38836326b0b1f45b6a3a308c1fc0",
    "0x54d85551a30758be3e54ecaef0ae4adacce18da909010f83ccf6acc964571ebd",
    "0xb717a5e820d6df9afde3b9dcdbc745c948155ffc352bc7b5353fd604908164d0",
    "0x0ca39e643140b51d35e20dbc301c22970079505947afb76029092aaa66f77567",
    "0x97528e31eca0f8c2bd0dac17f9d1d36093f7e4ecd72896a6860918bc7447e85b",
    "0xb98aeddc8640d7744c7d8da799cff5772b46c71a5e496949be1584b4d1c5be17",
    "0xb8f5380d34d5b82a41251eca505270aff930d3e288103da1c4fff8ba563a59ea",
    "0x66e9e2aff80e09fad81cccfbaf58723ec8c9e17b407a86eee72d652ed13db317",
    "0xbbe88ce2324b211aa6212bcc499e5ab52479ba571493336bb3e1d4233a593791",
    "0xf8d1ef7647ef6bff2c4939a3f99cf906fa95540d2435c1a95c661ab5b2b4043f",
    "0xcf955c3fa9f77969e7bb5777583c8894320defed8cd3945c4f67bbcd1d2bd3ba",
    "0x12451bf344f6e60b9bad9fe9a30353b7e1fb774a3bfccad699e7b5814bfa5956",
    "0xbf80c257b9ea225dadef9c26590aaf1c560acf7325afb6a924bbd9708595de31",
    "0x4a075db1aa902b86b41638db97ed498bbfe3fe256eadab9d92feaea25a22ff68",
    "0x51845348a7001b321d1aeb82ed3f4e5b519417ae29008199c671079baf6dfdf2",
    "0xf08cb1b6264608f9a3efaf0e1e171596fa62e57b7d6e0f12850e8d33e3cf851c",
    "0x946f3a5b225743dac7ff1b3f240ea9a0705d355b8f71d041bcc82463b4fdfc4d",
    "0xc118c87ae2e4c388410b6a1f1ce302ff9136e8775ed8739b0dff99f6c805bbab",
    "0x51845348a7001b321d1aeb82ed3f4e5b519417ae29008199c671079baf6dfdf2",
    "0xf08cb1b6264608f9a3efaf0e1e171596fa62e57b7d6e0f12850e8d33e3cf851c",
    "0x6776f13b2741f1b90bc575d8168e02b762719d55892b662d3f8eeda5a3340f43",
    "0xe55cab84050a0da7f187187018e8486d30003419fcfd6a5830067e814e968f9f",
    "0x9b84943cc31a11cc5667846a3c9a694ee938f4154203d9777988f044022abe8c",
    "0xdf6d649191183992513651bfb28c4f2e4fc8e19f9bd61c40de261de0a72d1c12",
    "0x185cec5ced27e1e04250c2d0d7febced0a54493f440acf0fcb1449033455986e",
    "0x4e7dfc46cbdbf22d2afb7504acefffd3eb3f6de3d292febe91e95bc605453aaf",
    "0x56f948dcae4b3f3c7b7e4b5ca9c049fce9748b7ae21d64ed84d983b34b6ff114",
    "0x5dd081ac6a8c734f275faa11ebcbe84fa5b6e172b214175727283be9f0bfadb1"
  ],
  "a_pub_user": [
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x7c4a3489a695f09d962204ae3cb42fd0",
    "0x0bfee9c26c3cd9549157ef90c7a648e7",
    "0xd7baafc7df716c71558ca0fa9cb261ba",
    "0x70f94af942dafda0a4ffb9d651e610b8",
    "0x8bae88e3ff98a3f1bfcc61e1158affb5",
    "0x0957213fbdf4e57da668994840c99439",
    "0x85b8f5c0457dbc3b7c8a280373c40044",
    "0xa30fe402",
    "0xa9059cbb",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ],
  "a_pub_block": [
    "0x4a13a0977f4d7101ebc24b87bb23f0d5",
    "0x13cb6ae3",
    "0x6941286c",
    "0x00",
    "0x965505",
    "0x00",
    "0xaaa74863900cd1aa397b147b5e3a97df",
    "0x3158a0204e0c6977c846dec8dcb483ab",
    "0x03938700",
    "0x00",
    "0xaa36a7",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x08dc98d739f58a805255c068ea55c0bc",
    "0x236aee1beb6982e29d97f81729692e5e",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ],
  "a_pub_function": [
    "0x01",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xe72f6afd7d1f72623e6b071492d1122b",
    "0x11dafe5d23e1218086a365b99fbf3d3b",
    "0x3e26ba5cc220fed7cc3f870e59d292aa",
    "0x1d523cf1ddab1a1793132e78c866c0c3",
    "0x00",
    "0x00",
    "0x01",
    "0x00",
    "0x80",
    "0x00",
    "0x00",
    "0x00",
    "0x200000",
    "0x04",
    "0x00",
    "0x44",
    "0x00",
    "0x010000",
    "0xe0",
    "0x00",
    "0x08000000",
    "0x20",
    "0x00",
    "0x10000000",
    "0xe0",
    "0x00",
    "0x10000000",
    "0x70a08231",
    "0x00",
    "0x020000",
    "0x98650275",
    "0x00",
    "0x020000",
    "0xaa271e1a",
    "0x00",
    "0x020000",
    "0x98650275",
    "0x00",
    "0x100000",
    "0xa457c2d7",
    "0x00",
    "0x100000",
    "0xa9059cbb",
    "0x00",
    "0x100000",
    "0x04",
    "0x00",
    "0x44",
    "0x00",
    "0x08",
    "0x40",
    "0x00",
    "0x010000",
    "0x200000",
    "0x02",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x100000",
    "0x200000",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x100000",
    "0x200000",
    "0x60",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x1da9",
    "0x00",
    "0xffffffff",
    "0x00",
    "0x020000",
    "0x200000",
    "0x08",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0x1acc",
    "0x00",
    "0xffffffff",
    "0x00",
    "0x02",
    "0x010000",
    "0x200000",
    "0x00",
    "0x00",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x20",
    "0x00",
    "0x02",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x00",
    "0x02",
    "0x08",
    "0x07",
    "0x00",
    "0x15",
    "0x00",
    "0x0100",
    "0x00",
    "0x01",
    "0x00",
    "0x10",
    "0xff",
    "0x00",
    "0x200000",
    "0x200000",
    "0x01",
    "0x00",
    "0x200000",
    "0x200000",
    "0x200000",
    "0x200000",
    "0x20",
    "0x00",
    "0x02",
    "0x08",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ]
}


================================================
FILE: utils/compareBlockHashMethods.js
================================================
#!/usr/bin/env node

import fs from 'fs';
import pkg from 'js-sha3';
const { keccak256 } = pkg;

/**
 * Method 1: Similar to _computeBlockInfosHash
 * Reconstructs 32-byte values from pairs and encodes as bytes16(upper), bytes16(lower)
 */
function computeBlockInfosHashStyle(blockInputs) {
    console.log('\n=== Method 1: _computeBlockInfosHash Style ===');
    
    let concatenatedData = '';
    
    // Process 12 block variables (24 values total)
    for (let i = 0; i < 24; i += 2) {
        let lower = blockInputs[i];
        let upper = blockInputs[i + 1];
        
        // Remove 0x prefix
        if (lower.startsWith('0x')) lower = lower.slice(2);
        if (upper.startsWith('0x')) upper = upper.slice(2);
        
        // Pad to 32 hex chars each (16 bytes)
        lower = lower.padStart(32, '0');
        upper = upper.padStart(32, '0');
        
        // Reconstruct the original 32-byte value
        // lower contains the lower 16 bytes, upper contains the upper 16 bytes
        const originalValue = upper + lower; // upper 16 bytes + lower 16 bytes
        
        // Now split it back for bytes16(uint128(value >> 128)), bytes16(uint128(value))
        const value = BigInt('0x' + originalValue);
        const upperPart = (value >> 128n).toString(16).padStart(32, '0'); // bytes16(uint128(value >> 128))
        const lowerPart = (value & ((1n << 128n) - 1n)).toString(16).padStart(32, '0'); // bytes16(uint128(value))
        
        // Encode as bytes16(upper), bytes16(lower) - matching Solidity abi.encodePacked
        concatenatedData += upperPart + lowerPart;
        
        console.log(`Variable ${Math.floor(i/2)}: reconstructed=${originalValue} -> encoded=${upperPart}${lowerPart}`);
    }
    
    const buffer1 = Buffer.from(concatenatedData, 'hex');
    const hash1 = '0x' + keccak256(buffer1);
    
    console.log(`Method 1 concatenated data: ${concatenatedData.length} hex chars`);
    console.log(`Method 1 hash: ${hash1}`);
    
    return hash1;
}

/**
 * Method 2: Similar to _extractBlockInfoHashFromProof  
 * Treats pairs as (lower, upper) and encodes as bytes16(upper), bytes16(lower)
 */
function extractBlockInfoHashStyle(blockInputs) {
    console.log('\n=== Method 2: _extractBlockInfoHashFromProof Style ===');
    
    let concatenatedData = '';
    
    // Process pairs directly as lower/upper
    for (let i = 0; i < 24; i += 2) {
        let lower = blockInputs[i];      // publicInputs[i]
        let upper = blockInputs[i + 1];  // publicInputs[i + 1]
        
        // Remove 0x prefix
        if (lower.startsWith('0x')) lower = lower.slice(2);
        if (upper.startsWith('0x')) upper = upper.slice(2);
        
        // Pad to 32 hex chars (16 bytes) for uint128 truncation
        lower = lower.padStart(32, '0');
        upper = upper.padStart(32, '0');
        
        // Encode as bytes16(uint128(upper)), bytes16(uint128(lower))
        concatenatedData += upper + lower;
        
        console.log(`Pair ${Math.floor(i/2)}: lower=${blockInputs[i]}, upper=${blockInputs[i+1]} -> ${upper}${lower}`);
    }
    
    const buffer2 = Buffer.from(concatenatedData, 'hex');
    const hash2 = '0x' + keccak256(buffer2);
    
    console.log(`Method 2 concatenated data: ${concatenatedData.length} hex chars`);
    console.log(`Method 2 hash: ${hash2}`);
    
    return hash2;
}

/**
 * Main function
 */
function main() {
    console.log('=== Block Hash Method Comparison ===');
    
    const args = process.argv.slice(2);
    if (args.length === 0) {
        console.log('Usage: node compareBlockHashMethods.js <path-to-json-file>');
        process.exit(1);
    }
    
    try {
        const jsonData = JSON.parse(fs.readFileSync(args[0], 'utf8'));
        const blockInputs = jsonData.a_pub_block;
        
        if (!Array.isArray(blockInputs) || blockInputs.length < 24) {
            throw new Error('Invalid a_pub_block data');
        }
        
        console.log('Block inputs:', blockInputs.slice(0, 6), '... (24 total)');
        
        const hash1 = computeBlockInfosHashStyle(blockInputs);
        const hash2 = extractBlockInfoHashStyle(blockInputs);
        
        console.log('\n=== COMPARISON ===');
        console.log(`Method 1 (_computeBlockInfosHash style): ${hash1}`);
        console.log(`Method 2 (_extractBlockInfoHashFromProof style): ${hash2}`);
        console.log(`Hashes match: ${hash1 === hash2}`);
        
        console.log('\nExpected hash: 0xf296a7e2ea8f4a80e31abe6135d96a70563a691d77fd9a19d8fb4bacafbb7baa');
        console.log(`Method 1 matches expected: ${hash1 === '0xf296a7e2ea8f4a80e31abe6135d96a70563a691d77fd9a19d8fb4bacafbb7baa'}`);
        console.log(`Method 2 matches expected: ${hash2 === '0xf296a7e2ea8f4a80e31abe6135d96a70563a691d77fd9a19d8fb4bacafbb7baa'}`);
        
    } catch (error) {
        console.error('Error:', error.message);
        process.exit(1);
    }
}

if (import.meta.url === `file://${process.argv[1]}`) {
    main();
}


================================================
FILE: utils/computeBlockHashFromEvent.js
================================================
#!/usr/bin/env node

import pkg from 'js-sha3';
const { keccak256 } = pkg;

/**
 * Computes the block info hash using actual block data from StateInitialized event
 * This should match what _computeBlockInfosHash produces
 */
function computeBlockHashFromEventData() {
    console.log('=== Computing Block Hash from StateInitialized Event Data ===');
    
    // Data from the StateInitialized event
    const blockData = {
        blockNumber: 10042082,
        timestamp: 1768395648,
        prevrandao: BigInt('61187585605546888283688024508636489663394840223037630789961933750249413663611'),
        gaslimit: 60000000,
        basefee: 1070733430,
        coinbase: '0x4dF6EB2EC570B58cC64f540247A8AdFA11F1Cf63',
        chainId: 11155111,
        selfbalance: 0,
        // Block hashes would be computed as blockhash(block.number - 1) through blockhash(block.number - 4)
        // For this example, let's assume they are from the a_pub_block data (blocks n-1 to n-4)
        blockHash1: BigInt('0x5124141fe4d8f8248ff8fb31c6a0b8a73a91c006398956bd1190e17d2ad63c11'),
        blockHash2: BigInt('0x472ed29235baa4d8b63f2c7eb229c5b4d08f571e5dcb0f26c5cf5eeac0765018'),
        blockHash3: BigInt('0x6b429d3883eb84a2ab0a430c65e53a19103958f3cdc5ddb02423c32c9f268d5e'),
        blockHash4: BigInt('0x827c474d2507f1152f1bb1cde00f54888f93977b2c571e2ea67377a9d0265bea')
    };
    
    let concatenatedData = '';
    
    // 1. COINBASE (32 bytes total - upper 16 + lower 16)
    const coinbaseValue = BigInt(blockData.coinbase);
    const coinbaseUpper = (coinbaseValue >> 128n).toString(16).padStart(32, '0');
    const coinbaseLower = (coinbaseValue & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += coinbaseUpper + coinbaseLower;
    console.log(`COINBASE: ${blockData.coinbase} -> ${coinbaseUpper}${coinbaseLower}`);
    
    // 2. TIMESTAMP (32 bytes total - upper 16 + lower 16)
    const timestamp = BigInt(blockData.timestamp);
    const timestampUpper = (timestamp >> 128n).toString(16).padStart(32, '0');
    const timestampLower = (timestamp & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += timestampUpper + timestampLower;
    console.log(`TIMESTAMP: ${blockData.timestamp} -> ${timestampUpper}${timestampLower}`);
    
    // 3. NUMBER (32 bytes total - upper 16 + lower 16)
    const number = BigInt(blockData.blockNumber);
    const numberUpper = (number >> 128n).toString(16).padStart(32, '0');
    const numberLower = (number & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += numberUpper + numberLower;
    console.log(`NUMBER: ${blockData.blockNumber} -> ${numberUpper}${numberLower}`);
    
    // 4. PREVRANDAO (32 bytes total - upper 16 + lower 16)
    const prevrandaoUpper = (blockData.prevrandao >> 128n).toString(16).padStart(32, '0');
    const prevrandaoLower = (blockData.prevrandao & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += prevrandaoUpper + prevrandaoLower;
    console.log(`PREVRANDAO: ${blockData.prevrandao.toString()} -> ${prevrandaoUpper}${prevrandaoLower}`);
    
    // 5. GASLIMIT (32 bytes total - upper 16 + lower 16)
    const gaslimit = BigInt(blockData.gaslimit);
    const gaslimitUpper = (gaslimit >> 128n).toString(16).padStart(32, '0');
    const gaslimitLower = (gaslimit & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += gaslimitUpper + gaslimitLower;
    console.log(`GASLIMIT: ${blockData.gaslimit} -> ${gaslimitUpper}${gaslimitLower}`);
    
    // 6. CHAINID (32 bytes total - upper 16 + lower 16)
    const chainId = BigInt(blockData.chainId);
    const chainIdUpper = (chainId >> 128n).toString(16).padStart(32, '0');
    const chainIdLower = (chainId & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += chainIdUpper + chainIdLower;
    console.log(`CHAINID: ${blockData.chainId} -> ${chainIdUpper}${chainIdLower}`);
    
    // 7. SELFBALANCE (32 bytes total - upper 16 + lower 16)
    const selfbalance = BigInt(blockData.selfbalance);
    const selfbalanceUpper = (selfbalance >> 128n).toString(16).padStart(32, '0');
    const selfbalanceLower = (selfbalance & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += selfbalanceUpper + selfbalanceLower;
    console.log(`SELFBALANCE: ${blockData.selfbalance} -> ${selfbalanceUpper}${selfbalanceLower}`);
    
    // 8. BASEFEE (32 bytes total - upper 16 + lower 16)
    const basefee = BigInt(blockData.basefee);
    const basefeeUpper = (basefee >> 128n).toString(16).padStart(32, '0');
    const basefeeLower = (basefee & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
    concatenatedData += basefeeUpper + basefeeLower;
    console.log(`BASEFEE: ${blockData.basefee} -> ${basefeeUpper}${basefeeLower}`);
    
    // 9-12. Block hashes 1-4 blocks ago
    const blockHashes = [blockData.blockHash1, blockData.blockHash2, blockData.blockHash3, blockData.blockHash4];
    for (let i = 0; i < blockHashes.length; i++) {
        const blockHash = blockHashes[i];
        const blockHashUpper = (blockHash >> 128n).toString(16).padStart(32, '0');
        const blockHashLower = (blockHash & ((1n << 128n) - 1n)).toString(16).padStart(32, '0');
        concatenatedData += blockHashUpper + blockHashLower;
        console.log(`BLOCKHASH${i+1}: 0x${blockHash.toString(16)} -> ${blockHashUpper}${blockHashLower}`);
    }
    
    // Compute hash
    const buffer = Buffer.from(concatenatedData, 'hex');
    const hash = '0x' + keccak256(buffer);
    
    console.log(`\nConcatenated data length: ${concatenatedData.length} hex chars`);
    console.log(`Computed hash: ${hash}`);
    console.log(`Expected _computeBlockInfosHash result: 0x99bb0c6be082fed8813c4488a6e24d6471787aa15f88a8fa6344ced5c68378ac`);
    console.log(`Match: ${hash === '0x99bb0c6be082fed8813c4488a6e24d6471787aa15f88a8fa6344ced5c68378ac'}`);
    
    return hash;
}

// Run the computation
computeBlockHashFromEventData();


================================================
FILE: utils/computeBlockInfoHash.js
================================================
#!/usr/bin/env node

import fs from 'fs';
import pkg from 'js-sha3';
const { keccak256 } = pkg;

/**
 * Computes the block info hash from a JSON file containing block public inputs
 * This replicates the logic from BridgeProofManager._extractBlockInfoHashFromProof()
 * 
 * Note: The proof data contains block hashes for blocks n-1 through n-4,
 * while _computeBlockInfosHash uses blocks n-2 through n-5 (different range).
 * 
 * @param {string} jsonFilePath - Path to the JSON file (e.g., utils/instance.json)
 * @returns {string} - The computed keccak256 hash as a hex string
 */
function computeBlockInfoHash(jsonFilePath) {
    try {
        // Read and parse the JSON file
        const jsonData = JSON.parse(fs.readFileSync(jsonFilePath, 'utf8'));
        
        // Extract the a_pub_block array
        const blockInputs = jsonData.a_pub_block;
        
        if (!Array.isArray(blockInputs)) {
            throw new Error('Invalid JSON structure: a_pub_block should be an array');
        }
        
        // Block info should have 24 entries (12 variables Ã— 2 for upper/lower 16 bytes)
        if (blockInputs.length < 24) {
            throw new Error('Block inputs too short - expected at least 24 entries');
        }
        
        console.log(`Total block inputs: ${blockInputs.length}`);
        console.log(`Block inputs (first 10 entries):`, blockInputs.slice(0, 10));
        
        // Extract block info from the array (replicating _extractBlockInfoHashFromProof logic)
        // Each block variable is stored as lower 16 bytes + upper 16 bytes
        // In _extractBlockInfoHashFromProof: for (uint256 i = 40; i < 64; i += 2)
        // 
        // Structure: COINBASE, TIMESTAMP, NUMBER, PREVRANDAO, GASLIMIT, CHAINID, SELFBALANCE, BASEFEE, 
        //           then 4 block hashes (n-1, n-2, n-3, n-4 in proof vs n-2, n-3, n-4, n-5 in _computeBlockInfosHash)
        let concatenatedData = '';
        
        for (let i = 0; i < 24; i += 2) {
            // Get lower and upper 16 bytes (matching the Solidity function)
            let lower = blockInputs[i];      // publicInputs[i] in Solidity
            let upper = blockInputs[i + 1];  // publicInputs[i + 1] in Solidity
            
            // Remove '0x' prefix if present
            if (lower.startsWith('0x')) {
                lower = lower.slice(2);
            }
            if (upper.startsWith('0x')) {
                upper = upper.slice(2);
            }
            
            // Convert to proper uint128 (16 bytes) - truncate if longer, pad if shorter
            // uint128 in Solidity is exactly 16 bytes (128 bits)
            if (lower.length > 32) lower = lower.slice(-32); // Take last 32 hex chars (16 bytes)
            if (upper.length > 32) upper = upper.slice(-32); // Take last 32 hex chars (16 bytes)
            
            lower = lower.padStart(32, '0');  // Pad to exactly 16 bytes
            upper = upper.padStart(32, '0');  // Pad to exactly 16 bytes
            
            // Combine as upper + lower (back to matching Solidity's: bytes16(uint128(upper)), bytes16(uint128(lower)))
            // This means upper comes first, then lower
            concatenatedData += upper + lower;
            
            console.log(`Variable ${Math.floor(i/2)}: lower=${blockInputs[i]}, upper=${blockInputs[i+1]} -> ${upper}${lower}`);
        }
        
        // Convert hex string to buffer for keccak256
        const dataBuffer = Buffer.from(concatenatedData, 'hex');
        
        // Compute keccak256 hash
        const hash = '0x' + keccak256(dataBuffer);
        
        console.log(`Concatenated data length: ${concatenatedData.length} hex chars (${concatenatedData.length/2} bytes)`);
        console.log(`Computed block info hash: ${hash}`);
        
        return hash;
        
    } catch (error) {
        console.error('Error computing block info hash:', error.message);
        throw error;
    }
}

/**
 * Main execution function
 */
function main() {
    console.log('=== Block Info Hash Computer ===');
    console.log('This script replicates the hash computation from BridgeProofManager._extractBlockInfoHashFromProof()');
    console.log('');
    
    // Get file path from command line arguments
    const args = process.argv.slice(2);
    
    if (args.length === 0) {
        console.log('Usage: node computeBlockInfoHash.js <path-to-json-file>');
        console.log('Example: node computeBlockInfoHash.js utils/instance.json');
        console.log('');
        console.log('Note: This script processes the a_pub_block array from the JSON file.');
        process.exit(1);
    }
    
    const jsonFilePath = args[0];
    
    try {
        const hash = computeBlockInfoHash(jsonFilePath);
        console.log('\n=== RESULT ===');
        console.log(`Block Info Hash: ${hash}`);
        console.log('');
        console.log('This hash represents the block information used in proof verification.');
    } catch (error) {
        console.error('Failed to compute hash:', error.message);
        process.exit(1);
    }
}

// Run main function if script is executed directly
if (import.meta.url === `file://${process.argv[1]}`) {
    main();
}

export { computeBlockInfoHash };


================================================
FILE: utils/computeFunctionInstanceHash.js
================================================
#!/usr/bin/env node

import fs from 'fs';
import pkg from 'js-sha3';
const { keccak256 } = pkg;

/**
 * Computes the function instance hash from a JSON file containing public inputs
 * This replicates the logic from BridgeProofManager._extractFunctionInstanceHashFromProof()
 * 
 * @param {string} jsonFilePath - Path to the JSON file (e.g., test/verifier/proof1/a_pub_function.json)
 * @returns {string} - The computed keccak256 hash as a hex string
 */
function computeFunctionInstanceHash(jsonFilePath) {
    try {
        // Read and parse the JSON file
        const jsonData = JSON.parse(fs.readFileSync(jsonFilePath, 'utf8'));
        
        // Extract the a_pub_function array
        const publicInputs = jsonData.a_pub_function;
        
        if (!Array.isArray(publicInputs)) {
            throw new Error('Invalid JSON structure: a_pub_function should be an array');
        }
        
        // When working directly with a_pub_function, use all data starting from index 0
        // (The index 66 offset is only used when working with combined public inputs)
        const functionInstanceData = publicInputs;
        
        console.log(`Total public inputs: ${publicInputs.length}`);
        console.log(`Function instance data length: ${functionInstanceData.length}`);
        console.log(`Function instance data (first 10 entries):`, functionInstanceData.slice(0, 10));
        
        // Convert hex strings to bytes and concatenate for keccak256
        // Each hex string represents a uint256 (32 bytes)
        let concatenatedData = '';
        
        for (let i = 0; i < functionInstanceData.length; i++) {
            let hexValue = functionInstanceData[i];
            
            // Remove '0x' prefix if present
            if (hexValue.startsWith('0x')) {
                hexValue = hexValue.slice(2);
            }
            
            // Pad to 64 characters (32 bytes) for uint256
            hexValue = hexValue.padStart(64, '0');
            concatenatedData += hexValue;
        }
        
        // Convert hex string to buffer for keccak256
        const dataBuffer = Buffer.from(concatenatedData, 'hex');
        
        // Compute keccak256 hash
        const hash = '0x' + keccak256(dataBuffer);
        
        console.log(`Concatenated data length: ${concatenatedData.length} hex chars (${concatenatedData.length/2} bytes)`);
        console.log(`Computed function instance hash: ${hash}`);
        
        return hash;
        
    } catch (error) {
        console.error('Error computing function instance hash:', error.message);
        throw error;
    }
}

/**
 * Main execution function
 */
function main() {
    console.log('=== Function Instance Hash Computer ===');
    console.log('This script replicates the hash computation from BridgeProofManager.sol');
    console.log('');
    
    // Get file path from command line arguments
    const args = process.argv.slice(2);
    
    if (args.length === 0) {
        console.log('Usage: node computeFunctionInstanceHash.js <path-to-json-file>');
        console.log('Example: node computeFunctionInstanceHash.js test/verifier/proof1/a_pub_function.json');
        console.log('');
        console.log('Note: This script now uses proper keccak256 from js-sha3 package.');
        process.exit(1);
    }
    
    const jsonFilePath = args[0];
    
    try {
        const hash = computeFunctionInstanceHash(jsonFilePath);
        console.log('\n=== RESULT ===');
        console.log(`Function Instance Hash: ${hash}`);
        console.log('');
        console.log('This hash should match the instancesHash in the registered function');
        console.log('when used in submitProofAndSignature verification.');
    } catch (error) {
        console.error('Failed to compute hash:', error.message);
        process.exit(1);
    }
}

// Run main function if script is executed directly
if (import.meta.url === `file://${process.argv[1]}`) {
    main();
}

export { computeFunctionInstanceHash };


================================================
FILE: utils/instance.json
================================================
{
  "a_pub_user": [
    "0x11420a3238e017cc098dfb6a46b4af5c",
    "0x30af2c2d6ea0a909996df04531d19b36",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x639c04dd552be2eb627060b8ce1bdbb3",
    "0x3a11d3412ac42d891c960c7cc1c5f8e6",
    "0xa2ba752bfe4819f0ae4fca417e456dda",
    "0xdd331c991e4350e201aa60546c63a4c",
    "0x85b8f5c0457dbc3b7c8a280373c40044",
    "0xa30fe402",
    "0xa9059cbb",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0"
  ],
  "a_pub_block": [
    "0x0",
    "0x0",
    "0x69689f34",
    "0x0",
    "0x995129",
    "0x0",
    "0x65041d3af67e814c20b9477fc0a8cba4",
    "0x915c0a256ab7b0283b2ecdd5a91b4e87",
    "0x3938700",
    "0x0",
    "0xaa36a7",
    "0x0",
    "0x0",
    "0x0",
    "0x3679464f",
    "0x0",
    "0x16f53c96ac0acf9318b0cff1b65a06d6",
    "0x56fa8b878ea075f386363246f6cae60",
    "0xa54923f8851260ec9636b3f0ec4c7f03",
    "0x18d2244704c588174cddfa8c8a7eab83",
    "0x64eeed017d4d3bd0a7c3c8c8135478b5",
    "0x21da0b08b5dcf5cd87494400dbc6068",
    "0x839dfe0a226c6cd75dfb7884c5eda253",
    "0x3e2e390a3d954384c439a6f7582f8d76"
  ],
  "a_pub_function": [
    "0x1",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xe72f6afd7d1f72623e6b071492d1122b",
    "0x11dafe5d23e1218086a365b99fbf3d3b",
    "0x3e26ba5cc220fed7cc3f870e59d292aa",
    "0x1d523cf1ddab1a1793132e78c866c0c3",
    "0x0",
    "0x0",
    "0x1",
    "0x0",
    "0x80",
    "0x0",
    "0x0",
    "0x0",
    "0x200000",
    "0x4",
    "0x0",
    "0x44",
    "0x0",
    "0x10000",
    "0xe0",
    "0x0",
    "0x8000000",
    "0x20",
    "0x0",
    "0x10000000",
    "0xe0",
    "0x0",
    "0x10000000",
    "0x70a08231",
    "0x0",
    "0x20000",
    "0x98650275",
    "0x0",
    "0x20000",
    "0xaa271e1a",
    "0x0",
    "0x20000",
    "0x98650275",
    "0x0",
    "0x100000",
    "0xa457c2d7",
    "0x0",
    "0x100000",
    "0xa9059cbb",
    "0x0",
    "0x100000",
    "0x4",
    "0x0",
    "0x44",
    "0x0",
    "0x8",
    "0x40",
    "0x0",
    "0x10000",
    "0x200000",
    "0x2",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x0",
    "0x2",
    "0x20",
    "0x0",
    "0x2",
    "0x0",
    "0x0",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x100000",
    "0x200000",
    "0x0",
    "0x0",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x100000",
    "0x200000",
    "0x60",
    "0x0",
    "0x2",
    "0x20",
    "0x0",
    "0x2",
    "0x0",
    "0x0",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x0",
    "0x2",
    "0x20",
    "0x0",
    "0x2",
    "0x1da9",
    "0x0",
    "0xffffffff",
    "0x0",
    "0x20000",
    "0x200000",
    "0x8",
    "0x0",
    "0x0",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x0",
    "0x2",
    "0x20",
    "0x0",
    "0x2",
    "0x0",
    "0x0",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x0",
    "0x2",
    "0x20",
    "0x0",
    "0x2",
    "0x1acc",
    "0x0",
    "0xffffffff",
    "0x0",
    "0x2",
    "0x10000",
    "0x200000",
    "0x0",
    "0x0",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x0",
    "0x2",
    "0x20",
    "0x0",
    "0x2",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0xffffffffffffffffffffffffffffffff",
    "0xffffffff",
    "0x20",
    "0x0",
    "0x2",
    "0x8",
    "0x7",
    "0x0",
    "0x15",
    "0x0",
    "0x100",
    "0x0",
    "0x1",
    "0x0",
    "0x10",
    "0xff",
    "0x0",
    "0x200000",
    "0x200000",
    "0x1",
    "0x0",
    "0x200000",
    "0x200000",
    "0x200000",
    "0x200000",
    "0x20",
    "0x0",
    "0x2",
    "0x8",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x0",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00",
    "0x00"
  ]
}


================================================
FILE: utils/instance_description.json
================================================
{
  "a_pub_user_description": [
    "Resulting Merkle tree root hash (lower 16 bytes)",
    "Resulting Merkle tree root hash (upper 16 bytes)",
    "",
    "",
    "",
    "",
    "",
    "",
    "Initial Merkle tree root hash (lower 16 bytes)",
    "Initial Merkle tree root hash (upper 16 bytes)",
    "EdDSA signature of transaction (lower 16 bytes)",
    "EdDSA signature of transaction (upper 16 bytes)",
    "Contract address to call (lower 16 bytes)",
    "Contract address to call (upper 16 bytes)",
    "Selector for a function to call (lower 16 bytes)",
    "Selector for a function to call (upper 16 bytes)",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    ""
  ],
  "a_pub_block_description": [
    "COINBASE (lower 16 bytes)",
    "COINBASE (upper 16 bytes)",
    "TIMESTAMP (lower 16 bytes)",
    "TIMESTAMP (upper 16 bytes)",
    "NUMBER (lower 16 bytes)",
    "NUMBER (upper 16 bytes)",
    "PREVRANDAO (lower 16 bytes)",
    "PREVRANDAO (upper 16 bytes)",
    "GASLIMIT (lower 16 bytes)",
    "GASLIMIT (upper 16 bytes)",
    "CHAINID (lower 16 bytes)",
    "CHAINID (upper 16 bytes)",
    "SELFBALANCE (lower 16 bytes)",
    "SELFBALANCE (upper 16 bytes)",
    "BASEFEE (lower 16 bytes)",
    "BASEFEE (upper 16 bytes)",
    "Block hash 1 block ago (lower 16 bytes)",
    "Block hash 1 block ago (upper 16 bytes)",
    "Block hash 2 blocks ago (lower 16 bytes)",
    "Block hash 2 blocks ago (upper 16 bytes)",
    "Block hash 3 blocks ago (lower 16 bytes)",
    "Block hash 3 blocks ago (upper 16 bytes)",
    "Block hash 4 blocks ago (lower 16 bytes)",
    "Block hash 4 blocks ago (upper 16 bytes)"
  ],
  "a_pub_function_description": [
    "Arbitrary constant",
    "Masker for Ethereum address (20 bytes) (lower 16 bytes)",
    "Masker for Ethereum address (20 bytes) (upper 16 bytes)",
    "Base point of Jubjub curve (x coordinate) (lower 16 bytes)",
    "Base point of Jubjub curve (x coordinate) (upper 16 bytes)",
    "Base point of Jubjub curve (y coordinate) (lower 16 bytes)",
    "Base point of Jubjub curve (y coordinate) (upper 16 bytes)",
    "Point at infinity of Jubjub curve (x coordinate) (lower 16 bytes)",
    "Point at infinity of Jubjub curve (x coordinate) (upper 16 bytes)",
    "Point at infinity of Jubjub curve (y coordinate) (lower 16 bytes)",
    "Point at infinity of Jubjub curve (y coordinate) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC -1 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC -1 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for CALLVALUE instruction at PC 4 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth : 0) (lower 16 bytes)",
    "Static input for CALLVALUE instruction at PC 4 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth : 0) (upper 16 bytes)",
    "ALU selector for ISZERO of ALU1",
    "Static input for PUSH1 instruction at PC 17 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 17 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for CALLDATASIZE instruction at PC 19 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth : 0) (lower 16 bytes)",
    "Static input for CALLDATASIZE instruction at PC 19 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth : 0) (upper 16 bytes)",
    "ALU selector for LT of ALU4",
    "Shifter for memory manipulation (lower 16 bytes)",
    "Shifter for memory manipulation (upper 16 bytes)",
    "ALU selector for SHL of ALU3",
    "Shifter for memory manipulation (lower 16 bytes)",
    "Shifter for memory manipulation (upper 16 bytes)",
    "ALU selector for SHR of ALU3",
    "Static input for PUSH1 instruction at PC 28 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 28 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for SHR of ALU3",
    "Static input for PUSH4 instruction at PC 32 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 32 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for GT of ALU4",
    "Static input for PUSH4 instruction at PC 43 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 43 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for GT of ALU4",
    "Static input for PUSH4 instruction at PC 54 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 54 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for GT of ALU4",
    "Static input for PUSH4 instruction at PC 114 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 114 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for EQ of ALU1",
    "Static input for PUSH4 instruction at PC 125 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 125 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for EQ of ALU1",
    "Static input for PUSH4 instruction at PC 136 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 136 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for EQ of ALU1",
    "Static input for PUSH1 instruction at PC 2142 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 2142 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for CALLDATASIZE instruction at PC 2145 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth : 0) (lower 16 bytes)",
    "Static input for CALLDATASIZE instruction at PC 2145 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth : 0) (upper 16 bytes)",
    "ALU selector for SUB of ALU1",
    "Static input for PUSH1 instruction at PC 2147 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 2147 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for LT of ALU4",
    "ALU selector for ISZERO of ALU1",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH20 instruction at PC 2167 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 2167 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 2190 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 2190 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 2200 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 2200 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 10515 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10515 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10517 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10517 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10540 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10540 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for EQ of ALU1",
    "ALU selector for ISZERO of ALU1",
    "Static input for PUSH1 instruction at PC 10649 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10649 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10651 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10651 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10674 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10674 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for EQ of ALU1",
    "ALU selector for ISZERO of ALU1",
    "Static input for PUSH1 instruction at PC 10791 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10791 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 10802 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10802 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 10812 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10812 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10816 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10816 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10838 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10838 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 10862 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10862 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 10868 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10868 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH2 instruction at PC 10875 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH2 instruction at PC 10875 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH4 instruction at PC 10882 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 10882 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for GT of ALU4",
    "ALU selector for ISZERO of ALU1",
    "ALU selector for SUB of ALU1",
    "Static input for PUSH1 instruction at PC 10890 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10890 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10894 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10894 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10916 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10916 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 10940 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10940 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 10946 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10946 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 10960 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 10960 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10964 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10964 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 10986 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 10986 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 11010 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 11010 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 11016 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 11016 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH2 instruction at PC 11023 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH2 instruction at PC 11023 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH4 instruction at PC 11029 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH4 instruction at PC 11029 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "ALU selector for LT of ALU4",
    "ALU selector for ISZERO of ALU1",
    "Static input for PUSH1 instruction at PC 11037 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 11037 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 11041 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 11041 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 11063 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 11063 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 11087 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 11087 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH1 instruction at PC 11093 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 11093 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "Static input for PUSH20 instruction at PC 11104 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 11104 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH20 instruction at PC 11127 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH20 instruction at PC 11127 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 11190 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 11190 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "ALU selector for SUB of ALU1",
    "Static input for PUSH1 instruction at PC 7796 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 7796 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH1 instruction at PC 7798 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 7798 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Static input for PUSH2 instruction at PC 7803 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH2 instruction at PC 7803 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "Arbitrary constant (lower 16 bytes)",
    "Arbitrary constant (upper 16 bytes)",
    "ALU selector for DIV of ALU2",
    "Static input for PUSH1 instruction at PC 7809 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 7809 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ISZERO of ALU1",
    "ALU selector for ISZERO of ALU1",
    "Static input for PUSH1 instruction at PC 5780 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 5780 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ISZERO of ALU1",
    "ALU selector for ISZERO of ALU1",
    "ALU selector for ISZERO of ALU1",
    "ALU selector for ISZERO of ALU1",
    "Static input for PUSH1 instruction at PC 2226 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (lower 16 bytes)",
    "Static input for PUSH1 instruction at PC 2226 of code address 0xa30fe40285b8f5c0457dbc3b7c8a280373c40044 (depth: 0) (upper 16 bytes)",
    "ALU selector for ADD of ALU1",
    "ALU selector for SUB of ALU1",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    "",
    ""
  ]
}


================================================
FILE: .github/ISSUE_TEMPLATE/bug_report.md
================================================
name: Bug Report
description: Report a bug in the zkEVM verifier or related contracts
title: "[Bug] <short description>"
labels: ["bug", "needs triage"]
assignees: ""

body:
  - type: markdown
    attributes:
      value: |
        ## Thank you for reporting a bug!

  - type: input
    id: what-happened
    attributes:
      label: What happened?
      description: Describe the bug in detail.
      placeholder: Describe the unexpected behavior
    validations:
      required: true

  - type: textarea
    id: reproduction-steps
    attributes:
      label: Steps to reproduce
      description: How can we reproduce the issue?
      placeholder: |
        1. Go to '...'
        2. Click on '...'
        3. See the error
    validations:
      required: true

  - type: input
    id: contract-version
    attributes:
      label: Contract Version / Branch
      placeholder: e.g., main / L2toL2Implementation

  - type: textarea
    id: additional-context
    attributes:
      label: Additional context
      description: Add any other context or logs here


================================================
FILE: .github/ISSUE_TEMPLATE/feature_request.md
================================================
name: Feature Request
description: Suggest an improvement or new feature
title: "[Feature] <short description>"
labels: ["enhancement"]
assignees: ""

body:
  - type: input
    id: request-summary
    attributes:
      label: Summary
      description: A short summary of the feature request
      placeholder: Add a new opcode verifier...

  - type: textarea
    id: motivation
    attributes:
      label: Motivation
      description: Why is this feature important?
      placeholder: It helps reduce gas cost in...
    validations:
      required: true

  - type: textarea
    id: proposal
    attributes:
      label: Proposal
      description: Describe your proposed solution
      placeholder: We could refactor the verifier to...

  - type: dropdown
    id: priority
    attributes:
      label: Priority
      options:
        - High
        - Medium
        - Low


================================================
FILE: .github/workflows/claude-code-review.yml
================================================
name: Claude Code Review

on:
  pull_request:
    types: [opened, synchronize]
    # Optional: Only run on specific file changes
    # paths:
    #   - "src/**/*.ts"
    #   - "src/**/*.tsx"
    #   - "src/**/*.js"
    #   - "src/**/*.jsx"

jobs:
  claude-review:
    # Optional: Filter by PR author
    # if: |
    #   github.event.pull_request.user.login == 'external-contributor' ||
    #   github.event.pull_request.user.login == 'new-developer' ||
    #   github.event.pull_request.author_association == 'FIRST_TIME_CONTRIBUTOR'
    
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: read
      issues: read
      id-token: write
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Run Claude Code Review
        id: claude-review
        uses: anthropics/claude-code-action@beta
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}

          # Optional: Specify model (defaults to Claude Sonnet 4, uncomment for Claude Opus 4.1)
          # model: "claude-opus-4-1-20250805"

          # Direct prompt for automated review (no @claude mention needed)
          direct_prompt: |
            Please review this pull request and provide feedback on:
            - Code quality and best practices
            - Potential bugs or issues
            - Performance considerations
            - Security concerns
            - Test coverage
            
            Be constructive and helpful in your feedback.

          # Optional: Use sticky comments to make Claude reuse the same comment on subsequent pushes to the same PR
          # use_sticky_comment: true
          
          # Optional: Customize review based on file types
          # direct_prompt: |
          #   Review this PR focusing on:
          #   - For TypeScript files: Type safety and proper interface usage
          #   - For API endpoints: Security, input validation, and error handling
          #   - For React components: Performance, accessibility, and best practices
          #   - For tests: Coverage, edge cases, and test quality
          
          # Optional: Different prompts for different authors
          # direct_prompt: |
          #   ${{ github.event.pull_request.author_association == 'FIRST_TIME_CONTRIBUTOR' && 
          #   'Welcome! Please review this PR from a first-time contributor. Be encouraging and provide detailed explanations for any suggestions.' ||
          #   'Please provide a thorough code review focusing on our coding standards and best practices.' }}
          
          # Optional: Add specific tools for running tests or linting
          # allowed_tools: "Bash(npm run test),Bash(npm run lint),Bash(npm run typecheck)"
          
          # Optional: Skip review for certain conditions
          # if: |
          #   !contains(github.event.pull_request.title, '[skip-review]') &&
          #   !contains(github.event.pull_request.title, '[WIP]')




================================================
FILE: .github/workflows/claude.yml
================================================
name: Claude Code

on:
  issue_comment:
    types: [created]
  pull_request_review_comment:
    types: [created]
  issues:
    types: [opened, assigned]
  pull_request_review:
    types: [submitted]

jobs:
  claude:
    if: |
      (github.event_name == 'issue_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'pull_request_review_comment' && contains(github.event.comment.body, '@claude')) ||
      (github.event_name == 'pull_request_review' && contains(github.event.review.body, '@claude')) ||
      (github.event_name == 'issues' && (contains(github.event.issue.body, '@claude') || contains(github.event.issue.title, '@claude')))
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: read
      issues: read
      id-token: write
      actions: read # Required for Claude to read CI results on PRs
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Run Claude Code
        id: claude
        uses: anthropics/claude-code-action@beta
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}

          # This is an optional setting that allows Claude to read CI results on PRs
          additional_permissions: |
            actions: read
          
          # Optional: Specify model (defaults to Claude Sonnet 4, uncomment for Claude Opus 4.1)
          # model: "claude-opus-4-1-20250805"
          
          # Optional: Customize the trigger phrase (default: @claude)
          # trigger_phrase: "/claude"
          
          # Optional: Trigger when specific user is assigned to an issue
          # assignee_trigger: "claude-bot"
          
          # Optional: Allow Claude to run specific commands
          # allowed_tools: "Bash(npm install),Bash(npm run build),Bash(npm run test:*),Bash(npm run lint:*)"
          
          # Optional: Add custom instructions for Claude to customize its behavior for your project
          # custom_instructions: |
          #   Follow our coding standards
          #   Ensure all new code has tests
          #   Use TypeScript for new files
          
          # Optional: Custom environment variables for Claude
          # claude_env: |
          #   NODE_ENV: test




================================================
FILE: .github/workflows/test.yml
================================================
name: CI

on:
  push:
  pull_request:
  workflow_dispatch:

env:
  FOUNDRY_PROFILE: ci

jobs:
  check:
    strategy:
      fail-fast: true

    name: Foundry project
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: recursive

      - name: Install Foundry
        uses: foundry-rs/foundry-toolchain@v1
        with:
          version: nightly

      - name: Show Forge version
        run: |
          forge --version

      - name: Run Forge build
        run: |
          forge build --sizes
        id: build

      - name: Run Forge tests
        run: |
          forge test -vvv
        id: test


